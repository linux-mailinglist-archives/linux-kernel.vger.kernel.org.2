Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id A42FB444FFD
	for <lists+linux-kernel@lfdr.de>; Thu,  4 Nov 2021 09:15:09 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S230401AbhKDIRo (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Thu, 4 Nov 2021 04:17:44 -0400
Received: from smtp-out1.suse.de ([195.135.220.28]:41492 "EHLO
        smtp-out1.suse.de" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S230084AbhKDIRn (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Thu, 4 Nov 2021 04:17:43 -0400
Received: from relay2.suse.de (relay2.suse.de [149.44.160.134])
        by smtp-out1.suse.de (Postfix) with ESMTP id 35DA7212C1;
        Thu,  4 Nov 2021 08:15:05 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
        t=1636013705; h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
         mime-version:mime-version:content-type:content-type:
         content-transfer-encoding:content-transfer-encoding:
         in-reply-to:in-reply-to:references:references;
        bh=zjfpjf+wWG+a6PW8/Ph/9P7mUOMrhlSJIQZr1/dyvjA=;
        b=iuPabJfi930FIxY1p7TzCKK4A5T2WfUTPWrsLxmFmJMdboVA9ueLfBRqH1ztz2Y5ZSCV8V
        TckVjx1TgbBH4IigGlTZemmAISRedHkHbhiHKU4WUxo+G1bUNVM0j/R6kapLyswgYNeDPA
        656BVKIixK3b+aJrVTSDzixUXi3ZAcA=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
        s=susede2_ed25519; t=1636013705;
        h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
         mime-version:mime-version:content-type:content-type:
         content-transfer-encoding:content-transfer-encoding:
         in-reply-to:in-reply-to:references:references;
        bh=zjfpjf+wWG+a6PW8/Ph/9P7mUOMrhlSJIQZr1/dyvjA=;
        b=BTKgHI8sc6CGYmBYEGe6drTehIs4UvH5RLl9Nmagtjy58OaLLjhIH/QQ19VNIppvIrn3tz
        7qQZxB8VAtuOxcDg==
Received: from alsa1.suse.de (alsa1.suse.de [10.160.4.42])
        by relay2.suse.de (Postfix) with ESMTP id AB67E2C144;
        Thu,  4 Nov 2021 08:15:04 +0000 (UTC)
Date:   Thu, 04 Nov 2021 09:15:04 +0100
Message-ID: <s5hlf24jq0n.wl-tiwai@suse.de>
From:   Takashi Iwai <tiwai@suse.de>
To:     Guo Zhengkui <guozhengkui@vivo.com>
Cc:     Jaroslav Kysela <perex@perex.cz>, Takashi Iwai <tiwai@suse.com>,
        Jeremy Szu <jeremy.szu@canonical.com>,
        Kailang Yang <kailang@realtek.com>,
        Hui Wang <hui.wang@canonical.com>,
        Chris Chiu <chris.chiu@canonical.com>,
        Cameron Berkenpas <cam@neo-zeon.de>,
        PeiSen Hou <pshou@realtek.com>,
        Werner Sembach <wse@tuxedocomputers.com>,
        Sami Loone <sami@loone.fi>, Elia Devito <eliadevito@gmail.com>,
        alsa-devel@alsa-project.org, linux-kernel@vger.kernel.org,
        kernel@vivo.com
Subject: Re: [PATCH] ALSA: hda/realtek: fix flexible_array.cocci warning
In-Reply-To: <20211104080017.589-1-guozhengkui@vivo.com>
References: <20211104080017.589-1-guozhengkui@vivo.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On Thu, 04 Nov 2021 08:59:41 +0100,
Guo Zhengkui wrote:
> 
> Fix following coccicheck warnings:
> ./sound/pci/hda/patch_realtek.c:128:4-24: WARNING use
> flexible-array member instead.
> 
> There is a regular need in the kernel to provide a way
> to declare having a dynamically sized set of trailing
> elements in a structure. Kernel code should always use
> “flexible array members” for these cases. The older style
> of one-element or zero-length arrays should no longer be used.
> 
> Signed-off-by: Guo Zhengkui <guozhengkui@vivo.com>

It's a false positive.  That is no flexible array but really an array
of the size 1.  It's written in that way so that you can extend more
members in future in case other keys needed.


thanks,

Takashi

> ---
>  sound/pci/hda/patch_realtek.c | 2 +-
>  1 file changed, 1 insertion(+), 1 deletion(-)
> 
> diff --git a/sound/pci/hda/patch_realtek.c b/sound/pci/hda/patch_realtek.c
> index 6322fac9e694..7935c363092e 100644
> --- a/sound/pci/hda/patch_realtek.c
> +++ b/sound/pci/hda/patch_realtek.c
> @@ -125,7 +125,7 @@ struct alc_spec {
>  	unsigned int pll_coef_idx, pll_coef_bit;
>  	unsigned int coef0;
>  	struct input_dev *kb_dev;
> -	u8 alc_mute_keycode_map[1];
> +	u8 alc_mute_keycode_map[];
>  };
>  
>  /*
> -- 
> 2.20.1
> 
