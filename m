Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id D2D6B359C47
	for <lists+linux-kernel@lfdr.de>; Fri,  9 Apr 2021 12:38:43 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S233804AbhDIKiu (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Fri, 9 Apr 2021 06:38:50 -0400
Received: from mail.kernel.org ([198.145.29.99]:35694 "EHLO mail.kernel.org"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S233755AbhDIKi0 (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
        Fri, 9 Apr 2021 06:38:26 -0400
Received: from disco-boy.misterjones.org (disco-boy.misterjones.org [51.254.78.96])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        by mail.kernel.org (Postfix) with ESMTPSA id 8BCF560230;
        Fri,  9 Apr 2021 10:38:13 +0000 (UTC)
Received: from 78.163-31-62.static.virginmediabusiness.co.uk ([62.31.163.78] helo=why.misterjones.org)
        by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        (Exim 4.94)
        (envelope-from <maz@kernel.org>)
        id 1lUoWh-006WQt-Gu; Fri, 09 Apr 2021 11:38:11 +0100
Date:   Fri, 09 Apr 2021 11:38:11 +0100
Message-ID: <87k0pboi98.wl-maz@kernel.org>
From:   Marc Zyngier <maz@kernel.org>
To:     414777006@qq.com
Cc:     tglx@linutronix.de, linux-kernel@vger.kernel.org,
        Mengguang Peng <pengmengguang@phytium.com.cn>
Subject: Re: [PATCH] irqchip: fixed S3 could not resume after suspend
In-Reply-To: <tencent_7DFDDF87297476D86084241FE91E1E9D950A@qq.com>
References: <tencent_7DFDDF87297476D86084241FE91E1E9D950A@qq.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/27.1
 (x86_64-pc-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 62.31.163.78
X-SA-Exim-Rcpt-To: 414777006@qq.com, tglx@linutronix.de, linux-kernel@vger.kernel.org, pengmengguang@phytium.com.cn
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On Fri, 09 Apr 2021 11:10:09 +0100,
414777006@qq.com wrote:
> 
> From: Mengguang Peng <pengmengguang@phytium.com.cn>
> 
> On arm64 platform, found that the machine could not wake up after suspend,
> this patch updates the its suspend and resume handling code.
> 
> - Add a variable named ctlr_save in struct rdists.
> - When suspend, save the value of GICR_CTLR to memmory
> 	in its_save_disable().
> - When resume, write the value of memory saved to GICR_CTLR
> 	in its_restore_enable().

This really is the kind of things that must be handled by firmware.
How comes yours doesn't handle it?

That is what you should be fixing. See the ATF code for a (working)
reference implementation

Thanks,

	M.

-- 
Without deviation from the norm, progress is not possible.
