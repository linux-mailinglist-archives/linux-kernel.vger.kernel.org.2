Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 339023CF91B
	for <lists+linux-kernel@lfdr.de>; Tue, 20 Jul 2021 13:47:06 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S237679AbhGTLGW (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Tue, 20 Jul 2021 07:06:22 -0400
Received: from mail-sn1anam02on2129.outbound.protection.outlook.com ([40.107.96.129]:35952
        "EHLO NAM02-SN1-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S234685AbhGTLCv (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
        Tue, 20 Jul 2021 07:02:51 -0400
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=mVXuwnEFw6iNf2dEDLB5RedJEhUQ56SRHvr1V5SSxmfW3XMmHE7593iGf7s2gfCI/xOI7BR4YvI/p/P8Q4DR96OeMnaZjnQzMwwMfCi2/e4f/TWvk6fFzTRGk/Zhh9PoKa3TRqmJ0FE7VURwk5OZY/zr2T9cqOsK2S0FxQxI9xgcLJhYZCa+ODMEbv5kedF9KJs76nJeTzi92dQxWe3QOWnBnNW+IpJURtn5XXTGZN3ViSAXzW3kFduAcddTojcfhjrQPq5trsB6TuNBV4hFQYMECCtiq6NAFWpjbp7cPLC+K3WAsDHlvXkunzl3ObYWAe1FWJqUB7E9+30S+0D94A==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Wcj6SQ5VdmWqnYXmb2U1Wwb4JXW0OB1nel6HJTeLZZ0=;
 b=fl9wajNSolwjLiYpjw1QJTdM5FI1gkJZQuAY+wmjSRINRjZFnNSkeebfUfqpejqxz5k5zDV5HNqYLLvTr7N7Y/u3mhIl3xTRojjLG0C63dyl+vTeRz4H9Jp7yACoe0odcDZnFOh30Ux1mD0qr2/YyO14PCwoiiR0oy1hZd0JM+697mQ+9eqA3UD8Zww3a2W/1q8TD6GJNAqOzazfSbkXI3+EixdcvErE6q20Q0ewuwAXhKfeTJblug0vJgWHHTmj2NX/Z/MKZyaqWpo5cNDweOsLKNweiuUwWTw7HZbIY8QwLMFRM6To6WBLd4CpYYcAFprzrzgV5Fokp+ptssG9fw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=bayhubtech.com; dmarc=pass action=none
 header.from=bayhubtech.com; dkim=pass header.d=bayhubtech.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=towerbridgetechnology.onmicrosoft.com;
 s=selector2-towerbridgetechnology-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Wcj6SQ5VdmWqnYXmb2U1Wwb4JXW0OB1nel6HJTeLZZ0=;
 b=Gf3HsXQjjzNHRT8+5eYTqsopOkdNsj8SxdshQI+8uUpKLurCzPdSOVTKstH25cRdm607xWKUDHNK238ctdx8EOoeFLPOAcmrIwFKOur+HZNF0fJvTRV9rHUW7j3lXl6iDamv0BIzP+E57Cng2UbVRIVbhprmBW6PYciENM5DC2I=
Received: from SN6PR16MB2480.namprd16.prod.outlook.com (2603:10b6:805:d2::17)
 by SN1PR16MB2398.namprd16.prod.outlook.com (2603:10b6:802:27::33) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4331.31; Tue, 20 Jul
 2021 11:43:21 +0000
Received: from SN6PR16MB2480.namprd16.prod.outlook.com
 ([fe80::c967:1927:1aeb:a5c]) by SN6PR16MB2480.namprd16.prod.outlook.com
 ([fe80::c967:1927:1aeb:a5c%3]) with mapi id 15.20.4331.034; Tue, 20 Jul 2021
 11:43:21 +0000
From:   "Chevron Li (WH)" <chevron.li@bayhubtech.com>
To:     "adrian.hunter@intel.com" <adrian.hunter@intel.com>,
        "ulf.hansson@linaro.org" <ulf.hansson@linaro.org>,
        "linux-mmc@vger.kernel.org" <linux-mmc@vger.kernel.org>,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>
CC:     "Shaper Liu (WH)" <shaper.liu@bayhubtech.com>,
        "Xiaoguang Yu (WH)" <xiaoguang.yu@bayhubtech.com>,
        "Shirley Her (SC)" <shirley.her@bayhubtech.com>
Subject: =?gb2312?B?u9i4tDogW1BBVENIIFYxIDEvMV1tbWM6c2RoY2ktYmF5aHViOmZpeCBRdWFs?=
 =?gb2312?Q?comm_sd_host_845_SD_card_compatibility_issue?=
Thread-Topic: [PATCH V1 1/1]mmc:sdhci-bayhub:fix Qualcomm sd host 845 SD card
 compatibility issue
Thread-Index: AQHXeEyqesdCbfGVHEqOsL9YWdZICatLxjYg
Date:   Tue, 20 Jul 2021 11:43:20 +0000
Message-ID: <SN6PR16MB24808C4F8AEEBA4319A97859EAE29@SN6PR16MB2480.namprd16.prod.outlook.com>
References: <20210714010742.4707-1-chevron.li@bayhubtech.com>
In-Reply-To: <20210714010742.4707-1-chevron.li@bayhubtech.com>
Accept-Language: zh-CN, en-US
Content-Language: zh-CN
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: intel.com; dkim=none (message not signed)
 header.d=none;intel.com; dmarc=none action=none header.from=bayhubtech.com;
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: b6422ef1-d375-4e4d-fb55-08d94b739316
x-ms-traffictypediagnostic: SN1PR16MB2398:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <SN1PR16MB23984F416A06E4B2EE4D696FEAE29@SN1PR16MB2398.namprd16.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:154;
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: a4bNVFosacbpMMBgp5q4cTfUaBVgQMAf7apJ/7ECn9HepPffUA3nwMjFVAnEG4H5RBhUsHPEsqrulq7NRWX05ynmA+evGsWkVdwdfIsjpyDhmIk/2FPi+9DsqB+tNh1JLWQ4zW6UQiueX7dotVGG+Z4DBnaeEdtloN7QPSi71iXCgm/uhhttxEH4i+fOS9CTK7nbpGgWlZBcnShMHadpY3EOLS4W99u6fiAaWA2SlcGmLE62A3bGQawc49EW5HCBVC2fmmbIWnsyM3FC0gp9zgPAIu4VMcbInP0WZcIT7Jt0K1Konfe/J7U1ipaHaEHYdNdj3J00lC7onnRvjXl/YRFQQGQqYMgcbG85Vy+MIuW7Trj2VvEEqEx5ER75+GxQZBcw6YB5O+8Ba/JGsP+r4N8RJ15yVafnNs7LlV03ypo7ISMWhke4I18pxMZd4ERO5Wwl9iE7p6TwCtPKAxdLIhwWm+rHlQMX+lVIV/y++y4A/IwREeR6U9gTAnEGOFag9NR8+OJLeuerXqRZidAACEq7X0uEIJ/9nN3TYjFrE7PsDEBEurjE92ayHqwRNuIuTWlOzq//aEse+HcxZdBta1+pQZCWGpA6a1jQSO0tUkLLl7CiMDihZ/byjO/13h0UWynf2/MRdEArmbFJRvCHj6lQTBxmldwDASEo+868+0V5eczfs1i7TP9IrnoqyX0D32gYUFZ1b/hCFMBdIZ4YlLAv3rMSMHnG7ajuGmA5BPk=
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:SN6PR16MB2480.namprd16.prod.outlook.com;PTR:;CAT:NONE;SFS:(366004)(376002)(136003)(39830400003)(396003)(346002)(38100700002)(54906003)(224303003)(2906002)(55016002)(9686003)(30864003)(316002)(86362001)(110136005)(52536014)(5660300002)(107886003)(83380400001)(66476007)(4326008)(66946007)(8936002)(478600001)(26005)(66446008)(71200400001)(7696005)(122000001)(6506007)(186003)(64756008)(66556008)(33656002)(76116006)(2004002)(38070700004)(579004)(559001)(569008);DIR:OUT;SFP:1102;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?gb2312?B?MURCclp2QllzRW9ML3UxeE5CSVRrYWVKOWVCOWYxNDZIWE50clpIbThIQlFH?=
 =?gb2312?B?cVVLY1F0bGhKRGZIbkR1ZTFtM1VCeUs1enNCdjRZbU1kWGZMRm9BVGVJRGVj?=
 =?gb2312?B?aEsxZzhzNVhxbE5UdXRkbTQzdzVIZ2N3VWVUNHVvbS8rUy9tcmIzcXNjSDZK?=
 =?gb2312?B?TWNONVdUVGMxZ2hTSnEyS25Fa0Z0S3k1M2RoRUJWeU4vd1ZNNXArTG5yeTlK?=
 =?gb2312?B?SXR3MDNIREl6SkFvWWVUbTk2ZUFSb2lEQk9zcTI4MjVoakNDSzB0WHlMSWFB?=
 =?gb2312?B?TmY5Z3lCU1dkTmYvUGo1YUt3MUhXRmY3cGJXZERrN0JKczRNR0l2UEdvQWxB?=
 =?gb2312?B?cUNRbzNzU1pJTTV4Ny9MRndEdG1hRnJIQVlCL1VGT0grLzVvNmJHbHdaYUxS?=
 =?gb2312?B?R0lHaUNheGNuTlhSL1VGdVQrOHBPVlNXMEo5UlgySGJmajB6d0lCYTRrUkhQ?=
 =?gb2312?B?OHRQLzFpeGVvR2grR1VuUmJlWW9wVEtxMGhPR05Ybk5MeDUrdkg2TGg5cU03?=
 =?gb2312?B?ZWlONnlMWnNxTVFiOERYcm1KdzdMaDZDTXlkZVVvTDc5NmJ6MFpnNC9pV09i?=
 =?gb2312?B?cnU5U3VZRk50NWVJd25VSS9hekxyQmhZN09uL2dmbjRicWx6QXczanFJd0Uv?=
 =?gb2312?B?U2F0enA0RVJXVGFmZDZYREVZc0VlSmlTRGl5MU9qZWFGWTdWb3NpWTBjREZM?=
 =?gb2312?B?d3Vtb0l4c2JsTTNKQkFZUUtwbnNDc1ZNcEVlREg5RXdWYUN2TGtub3p4Sjk1?=
 =?gb2312?B?Z1FvMFBXSUh6c3ZtT2tKd2tKUjAwUXkxZ3JWTGF5UkEzaUMvd0RhSjArN0Jr?=
 =?gb2312?B?TlFqS3RyMVhMMk1SemMrMTZmUHQ4ZU1LZGVHWS9RZWxqSCt4MDBWeGhPS3kz?=
 =?gb2312?B?Ums1TWg2eWV1TnZ3b2Rzd0FwaXdBcWEzYWpRZEFqVWZNZTBDdWM0OEdPSzFh?=
 =?gb2312?B?aGdnWmZuV004ZWlQbGFMaFNHUDdQSUFkSlFPK0p5S1JRZmUvYWtPclhDb3la?=
 =?gb2312?B?SUhscC9ubis2LzRJQzQrOENOYmFQbkRQbXNPZEszQTd3TEl2K1gvdGhrbnA5?=
 =?gb2312?B?OEZlL1BMT0tsVGZLR3JIY296ZVUvclRyeVdsZWt3NEwxN2lid2I0bnhhQ3BM?=
 =?gb2312?B?Q1FqdzcrZmtVMWlqc29RWnpIeXBSbkZPYkdGdWU4MVdPWmxTWVZQNkw1eFVV?=
 =?gb2312?B?cit1RVB2T1laYzVrZEJUZGtYV1VjTWRJQUs3Y0N5UHIxZCs2ZzRUK2p4UGxo?=
 =?gb2312?B?QW93L2JRaDZGTTdkR3FWSnNMaU1nczdRT3VnOVNId295MnJHTDBIMTFEMDNU?=
 =?gb2312?B?UmdhMzRpc3JwT3N1Vmg3WTMyYU5QcEtIWnJoREs0dkMyOCtvV0xpemxFRHM1?=
 =?gb2312?B?MUExOHJNNEZGZE5CdWx1RkNKUXBYaEpFQjJxalJ5dW5iKzB0VThmaUR3dmUr?=
 =?gb2312?B?VTZiQkM1Y1BFS0o4aEQwSzlFYVhTLzhZTUtzZUF0NWZiVVlaR0JlZEJwSm1L?=
 =?gb2312?B?OWZEWndNTjhLWXRrUHpxOHdGRmxDSWc0QjBONlBYeDVycTQyZzE4bUUvSXlh?=
 =?gb2312?B?UG9WSG9OTG13SUh4Z1JUZGJVbzZTRGYyc3VLQWxGM2ZBWTlyVXMwK1AzaGtD?=
 =?gb2312?B?dFE1VmFtd1RsbGNmTU43SHlEb2FlaFpveHN3L1lONW0rRUNiL3A5SUtvSitR?=
 =?gb2312?B?Vk9wdy9tbEFkUzZoN2ZOS2VyVUdrYktzbEJvMFVYL2NuZWVjSU9NWmFndmxT?=
 =?gb2312?Q?Xdd82aLQerg2BgePKZR0tiJi9wCBlYIQLEoPDfP?=
Content-Type: text/plain; charset="gb2312"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: bayhubtech.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: SN6PR16MB2480.namprd16.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: b6422ef1-d375-4e4d-fb55-08d94b739316
X-MS-Exchange-CrossTenant-originalarrivaltime: 20 Jul 2021 11:43:20.7996
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 0a7aae2b-8f2e-44df-ba2f-42de7f93c642
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: Q/qrjMn6ArVljBzABOe8TaACr8kNDxfZkBi24egFiBbaBMw+QnvoAesgt3sBI1zpnPY2Bx1NOJflhLIqw4+hCyYpUb4IyPGYvdUZiYardcE=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SN1PR16MB2398
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

SGksIEFkcmlhbiZVbGYsDQoNCkNhbiB5b3UgZ2l2ZSBzb21lIGNvbW1lbnRzIGZvciB0aGlzIHBh
dGNoPw0KWW91ciBzdWdnZXN0aW9uIGlzIGltcG9ydGFudCBmb3IgdXMuDQpXZSBsb29rIGZvcndh
cmQgdG8gaGVhcmluZyBmcm9tIHlvdS4NCg0KLS0tLS3Tyrz+1K28/i0tLS0tDQq3orz+yMs6IENo
ZXZyb24gTGkgKFdIKSA8Y2hldnJvbi5saUBiYXlodWJ0ZWNoLmNvbT4gDQq3osvNyrG85DogV2Vk
bmVzZGF5LCBKdWx5IDE0LCAyMDIxIDk6MDggQU0NCsrVvP7IyzogYWRyaWFuLmh1bnRlckBpbnRl
bC5jb207IHVsZi5oYW5zc29uQGxpbmFyby5vcmc7IGxpbnV4LW1tY0B2Z2VyLmtlcm5lbC5vcmc7
IGxpbnV4Lmtlcm5lbEB2Z2VyLmtlcm5lbC5vcmcNCrOty806IFNoYXBlciBMaXUgKFdIKSA8c2hh
cGVyLmxpdUBiYXlodWJ0ZWNoLmNvbT47IENoZXZyb24gTGkgKFdIKSA8Y2hldnJvbi5saUBiYXlo
dWJ0ZWNoLmNvbT47IFhpYW9ndWFuZyBZdSAoV0gpIDx4aWFvZ3VhbmcueXVAYmF5aHVidGVjaC5j
b20+OyBTaGlybGV5IEhlciAoU0MpIDxzaGlybGV5LmhlckBiYXlodWJ0ZWNoLmNvbT4NCtb3zOI6
IFtQQVRDSCBWMSAxLzFdbW1jOnNkaGNpLWJheWh1YjpmaXggUXVhbGNvbW0gc2QgaG9zdCA4NDUg
U0QgY2FyZCBjb21wYXRpYmlsaXR5IGlzc3VlDQoNCkltcHJvdmUgdGhlIHNpZ25hbCBpbnRlZ3Jp
dHkgZm9yIGxvbmcgU0QgYnVzIHRyYWNlIGJ5IHVzaW5nIDg0NStCSDIwMSBTRCBob3N0IHJlZHJp
dmVyIGNoaXANCg0KU2lnbmVkLW9mZi1ieTogY2hldnJvbi5saSA8Y2hldnJvbi5saUBiYXlodWJ0
ZWNoLmNvbT4NCi0tLQ0KY2hhbmdlIGluIFYxOg0KMS4gY29weSBRdWFsY29tbSBkcml2ZXIgYmFz
ZSBmcm9tIHNkaGNpLW1zbS5jIHRvIHNkaGNpLWJheWh1Yi5jDQoyLiBpbXBsZW1lbnQgdGhlIEJI
MjAxIGNoaXAgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb24gYXQgc2RoY2ktYmF5aHViLmMNCjMuIGlt
cGxlbWVudCB0aGUgQkgyMDEgY2hpcCBwb3dlciBjb250cm9sIGZ1bmN0aW9uIGF0IHNkaGNpLWJh
eWh1Yi5jDQo0LiBpbXBsZW1lbnQgdGhlIEJIMjAxIGNoaXAgdHVuaW5nIGZ1bmN0aW9uIGF0IHNk
aGNpLWJheWh1Yi5jDQo1LiByZS1pbXBsZW1lbnQgbW1jX3Jlc2NhbiB0byBtYXRjaCBCSDIwMSBt
b2RlIHN3aXRjaCBmbG93IGF0IHNkaGNpLWJheWh1Yi5jDQotLS0NCi0tLQ0KIC4uLi9kZXZpY2V0
cmVlL2JpbmRpbmdzL21tYy9zZGhjaS1tc20udHh0ICAgICB8ICAgIDEgKw0KIGRyaXZlcnMvbW1j
L2hvc3QvTWFrZWZpbGUgICAgICAgICAgICAgICAgICAgICB8ICAgIDEgKw0KIGRyaXZlcnMvbW1j
L2hvc3Qvc2RoY2ktYmF5aHViLmMgICAgICAgICAgICAgICB8IDY1NjMgKysrKysrKysrKysrKysr
KysNCiAzIGZpbGVzIGNoYW5nZWQsIDY1NjUgaW5zZXJ0aW9ucygrKQ0KIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL21tYy9ob3N0L3NkaGNpLWJheWh1Yi5jDQoNCmRpZmYgLS1naXQgYS9Eb2N1
bWVudGF0aW9uL2RldmljZXRyZWUvYmluZGluZ3MvbW1jL3NkaGNpLW1zbS50eHQgYi9Eb2N1bWVu
dGF0aW9uL2RldmljZXRyZWUvYmluZGluZ3MvbW1jL3NkaGNpLW1zbS50eHQNCmluZGV4IDRjN2Zh
NmE0ZWQxNS4uYTA0MDFkYzE2OTI5IDEwMDY0NA0KLS0tIGEvRG9jdW1lbnRhdGlvbi9kZXZpY2V0
cmVlL2JpbmRpbmdzL21tYy9zZGhjaS1tc20udHh0DQorKysgYi9Eb2N1bWVudGF0aW9uL2Rldmlj
ZXRyZWUvYmluZGluZ3MvbW1jL3NkaGNpLW1zbS50eHQNCkBAIC0yMCw2ICsyMCw3IEBAIFJlcXVp
cmVkIHByb3BlcnRpZXM6DQogCQkicWNvbSxxY3M0MDQtc2RoY2kiLCAicWNvbSxzZGhjaS1tc20t
djUiDQogCQkicWNvbSxzYzcxODAtc2RoY2kiLCAicWNvbSxzZGhjaS1tc20tdjUiOw0KIAkJInFj
b20sc2RtODQ1LXNkaGNpIiwgInFjb20sc2RoY2ktbXNtLXY1Ig0KKwkJInFjb20sc2RtODQ1LWJh
eWh1Yi1zZGhjaSIsICJxY29tLHNkaGNpLW1zbS1iYXlodWItdjUiDQogCQkicWNvbSxzZHg1NS1z
ZGhjaSIsICJxY29tLHNkaGNpLW1zbS12NSI7DQogCQkicWNvbSxzbTgyNTAtc2RoY2kiLCAicWNv
bSxzZGhjaS1tc20tdjUiDQogCU5PVEUgdGhhdCBzb21lIG9sZCBkZXZpY2UgdHJlZSBmaWxlcyBt
YXkgYmUgZmxvYXRpbmcgYXJvdW5kIHRoYXQgb25seQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbW1j
L2hvc3QvTWFrZWZpbGUgYi9kcml2ZXJzL21tYy9ob3N0L01ha2VmaWxlDQppbmRleCAxNDAwNGNj
MDlhYWEuLmQ0ZDZmNGNjYTczMiAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvbW1jL2hvc3QvTWFrZWZp
bGUNCisrKyBiL2RyaXZlcnMvbW1jL2hvc3QvTWFrZWZpbGUNCkBAIC05Myw2ICs5Myw3IEBAIG9i
ai0kKENPTkZJR19NTUNfU0RIQ0lfT0ZfU1BBUlg1KQkrPSBzZGhjaS1vZi1zcGFyeDUubw0KIG9i
ai0kKENPTkZJR19NTUNfU0RIQ0lfQkNNX0tPTkEpCSs9IHNkaGNpLWJjbS1rb25hLm8NCiBvYmot
JChDT05GSUdfTU1DX1NESENJX0lQUk9DKQkJKz0gc2RoY2ktaXByb2Mubw0KIG9iai0kKENPTkZJ
R19NTUNfU0RIQ0lfTVNNKQkJKz0gc2RoY2ktbXNtLm8NCitvYmotJChDT05GSUdfTU1DX1NESENJ
X01TTSkJCSs9IHNkaGNpLWJheWh1Yi5vDQogb2JqLSQoQ09ORklHX01NQ19TREhDSV9TVCkJCSs9
IHNkaGNpLXN0Lm8NCiBvYmotJChDT05GSUdfTU1DX1NESENJX01JQ1JPQ0hJUF9QSUMzMikJKz0g
c2RoY2ktcGljMzIubw0KIG9iai0kKENPTkZJR19NTUNfU0RIQ0lfQlJDTVNUQikJCSs9IHNkaGNp
LWJyY21zdGIubw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbW1jL2hvc3Qvc2RoY2ktYmF5aHViLmMg
Yi9kcml2ZXJzL21tYy9ob3N0L3NkaGNpLWJheWh1Yi5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0K
aW5kZXggMDAwMDAwMDAwMDAwLi43NTAyOTQ3MGJkMjINCi0tLSAvZGV2L251bGwNCisrKyBiL2Ry
aXZlcnMvbW1jL2hvc3Qvc2RoY2ktYmF5aHViLmMNCkBAIC0wLDAgKzEsNjU2MyBAQA0KKy8vIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkNCisvKg0KKyAqIEJheWh1YiBUZWNo
bm9sb2dpZXMsIEluYy4gQkgyMDEgU0RIQ0kgYnJpZGdlIElDIGZvcg0KKyAqIFZFTkRPUiBTREhD
SSBwbGF0Zm9ybSBkcml2ZXIgc291cmNlIGZpbGUNCisgKg0KKyAqIENvcHlyaWdodCAoYykgMjAx
Mi0yMDE4LCBUaGUgTGludXggRm91bmRhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4NCisgKg0K
KyAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IgbW9kaWZ5DQorICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgYW5kDQorICogb25seSB2ZXJzaW9uIDIgYXMgcHVi
bGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24uDQorICoNCisgKiBUaGlzIHBy
b2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwN
CisgKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3
YXJyYW50eSBvZg0KKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VM
QVIgUFVSUE9TRS4gIFNlZSB0aGUNCisgKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3Ig
bW9yZSBkZXRhaWxzLg0KKyAqLw0KKw0KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4NCisjaW5j
bHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+DQorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+DQorI2lu
Y2x1ZGUgPGxpbnV4L21tYy9tbWMuaD4NCisjaW5jbHVkZSA8bGludXgvcG1fcnVudGltZS5oPg0K
KyNpbmNsdWRlIDxsaW51eC9wbV9vcHAuaD4NCisjaW5jbHVkZSA8bGludXgvc2xhYi5oPg0KKyNp
bmNsdWRlIDxsaW51eC9pb3BvbGwuaD4NCisjaW5jbHVkZSA8bGludXgvcmVndWxhdG9yL2NvbnN1
bWVyLmg+DQorI2luY2x1ZGUgPGxpbnV4L2ludGVyY29ubmVjdC5oPg0KKyNpbmNsdWRlIDxsaW51
eC9waW5jdHJsL2NvbnN1bWVyLmg+DQorI2luY2x1ZGUgPGxpbnV4L21tYy9ob3N0Lmg+DQorI2lu
Y2x1ZGUgPGxpbnV4L21tYy9jYXJkLmg+DQorI2luY2x1ZGUgPGxpbnV4L21tYy9zZC5oPg0KKyNp
bmNsdWRlIDxsaW51eC9pby5oPg0KKyNpbmNsdWRlIDxsaW51eC9vZl9ncGlvLmg+DQorDQorI2lu
Y2x1ZGUgInNkaGNpLXBsdGZtLmgiDQorI2luY2x1ZGUgImNxaGNpLmgiDQorI2luY2x1ZGUgIi4u
L2NvcmUvY29yZS5oIg0KKyNpbmNsdWRlICIuLi9jb3JlL3NkX29wcy5oIg0KKyNpbmNsdWRlICIu
Li9jb3JlL3NkaW9fb3BzLmgiDQorI2luY2x1ZGUgIi4uL2NvcmUvbW1jX29wcy5oIg0KKyNpbmNs
dWRlICIuLi9jb3JlL3NkLmgiDQorI2luY2x1ZGUgIi4uL2NvcmUvYnVzLmgiDQorI2luY2x1ZGUg
Ii4uL2NvcmUvaG9zdC5oIg0KKyNpbmNsdWRlICIuLi9jb3JlL2NhcmQuaCINCisjaW5jbHVkZSAi
Li4vY29yZS9wd3JzZXEuaCINCisNCisjZGVmaW5lIFRSVUUJMQ0KKyNkZWZpbmUgRkFMU0UJMA0K
Kw0KKyNkZWZpbmUJU0RfRk5DX0FNX1NEUjUwCQkweDINCisjZGVmaW5lCVNEX0ZOQ19BTV9TRFIx
MDQJMHgzDQorI2RlZmluZSBCSVRfUEFTU19NQVNLICAoMHg3ZmYpDQorI2RlZmluZSBTRFIxMDRf
TUFOVUFMX0lOSkVDVCAweDNmZg0KKyNkZWZpbmUgU0RSNTBfTUFOVUFMX0lOSkVDVCAgMHg3N2YN
CisNCisjZGVmaW5lCVRSVU5JTkdfUklOR19JRFgoeCkgICgoeCkgJSBUVU5JTkdfUEhBU0VfU0la
RSkNCisjZGVmaW5lCUdFVF9JRFhfVkFMVUUodGIsIHgpICAodGIgJiAoMSA8PCAoeCkpKQ0KKyNk
ZWZpbmUJR0VORVJBVEVfSURYX1ZBTFVFKHgpICAoMSA8PCAoeCkpDQorI2RlZmluZQlHRVRfVFJV
TklOR19SSU5HX0lEWF9WQUxVRSh0YiwgeCkgXA0KKwkodGIgJiAoMSA8PCBUUlVOSU5HX1JJTkdf
SURYKHgpKSkNCisjZGVmaW5lCUdFTkVSQVRFX1RSVU5JTkdfUklOR19JRFhfVkFMVUUoeCkgXA0K
KwkoMSA8PCBUUlVOSU5HX1JJTkdfSURYKHgpKQ0KKyNkZWZpbmUJTUFYX0NGR19CSVRfVkFMICgz
ODMpDQorDQorI2RlZmluZSBDT1JFX01DSV9WRVJTSU9OCQkweDUwDQorI2RlZmluZSBDT1JFX1ZF
UlNJT05fTUFKT1JfU0hJRlQJMjgNCisjZGVmaW5lIENPUkVfVkVSU0lPTl9NQUpPUl9NQVNLCQko
MHhmIDw8IENPUkVfVkVSU0lPTl9NQUpPUl9TSElGVCkNCisjZGVmaW5lIENPUkVfVkVSU0lPTl9N
SU5PUl9NQVNLCQkweGZmDQorDQorI2RlZmluZSBDT1JFX01DSV9HRU5FUklDUwkJMHg3MA0KKyNk
ZWZpbmUgU1dJVENIQUJMRV9TSUdOQUxJTkdfVk9MVEFHRQlCSVQoMjkpDQorDQorI2RlZmluZSBI
Q19NT0RFX0VOCQkweDENCisjZGVmaW5lIENPUkVfUE9XRVIJCTB4MA0KKyNkZWZpbmUgQ09SRV9T
V19SU1QJCUJJVCg3KQ0KKyNkZWZpbmUgRkZfQ0xLX1NXX1JTVF9ESVMJQklUKDEzKQ0KKw0KKyNk
ZWZpbmUgQ09SRV9QV1JDVExfQlVTX09GRglCSVQoMCkNCisjZGVmaW5lIENPUkVfUFdSQ1RMX0JV
U19PTglCSVQoMSkNCisjZGVmaW5lIENPUkVfUFdSQ1RMX0lPX0xPVwlCSVQoMikNCisjZGVmaW5l
IENPUkVfUFdSQ1RMX0lPX0hJR0gJQklUKDMpDQorI2RlZmluZSBDT1JFX1BXUkNUTF9CVVNfU1VD
Q0VTUyBCSVQoMCkNCisjZGVmaW5lIENPUkVfUFdSQ1RMX0JVU19GQUlMICAgIEJJVCgxKQ0KKyNk
ZWZpbmUgQ09SRV9QV1JDVExfSU9fU1VDQ0VTUwlCSVQoMikNCisjZGVmaW5lIENPUkVfUFdSQ1RM
X0lPX0ZBSUwgICAgIEJJVCgzKQ0KKyNkZWZpbmUgUkVRX0JVU19PRkYJCUJJVCgwKQ0KKyNkZWZp
bmUgUkVRX0JVU19PTgkJQklUKDEpDQorI2RlZmluZSBSRVFfSU9fTE9XCQlCSVQoMikNCisjZGVm
aW5lIFJFUV9JT19ISUdICQlCSVQoMykNCisjZGVmaW5lIElOVF9NQVNLCQkweGYNCisjZGVmaW5l
IE1BWF9QSEFTRVMJCTE2DQorI2RlZmluZSBDT1JFX0RMTF9MT0NLCQlCSVQoNykNCisjZGVmaW5l
IENPUkVfRERSX0RMTF9MT0NLCUJJVCgxMSkNCisjZGVmaW5lIENPUkVfRExMX0VOCQlCSVQoMTYp
DQorI2RlZmluZSBDT1JFX0NEUl9FTgkJQklUKDE3KQ0KKyNkZWZpbmUgQ09SRV9DS19PVVRfRU4J
CUJJVCgxOCkNCisjZGVmaW5lIENPUkVfQ0RSX0VYVF9FTgkJQklUKDE5KQ0KKyNkZWZpbmUgQ09S
RV9ETExfUEROCQlCSVQoMjkpDQorI2RlZmluZSBDT1JFX0RMTF9SU1QJCUJJVCgzMCkNCisjZGVm
aW5lIENPUkVfQ01EX0RBVF9UUkFDS19TRUwJQklUKDApDQorDQorI2RlZmluZSBDT1JFX0REUl9D
QUxfRU4JCUJJVCgwKQ0KKyNkZWZpbmUgQ09SRV9GTExfQ1lDTEVfQ05UCUJJVCgxOCkNCisjZGVm
aW5lIENPUkVfRExMX0NMT0NLX0RJU0FCTEUJQklUKDIxKQ0KKw0KKyNkZWZpbmUgRExMX1VTUl9D
VExfUE9SX1ZBTAkweDEwODAwDQorI2RlZmluZSBFTkFCTEVfRExMX0xPQ0tfU1RBVFVTCUJJVCgy
NikNCisjZGVmaW5lIEZJTkVfVFVORV9NT0RFX0VOCUJJVCgyNykNCisjZGVmaW5lIEJJQVNfT0tf
U0lHTkFMCQlCSVQoMjkpDQorDQorI2RlZmluZSBETExfQ09ORklHXzNfTE9XX0ZSRVFfVkFMCTB4
MDgNCisjZGVmaW5lIERMTF9DT05GSUdfM19ISUdIX0ZSRVFfVkFMCTB4MTANCisNCisjZGVmaW5l
IENPUkVfVkVORE9SX1NQRUNfUE9SX1ZBTCAweGE5Yw0KKyNkZWZpbmUgQ09SRV9DTEtfUFdSU0FW
RQlCSVQoMSkNCisjZGVmaW5lIENPUkVfSENfTUNMS19TRUxfREZMVAkoMiA8PCA4KQ0KKyNkZWZp
bmUgQ09SRV9IQ19NQ0xLX1NFTF9IUzQwMAkoMyA8PCA4KQ0KKyNkZWZpbmUgQ09SRV9IQ19NQ0xL
X1NFTF9NQVNLCSgzIDw8IDgpDQorI2RlZmluZSBDT1JFX0lPX1BBRF9QV1JfU1dJVENIX0VOCUJJ
VCgxNSkNCisjZGVmaW5lIENPUkVfSU9fUEFEX1BXUl9TV0lUQ0gJQklUKDE2KQ0KKyNkZWZpbmUg
Q09SRV9IQ19TRUxFQ1RfSU5fRU4JQklUKDE4KQ0KKyNkZWZpbmUgQ09SRV9IQ19TRUxFQ1RfSU5f
SFM0MDAJKDYgPDwgMTkpDQorI2RlZmluZSBDT1JFX0hDX1NFTEVDVF9JTl9NQVNLCSg3IDw8IDE5
KQ0KKw0KKyNkZWZpbmUgQ09SRV8zXzBWX1NVUFBPUlQJQklUKDI1KQ0KKyNkZWZpbmUgQ09SRV8x
XzhWX1NVUFBPUlQJQklUKDI2KQ0KKyNkZWZpbmUgQ09SRV9WT0xUX1NVUFBPUlQJKENPUkVfM18w
Vl9TVVBQT1JUIHwgQ09SRV8xXzhWX1NVUFBPUlQpDQorDQorI2RlZmluZSBDT1JFX0NTUl9DRENf
Q1RMUl9DRkcwCQkweDEzMA0KKyNkZWZpbmUgQ09SRV9TV19UUklHX0ZVTExfQ0FMSUIJCUJJVCgx
NikNCisjZGVmaW5lIENPUkVfSFdfQVVUT0NBTF9FTkEJCUJJVCgxNykNCisNCisjZGVmaW5lIENP
UkVfQ1NSX0NEQ19DVExSX0NGRzEJCTB4MTM0DQorI2RlZmluZSBDT1JFX0NTUl9DRENfQ0FMX1RJ
TUVSX0NGRzAJMHgxMzgNCisjZGVmaW5lIENPUkVfVElNRVJfRU5BCQkJQklUKDE2KQ0KKw0KKyNk
ZWZpbmUgQ09SRV9DU1JfQ0RDX0NBTF9USU1FUl9DRkcxCTB4MTNDDQorI2RlZmluZSBDT1JFX0NT
Ul9DRENfUkVGQ09VTlRfQ0ZHCTB4MTQwDQorI2RlZmluZSBDT1JFX0NTUl9DRENfQ09BUlNFX0NB
TF9DRkcJMHgxNDQNCisjZGVmaW5lIENPUkVfQ0RDX09GRlNFVF9DRkcJCTB4MTRDDQorI2RlZmlu
ZSBDT1JFX0NTUl9DRENfREVMQVlfQ0ZHCQkweDE1MA0KKyNkZWZpbmUgQ09SRV9DRENfU0xBVkVf
RERBX0NGRwkJMHgxNjANCisjZGVmaW5lIENPUkVfQ1NSX0NEQ19TVEFUVVMwCQkweDE2NA0KKyNk
ZWZpbmUgQ09SRV9DQUxJQlJBVElPTl9ET05FCQlCSVQoMCkNCisNCisjZGVmaW5lIENPUkVfQ0RD
X0VSUk9SX0NPREVfTUFTSwkweDcwMDAwMDANCisNCisjZGVmaW5lIENPUkVfQ1NSX0NEQ19HRU5f
Q0ZHCQkweDE3OA0KKyNkZWZpbmUgQ09SRV9DRENfU1dJVENIX0JZUEFTU19PRkYJQklUKDApDQor
I2RlZmluZSBDT1JFX0NEQ19TV0lUQ0hfUkNfRU4JCUJJVCgxKQ0KKw0KKyNkZWZpbmUgQ09SRV9D
RENfVDRfRExZX1NFTAkJQklUKDApDQorI2RlZmluZSBDT1JFX0NNRElOX1JDTEtfRU4JCUJJVCgx
KQ0KKyNkZWZpbmUgQ09SRV9TVEFSVF9DRENfVFJBRkZJQwkJQklUKDYpDQorDQorI2RlZmluZSBD
T1JFX1BXUlNBVkVfRExMCUJJVCgzKQ0KKw0KKyNkZWZpbmUgRERSX0NPTkZJR19QT1JfVkFMCTB4
ODAwNDA4NzMNCisNCisNCisjZGVmaW5lIElOVkFMSURfVFVOSU5HX1BIQVNFCS0xDQorI2RlZmlu
ZSBTREhDSV9NU01fTUlOX0NMT0NLCTQwMDAwMA0KKyNkZWZpbmUgQ09SRV9GUkVRXzEwME1IWgko
MTAwICogMTAwMCAqIDEwMDApDQorDQorI2RlZmluZSBDRFJfU0VMRVhUX1NISUZUCTIwDQorI2Rl
ZmluZSBDRFJfU0VMRVhUX01BU0sJCSgweGYgPDwgQ0RSX1NFTEVYVF9TSElGVCkNCisjZGVmaW5l
IENNVVhfU0hJRlRfUEhBU0VfU0hJRlQJMjQNCisjZGVmaW5lIENNVVhfU0hJRlRfUEhBU0VfTUFT
SwkoNyA8PCBDTVVYX1NISUZUX1BIQVNFX1NISUZUKQ0KKw0KKyNkZWZpbmUgTVNNX01NQ19BVVRP
U1VTUEVORF9ERUxBWV9NUwk1MA0KKw0KKy8qIFRpbWVvdXQgdmFsdWUgdG8gYXZvaWQgaW5maW5p
dGUgd2FpdGluZyBmb3IgcHdyX2lycSAqLw0KKyNkZWZpbmUgTVNNX1BXUl9JUlFfVElNRU9VVF9N
UyA1MDAwDQorDQorLyogTWF4IGxvYWQgZm9yIGVNTUMgVmRkLWlvIHN1cHBseSAqLw0KKyNkZWZp
bmUgTU1DX1ZRTU1DX01BWF9MT0FEX1VBCTMyNTAwMA0KKw0KKyNkZWZpbmUgbXNtX2JheWh1Yl9o
b3N0X3JlYWRsKG1zbV9iYXlodWJfaG9zdCwgaG9zdCwgb2Zmc2V0KSBcDQorCW1zbV9iYXlodWJf
aG9zdC0+dmFyX29wcy0+bXNtX2JheWh1Yl9yZWFkbF9yZWxheGVkKGhvc3QsIG9mZnNldCkNCisN
CisjZGVmaW5lIG1zbV9iYXlodWJfaG9zdF93cml0ZWwobXNtX2JheWh1Yl9ob3N0LCB2YWwsIGhv
c3QsIG9mZnNldCkgXA0KKwltc21fYmF5aHViX2hvc3QtPnZhcl9vcHMtPm1zbV9iYXlodWJfd3Jp
dGVsX3JlbGF4ZWQodmFsLCBob3N0LCBvZmZzZXQpDQorDQorLyogQ1FIQ0kgdmVuZG9yIHNwZWNp
ZmljIHJlZ2lzdGVycyAqLw0KKyNkZWZpbmUgQ1FIQ0lfVkVORE9SX0NGRzEJMHhBMDANCisjZGVm
aW5lIENRSENJX1ZFTkRPUl9ESVNfUlNUX09OX0NRX0VOCSgweDMgPDwgMTMpDQorDQorI2RlZmlu
ZSBUVU5JTkdfUEhBU0VfU0laRQkxMQ0KKyNkZWZpbmUgR0dDX0NGR19EQVRBIHsweDA3MDAwMDAw
LCAweDA3MzY0MDIyLCAweDAxMDE1NDEyLCAweDAxMDYyNDAwLFwNCisJMHgxMDQwMDA3NiwgMHgw
MDAyNTQzMiwgMHgwMTA0NjA3NiwgMHg2MjAxMTAwMCxcDQorCTB4MzA1MDMxMDYsIDB4NjQxNDE3
MTEsIDB4MTAwNTc1MTMsIDB4MDAzMzYyMDAsXA0KKwkweDAwMDIwMDA2LCAweDQwMDAwNDAwLCAw
eDEyMjAwMzEwLCAweDNBMzE0MTc3fQ0KKw0KK3N0cnVjdCBnZ2NfYnVzX21vZGVfY2ZnX3Qgew0K
Kwl1MzIgdHhfc2VsYl90YltUVU5JTkdfUEhBU0VfU0laRV07DQorCXUzMiBhbGxfc2VsYl90YltU
VU5JTkdfUEhBU0VfU0laRV07DQorCXUzMiB0eF9zZWxiX2ZhaWxlZF9oaXN0b3J5Ow0KKwlpbnQg
YnVzX21vZGU7DQorCWludCBkZWZhdWx0X3NlbGE7DQorCWludCBkZWZhdWx0X3NlbGI7DQorCXUz
MiBkZWZhdWx0X2RlbGF5Y29kZTsNCisJdTMyIGRsbF92b2x0YWdlX3VubG9ja19jbnRbNF07DQor
CXUzMiBtYXhfZGVsYXljb2RlOw0KKwl1MzIgbWluX2RlbGF5Y29kZTsNCisJdTMyIGRlbGF5Y29k
ZV9uYXJyb3dkb3duX2luZGV4Ow0KKwl1MzIgZmFpbF9waGFzZTsNCit9Ow0KKw0KK2VudW0gdHVu
aW5nX3N0YXRfZXQgew0KKwlOT19UVU5JTkcgPSAwLA0KKwlPVVRQVVRfUEFTU19UWVBFID0gMSwN
CisJU0VUX1BIQVNFX0ZBSUxfVFlQRSA9IDIsDQorCVRVTklOR19GQUlMX1RZUEUgPSAzLA0KKwlS
RUFEX1NUQVRVU19GQUlMX1RZUEUgPSA0LA0KKwlUVU5JTkdfQ01EN19USU1FT1VUID0gNSwNCisJ
UkVUVU5JTkdfQ0FTRSA9IDYsDQorfTsNCisNCisNCitzdHJ1Y3QgdF9nZ19yZWdfc3RydCB7DQor
CXUzMiBvZnM7DQorCXUzMiBtYXNrOw0KKwl1MzIgdmFsdWU7DQorfTsNCisNCitzdHJ1Y3Qgcmxf
Yml0X2xjdCB7DQorCXU4IGJpdHM7DQorCXU4IHJsX2JpdHM7DQorfTsNCisNCitzdHJ1Y3QgY2hr
X3R5cGVfdCB7DQorCXU4IHJpZ2h0X3ZhbGlkOjE7DQorCXU4IGZpcnN0X3ZhbGlkOjE7DQorCXU4
IHJlY29yZF92YWxpZDoxOw0KKwl1OCByZXNlcnZlZDo1Ow0KK307DQorDQorc3RhdGljIGNvbnN0
IGNoYXIgKmNvbnN0IG9wX2RiZ19zdHJbXSA9IHsNCisJIm5vIHR1bmluZyIsDQorCSJwYXNzIiwN
CisJInNldF9waGFzZV9mYWlsIiwNCisJInR1bmluZyBmYWlsIiwNCisJInJlYWQgc3RhdHVzIGZh
aWwiLA0KKwkidHVuaW5nIENNRDcgdGltZW91dCIsDQorCSJyZXR1bmluZyBjYXNlIg0KK307DQor
DQorc3RydWN0IGdnY19wbGF0Zm9ybV90IHsNCisJc3RydWN0IGdnY19idXNfbW9kZV9jZmdfdCBz
ZHI1MDsNCisJc3RydWN0IGdnY19idXNfbW9kZV9jZmdfdCBzZHIxMDQ7DQorCXN0cnVjdCBnZ2Nf
YnVzX21vZGVfY2ZnX3QgKmN1cl9idXNfbW9kZTsNCisNCisJc3RydWN0IHRfZ2dfcmVnX3N0cnQg
cGhhX3N0YXNfcnhfbG93MzI7DQorCXN0cnVjdCB0X2dnX3JlZ19zdHJ0IHBoYV9zdGFzX3J4X2hp
Z2gzMjsNCisJc3RydWN0IHRfZ2dfcmVnX3N0cnQgcGhhX3N0YXNfdHhfbG93MzI7DQorCXN0cnVj
dCB0X2dnX3JlZ19zdHJ0IHBoYV9zdGFzX3R4X2hpZ2gzMjsNCisJc3RydWN0IHRfZ2dfcmVnX3N0
cnQgZGxsX3NlbGFfYWZ0ZXJfbWFzazsNCisJc3RydWN0IHRfZ2dfcmVnX3N0cnQgZGxsX3NlbGJf
YWZ0ZXJfbWFzazsNCisNCisJc3RydWN0IHRfZ2dfcmVnX3N0cnQgZGxsX2RlbGF5XzEwMG1fYmFj
a3VwOw0KKwlzdHJ1Y3QgdF9nZ19yZWdfc3RydCBkbGxfZGVsYXlfMjAwbV9iYWNrdXA7DQorDQor
CXN0cnVjdCB0X2dnX3JlZ19zdHJ0IGRsbF9zZWxhXzEwMG1fY2ZnOw0KKwlzdHJ1Y3QgdF9nZ19y
ZWdfc3RydCBkbGxfc2VsYV8yMDBtX2NmZzsNCisJc3RydWN0IHRfZ2dfcmVnX3N0cnQgZGxsX3Nl
bGJfMTAwbV9jZmc7DQorCXN0cnVjdCB0X2dnX3JlZ19zdHJ0IGRsbF9zZWxiXzIwMG1fY2ZnOw0K
KwlzdHJ1Y3QgdF9nZ19yZWdfc3RydCBkbGxfc2VsYl8xMDBtX2NmZ19lbjsNCisJc3RydWN0IHRf
Z2dfcmVnX3N0cnQgZGxsX3NlbGJfMjAwbV9jZmdfZW47DQorCXN0cnVjdCB0X2dnX3JlZ19zdHJ0
IGludGVybmxfdHVuaW5nX2VuXzEwMG07DQorCXN0cnVjdCB0X2dnX3JlZ19zdHJ0IGludGVybmxf
dHVuaW5nX2VuXzIwMG07DQorCXN0cnVjdCB0X2dnX3JlZ19zdHJ0IGNtZDE5X2NudF9jZmc7DQor
DQorCXN0cnVjdCB0X2dnX3JlZ19zdHJ0IGluamVjdF9mYWlsdXJlX2Zvcl90dW5pbmdfZW5hYmxl
X2NmZzsNCisJc3RydWN0IHRfZ2dfcmVnX3N0cnQgaW5qZWN0X2ZhaWx1cmVfZm9yXzIwMG1fdHVu
aW5nX2NmZzsNCisJc3RydWN0IHRfZ2dfcmVnX3N0cnQgaW5qZWN0X2ZhaWx1cmVfZm9yXzEwMG1f
dHVuaW5nX2NmZzsNCisNCisJaW50IGRlZl9zZWxhXzEwMG07DQorCWludCBkZWZfc2VsYV8yMDBt
Ow0KKwlpbnQgZGVmX3NlbGJfMTAwbTsNCisJaW50IGRlZl9zZWxiXzIwMG07DQorDQorCXUzMiBf
Z2dfcmVnX2N1clsxNl07DQorCXU4IF9jdXJfcmVhZF9idWZbNTEyXTsNCisNCisJYm9vbCBkbGxf
dW5sb2NrX3JlaW5pdF9mbGc7DQorCXU4IGRyaXZlcl9zdHJlbmd0aF9yZWluaXRfZmxnOw0KKwli
b29sIHR1bmluZ19jbWQ3X3RpbWVvdXRfcmVpbml0X2ZsZzsNCisJdTMyIHR1bmluZ19jbWQ3X3Rp
bWVvdXRfcmVpbml0X2NudDsNCisJdTMyIGdnY19jdXJfc2VsYTsNCisJYm9vbCBzZWx4X3R1bmlu
Z19kb25lX2ZsYWc7DQorCXUzMiBnZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlOw0KKwlpbnQg
Z2djX3N3X3NlbGJfdHVuaW5nX2ZpcnN0X3NlbGI7DQorCWVudW0gdHVuaW5nX3N0YXRfZXQgZ2dj
X3NlbGFfdHVuaW5nX3Jlc3VsdFsxMV07DQorCWludCBkbGxfdm9sdGFnZV9zY2FuX21hcFs0XTsN
CisJaW50IGN1cl9kbGxfdm9sdGFnZV9pZHg7DQorCWludCBzZHI1MF9ub3R1bmluZ19zZWxhX2lu
amVjdF9mbGFnOw0KKwlpbnQgc2RyNTBfbm90dW5pbmdfY3JjX2Vycm9yX2ZsYWc7DQorCXUzMiBz
ZHI1MF9ub3R1bmluZ19zZWxhX3J4X2luamVjdDsNCisJdTMyIGJoMjAxX3NkcjUwX3NlbGFfc3df
aW5qZWN0Ow0KKwl1MzIgYmgyMDFfc2RyNTBfc2VsYl9od19pbmplY3Q7DQorCXUzMiBiaDIwMV9z
ZHIxMDRfc2VsYl9od19pbmplY3Q7DQorCXUzMiBiaDIwMV9kcml2ZV9zdHJlbmd0aDsNCisJYm9v
bCB0dW5pbmdfaW5fcHJvZ3Jlc3M7DQorCWludCBiaDIwMV91c2VkOw0KKwlpbnQgcHdyX2dwaW87
IC8qIEV4dGVybmFsIHBvd2VyIGVuYWJsZSBwaW4gZm9yIFJlZHJpdmVyIElDICovDQorCWludCBk
ZXRfZ3BpbzsNCit9Ow0KKw0KK3N0cnVjdCBzZGhjaV9tc21fYmF5aHViX29mZnNldCB7DQorCXUz
MiBjb3JlX2hjX21vZGU7DQorCXUzMiBjb3JlX21jaV9kYXRhX2NudDsNCisJdTMyIGNvcmVfbWNp
X3N0YXR1czsNCisJdTMyIGNvcmVfbWNpX2ZpZm9fY250Ow0KKwl1MzIgY29yZV9tY2lfdmVyc2lv
bjsNCisJdTMyIGNvcmVfZ2VuZXJpY3M7DQorCXUzMiBjb3JlX3Rlc3RidXNfY29uZmlnOw0KKwl1
MzIgY29yZV90ZXN0YnVzX3NlbDJfYml0Ow0KKwl1MzIgY29yZV90ZXN0YnVzX2VuYTsNCisJdTMy
IGNvcmVfdGVzdGJ1c19zZWwyOw0KKwl1MzIgY29yZV9wd3JjdGxfc3RhdHVzOw0KKwl1MzIgY29y
ZV9wd3JjdGxfbWFzazsNCisJdTMyIGNvcmVfcHdyY3RsX2NsZWFyOw0KKwl1MzIgY29yZV9wd3Jj
dGxfY3RsOw0KKwl1MzIgY29yZV9zZGNjX2RlYnVnX3JlZzsNCisJdTMyIGNvcmVfZGxsX2NvbmZp
ZzsNCisJdTMyIGNvcmVfZGxsX3N0YXR1czsNCisJdTMyIGNvcmVfdmVuZG9yX3NwZWM7DQorCXUz
MiBjb3JlX3ZlbmRvcl9zcGVjX2FkbWFfZXJyX2FkZHIwOw0KKwl1MzIgY29yZV92ZW5kb3Jfc3Bl
Y19hZG1hX2Vycl9hZGRyMTsNCisJdTMyIGNvcmVfdmVuZG9yX3NwZWNfZnVuYzI7DQorCXUzMiBj
b3JlX3ZlbmRvcl9zcGVjX2NhcGFiaWxpdGllczA7DQorCXUzMiBjb3JlX2Rkcl8yMDBfY2ZnOw0K
Kwl1MzIgY29yZV92ZW5kb3Jfc3BlYzM7DQorCXUzMiBjb3JlX2RsbF9jb25maWdfMjsNCisJdTMy
IGNvcmVfZGxsX2NvbmZpZ18zOw0KKwl1MzIgY29yZV9kZHJfY29uZmlnX29sZDsgLyogQXBwbGlj
YWJsZSB0byBzZGNjIG1pbm9yIHZlciA8IDB4NDkgKi8NCisJdTMyIGNvcmVfZGRyX2NvbmZpZzsN
CisJdTMyIGNvcmVfZGxsX3Vzcl9jdGw7IC8qIFByZXNlbnQgb24gU0RDQzUuMSBvbndhcmRzICov
DQorfTsNCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IHNkaGNpX21zbV9iYXlodWJfb2Zmc2V0IHNk
aGNpX21zbV9iYXlodWJfdjVfb2Zmc2V0ID0gew0KKwkuY29yZV9tY2lfZGF0YV9jbnQgPSAweDM1
YywNCisJLmNvcmVfbWNpX3N0YXR1cyA9IDB4MzI0LA0KKwkuY29yZV9tY2lfZmlmb19jbnQgPSAw
eDMwOCwNCisJLmNvcmVfbWNpX3ZlcnNpb24gPSAweDMxOCwNCisJLmNvcmVfZ2VuZXJpY3MgPSAw
eDMyMCwNCisJLmNvcmVfdGVzdGJ1c19jb25maWcgPSAweDMyYywNCisJLmNvcmVfdGVzdGJ1c19z
ZWwyX2JpdCA9IDMsDQorCS5jb3JlX3Rlc3RidXNfZW5hID0gKDEgPDwgMzEpLA0KKwkuY29yZV90
ZXN0YnVzX3NlbDIgPSAoMSA8PCAzKSwNCisJLmNvcmVfcHdyY3RsX3N0YXR1cyA9IDB4MjQwLA0K
KwkuY29yZV9wd3JjdGxfbWFzayA9IDB4MjQ0LA0KKwkuY29yZV9wd3JjdGxfY2xlYXIgPSAweDI0
OCwNCisJLmNvcmVfcHdyY3RsX2N0bCA9IDB4MjRjLA0KKwkuY29yZV9zZGNjX2RlYnVnX3JlZyA9
IDB4MzU4LA0KKwkuY29yZV9kbGxfY29uZmlnID0gMHgyMDAsDQorCS5jb3JlX2RsbF9zdGF0dXMg
PSAweDIwOCwNCisJLmNvcmVfdmVuZG9yX3NwZWMgPSAweDIwYywNCisJLmNvcmVfdmVuZG9yX3Nw
ZWNfYWRtYV9lcnJfYWRkcjAgPSAweDIxNCwNCisJLmNvcmVfdmVuZG9yX3NwZWNfYWRtYV9lcnJf
YWRkcjEgPSAweDIxOCwNCisJLmNvcmVfdmVuZG9yX3NwZWNfZnVuYzIgPSAweDIxMCwNCisJLmNv
cmVfdmVuZG9yX3NwZWNfY2FwYWJpbGl0aWVzMCA9IDB4MjFjLA0KKwkuY29yZV9kZHJfMjAwX2Nm
ZyA9IDB4MjI0LA0KKwkuY29yZV92ZW5kb3Jfc3BlYzMgPSAweDI1MCwNCisJLmNvcmVfZGxsX2Nv
bmZpZ18yID0gMHgyNTQsDQorCS5jb3JlX2RsbF9jb25maWdfMyA9IDB4MjU4LA0KKwkuY29yZV9k
ZHJfY29uZmlnID0gMHgyNWMsDQorCS5jb3JlX2RsbF91c3JfY3RsID0gMHgzODgsDQorfTsNCisN
CitzdGF0aWMgY29uc3Qgc3RydWN0IHNkaGNpX21zbV9iYXlodWJfb2Zmc2V0IHNkaGNpX21zbV9i
YXlodWJfbWNpX29mZnNldCA9IHsNCisJLmNvcmVfaGNfbW9kZSA9IDB4NzgsDQorCS5jb3JlX21j
aV9kYXRhX2NudCA9IDB4MzAsDQorCS5jb3JlX21jaV9zdGF0dXMgPSAweDM0LA0KKwkuY29yZV9t
Y2lfZmlmb19jbnQgPSAweDQ0LA0KKwkuY29yZV9tY2lfdmVyc2lvbiA9IDB4MDUwLA0KKwkuY29y
ZV9nZW5lcmljcyA9IDB4NzAsDQorCS5jb3JlX3Rlc3RidXNfY29uZmlnID0gMHgwY2MsDQorCS5j
b3JlX3Rlc3RidXNfc2VsMl9iaXQgPSA0LA0KKwkuY29yZV90ZXN0YnVzX2VuYSA9ICgxIDw8IDMp
LA0KKwkuY29yZV90ZXN0YnVzX3NlbDIgPSAoMSA8PCA0KSwNCisJLmNvcmVfcHdyY3RsX3N0YXR1
cyA9IDB4ZGMsDQorCS5jb3JlX3B3cmN0bF9tYXNrID0gMHhlMCwNCisJLmNvcmVfcHdyY3RsX2Ns
ZWFyID0gMHhlNCwNCisJLmNvcmVfcHdyY3RsX2N0bCA9IDB4ZTgsDQorCS5jb3JlX3NkY2NfZGVi
dWdfcmVnID0gMHgxMjQsDQorCS5jb3JlX2RsbF9jb25maWcgPSAweDEwMCwNCisJLmNvcmVfZGxs
X3N0YXR1cyA9IDB4MTA4LA0KKwkuY29yZV92ZW5kb3Jfc3BlYyA9IDB4MTBjLA0KKwkuY29yZV92
ZW5kb3Jfc3BlY19hZG1hX2Vycl9hZGRyMCA9IDB4MTE0LA0KKwkuY29yZV92ZW5kb3Jfc3BlY19h
ZG1hX2Vycl9hZGRyMSA9IDB4MTE4LA0KKwkuY29yZV92ZW5kb3Jfc3BlY19mdW5jMiA9IDB4MTEw
LA0KKwkuY29yZV92ZW5kb3Jfc3BlY19jYXBhYmlsaXRpZXMwID0gMHgxMWMsDQorCS5jb3JlX2Rk
cl8yMDBfY2ZnID0gMHgxODQsDQorCS5jb3JlX3ZlbmRvcl9zcGVjMyA9IDB4MWIwLA0KKwkuY29y
ZV9kbGxfY29uZmlnXzIgPSAweDFiNCwNCisJLmNvcmVfZGRyX2NvbmZpZ19vbGQgPSAweDFiOCwN
CisJLmNvcmVfZGRyX2NvbmZpZyA9IDB4MWJjLA0KK307DQorDQorc3RydWN0IHNkaGNpX21zbV9i
YXlodWJfdmFyaWFudF9vcHMgew0KKwl1MzIgKCptc21fYmF5aHViX3JlYWRsX3JlbGF4ZWQpKHN0
cnVjdCBzZGhjaV9ob3N0ICpob3N0LCB1MzIgb2Zmc2V0KTsNCisJdm9pZCAoKm1zbV9iYXlodWJf
d3JpdGVsX3JlbGF4ZWQpKHUzMiB2YWwsIHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LA0KKwkJCXUz
MiBvZmZzZXQpOw0KK307DQorDQorLyoNCisgKiBGcm9tIFY1LCByZWdpc3RlciBzcGFjZXMgaGF2
ZSBjaGFuZ2VkLiBXcmFwIHRoaXMgaW5mbyBpbiBhIHN0cnVjdHVyZQ0KKyAqIGFuZCBjaG9vc2Ug
dGhlIGRhdGFfc3RydWN0dXJlIGJhc2VkIG9uIHZlcnNpb24gaW5mbyBtZW50aW9uZWQgaW4gRFQu
DQorICovDQorc3RydWN0IHNkaGNpX21zbV9iYXlodWJfdmFyaWFudF9pbmZvIHsNCisJYm9vbCBt
Y2lfcmVtb3ZlZDsNCisJYm9vbCByZXN0b3JlX2RsbF9jb25maWc7DQorCWJvb2wgdXNlc190YXNz
YWRhcl9kbGw7DQorCWNvbnN0IHN0cnVjdCBzZGhjaV9tc21fYmF5aHViX3ZhcmlhbnRfb3BzICp2
YXJfb3BzOw0KKwljb25zdCBzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9vZmZzZXQgKm9mZnNldDsN
Cit9Ow0KKw0KK3N0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3Qgew0KKwlzdHJ1Y3QgcGxhdGZv
cm1fZGV2aWNlICpwZGV2Ow0KKwl2b2lkIF9faW9tZW0gKmNvcmVfbWVtOwkvKiBNU00gU0RDQyBt
YXBwZWQgYWRkcmVzcyAqLw0KKwlpbnQgcHdyX2lycTsJCS8qIHBvd2VyIGlycSAqLw0KKwlzdHJ1
Y3QgY2xrICpidXNfY2xrOwkvKiBTREhDIGJ1cyB2b3RlciBjbG9jayAqLw0KKwlzdHJ1Y3QgY2xr
ICp4b19jbGs7CS8qIFRDWE8gY2xrIG5lZWRlZCBmb3IgRkxMIGZlYXR1cmUgb2YgY21fZGxsKi8N
CisJc3RydWN0IGNsa19idWxrX2RhdGEgYnVsa19jbGtzWzRdOyAvKiBjb3JlLCBpZmFjZSwgY2Fs
LCBzbGVlcCBjbG9ja3MgKi8NCisJdW5zaWduZWQgbG9uZyBjbGtfcmF0ZTsNCisJc3RydWN0IG1t
Y19ob3N0ICptbWM7DQorCXN0cnVjdCBvcHBfdGFibGUgKm9wcF90YWJsZTsNCisJYm9vbCBoYXNf
b3BwX3RhYmxlOw0KKwlib29sIHVzZV8xNGxwcF9kbGxfcmVzZXQ7DQorCWJvb2wgdHVuaW5nX2Rv
bmU7DQorCWJvb2wgY2FsaWJyYXRpb25fZG9uZTsNCisJdTggc2F2ZWRfdHVuaW5nX3BoYXNlOw0K
Kwlib29sIHVzZV9jZGNscDUzMzsNCisJdTMyIGN1cnJfcHdyX3N0YXRlOw0KKwl1MzIgY3Vycl9p
b19sZXZlbDsNCisJd2FpdF9xdWV1ZV9oZWFkX3QgcHdyX2lycV93YWl0Ow0KKwlib29sIHB3cl9p
cnFfZmxhZzsNCisJdTMyIGNhcHNfMDsNCisJYm9vbCBtY2lfcmVtb3ZlZDsNCisJYm9vbCByZXN0
b3JlX2RsbF9jb25maWc7DQorCWNvbnN0IHN0cnVjdCBzZGhjaV9tc21fYmF5aHViX3ZhcmlhbnRf
b3BzICp2YXJfb3BzOw0KKwljb25zdCBzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9vZmZzZXQgKm9m
ZnNldDsNCisJYm9vbCB1c2VfY2RyOw0KKwl1MzIgdHJhbnNmZXJfbW9kZTsNCisJYm9vbCB1cGRh
dGVkX2Rkcl9jZmc7DQorCWJvb2wgdXNlc190YXNzYWRhcl9kbGw7DQorCXUzMiBkbGxfY29uZmln
Ow0KKwl1MzIgZGRyX2NvbmZpZzsNCisJYm9vbCB2cW1tY19lbmFibGVkOw0KKwlzdHJ1Y3QgZ2dj
X3BsYXRmb3JtX3QgIGdnYzsNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgc2RoY2lfbXNt
X2JheWh1Yl9vZmZzZXQgKnNkaGNpX3ByaXZfbXNtX2JheWh1Yl9vZmZzZXQoc3RydWN0IHNkaGNp
X2hvc3QgKmhvc3QpDQorew0KKwlzdHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9
IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKm1zbV9i
YXlodWJfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQorCXJldHVybiBt
c21fYmF5aHViX2hvc3QtPm9mZnNldDsNCit9DQorDQorLyoNCisgKiBBUElzIHRvIHJlYWQvd3Jp
dGUgdG8gdmVuZG9yIHNwZWNpZmljIHJlZ2lzdGVycyB3aGljaCB3ZXJlIHRoZXJlIGluIHRoZQ0K
KyAqIGNvcmVfbWVtIHJlZ2lvbiBiZWZvcmUgTUNJIHdhcyByZW1vdmVkLg0KKyAqLw0KK3N0YXRp
YyB1MzIgc2RoY2lfbXNtX2JheWh1Yl9tY2lfdmFyaWFudF9yZWFkbF9yZWxheGVkKHN0cnVjdCBz
ZGhjaV9ob3N0ICpob3N0LA0KKwkJdTMyIG9mZnNldCkNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRm
bV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21z
bV9iYXlodWJfaG9zdCAqbXNtX2JheWh1Yl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9o
b3N0KTsNCisNCisJcmV0dXJuIHJlYWRsX3JlbGF4ZWQobXNtX2JheWh1Yl9ob3N0LT5jb3JlX21l
bSArIG9mZnNldCk7DQorfQ0KKw0KK3N0YXRpYyB1MzIgc2RoY2lfbXNtX2JheWh1Yl92NV92YXJp
YW50X3JlYWRsX3JlbGF4ZWQoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsDQorCQl1MzIgb2Zmc2V0
KQ0KK3sNCisJcmV0dXJuIHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsgb2Zmc2V0KTsNCit9
DQorDQorc3RhdGljIHZvaWQgc2RoY2lfbXNtX2JheWh1Yl9tY2lfdmFyaWFudF93cml0ZWxfcmVs
YXhlZCh1MzIgdmFsLA0KKwkJc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsIHUzMiBvZmZzZXQpDQor
ew0KKwlzdHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9z
dCk7DQorCXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKm1zbV9iYXlodWJfaG9zdCA9IHNk
aGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQorCXdyaXRlbF9yZWxheGVkKHZhbCwgbXNt
X2JheWh1Yl9ob3N0LT5jb3JlX21lbSArIG9mZnNldCk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIHNk
aGNpX21zbV9iYXlodWJfdjVfdmFyaWFudF93cml0ZWxfcmVsYXhlZCh1MzIgdmFsLA0KKwkJc3Ry
dWN0IHNkaGNpX2hvc3QgKmhvc3QsIHUzMiBvZmZzZXQpDQorew0KKwl3cml0ZWxfcmVsYXhlZCh2
YWwsIGhvc3QtPmlvYWRkciArIG9mZnNldCk7DQorfQ0KKw0KK3N0YXRpYyB1bnNpZ25lZCBpbnQg
bXNtX2JheWh1Yl9nZXRfY2xvY2tfbXVsdF9mb3JfYnVzX21vZGUoc3RydWN0IHNkaGNpX2hvc3Qg
Kmhvc3QpDQorew0KKwlzdHJ1Y3QgbW1jX2lvcyBpb3MgPSBob3N0LT5tbWMtPmlvczsNCisJLyoN
CisJICogVGhlIFNESEMgcmVxdWlyZXMgaW50ZXJuYWwgY2xvY2sgZnJlcXVlbmN5IHRvIGJlIGRv
dWJsZSB0aGUNCisJICogYWN0dWFsIGNsb2NrIHRoYXQgd2lsbCBiZSBzZXQgZm9yIEREUiBtb2Rl
LiBUaGUgY29udHJvbGxlcg0KKwkgKiB1c2VzIHRoZSBmYXN0ZXIgY2xvY2soMTAwLzQwME1Ieikg
Zm9yIHNvbWUgb2YgaXRzIHBhcnRzIGFuZA0KKwkgKiBzZW5kIHRoZSBhY3R1YWwgcmVxdWlyZWQg
Y2xvY2sgKDUwLzIwME1IeikgdG8gdGhlIGNhcmQuDQorCSAqLw0KKwlpZiAoaW9zLnRpbWluZyA9
PSBNTUNfVElNSU5HX1VIU19ERFI1MCB8fA0KKwkgICAgaW9zLnRpbWluZyA9PSBNTUNfVElNSU5H
X01NQ19ERFI1MiB8fA0KKwkgICAgaW9zLnRpbWluZyA9PSBNTUNfVElNSU5HX01NQ19IUzQwMCB8
fA0KKwkgICAgaG9zdC0+ZmxhZ3MgJiBTREhDSV9IUzQwMF9UVU5JTkcpDQorCQlyZXR1cm4gMjsN
CisJcmV0dXJuIDE7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIG1zbV9iYXlodWJfc2V0X2Nsb2NrX3Jh
dGVfZm9yX2J1c19tb2RlKHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LA0KKwkJCQkJICAgIHVuc2ln
bmVkIGludCBjbG9jaykNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0
ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqbXNt
X2JheWh1Yl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisJc3RydWN0IG1t
Y19pb3MgY3Vycl9pb3MgPSBob3N0LT5tbWMtPmlvczsNCisJc3RydWN0IGNsayAqY29yZV9jbGsg
PSBtc21fYmF5aHViX2hvc3QtPmJ1bGtfY2xrc1swXS5jbGs7DQorCXVuc2lnbmVkIGxvbmcgYWNo
aWV2ZWRfcmF0ZTsNCisJdW5zaWduZWQgaW50IGRlc2lyZWRfcmF0ZTsNCisJdW5zaWduZWQgaW50
IG11bHQ7DQorCWludCByYzsNCisNCisJbXVsdCA9IG1zbV9iYXlodWJfZ2V0X2Nsb2NrX211bHRf
Zm9yX2J1c19tb2RlKGhvc3QpOw0KKwlkZXNpcmVkX3JhdGUgPSBjbG9jayAqIG11bHQ7DQorCXJj
ID0gZGV2X3BtX29wcF9zZXRfcmF0ZShtbWNfZGV2KGhvc3QtPm1tYyksIGRlc2lyZWRfcmF0ZSk7
DQorCWlmIChyYykgew0KKwkJcHJfZXJyKCIlczogRmFpbGVkIHRvIHNldCBjbG9jayBhdCByYXRl
ICV1IGF0IHRpbWluZyAlZFxuIiwNCisJCSAgICAgICBtbWNfaG9zdG5hbWUoaG9zdC0+bW1jKSwg
ZGVzaXJlZF9yYXRlLCBjdXJyX2lvcy50aW1pbmcpOw0KKwkJcmV0dXJuOw0KKwl9DQorDQorCS8q
DQorCSAqIFF1YWxjb21tIGNsb2NrIGRyaXZlcnMgYnkgZGVmYXVsdCByb3VuZCBjbG9jayBfdXBf
IGlmIHRoZXkgY2FuJ3QNCisJICogbWFrZSB0aGUgcmVxdWVzdGVkIHJhdGUuICBUaGlzIGlzIG5v
dCBnb29kIGZvciBTRC4gIFllbGwgaWYgd2UNCisJICogZW5jb3VudGVyIGl0Lg0KKwkgKi8NCisJ
YWNoaWV2ZWRfcmF0ZSA9IGNsa19nZXRfcmF0ZShjb3JlX2Nsayk7DQorCWlmIChhY2hpZXZlZF9y
YXRlID4gZGVzaXJlZF9yYXRlKQ0KKwkJcHJfd2FybigiJXM6IENhcmQgYXBwZWFycyBvdmVyY2xv
Y2tlZDsgcmVxICV1IEh6LCBhY3R1YWwgJWx1IEh6XG4iLA0KKwkJCW1tY19ob3N0bmFtZShob3N0
LT5tbWMpLCBkZXNpcmVkX3JhdGUsIGFjaGlldmVkX3JhdGUpOw0KKwlob3N0LT5tbWMtPmFjdHVh
bF9jbG9jayA9IGFjaGlldmVkX3JhdGUgLyBtdWx0Ow0KKw0KKwkvKiBTdGFzaCB0aGUgcmF0ZSB3
ZSByZXF1ZXN0ZWQgdG8gdXNlIGluIHNkaGNpX21zbV9iYXlodWJfcnVudGltZV9yZXN1bWUoKSAq
Lw0KKwltc21fYmF5aHViX2hvc3QtPmNsa19yYXRlID0gZGVzaXJlZF9yYXRlOw0KKw0KKwlwcl9k
ZWJ1ZygiJXM6IFNldHRpbmcgY2xvY2sgYXQgcmF0ZSAlbHUgYXQgdGltaW5nICVkXG4iLA0KKwkJ
IG1tY19ob3N0bmFtZShob3N0LT5tbWMpLCBhY2hpZXZlZF9yYXRlLCBjdXJyX2lvcy50aW1pbmcp
Ow0KK30NCisNCisvKiBQbGF0Zm9ybSBzcGVjaWZpYyB0dW5pbmcgKi8NCitzdGF0aWMgaW5saW5l
IGludCBtc21fYmF5aHViX2RsbF9wb2xsX2NrX291dF9lbihzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9z
dCwgdTggcG9sbCkNCit7DQorCXUzMiB3YWl0X2NudCA9IDUwOw0KKwl1OCBja19vdXRfZW47DQor
CXN0cnVjdCBtbWNfaG9zdCAqbW1jID0gaG9zdC0+bW1jOw0KKwljb25zdCBzdHJ1Y3Qgc2RoY2lf
bXNtX2JheWh1Yl9vZmZzZXQgKm1zbV9iYXlodWJfb2Zmc2V0ID0NCisJCQkJCXNkaGNpX3ByaXZf
bXNtX2JheWh1Yl9vZmZzZXQoaG9zdCk7DQorDQorCS8qIFBvbGwgZm9yIENLX09VVF9FTiBiaXQu
ICBtYXguIHBvbGwgdGltZSA9IDUwdXMgKi8NCisJY2tfb3V0X2VuID0gISEocmVhZGxfcmVsYXhl
ZChob3N0LT5pb2FkZHIgKw0KKwkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcp
ICYgQ09SRV9DS19PVVRfRU4pOw0KKw0KKwl3aGlsZSAoY2tfb3V0X2VuICE9IHBvbGwpIHsNCisJ
CWlmICgtLXdhaXRfY250ID09IDApIHsNCisJCQlkZXZfZXJyKG1tY19kZXYobW1jKSwgIiVzOiBD
S19PVVRfRU4gYml0IGlzIG5vdCAlZFxuIiwNCisJCQkgICAgICAgbW1jX2hvc3RuYW1lKG1tYyks
IHBvbGwpOw0KKwkJCXJldHVybiAtRVRJTUVET1VUOw0KKwkJfQ0KKwkJdWRlbGF5KDEpOw0KKw0K
KwkJY2tfb3V0X2VuID0gISEocmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKw0KKwkJCW1zbV9i
YXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpICYgQ09SRV9DS19PVVRfRU4pOw0KKwl9DQor
DQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgaW50IG1zbV9iYXlodWJfY29uZmlnX2NtX2Rs
bF9waGFzZShzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgdTggcGhhc2UpDQorew0KKwlpbnQgcmM7
DQorCXN0YXRpYyBjb25zdCB1OCBncmV5X2NvZGVkX3BoYXNlX3RhYmxlW10gPSB7DQorCQkweDAs
IDB4MSwgMHgzLCAweDIsIDB4NiwgMHg3LCAweDUsIDB4NCwNCisJCTB4YywgMHhkLCAweGYsIDB4
ZSwgMHhhLCAweGIsIDB4OSwgMHg4DQorCX07DQorCXVuc2lnbmVkIGxvbmcgZmxhZ3M7DQorCXUz
MiBjb25maWc7DQorCXN0cnVjdCBtbWNfaG9zdCAqbW1jID0gaG9zdC0+bW1jOw0KKwljb25zdCBz
dHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9vZmZzZXQgKm1zbV9iYXlodWJfb2Zmc2V0ID0NCisJCQkJ
CXNkaGNpX3ByaXZfbXNtX2JheWh1Yl9vZmZzZXQoaG9zdCk7DQorDQorCWlmIChwaGFzZSA+IDB4
ZikNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KKwlzcGluX2xvY2tfaXJxc2F2ZSgmaG9zdC0+bG9j
aywgZmxhZ3MpOw0KKw0KKwljb25maWcgPSByZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRkciArIG1z
bV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpOw0KKwljb25maWcgJj0gfihDT1JFX0NE
Ul9FTiB8IENPUkVfQ0tfT1VUX0VOKTsNCisJY29uZmlnIHw9IChDT1JFX0NEUl9FWFRfRU4gfCBD
T1JFX0RMTF9FTik7DQorCXdyaXRlbF9yZWxheGVkKGNvbmZpZywgaG9zdC0+aW9hZGRyICsgbXNt
X2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZyk7DQorDQorCS8qIFdhaXQgdW50aWwgQ0tf
T1VUX0VOIGJpdCBvZiBETExfQ09ORklHIHJlZ2lzdGVyIGJlY29tZXMgJzAnICovDQorCXJjID0g
bXNtX2JheWh1Yl9kbGxfcG9sbF9ja19vdXRfZW4oaG9zdCwgMCk7DQorCWlmIChyYykNCisJCWdv
dG8gZXJyX291dDsNCisNCisJLyoNCisJICogV3JpdGUgdGhlIHNlbGVjdGVkIERMTCBjbG9jayBv
dXRwdXQgcGhhc2UgKDAgLi4uIDE1KQ0KKwkgKiB0byBDRFJfU0VMRVhUIGJpdCBmaWVsZCBvZiBE
TExfQ09ORklHIHJlZ2lzdGVyLg0KKwkgKi8NCisJY29uZmlnID0gcmVhZGxfcmVsYXhlZChob3N0
LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29yZV9kbGxfY29uZmlnKTsNCisJY29uZmln
ICY9IH5DRFJfU0VMRVhUX01BU0s7DQorCWNvbmZpZyB8PSBncmV5X2NvZGVkX3BoYXNlX3RhYmxl
W3BoYXNlXSA8PCBDRFJfU0VMRVhUX1NISUZUOw0KKwl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhv
c3QtPmlvYWRkciArIG1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpOw0KKw0KKwlj
b25maWcgPSByZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRkciArIG1zbV9iYXlodWJfb2Zmc2V0LT5j
b3JlX2RsbF9jb25maWcpOw0KKwljb25maWcgfD0gQ09SRV9DS19PVVRfRU47DQorCXdyaXRlbF9y
ZWxheGVkKGNvbmZpZywgaG9zdC0+aW9hZGRyICsgbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxs
X2NvbmZpZyk7DQorDQorCS8qIFdhaXQgdW50aWwgQ0tfT1VUX0VOIGJpdCBvZiBETExfQ09ORklH
IHJlZ2lzdGVyIGJlY29tZXMgJzEnICovDQorCXJjID0gbXNtX2JheWh1Yl9kbGxfcG9sbF9ja19v
dXRfZW4oaG9zdCwgMSk7DQorCWlmIChyYykNCisJCWdvdG8gZXJyX291dDsNCisNCisJY29uZmln
ID0gcmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29yZV9k
bGxfY29uZmlnKTsNCisJY29uZmlnIHw9IENPUkVfQ0RSX0VOOw0KKwljb25maWcgJj0gfkNPUkVf
Q0RSX0VYVF9FTjsNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKyBtc21f
YmF5aHViX29mZnNldC0+Y29yZV9kbGxfY29uZmlnKTsNCisJZ290byBvdXQ7DQorDQorZXJyX291
dDoNCisJZGV2X2VycihtbWNfZGV2KG1tYyksICIlczogRmFpbGVkIHRvIHNldCBETEwgcGhhc2U6
ICVkXG4iLA0KKwkgICAgICAgbW1jX2hvc3RuYW1lKG1tYyksIHBoYXNlKTsNCitvdXQ6DQorCXNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJmhvc3QtPmxvY2ssIGZsYWdzKTsNCisJcmV0dXJuIHJjOw0K
K30NCisNCisvKg0KKyAqIEZpbmQgb3V0IHRoZSBncmVhdGVzdCByYW5nZSBvZiBjb25zZWN1aXRp
dmUgc2VsZWN0ZWQNCisgKiBETEwgY2xvY2sgb3V0cHV0IHBoYXNlcyB0aGF0IGNhbiBiZSB1c2Vk
IGFzIHNhbXBsaW5nDQorICogc2V0dGluZyBmb3IgU0QzLjAgVUhTLUkgY2FyZCByZWFkIG9wZXJh
dGlvbiAoaW4gU0RSMTA0DQorICogdGltaW5nIG1vZGUpIG9yIGZvciBlTU1DNC41IGNhcmQgcmVh
ZCBvcGVyYXRpb24gKGluDQorICogSFM0MDAvSFMyMDAgdGltaW5nIG1vZGUpLg0KKyAqIFNlbGVj
dCB0aGUgMy80IG9mIHRoZSByYW5nZSBhbmQgY29uZmlndXJlIHRoZSBETEwgd2l0aCB0aGUNCisg
KiBzZWxlY3RlZCBETEwgY2xvY2sgb3V0cHV0IHBoYXNlLg0KKyAqLw0KKw0KK3N0YXRpYyBpbnQg
bXNtX2JheWh1Yl9maW5kX21vc3RfYXBwcm9wcmlhdGVfcGhhc2Uoc3RydWN0IHNkaGNpX2hvc3Qg
Kmhvc3QsDQorCQkJCQkgICB1OCAqcGhhc2VfdGFibGUsIHU4IHRvdGFsX3BoYXNlcykNCit7DQor
CWludCByZXQ7DQorCXU4IHJhbmdlc1tNQVhfUEhBU0VTXVtNQVhfUEhBU0VTXSA9IHsgezB9LCB7
MH0gfTsNCisJdTggcGhhc2VzX3Blcl9yb3dbTUFYX1BIQVNFU10gPSB7IDAgfTsNCisJaW50IHJv
d19pbmRleCA9IDAsIGNvbF9pbmRleCA9IDAsIHNlbGVjdGVkX3Jvd19pbmRleCA9IDAsIGN1cnJf
bWF4ID0gMDsNCisJaW50IGksIGNudCwgcGhhc2VfMF9yYXdfaW5kZXggPSAwLCBwaGFzZV8xNV9y
YXdfaW5kZXggPSAwOw0KKwlib29sIHBoYXNlXzBfZm91bmQgPSBmYWxzZSwgcGhhc2VfMTVfZm91
bmQgPSBmYWxzZTsNCisJc3RydWN0IG1tY19ob3N0ICptbWMgPSBob3N0LT5tbWM7DQorDQorCWlm
ICghdG90YWxfcGhhc2VzIHx8ICh0b3RhbF9waGFzZXMgPiBNQVhfUEhBU0VTKSkgew0KKwkJZGV2
X2VycihtbWNfZGV2KG1tYyksICIlczogSW52YWxpZCBhcmd1bWVudDogdG90YWxfcGhhc2VzPSVk
XG4iLA0KKwkJICAgICAgIG1tY19ob3N0bmFtZShtbWMpLCB0b3RhbF9waGFzZXMpOw0KKwkJcmV0
dXJuIC1FSU5WQUw7DQorCX0NCisNCisJZm9yIChjbnQgPSAwOyBjbnQgPCB0b3RhbF9waGFzZXM7
IGNudCsrKSB7DQorCQlyYW5nZXNbcm93X2luZGV4XVtjb2xfaW5kZXhdID0gcGhhc2VfdGFibGVb
Y250XTsNCisJCXBoYXNlc19wZXJfcm93W3Jvd19pbmRleF0gKz0gMTsNCisJCWNvbF9pbmRleCsr
Ow0KKw0KKwkJaWYgKChjbnQgKyAxKSA9PSB0b3RhbF9waGFzZXMpIHsNCisJCQljb250aW51ZTsN
CisJCS8qIGNoZWNrIGlmIG5leHQgcGhhc2UgaW4gcGhhc2VfdGFibGUgaXMgY29uc2VjdXRpdmUg
b3Igbm90ICovDQorCQl9IGVsc2UgaWYgKChwaGFzZV90YWJsZVtjbnRdICsgMSkgIT0gcGhhc2Vf
dGFibGVbY250ICsgMV0pIHsNCisJCQlyb3dfaW5kZXgrKzsNCisJCQljb2xfaW5kZXggPSAwOw0K
KwkJfQ0KKwl9DQorDQorCWlmIChyb3dfaW5kZXggPj0gTUFYX1BIQVNFUykNCisJCXJldHVybiAt
RUlOVkFMOw0KKw0KKwkvKiBDaGVjayBpZiBwaGFzZS0wIGlzIHByZXNlbnQgaW4gZmlyc3QgdmFs
aWQgd2luZG93PyAqLw0KKwlpZiAoIXJhbmdlc1swXVswXSkgew0KKwkJcGhhc2VfMF9mb3VuZCA9
IHRydWU7DQorCQlwaGFzZV8wX3Jhd19pbmRleCA9IDA7DQorCQkvKiBDaGVjayBpZiBjeWNsZSBl
eGlzdCBiZXR3ZWVuIDIgdmFsaWQgd2luZG93cyAqLw0KKwkJZm9yIChjbnQgPSAxOyBjbnQgPD0g
cm93X2luZGV4OyBjbnQrKykgew0KKwkJCWlmIChwaGFzZXNfcGVyX3Jvd1tjbnRdKSB7DQorCQkJ
CWZvciAoaSA9IDA7IGkgPCBwaGFzZXNfcGVyX3Jvd1tjbnRdOyBpKyspIHsNCisJCQkJCWlmIChy
YW5nZXNbY250XVtpXSA9PSAxNSkgew0KKwkJCQkJCXBoYXNlXzE1X2ZvdW5kID0gdHJ1ZTsNCisJ
CQkJCQlwaGFzZV8xNV9yYXdfaW5kZXggPSBjbnQ7DQorCQkJCQkJYnJlYWs7DQorCQkJCQl9DQor
CQkJCX0NCisJCQl9DQorCQl9DQorCX0NCisNCisJLyogSWYgMiB2YWxpZCB3aW5kb3dzIGZvcm0g
Y3ljbGUgdGhlbiBtZXJnZSB0aGVtIGFzIHNpbmdsZSB3aW5kb3cgKi8NCisJaWYgKHBoYXNlXzBf
Zm91bmQgJiYgcGhhc2VfMTVfZm91bmQpIHsNCisJCS8qIG51bWJlciBvZiBwaGFzZXMgaW4gcmF3
IHdoZXJlIHBoYXNlIDAgaXMgcHJlc2VudCAqLw0KKwkJdTggcGhhc2VzXzAgPSBwaGFzZXNfcGVy
X3Jvd1twaGFzZV8wX3Jhd19pbmRleF07DQorCQkvKiBudW1iZXIgb2YgcGhhc2VzIGluIHJhdyB3
aGVyZSBwaGFzZSAxNSBpcyBwcmVzZW50ICovDQorCQl1OCBwaGFzZXNfMTUgPSBwaGFzZXNfcGVy
X3Jvd1twaGFzZV8xNV9yYXdfaW5kZXhdOw0KKw0KKwkJaWYgKHBoYXNlc18wICsgcGhhc2VzXzE1
ID49IE1BWF9QSEFTRVMpDQorCQkJLyoNCisJCQkgKiBJZiB0aGVyZSBhcmUgbW9yZSB0aGFuIDEg
cGhhc2Ugd2luZG93cyB0aGVuIHRvdGFsDQorCQkJICogbnVtYmVyIG9mIHBoYXNlcyBpbiBib3Ro
IHRoZSB3aW5kb3dzIHNob3VsZCBub3QgYmUNCisJCQkgKiBtb3JlIHRoYW4gb3IgZXF1YWwgdG8g
TUFYX1BIQVNFUy4NCisJCQkgKi8NCisJCQlyZXR1cm4gLUVJTlZBTDsNCisNCisJCS8qIE1lcmdl
IDIgY3ljbGljIHdpbmRvd3MgKi8NCisJCWkgPSBwaGFzZXNfMTU7DQorCQlmb3IgKGNudCA9IDA7
IGNudCA8IHBoYXNlc18wOyBjbnQrKykgew0KKwkJCXJhbmdlc1twaGFzZV8xNV9yYXdfaW5kZXhd
W2ldID0NCisJCQkgICAgcmFuZ2VzW3BoYXNlXzBfcmF3X2luZGV4XVtjbnRdOw0KKwkJCWlmICgr
K2kgPj0gTUFYX1BIQVNFUykNCisJCQkJYnJlYWs7DQorCQl9DQorDQorCQlwaGFzZXNfcGVyX3Jv
d1twaGFzZV8wX3Jhd19pbmRleF0gPSAwOw0KKwkJcGhhc2VzX3Blcl9yb3dbcGhhc2VfMTVfcmF3
X2luZGV4XSA9IHBoYXNlc18xNSArIHBoYXNlc18wOw0KKwl9DQorDQorCWZvciAoY250ID0gMDsg
Y250IDw9IHJvd19pbmRleDsgY250KyspIHsNCisJCWlmIChwaGFzZXNfcGVyX3Jvd1tjbnRdID4g
Y3Vycl9tYXgpIHsNCisJCQljdXJyX21heCA9IHBoYXNlc19wZXJfcm93W2NudF07DQorCQkJc2Vs
ZWN0ZWRfcm93X2luZGV4ID0gY250Ow0KKwkJfQ0KKwl9DQorDQorCWkgPSAoY3Vycl9tYXggKiAz
KSAvIDQ7DQorCWlmIChpKQ0KKwkJaS0tOw0KKw0KKwlyZXQgPSByYW5nZXNbc2VsZWN0ZWRfcm93
X2luZGV4XVtpXTsNCisNCisJaWYgKHJldCA+PSBNQVhfUEhBU0VTKSB7DQorCQlyZXQgPSAtRUlO
VkFMOw0KKwkJZGV2X2VycihtbWNfZGV2KG1tYyksICIlczogSW52YWxpZCBwaGFzZSBzZWxlY3Rl
ZD0lZFxuIiwNCisJCSAgICAgICBtbWNfaG9zdG5hbWUobW1jKSwgcmV0KTsNCisJfQ0KKw0KKwly
ZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgaW5saW5lIHZvaWQgbXNtX2JheWh1Yl9jbV9kbGxf
c2V0X2ZyZXEoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QpDQorew0KKwl1MzIgbWNsa19mcmVxID0g
MCwgY29uZmlnOw0KKwljb25zdCBzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9vZmZzZXQgKm1zbV9i
YXlodWJfb2Zmc2V0ID0NCisJCQkJCXNkaGNpX3ByaXZfbXNtX2JheWh1Yl9vZmZzZXQoaG9zdCk7
DQorDQorCS8qIFByb2dyYW0gdGhlIE1DTEsgdmFsdWUgdG8gTUNMS19GUkVRIGJpdCBmaWVsZCAq
Lw0KKwlpZiAoaG9zdC0+Y2xvY2sgPD0gMTEyMDAwMDAwKQ0KKwkJbWNsa19mcmVxID0gMDsNCisJ
ZWxzZSBpZiAoaG9zdC0+Y2xvY2sgPD0gMTI1MDAwMDAwKQ0KKwkJbWNsa19mcmVxID0gMTsNCisJ
ZWxzZSBpZiAoaG9zdC0+Y2xvY2sgPD0gMTM3MDAwMDAwKQ0KKwkJbWNsa19mcmVxID0gMjsNCisJ
ZWxzZSBpZiAoaG9zdC0+Y2xvY2sgPD0gMTUwMDAwMDAwKQ0KKwkJbWNsa19mcmVxID0gMzsNCisJ
ZWxzZSBpZiAoaG9zdC0+Y2xvY2sgPD0gMTYyMDAwMDAwKQ0KKwkJbWNsa19mcmVxID0gNDsNCisJ
ZWxzZSBpZiAoaG9zdC0+Y2xvY2sgPD0gMTc1MDAwMDAwKQ0KKwkJbWNsa19mcmVxID0gNTsNCisJ
ZWxzZSBpZiAoaG9zdC0+Y2xvY2sgPD0gMTg3MDAwMDAwKQ0KKwkJbWNsa19mcmVxID0gNjsNCisJ
ZWxzZSBpZiAoaG9zdC0+Y2xvY2sgPD0gMjAwMDAwMDAwKQ0KKwkJbWNsa19mcmVxID0gNzsNCisN
CisJY29uZmlnID0gcmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNl
dC0+Y29yZV9kbGxfY29uZmlnKTsNCisJY29uZmlnICY9IH5DTVVYX1NISUZUX1BIQVNFX01BU0s7
DQorCWNvbmZpZyB8PSBtY2xrX2ZyZXEgPDwgQ01VWF9TSElGVF9QSEFTRV9TSElGVDsNCisJd3Jp
dGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29y
ZV9kbGxfY29uZmlnKTsNCit9DQorDQorLyogSW5pdGlhbGl6ZSB0aGUgRExMIChQcm9ncmFtbWFi
bGUgRGVsYXkgTGluZSkgKi8NCitzdGF0aWMgaW50IG1zbV9iYXlodWJfaW5pdF9jbV9kbGwoc3Ry
dWN0IHNkaGNpX2hvc3QgKmhvc3QpDQorew0KKwlzdHJ1Y3QgbW1jX2hvc3QgKm1tYyA9IGhvc3Qt
Pm1tYzsNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2
KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3Qg
PSBzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKwlpbnQgd2FpdF9jbnQgPSA1MDsNCisJ
dW5zaWduZWQgbG9uZyBmbGFncywgeG9fY2xrID0gMDsNCisJdTMyIGNvbmZpZzsNCisJY29uc3Qg
c3RydWN0IHNkaGNpX21zbV9iYXlodWJfb2Zmc2V0ICptc21fYmF5aHViX29mZnNldCA9DQorCQkJ
CQltc21fYmF5aHViX2hvc3QtPm9mZnNldDsNCisNCisJaWYgKG1zbV9iYXlodWJfaG9zdC0+dXNl
XzE0bHBwX2RsbF9yZXNldCAmJiAhSVNfRVJSX09SX05VTEwobXNtX2JheWh1Yl9ob3N0LT54b19j
bGspKQ0KKwkJeG9fY2xrID0gY2xrX2dldF9yYXRlKG1zbV9iYXlodWJfaG9zdC0+eG9fY2xrKTsN
CisNCisJc3Bpbl9sb2NrX2lycXNhdmUoJmhvc3QtPmxvY2ssIGZsYWdzKTsNCisNCisJLyoNCisJ
ICogTWFrZSBzdXJlIHRoYXQgY2xvY2sgaXMgYWx3YXlzIGVuYWJsZWQgd2hlbiBETEwNCisJICog
dHVuaW5nIGlzIGluIHByb2dyZXNzLiBLZWVwaW5nIFBXUlNBVkUgT04gbWF5DQorCSAqIHR1cm4g
b2ZmIHRoZSBjbG9jay4NCisJICovDQorCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9h
ZGRyICsgbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfdmVuZG9yX3NwZWMpOw0KKwljb25maWcgJj0g
fkNPUkVfQ0xLX1BXUlNBVkU7DQorCXdyaXRlbF9yZWxheGVkKGNvbmZpZywgaG9zdC0+aW9hZGRy
ICsgbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfdmVuZG9yX3NwZWMpOw0KKw0KKwlpZiAobXNtX2Jh
eWh1Yl9ob3N0LT5kbGxfY29uZmlnKQ0KKwkJd3JpdGVsX3JlbGF4ZWQobXNtX2JheWh1Yl9ob3N0
LT5kbGxfY29uZmlnLA0KKwkJCQlob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29y
ZV9kbGxfY29uZmlnKTsNCisNCisJaWYgKG1zbV9iYXlodWJfaG9zdC0+dXNlXzE0bHBwX2RsbF9y
ZXNldCkgew0KKwkJY29uZmlnID0gcmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKw0KKwkJCQlt
c21fYmF5aHViX29mZnNldC0+Y29yZV9kbGxfY29uZmlnKTsNCisJCWNvbmZpZyAmPSB+Q09SRV9D
S19PVVRfRU47DQorCQl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhvc3QtPmlvYWRkciArDQorCQkJ
CW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpOw0KKw0KKwkJY29uZmlnID0gcmVh
ZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKw0KKwkJCQltc21fYmF5aHViX29mZnNldC0+Y29yZV9k
bGxfY29uZmlnXzIpOw0KKwkJY29uZmlnIHw9IENPUkVfRExMX0NMT0NLX0RJU0FCTEU7DQorCQl3
cml0ZWxfcmVsYXhlZChjb25maWcsIGhvc3QtPmlvYWRkciArDQorCQkJCW1zbV9iYXlodWJfb2Zm
c2V0LT5jb3JlX2RsbF9jb25maWdfMik7DQorCX0NCisNCisJY29uZmlnID0gcmVhZGxfcmVsYXhl
ZChob3N0LT5pb2FkZHIgKw0KKwkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcp
Ow0KKwljb25maWcgfD0gQ09SRV9ETExfUlNUOw0KKwl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhv
c3QtPmlvYWRkciArDQorCQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZyk7DQor
DQorCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsNCisJCQltc21fYmF5aHVi
X29mZnNldC0+Y29yZV9kbGxfY29uZmlnKTsNCisJY29uZmlnIHw9IENPUkVfRExMX1BETjsNCisJ
d3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKw0KKwkJCW1zbV9iYXlodWJfb2Zm
c2V0LT5jb3JlX2RsbF9jb25maWcpOw0KKw0KKwlpZiAoIW1zbV9iYXlodWJfaG9zdC0+ZGxsX2Nv
bmZpZykNCisJCW1zbV9iYXlodWJfY21fZGxsX3NldF9mcmVxKGhvc3QpOw0KKw0KKwlpZiAobXNt
X2JheWh1Yl9ob3N0LT51c2VfMTRscHBfZGxsX3Jlc2V0ICYmDQorCSAgICAhSVNfRVJSX09SX05V
TEwobXNtX2JheWh1Yl9ob3N0LT54b19jbGspKSB7DQorCQl1MzIgbWNsa19mcmVxID0gMDsNCisN
CisJCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsNCisJCQkJbXNtX2JheWh1
Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZ18yKTsNCisJCWNvbmZpZyAmPSBDT1JFX0ZMTF9DWUNM
RV9DTlQ7DQorCQlpZiAoY29uZmlnKQ0KKwkJCW1jbGtfZnJlcSA9IERJVl9ST1VORF9DTE9TRVNU
X1VMTCgoaG9zdC0+Y2xvY2sgKiA4KSwNCisJCQkJCXhvX2Nsayk7DQorCQllbHNlDQorCQkJbWNs
a19mcmVxID0gRElWX1JPVU5EX0NMT1NFU1RfVUxMKChob3N0LT5jbG9jayAqIDQpLA0KKwkJCQkJ
eG9fY2xrKTsNCisNCisJCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsNCisJ
CQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZ18yKTsNCisJCWNvbmZpZyAmPSB+
KDB4RkYgPDwgMTApOw0KKwkJY29uZmlnIHw9IG1jbGtfZnJlcSA8PCAxMDsNCisNCisJCXdyaXRl
bF9yZWxheGVkKGNvbmZpZywgaG9zdC0+aW9hZGRyICsNCisJCQkJbXNtX2JheWh1Yl9vZmZzZXQt
PmNvcmVfZGxsX2NvbmZpZ18yKTsNCisJCS8qIHdhaXQgZm9yIDV1cyBiZWZvcmUgZW5hYmxpbmcg
RExMIGNsb2NrICovDQorCQl1ZGVsYXkoNSk7DQorCX0NCisNCisJY29uZmlnID0gcmVhZGxfcmVs
YXhlZChob3N0LT5pb2FkZHIgKw0KKwkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25m
aWcpOw0KKwljb25maWcgJj0gfkNPUkVfRExMX1JTVDsNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmln
LCBob3N0LT5pb2FkZHIgKw0KKwkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcp
Ow0KKw0KKwljb25maWcgPSByZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRkciArDQorCQkJbXNtX2Jh
eWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZyk7DQorCWNvbmZpZyAmPSB+Q09SRV9ETExfUERO
Ow0KKwl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhvc3QtPmlvYWRkciArDQorCQkJbXNtX2JheWh1
Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZyk7DQorDQorCWlmIChtc21fYmF5aHViX2hvc3QtPnVz
ZV8xNGxwcF9kbGxfcmVzZXQpIHsNCisJCWlmICghbXNtX2JheWh1Yl9ob3N0LT5kbGxfY29uZmln
KQ0KKwkJCW1zbV9iYXlodWJfY21fZGxsX3NldF9mcmVxKGhvc3QpOw0KKwkJY29uZmlnID0gcmVh
ZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKw0KKwkJCQltc21fYmF5aHViX29mZnNldC0+Y29yZV9k
bGxfY29uZmlnXzIpOw0KKwkJY29uZmlnICY9IH5DT1JFX0RMTF9DTE9DS19ESVNBQkxFOw0KKwkJ
d3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKw0KKwkJCQltc21fYmF5aHViX29m
ZnNldC0+Y29yZV9kbGxfY29uZmlnXzIpOw0KKwl9DQorDQorCS8qDQorCSAqIENvbmZpZ3VyZSBE
TEwgdXNlciBjb250cm9sIHJlZ2lzdGVyIHRvIGVuYWJsZSBETEwgc3RhdHVzLg0KKwkgKiBUaGlz
IHNldHRpbmcgaXMgYXBwbGljYWJsZSB0byBTRENDIHY1LjEgb253YXJkcyBvbmx5Lg0KKwkgKi8N
CisJaWYgKG1zbV9iYXlodWJfaG9zdC0+dXNlc190YXNzYWRhcl9kbGwpIHsNCisJCWNvbmZpZyA9
IERMTF9VU1JfQ1RMX1BPUl9WQUwgfCBGSU5FX1RVTkVfTU9ERV9FTiB8DQorCQkJRU5BQkxFX0RM
TF9MT0NLX1NUQVRVUyB8IEJJQVNfT0tfU0lHTkFMOw0KKwkJd3JpdGVsX3JlbGF4ZWQoY29uZmln
LCBob3N0LT5pb2FkZHIgKw0KKwkJCQltc21fYmF5aHViX29mZnNldC0+Y29yZV9kbGxfdXNyX2N0
bCk7DQorDQorCQljb25maWcgPSByZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRkciArDQorCQkJCW1z
bV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWdfMyk7DQorCQljb25maWcgJj0gfjB4RkY7
DQorCQlpZiAobXNtX2JheWh1Yl9ob3N0LT5jbGtfcmF0ZSA8IDE1MDAwMDAwMCkNCisJCQljb25m
aWcgfD0gRExMX0NPTkZJR18zX0xPV19GUkVRX1ZBTDsNCisJCWVsc2UNCisJCQljb25maWcgfD0g
RExMX0NPTkZJR18zX0hJR0hfRlJFUV9WQUw7DQorCQl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhv
c3QtPmlvYWRkciArDQorCQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZ18zKTsN
CisJfQ0KKw0KKwljb25maWcgPSByZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRkciArDQorCQkJbXNt
X2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZyk7DQorCWNvbmZpZyB8PSBDT1JFX0RMTF9F
TjsNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKw0KKwkJCW1zbV9iYXlo
dWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpOw0KKw0KKwljb25maWcgPSByZWFkbF9yZWxheGVk
KGhvc3QtPmlvYWRkciArDQorCQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZyk7
DQorCWNvbmZpZyB8PSBDT1JFX0NLX09VVF9FTjsNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBo
b3N0LT5pb2FkZHIgKw0KKwkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpOw0K
Kw0KKwkvKiBXYWl0IHVudGlsIERMTF9MT0NLIGJpdCBvZiBETExfU1RBVFVTIHJlZ2lzdGVyIGJl
Y29tZXMgJzEnICovDQorCXdoaWxlICghKHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsgbXNt
X2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX3N0YXR1cykgJg0KKwkJIENPUkVfRExMX0xPQ0spKSB7
DQorCQkvKiBtYXguIHdhaXQgZm9yIDUwdXMgc2VjIGZvciBMT0NLIGJpdCB0byBiZSBzZXQgKi8N
CisJCWlmICgtLXdhaXRfY250ID09IDApIHsNCisJCQlkZXZfZXJyKG1tY19kZXYobW1jKSwgIiVz
OiBETEwgZmFpbGVkIHRvIExPQ0tcbiIsDQorCQkJICAgICAgIG1tY19ob3N0bmFtZShtbWMpKTsN
CisJCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZob3N0LT5sb2NrLCBmbGFncyk7DQorCQkJcmV0
dXJuIC1FVElNRURPVVQ7DQorCQl9DQorCQl1ZGVsYXkoMSk7DQorCX0NCisNCisJc3Bpbl91bmxv
Y2tfaXJxcmVzdG9yZSgmaG9zdC0+bG9jaywgZmxhZ3MpOw0KKwlyZXR1cm4gMDsNCit9DQorDQor
c3RhdGljIHZvaWQgbXNtX2JheWh1Yl9oY19zZWxlY3RfZGVmYXVsdChzdHJ1Y3Qgc2RoY2lfaG9z
dCAqaG9zdCkNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2Ro
Y2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqbXNtX2JheWh1
Yl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisJdTMyIGNvbmZpZzsNCisJ
Y29uc3Qgc3RydWN0IHNkaGNpX21zbV9iYXlodWJfb2Zmc2V0ICptc21fYmF5aHViX29mZnNldCA9
DQorCQkJCQltc21fYmF5aHViX2hvc3QtPm9mZnNldDsNCisNCisJaWYgKCFtc21fYmF5aHViX2hv
c3QtPnVzZV9jZGNscDUzMykgew0KKwkJY29uZmlnID0gcmVhZGxfcmVsYXhlZChob3N0LT5pb2Fk
ZHIgKw0KKwkJCQltc21fYmF5aHViX29mZnNldC0+Y29yZV92ZW5kb3Jfc3BlYzMpOw0KKwkJY29u
ZmlnICY9IH5DT1JFX1BXUlNBVkVfRExMOw0KKwkJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0
LT5pb2FkZHIgKw0KKwkJCQltc21fYmF5aHViX29mZnNldC0+Y29yZV92ZW5kb3Jfc3BlYzMpOw0K
Kwl9DQorDQorCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsgbXNtX2JheWh1
Yl9vZmZzZXQtPmNvcmVfdmVuZG9yX3NwZWMpOw0KKwljb25maWcgJj0gfkNPUkVfSENfTUNMS19T
RUxfTUFTSzsNCisJY29uZmlnIHw9IENPUkVfSENfTUNMS19TRUxfREZMVDsNCisJd3JpdGVsX3Jl
bGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29yZV92ZW5k
b3Jfc3BlYyk7DQorDQorCS8qDQorCSAqIERpc2FibGUgSENfU0VMRUNUX0lOIHRvIGJlIGFibGUg
dG8gdXNlIHRoZSBVSFMgbW9kZSBzZWxlY3QNCisJICogY29uZmlndXJhdGlvbiBmcm9tIEhvc3Qg
Q29udHJvbDIgcmVnaXN0ZXIgZm9yIGFsbCBvdGhlcg0KKwkgKiBtb2Rlcy4NCisJICogV3JpdGUg
MCB0byBIQ19TRUxFQ1RfSU4gYW5kIEhDX1NFTEVDVF9JTl9FTiBmaWVsZA0KKwkgKiBpbiBWRU5E
T1JfU1BFQ19GVU5DDQorCSAqLw0KKwljb25maWcgPSByZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRk
ciArIG1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX3ZlbmRvcl9zcGVjKTsNCisJY29uZmlnICY9IH5D
T1JFX0hDX1NFTEVDVF9JTl9FTjsNCisJY29uZmlnICY9IH5DT1JFX0hDX1NFTEVDVF9JTl9NQVNL
Ow0KKwl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhvc3QtPmlvYWRkciArIG1zbV9iYXlodWJfb2Zm
c2V0LT5jb3JlX3ZlbmRvcl9zcGVjKTsNCisNCisJLyoNCisJICogTWFrZSBzdXJlIGFib3ZlIHdy
aXRlcyBpbXBhY3RpbmcgZnJlZSBydW5uaW5nIE1DTEsgYXJlIGNvbXBsZXRlZA0KKwkgKiBiZWZv
cmUgY2hhbmdpbmcgdGhlIGNsa19yYXRlIGF0IEdDQy4NCisJICovDQorCXdtYigpOw0KK30NCisN
CitzdGF0aWMgdm9pZCBtc21fYmF5aHViX2hjX3NlbGVjdF9oczQwMChzdHJ1Y3Qgc2RoY2lfaG9z
dCAqaG9zdCkNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2Ro
Y2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqbXNtX2JheWh1
Yl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisJc3RydWN0IG1tY19pb3Mg
aW9zID0gaG9zdC0+bW1jLT5pb3M7DQorCXUzMiBjb25maWcsIGRsbF9sb2NrOw0KKwlpbnQgcmM7
DQorCWNvbnN0IHN0cnVjdCBzZGhjaV9tc21fYmF5aHViX29mZnNldCAqbXNtX2JheWh1Yl9vZmZz
ZXQgPQ0KKwkJCQkJbXNtX2JheWh1Yl9ob3N0LT5vZmZzZXQ7DQorDQorCS8qIFNlbGVjdCB0aGUg
ZGl2aWRlZCBjbG9jayAoZnJlZSBydW5uaW5nIE1DTEsvMikgKi8NCisJY29uZmlnID0gcmVhZGxf
cmVsYXhlZChob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29yZV92ZW5kb3Jfc3Bl
Yyk7DQorCWNvbmZpZyAmPSB+Q09SRV9IQ19NQ0xLX1NFTF9NQVNLOw0KKwljb25maWcgfD0gQ09S
RV9IQ19NQ0xLX1NFTF9IUzQwMDsNCisNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5p
b2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29yZV92ZW5kb3Jfc3BlYyk7DQorCS8qDQorCSAq
IFNlbGVjdCBIUzQwMCBtb2RlIHVzaW5nIHRoZSBIQ19TRUxFQ1RfSU4gZnJvbSBWRU5ET1IgU1BF
Qw0KKwkgKiByZWdpc3Rlcg0KKwkgKi8NCisJaWYgKChtc21fYmF5aHViX2hvc3QtPnR1bmluZ19k
b25lIHx8IGlvcy5lbmhhbmNlZF9zdHJvYmUpICYmDQorCSAgICAhbXNtX2JheWh1Yl9ob3N0LT5j
YWxpYnJhdGlvbl9kb25lKSB7DQorCQljb25maWcgPSByZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRk
ciArDQorCQkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX3ZlbmRvcl9zcGVjKTsNCisJCWNvbmZp
ZyB8PSBDT1JFX0hDX1NFTEVDVF9JTl9IUzQwMDsNCisJCWNvbmZpZyB8PSBDT1JFX0hDX1NFTEVD
VF9JTl9FTjsNCisJCXdyaXRlbF9yZWxheGVkKGNvbmZpZywgaG9zdC0+aW9hZGRyICsNCisJCQkJ
bXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfdmVuZG9yX3NwZWMpOw0KKwl9DQorCWlmICghbXNtX2Jh
eWh1Yl9ob3N0LT5jbGtfcmF0ZSAmJiAhbXNtX2JheWh1Yl9ob3N0LT51c2VfY2RjbHA1MzMpIHsN
CisJCS8qDQorCQkgKiBQb2xsIG9uIERMTF9MT0NLIG9yIEREUl9ETExfTE9DSyBiaXRzIGluDQor
CQkgKiBjb3JlX2RsbF9zdGF0dXMgdG8gYmUgc2V0LiBUaGlzIHNob3VsZCBnZXQgc2V0DQorCQkg
KiB3aXRoaW4gMTUgdXMgYXQgMjAwIE1Iei4NCisJCSAqLw0KKwkJcmMgPSByZWFkbF9yZWxheGVk
X3BvbGxfdGltZW91dChob3N0LT5pb2FkZHIgKw0KKwkJCQkJCW1zbV9iYXlodWJfb2Zmc2V0LT5j
b3JlX2RsbF9zdGF0dXMsDQorCQkJCQkJZGxsX2xvY2ssDQorCQkJCQkJKGRsbF9sb2NrICYNCisJ
CQkJCQkoQ09SRV9ETExfTE9DSyB8DQorCQkJCQkJQ09SRV9ERFJfRExMX0xPQ0spKSwgMTAsDQor
CQkJCQkJMTAwMCk7DQorCQlpZiAocmMgPT0gLUVUSU1FRE9VVCkNCisJCQlwcl9lcnIoIiVzOiBV
bmFibGUgdG8gZ2V0IERMTF9MT0NLL0REUl9ETExfTE9DSywgZGxsX3N0YXR1czogMHglMDh4XG4i
LA0KKwkJCSAgICAgICBtbWNfaG9zdG5hbWUoaG9zdC0+bW1jKSwgZGxsX2xvY2spOw0KKwl9DQor
CS8qDQorCSAqIE1ha2Ugc3VyZSBhYm92ZSB3cml0ZXMgaW1wYWN0aW5nIGZyZWUgcnVubmluZyBN
Q0xLIGFyZSBjb21wbGV0ZWQNCisJICogYmVmb3JlIGNoYW5naW5nIHRoZSBjbGtfcmF0ZSBhdCBH
Q0MuDQorCSAqLw0KKwl3bWIoKTsNCit9DQorDQorLyoNCisgKiBzZGhjaV9tc21fYmF5aHViX2hj
X3NlbGVjdF9tb2RlIDotIEluIGdlbmVyYWwgYWxsIHRpbWluZyBtb2RlcyBhcmUNCisgKiBjb250
cm9sbGVkIHZpYSBVSFMgbW9kZSBzZWxlY3QgaW4gSG9zdCBDb250cm9sMiByZWdpc3Rlci4NCisg
KiBlTU1DIHNwZWNpZmljIEhTMjAwL0hTNDAwIGRvZXNuJ3QgaGF2ZSB0aGVpciByZXNwZWN0aXZl
IG1vZGVzDQorICogZGVmaW5lZCBoZXJlLCBoZW5jZSB3ZSB1c2UgdGhlc2UgdmFsdWVzLg0KKyAq
DQorICogSFMyMDAgLSBTRFIxMDQgKFNpbmNlIHRoZXkgYm90aCBhcmUgZXF1aXZhbGVudCBpbiBm
dW5jdGlvbmFsaXR5KQ0KKyAqIEhTNDAwIC0gVGhpcyBpbnZvbHZlcyBtdWx0aXBsZSBjb25maWd1
cmF0aW9ucw0KKyAqCQlJbml0aWFsbHkgU0RSMTA0IC0gd2hlbiB0dW5pbmcgaXMgcmVxdWlyZWQg
YXMgSFMyMDANCisgKgkJVGhlbiB3aGVuIHN3aXRjaGluZyB0byBERFIgQCA0MDBNSHogKEhTNDAw
KSB3ZSB1c2UNCisgKgkJdGhlIHZlbmRvciBzcGVjaWZpYyBIQ19TRUxFQ1RfSU4gdG8gY29udHJv
bCB0aGUgbW9kZS4NCisgKg0KKyAqIEluIGFkZGl0aW9uIHRvIGNvbnRyb2xsaW5nIHRoZSBtb2Rl
cyB3ZSBhbHNvIG5lZWQgdG8gc2VsZWN0IHRoZQ0KKyAqIGNvcnJlY3QgaW5wdXQgY2xvY2sgZm9y
IERMTCBkZXBlbmRpbmcgb24gdGhlIG1vZGUuDQorICoNCisgKiBIUzQwMCAtIGRpdmlkZWQgY2xv
Y2sgKGZyZWUgcnVubmluZyBNQ0xLLzIpDQorICogQWxsIG90aGVyIG1vZGVzIC0gZGVmYXVsdCAo
ZnJlZSBydW5uaW5nIE1DTEspDQorICovDQorc3RhdGljIHZvaWQgc2RoY2lfbXNtX2JheWh1Yl9o
Y19zZWxlY3RfbW9kZShzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCXN0cnVjdCBtbWNf
aW9zIGlvcyA9IGhvc3QtPm1tYy0+aW9zOw0KKw0KKwlpZiAoaW9zLnRpbWluZyA9PSBNTUNfVElN
SU5HX01NQ19IUzQwMCB8fA0KKwkgICAgaG9zdC0+ZmxhZ3MgJiBTREhDSV9IUzQwMF9UVU5JTkcp
DQorCQltc21fYmF5aHViX2hjX3NlbGVjdF9oczQwMChob3N0KTsNCisJZWxzZQ0KKwkJbXNtX2Jh
eWh1Yl9oY19zZWxlY3RfZGVmYXVsdChob3N0KTsNCit9DQorDQorc3RhdGljIGludCBzZGhjaV9t
c21fYmF5aHViX2NkY2xwNTMzX2NhbGlicmF0aW9uKHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0KQ0K
K3sNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhv
c3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3QgPSBz
ZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKwl1MzIgY29uZmlnLCBjYWxpYl9kb25lOw0K
KwlpbnQgcmV0Ow0KKwljb25zdCBzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9vZmZzZXQgKm1zbV9i
YXlodWJfb2Zmc2V0ID0NCisJCQkJCW1zbV9iYXlodWJfaG9zdC0+b2Zmc2V0Ow0KKw0KKwlwcl9k
ZWJ1ZygiJXM6ICVzOiBFbnRlclxuIiwgbW1jX2hvc3RuYW1lKGhvc3QtPm1tYyksIF9fZnVuY19f
KTsNCisNCisJLyoNCisJICogUmV0dW5pbmcgaW4gSFM0MDAgKEREUiBtb2RlKSB3aWxsIGZhaWws
IGp1c3QgcmVzZXQgdGhlDQorCSAqIHR1bmluZyBibG9jayBhbmQgcmVzdG9yZSB0aGUgc2F2ZWQg
dHVuaW5nIHBoYXNlLg0KKwkgKi8NCisJcmV0ID0gbXNtX2JheWh1Yl9pbml0X2NtX2RsbChob3N0
KTsNCisJaWYgKHJldCkNCisJCWdvdG8gb3V0Ow0KKw0KKwkvKiBTZXQgdGhlIHNlbGVjdGVkIHBo
YXNlIGluIGRlbGF5IGxpbmUgaHcgYmxvY2sgKi8NCisJcmV0ID0gbXNtX2JheWh1Yl9jb25maWdf
Y21fZGxsX3BoYXNlKGhvc3QsIG1zbV9iYXlodWJfaG9zdC0+c2F2ZWRfdHVuaW5nX3BoYXNlKTsN
CisJaWYgKHJldCkNCisJCWdvdG8gb3V0Ow0KKw0KKwljb25maWcgPSByZWFkbF9yZWxheGVkKGhv
c3QtPmlvYWRkciArIG1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpOw0KKwljb25m
aWcgfD0gQ09SRV9DTURfREFUX1RSQUNLX1NFTDsNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBo
b3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29yZV9kbGxfY29uZmlnKTsNCisNCisJ
Y29uZmlnID0gcmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+
Y29yZV9kZHJfMjAwX2NmZyk7DQorCWNvbmZpZyAmPSB+Q09SRV9DRENfVDRfRExZX1NFTDsNCisJ
d3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+
Y29yZV9kZHJfMjAwX2NmZyk7DQorDQorCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9h
ZGRyICsgQ09SRV9DU1JfQ0RDX0dFTl9DRkcpOw0KKwljb25maWcgJj0gfkNPUkVfQ0RDX1NXSVRD
SF9CWVBBU1NfT0ZGOw0KKwl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhvc3QtPmlvYWRkciArIENP
UkVfQ1NSX0NEQ19HRU5fQ0ZHKTsNCisNCisJY29uZmlnID0gcmVhZGxfcmVsYXhlZChob3N0LT5p
b2FkZHIgKyBDT1JFX0NTUl9DRENfR0VOX0NGRyk7DQorCWNvbmZpZyB8PSBDT1JFX0NEQ19TV0lU
Q0hfUkNfRU47DQorCXdyaXRlbF9yZWxheGVkKGNvbmZpZywgaG9zdC0+aW9hZGRyICsgQ09SRV9D
U1JfQ0RDX0dFTl9DRkcpOw0KKw0KKwljb25maWcgPSByZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRk
ciArIG1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2Rkcl8yMDBfY2ZnKTsNCisJY29uZmlnICY9IH5D
T1JFX1NUQVJUX0NEQ19UUkFGRklDOw0KKwl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhvc3QtPmlv
YWRkciArIG1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2Rkcl8yMDBfY2ZnKTsNCisNCisJLyogUGVy
Zm9ybSBDREMgUmVnaXN0ZXIgSW5pdGlhbGl6YXRpb24gU2VxdWVuY2UgKi8NCisNCisJd3JpdGVs
X3JlbGF4ZWQoMHgxMTgwMEVDLCBob3N0LT5pb2FkZHIgKyBDT1JFX0NTUl9DRENfQ1RMUl9DRkcw
KTsNCisJd3JpdGVsX3JlbGF4ZWQoMHgzMDExMTExLCBob3N0LT5pb2FkZHIgKyBDT1JFX0NTUl9D
RENfQ1RMUl9DRkcxKTsNCisJd3JpdGVsX3JlbGF4ZWQoMHgxMjAxMDAwLCBob3N0LT5pb2FkZHIg
KyBDT1JFX0NTUl9DRENfQ0FMX1RJTUVSX0NGRzApOw0KKwl3cml0ZWxfcmVsYXhlZCgweDQsIGhv
c3QtPmlvYWRkciArIENPUkVfQ1NSX0NEQ19DQUxfVElNRVJfQ0ZHMSk7DQorCXdyaXRlbF9yZWxh
eGVkKDB4Q0I3MzIwMjAsIGhvc3QtPmlvYWRkciArIENPUkVfQ1NSX0NEQ19SRUZDT1VOVF9DRkcp
Ow0KKwl3cml0ZWxfcmVsYXhlZCgweEIxOSwgaG9zdC0+aW9hZGRyICsgQ09SRV9DU1JfQ0RDX0NP
QVJTRV9DQUxfQ0ZHKTsNCisJd3JpdGVsX3JlbGF4ZWQoMHg0RTIsIGhvc3QtPmlvYWRkciArIENP
UkVfQ1NSX0NEQ19ERUxBWV9DRkcpOw0KKwl3cml0ZWxfcmVsYXhlZCgweDAsIGhvc3QtPmlvYWRk
ciArIENPUkVfQ0RDX09GRlNFVF9DRkcpOw0KKwl3cml0ZWxfcmVsYXhlZCgweDE2MzM0LCBob3N0
LT5pb2FkZHIgKyBDT1JFX0NEQ19TTEFWRV9EREFfQ0ZHKTsNCisNCisJLyogQ0RDIEhXIENhbGli
cmF0aW9uICovDQorDQorCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsgQ09S
RV9DU1JfQ0RDX0NUTFJfQ0ZHMCk7DQorCWNvbmZpZyB8PSBDT1JFX1NXX1RSSUdfRlVMTF9DQUxJ
QjsNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKyBDT1JFX0NTUl9DRENf
Q1RMUl9DRkcwKTsNCisNCisJY29uZmlnID0gcmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKyBD
T1JFX0NTUl9DRENfQ1RMUl9DRkcwKTsNCisJY29uZmlnICY9IH5DT1JFX1NXX1RSSUdfRlVMTF9D
QUxJQjsNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKyBDT1JFX0NTUl9D
RENfQ1RMUl9DRkcwKTsNCisNCisJY29uZmlnID0gcmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIg
KyBDT1JFX0NTUl9DRENfQ1RMUl9DRkcwKTsNCisJY29uZmlnIHw9IENPUkVfSFdfQVVUT0NBTF9F
TkE7DQorCXdyaXRlbF9yZWxheGVkKGNvbmZpZywgaG9zdC0+aW9hZGRyICsgQ09SRV9DU1JfQ0RD
X0NUTFJfQ0ZHMCk7DQorDQorCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsg
Q09SRV9DU1JfQ0RDX0NBTF9USU1FUl9DRkcwKTsNCisJY29uZmlnIHw9IENPUkVfVElNRVJfRU5B
Ow0KKwl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhvc3QtPmlvYWRkciArIENPUkVfQ1NSX0NEQ19D
QUxfVElNRVJfQ0ZHMCk7DQorDQorCXJldCA9IHJlYWRsX3JlbGF4ZWRfcG9sbF90aW1lb3V0KGhv
c3QtPmlvYWRkciArIENPUkVfQ1NSX0NEQ19TVEFUVVMwLA0KKwkJCQkJIGNhbGliX2RvbmUsDQor
CQkJCQkgKGNhbGliX2RvbmUgJiBDT1JFX0NBTElCUkFUSU9OX0RPTkUpLA0KKwkJCQkJIDEsIDUw
KTsNCisNCisJaWYgKHJldCA9PSAtRVRJTUVET1VUKSB7DQorCQlwcl9lcnIoIiVzOiAlczogQ0RD
IGNhbGlicmF0aW9uIHdhcyBub3QgY29tcGxldGVkXG4iLA0KKwkJICAgICAgIG1tY19ob3N0bmFt
ZShob3N0LT5tbWMpLCBfX2Z1bmNfXyk7DQorCQlnb3RvIG91dDsNCisJfQ0KKw0KKwlyZXQgPSBy
ZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRkciArIENPUkVfQ1NSX0NEQ19TVEFUVVMwKQ0KKwkJCSYg
Q09SRV9DRENfRVJST1JfQ09ERV9NQVNLOw0KKwlpZiAocmV0KSB7DQorCQlwcl9lcnIoIiVzOiAl
czogQ0RDIGVycm9yIGNvZGUgJWRcbiIsDQorCQkgICAgICAgbW1jX2hvc3RuYW1lKGhvc3QtPm1t
YyksIF9fZnVuY19fLCByZXQpOw0KKwkJcmV0ID0gLUVJTlZBTDsNCisJCWdvdG8gb3V0Ow0KKwl9
DQorDQorCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsgbXNtX2JheWh1Yl9v
ZmZzZXQtPmNvcmVfZGRyXzIwMF9jZmcpOw0KKwljb25maWcgfD0gQ09SRV9TVEFSVF9DRENfVFJB
RkZJQzsNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLCBob3N0LT5pb2FkZHIgKyBtc21fYmF5aHVi
X29mZnNldC0+Y29yZV9kZHJfMjAwX2NmZyk7DQorb3V0Og0KKwlwcl9kZWJ1ZygiJXM6ICVzOiBF
eGl0LCByZXQgJWRcbiIsIG1tY19ob3N0bmFtZShob3N0LT5tbWMpLA0KKwkJIF9fZnVuY19fLCBy
ZXQpOw0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgaW50IHNkaGNpX21zbV9iYXlodWJf
Y21fZGxsX3NkYzRfY2FsaWJyYXRpb24oc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QpDQorew0KKwlz
dHJ1Y3QgbW1jX2hvc3QgKm1tYyA9IGhvc3QtPm1tYzsNCisJdTMyIGRsbF9zdGF0dXMsIGNvbmZp
ZywgZGRyX2NmZ19vZmZzZXQ7DQorCWludCByZXQ7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0
ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlo
dWJfaG9zdCAqbXNtX2JheWh1Yl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsN
CisJY29uc3Qgc3RydWN0IHNkaGNpX21zbV9iYXlodWJfb2Zmc2V0ICptc21fYmF5aHViX29mZnNl
dCA9DQorCQkJCQlzZGhjaV9wcml2X21zbV9iYXlodWJfb2Zmc2V0KGhvc3QpOw0KKw0KKwlwcl9k
ZWJ1ZygiJXM6ICVzOiBFbnRlclxuIiwgbW1jX2hvc3RuYW1lKGhvc3QtPm1tYyksIF9fZnVuY19f
KTsNCisNCisJLyoNCisJICogQ3VycmVudGx5IHRoZSBjb3JlX2Rkcl9jb25maWcgcmVnaXN0ZXIg
ZGVmYXVsdHMgdG8gZGVzaXJlZA0KKwkgKiBjb25maWd1cmF0aW9uIG9uIHJlc2V0LiBDdXJyZW50
bHkgcmVwcm9ncmFtbWluZyB0aGUgcG93ZXIgb24NCisJICogcmVzZXQgKFBPUikgdmFsdWUgaW4g
Y2FzZSBpdCBtaWdodCBoYXZlIGJlZW4gbW9kaWZpZWQgYnkNCisJICogYm9vdGxvYWRlcnMuIElu
IHRoZSBmdXR1cmUsIGlmIHRoaXMgY2hhbmdlcywgdGhlbiB0aGUgZGVzaXJlZA0KKwkgKiB2YWx1
ZXMgd2lsbCBuZWVkIHRvIGJlIHByb2dyYW1tZWQgYXBwcm9wcmlhdGVseS4NCisJICovDQorCWlm
IChtc21fYmF5aHViX2hvc3QtPnVwZGF0ZWRfZGRyX2NmZykNCisJCWRkcl9jZmdfb2Zmc2V0ID0g
bXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGRyX2NvbmZpZzsNCisJZWxzZQ0KKwkJZGRyX2NmZ19v
ZmZzZXQgPSBtc21fYmF5aHViX29mZnNldC0+Y29yZV9kZHJfY29uZmlnX29sZDsNCisJd3JpdGVs
X3JlbGF4ZWQobXNtX2JheWh1Yl9ob3N0LT5kZHJfY29uZmlnLCBob3N0LT5pb2FkZHIgKyBkZHJf
Y2ZnX29mZnNldCk7DQorDQorCWlmIChtbWMtPmlvcy5lbmhhbmNlZF9zdHJvYmUpIHsNCisJCWNv
bmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsNCisJCQkJbXNtX2JheWh1Yl9vZmZz
ZXQtPmNvcmVfZGRyXzIwMF9jZmcpOw0KKwkJY29uZmlnIHw9IENPUkVfQ01ESU5fUkNMS19FTjsN
CisJCXdyaXRlbF9yZWxheGVkKGNvbmZpZywgaG9zdC0+aW9hZGRyICsNCisJCQkJbXNtX2JheWh1
Yl9vZmZzZXQtPmNvcmVfZGRyXzIwMF9jZmcpOw0KKwl9DQorDQorCWNvbmZpZyA9IHJlYWRsX3Jl
bGF4ZWQoaG9zdC0+aW9hZGRyICsgbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZ18y
KTsNCisJY29uZmlnIHw9IENPUkVfRERSX0NBTF9FTjsNCisJd3JpdGVsX3JlbGF4ZWQoY29uZmln
LCBob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29yZV9kbGxfY29uZmlnXzIpOw0K
Kw0KKwlyZXQgPSByZWFkbF9yZWxheGVkX3BvbGxfdGltZW91dChob3N0LT5pb2FkZHIgKw0KKwkJ
CQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX3N0YXR1cywNCisJCQkJCWRsbF9zdGF0dXMs
DQorCQkJCQkoZGxsX3N0YXR1cyAmIENPUkVfRERSX0RMTF9MT0NLKSwNCisJCQkJCTEwLCAxMDAw
KTsNCisNCisJaWYgKHJldCA9PSAtRVRJTUVET1VUKSB7DQorCQlwcl9lcnIoIiVzOiAlczogQ01f
RExMX1NEQzQgY2FsaWJyYXRpb24gd2FzIG5vdCBjb21wbGV0ZWRcbiIsDQorCQkgICAgICAgbW1j
X2hvc3RuYW1lKGhvc3QtPm1tYyksIF9fZnVuY19fKTsNCisJCWdvdG8gb3V0Ow0KKwl9DQorDQor
CS8qDQorCSAqIFNldCBDT1JFX1BXUlNBVkVfRExMIGJpdCBpbiBDT1JFX1ZFTkRPUl9TUEVDMy4N
CisJICogV2hlbiBNQ0xLIGlzIGdhdGVkIE9GRiwgaXQgaXMgbm90IGdhdGVkIGZvciBsZXNzIHRo
YW4gMC41dXMNCisJICogYW5kIE1DTEsgbXVzdCBiZSBzd2l0Y2hlZCBvbiBmb3IgYXQtbGVhc3Qg
MXVzIGJlZm9yZSBEQVRBDQorCSAqIHN0YXJ0cyBjb21pbmcuIENvbnRyb2xsZXJzIHdpdGggMTRs
cHAgYW5kIGxhdGVyIHRlY2ggRExMIGNhbm5vdA0KKwkgKiBndWFyYW50ZWUgYWJvdmUgcmVxdWly
ZW1lbnQuIFNvIFBXUlNBVkVfRExMIHNob3VsZCBub3QgYmUNCisJICogdHVybmVkIG9uIGZvciBo
b3N0IGNvbnRyb2xsZXJzIHVzaW5nIHRoaXMgRExMLg0KKwkgKi8NCisJaWYgKCFtc21fYmF5aHVi
X2hvc3QtPnVzZV8xNGxwcF9kbGxfcmVzZXQpIHsNCisJCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQo
aG9zdC0+aW9hZGRyICsNCisJCQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfdmVuZG9yX3NwZWMz
KTsNCisJCWNvbmZpZyB8PSBDT1JFX1BXUlNBVkVfRExMOw0KKwkJd3JpdGVsX3JlbGF4ZWQoY29u
ZmlnLCBob3N0LT5pb2FkZHIgKw0KKwkJCQltc21fYmF5aHViX29mZnNldC0+Y29yZV92ZW5kb3Jf
c3BlYzMpOw0KKwl9DQorDQorCS8qDQorCSAqIERyYWluIHdyaXRlYnVmZmVyIHRvIGVuc3VyZSBh
Ym92ZSBETEwgY2FsaWJyYXRpb24NCisJICogYW5kIFBXUlNBVkUgRExMIGlzIGVuYWJsZWQuDQor
CSAqLw0KKwl3bWIoKTsNCitvdXQ6DQorCXByX2RlYnVnKCIlczogJXM6IEV4aXQsIHJldCAlZFxu
IiwgbW1jX2hvc3RuYW1lKGhvc3QtPm1tYyksDQorCQkgX19mdW5jX18sIHJldCk7DQorCXJldHVy
biByZXQ7DQorfQ0KKw0KK3N0YXRpYyBpbnQgc2RoY2lfbXNtX2JheWh1Yl9oczQwMF9kbGxfY2Fs
aWJyYXRpb24oc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QpDQorew0KKwlzdHJ1Y3Qgc2RoY2lfcGx0
Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0cnVjdCBzZGhjaV9t
c21fYmF5aHViX2hvc3QgKm1zbV9iYXlodWJfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1f
aG9zdCk7DQorCXN0cnVjdCBtbWNfaG9zdCAqbW1jID0gaG9zdC0+bW1jOw0KKwlpbnQgcmV0Ow0K
Kwl1MzIgY29uZmlnOw0KKwljb25zdCBzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9vZmZzZXQgKm1z
bV9iYXlodWJfb2Zmc2V0ID0NCisJCQkJCW1zbV9iYXlodWJfaG9zdC0+b2Zmc2V0Ow0KKw0KKwlw
cl9kZWJ1ZygiJXM6ICVzOiBFbnRlclxuIiwgbW1jX2hvc3RuYW1lKGhvc3QtPm1tYyksIF9fZnVu
Y19fKTsNCisNCisJLyoNCisJICogUmV0dW5pbmcgaW4gSFM0MDAgKEREUiBtb2RlKSB3aWxsIGZh
aWwsIGp1c3QgcmVzZXQgdGhlDQorCSAqIHR1bmluZyBibG9jayBhbmQgcmVzdG9yZSB0aGUgc2F2
ZWQgdHVuaW5nIHBoYXNlLg0KKwkgKi8NCisJcmV0ID0gbXNtX2JheWh1Yl9pbml0X2NtX2RsbCho
b3N0KTsNCisJaWYgKHJldCkNCisJCWdvdG8gb3V0Ow0KKw0KKwlpZiAoIW1tYy0+aW9zLmVuaGFu
Y2VkX3N0cm9iZSkgew0KKwkJLyogU2V0IHRoZSBzZWxlY3RlZCBwaGFzZSBpbiBkZWxheSBsaW5l
IGh3IGJsb2NrICovDQorCQlyZXQgPSBtc21fYmF5aHViX2NvbmZpZ19jbV9kbGxfcGhhc2UoaG9z
dCwNCisJCQkJCSAgICAgIG1zbV9iYXlodWJfaG9zdC0+c2F2ZWRfdHVuaW5nX3BoYXNlKTsNCisJ
CWlmIChyZXQpDQorCQkJZ290byBvdXQ7DQorCQljb25maWcgPSByZWFkbF9yZWxheGVkKGhvc3Qt
PmlvYWRkciArDQorCQkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpOw0KKwkJ
Y29uZmlnIHw9IENPUkVfQ01EX0RBVF9UUkFDS19TRUw7DQorCQl3cml0ZWxfcmVsYXhlZChjb25m
aWcsIGhvc3QtPmlvYWRkciArDQorCQkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25m
aWcpOw0KKwl9DQorDQorCWlmIChtc21fYmF5aHViX2hvc3QtPnVzZV9jZGNscDUzMykNCisJCXJl
dCA9IHNkaGNpX21zbV9iYXlodWJfY2RjbHA1MzNfY2FsaWJyYXRpb24oaG9zdCk7DQorCWVsc2UN
CisJCXJldCA9IHNkaGNpX21zbV9iYXlodWJfY21fZGxsX3NkYzRfY2FsaWJyYXRpb24oaG9zdCk7
DQorb3V0Og0KKwlwcl9kZWJ1ZygiJXM6ICVzOiBFeGl0LCByZXQgJWRcbiIsIG1tY19ob3N0bmFt
ZShob3N0LT5tbWMpLA0KKwkJIF9fZnVuY19fLCByZXQpOw0KKwlyZXR1cm4gcmV0Ow0KK30NCisN
CitzdGF0aWMgYm9vbCBzZGhjaV9tc21fYmF5aHViX2lzX3R1bmluZ19uZWVkZWQoc3RydWN0IHNk
aGNpX2hvc3QgKmhvc3QpDQorew0KKwlzdHJ1Y3QgbW1jX2lvcyAqaW9zID0gJmhvc3QtPm1tYy0+
aW9zOw0KKw0KKwkvKg0KKwkgKiBUdW5pbmcgaXMgcmVxdWlyZWQgZm9yIFNEUjEwNCwgSFMyMDAg
YW5kIEhTNDAwIGNhcmRzIGFuZA0KKwkgKiBpZiBjbG9jayBmcmVxdWVuY3kgaXMgZ3JlYXRlciB0
aGFuIDEwME1IeiBpbiB0aGVzZSBtb2Rlcy4NCisJICovDQorCWlmIChob3N0LT5jbG9jayA8PSBD
T1JFX0ZSRVFfMTAwTUhaIHx8DQorCSAgICAhKGlvcy0+dGltaW5nID09IE1NQ19USU1JTkdfTU1D
X0hTNDAwIHx8DQorCSAgICBpb3MtPnRpbWluZyA9PSBNTUNfVElNSU5HX01NQ19IUzIwMCB8fA0K
KwkgICAgaW9zLT50aW1pbmcgPT0gTU1DX1RJTUlOR19VSFNfU0RSMTA0KSB8fA0KKwkgICAgaW9z
LT5lbmhhbmNlZF9zdHJvYmUpDQorCQlyZXR1cm4gZmFsc2U7DQorDQorCXJldHVybiB0cnVlOw0K
K30NCisNCitzdGF0aWMgaW50IHNkaGNpX21zbV9iYXlodWJfcmVzdG9yZV9zZHJfZGxsX2NvbmZp
ZyhzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0
ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlo
dWJfaG9zdCAqbXNtX2JheWh1Yl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsN
CisJaW50IHJldDsNCisNCisJLyoNCisJICogU0RSIERMTCBjb21lcyBpbnRvIHBpY3R1cmUgb25s
eSBmb3IgdGltaW5nIG1vZGVzIHdoaWNoIG5lZWRzDQorCSAqIHR1bmluZy4NCisJICovDQorCWlm
ICghc2RoY2lfbXNtX2JheWh1Yl9pc190dW5pbmdfbmVlZGVkKGhvc3QpKQ0KKwkJcmV0dXJuIDA7
DQorDQorCS8qIFJlc2V0IHRoZSB0dW5pbmcgYmxvY2sgKi8NCisJcmV0ID0gbXNtX2JheWh1Yl9p
bml0X2NtX2RsbChob3N0KTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCS8qIFJl
c3RvcmUgdGhlIHR1bmluZyBibG9jayAqLw0KKwlyZXQgPSBtc21fYmF5aHViX2NvbmZpZ19jbV9k
bGxfcGhhc2UoaG9zdCwgbXNtX2JheWh1Yl9ob3N0LT5zYXZlZF90dW5pbmdfcGhhc2UpOw0KKw0K
KwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgdm9pZCBzZGhjaV9tc21fYmF5aHViX3NldF9j
ZHIoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsIGJvb2wgZW5hYmxlKQ0KK3sNCisJY29uc3Qgc3Ry
dWN0IHNkaGNpX21zbV9iYXlodWJfb2Zmc2V0ICptc21fYmF5aHViX29mZnNldCA9DQorCQkJCQkJ
CXNkaGNpX3ByaXZfbXNtX2JheWh1Yl9vZmZzZXQoaG9zdCk7DQorCXUzMiBjb25maWcsIG9sZGNv
bmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsNCisJCQkJCSAgICAgIG1zbV9iYXlo
dWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpOw0KKw0KKwljb25maWcgPSBvbGRjb25maWc7DQor
CWlmIChlbmFibGUpIHsNCisJCWNvbmZpZyB8PSBDT1JFX0NEUl9FTjsNCisJCWNvbmZpZyAmPSB+
Q09SRV9DRFJfRVhUX0VOOw0KKwl9IGVsc2Ugew0KKwkJY29uZmlnICY9IH5DT1JFX0NEUl9FTjsN
CisJCWNvbmZpZyB8PSBDT1JFX0NEUl9FWFRfRU47DQorCX0NCisNCisJaWYgKGNvbmZpZyAhPSBv
bGRjb25maWcpIHsNCisJCXdyaXRlbF9yZWxheGVkKGNvbmZpZywgaG9zdC0+aW9hZGRyICsNCisJ
CQkgICAgICAgbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZyk7DQorCX0NCit9DQor
DQorc3RhdGljIGludCBzZGhjaV9tc21fYmF5aHViX2V4ZWN1dGVfdHVuaW5nKHN0cnVjdCBtbWNf
aG9zdCAqbW1jLCB1MzIgb3Bjb2RlKQ0KK3sNCisJc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QgPSBt
bWNfcHJpdihtbWMpOw0KKwlpbnQgdHVuaW5nX3NlcV9jbnQgPSAxMDsNCisJdTggcGhhc2UsIHR1
bmVkX3BoYXNlc1sxNl0sIHR1bmVkX3BoYXNlX2NudCA9IDA7DQorCWludCByYzsNCisJc3RydWN0
IG1tY19pb3MgaW9zID0gaG9zdC0+bW1jLT5pb3M7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0
ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlo
dWJfaG9zdCAqbXNtX2JheWh1Yl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsN
CisNCisJaWYgKCFzZGhjaV9tc21fYmF5aHViX2lzX3R1bmluZ19uZWVkZWQoaG9zdCkpIHsNCisJ
CW1zbV9iYXlodWJfaG9zdC0+dXNlX2NkciA9IGZhbHNlOw0KKwkJc2RoY2lfbXNtX2JheWh1Yl9z
ZXRfY2RyKGhvc3QsIGZhbHNlKTsNCisJCXJldHVybiAwOw0KKwl9DQorDQorCS8qIENsb2NrLURh
dGEtUmVjb3ZlcnkgdXNlZCB0byBkeW5hbWljYWxseSBhZGp1c3QgUlggc2FtcGxpbmcgcG9pbnQg
Ki8NCisJbXNtX2JheWh1Yl9ob3N0LT51c2VfY2RyID0gdHJ1ZTsNCisNCisJLyoNCisJICogQ2xl
YXIgdHVuaW5nX2RvbmUgZmxhZyBiZWZvcmUgdHVuaW5nIHRvIGVuc3VyZSBwcm9wZXINCisJICog
SFM0MDAgc2V0dGluZ3MuDQorCSAqLw0KKwltc21fYmF5aHViX2hvc3QtPnR1bmluZ19kb25lID0g
MDsNCisNCisJLyoNCisJICogRm9yIEhTNDAwIHR1bmluZyBpbiBIUzIwMCB0aW1pbmcgcmVxdWly
ZXM6DQorCSAqIC0gc2VsZWN0IE1DTEsvMiBpbiBWRU5ET1JfU1BFQw0KKwkgKiAtIHByb2dyYW0g
TUNMSyB0byA0MDBNSHogKG9yIG5lYXJlc3Qgc3VwcG9ydGVkKSBpbiBHQ0MNCisJICovDQorCWlm
IChob3N0LT5mbGFncyAmIFNESENJX0hTNDAwX1RVTklORykgew0KKwkJc2RoY2lfbXNtX2JheWh1
Yl9oY19zZWxlY3RfbW9kZShob3N0KTsNCisJCW1zbV9iYXlodWJfc2V0X2Nsb2NrX3JhdGVfZm9y
X2J1c19tb2RlKGhvc3QsIGlvcy5jbG9jayk7DQorCQlob3N0LT5mbGFncyAmPSB+U0RIQ0lfSFM0
MDBfVFVOSU5HOw0KKwl9DQorDQorcmV0cnk6DQorCS8qIEZpcnN0IG9mIGFsbCByZXNldCB0aGUg
dHVuaW5nIGJsb2NrICovDQorCXJjID0gbXNtX2JheWh1Yl9pbml0X2NtX2RsbChob3N0KTsNCisJ
aWYgKHJjKQ0KKwkJcmV0dXJuIHJjOw0KKw0KKwlwaGFzZSA9IDA7DQorCWRvIHsNCisJCS8qIFNl
dCB0aGUgcGhhc2UgaW4gZGVsYXkgbGluZSBodyBibG9jayAqLw0KKwkJcmMgPSBtc21fYmF5aHVi
X2NvbmZpZ19jbV9kbGxfcGhhc2UoaG9zdCwgcGhhc2UpOw0KKwkJaWYgKHJjKQ0KKwkJCXJldHVy
biByYzsNCisNCisJCXJjID0gbW1jX3NlbmRfdHVuaW5nKG1tYywgb3Bjb2RlLCBOVUxMKTsNCisJ
CWlmICghcmMpIHsNCisJCQkvKiBUdW5pbmcgaXMgc3VjY2Vzc2Z1bCBhdCB0aGlzIHR1bmluZyBw
b2ludCAqLw0KKwkJCXR1bmVkX3BoYXNlc1t0dW5lZF9waGFzZV9jbnQrK10gPSBwaGFzZTsNCisJ
CQlkZXZfZGJnKG1tY19kZXYobW1jKSwgIiVzOiBGb3VuZCBnb29kIHBoYXNlID0gJWRcbiIsDQor
CQkJCSBtbWNfaG9zdG5hbWUobW1jKSwgcGhhc2UpOw0KKwkJfQ0KKw0KKwkJaWYgKG1zbV9iYXlo
dWJfaG9zdC0+Z2djLmJoMjAxX3VzZWQpDQorCQkJdXNsZWVwX3JhbmdlKDEwMDAsIDEyMDApOw0K
Kw0KKwl9IHdoaWxlICgrK3BoYXNlIDwgQVJSQVlfU0laRSh0dW5lZF9waGFzZXMpKTsNCisNCisJ
aWYgKHR1bmVkX3BoYXNlX2NudCkgew0KKwkJaWYgKHR1bmVkX3BoYXNlX2NudCA9PSBBUlJBWV9T
SVpFKHR1bmVkX3BoYXNlcykpIHsNCisJCQkvKg0KKwkJCSAqIEFsbCBwaGFzZXMgdmFsaWQgaXMg
X2FsbW9zdF8gYXMgYmFkIGFzIG5vIHBoYXNlcw0KKwkJCSAqIHZhbGlkLiAgUHJvYmFibHkgYWxs
IHBoYXNlcyBhcmUgbm90IHJlYWxseSByZWxpYWJsZQ0KKwkJCSAqIGJ1dCB3ZSBkaWRuJ3QgZGV0
ZWN0IHdoZXJlIHRoZSB1bnJlbGlhYmxlIHBsYWNlIGlzLg0KKwkJCSAqIFRoYXQgbWVhbnMgd2Un
bGwgZXNzZW50aWFsbHkgYmUgZ3Vlc3NpbmcgYW5kIGhvcGluZw0KKwkJCSAqIHdlIGdldCBhIGdv
b2QgcGhhc2UuICBCZXR0ZXIgdG8gdHJ5IGEgZmV3IHRpbWVzLg0KKwkJCSAqLw0KKwkJCWRldl9k
YmcobW1jX2RldihtbWMpLCAiJXM6IEFsbCBwaGFzZXMgdmFsaWQ7IHRyeSBhZ2FpblxuIiwNCisJ
CQkJbW1jX2hvc3RuYW1lKG1tYykpOw0KKwkJCWlmICgtLXR1bmluZ19zZXFfY250KSB7DQorCQkJ
CXR1bmVkX3BoYXNlX2NudCA9IDA7DQorCQkJCWdvdG8gcmV0cnk7DQorCQkJfQ0KKwkJfQ0KKw0K
KwkJcmMgPSBtc21fYmF5aHViX2ZpbmRfbW9zdF9hcHByb3ByaWF0ZV9waGFzZShob3N0LCB0dW5l
ZF9waGFzZXMsDQorCQkJCQkJICAgICB0dW5lZF9waGFzZV9jbnQpOw0KKwkJaWYgKHJjID49IDAp
DQorCQkJcGhhc2UgPSByYzsNCisJCWVsc2UNCisJCQlyZXR1cm4gcmM7DQorDQorCQkvKg0KKwkJ
ICogRmluYWxseSBzZXQgdGhlIHNlbGVjdGVkIHBoYXNlIGluIGRlbGF5DQorCQkgKiBsaW5lIGh3
IGJsb2NrLg0KKwkJICovDQorCQlyYyA9IG1zbV9iYXlodWJfY29uZmlnX2NtX2RsbF9waGFzZSho
b3N0LCBwaGFzZSk7DQorCQlpZiAocmMpDQorCQkJcmV0dXJuIHJjOw0KKwkJbXNtX2JheWh1Yl9o
b3N0LT5zYXZlZF90dW5pbmdfcGhhc2UgPSBwaGFzZTsNCisJCWRldl9kYmcobW1jX2RldihtbWMp
LCAiJXM6IFNldHRpbmcgdGhlIHR1bmluZyBwaGFzZSB0byAlZFxuIiwNCisJCQkgbW1jX2hvc3Ru
YW1lKG1tYyksIHBoYXNlKTsNCisJfSBlbHNlIHsNCisJCWlmICgtLXR1bmluZ19zZXFfY250KQ0K
KwkJCWdvdG8gcmV0cnk7DQorCQkvKiBUdW5pbmcgZmFpbGVkICovDQorCQlkZXZfZGJnKG1tY19k
ZXYobW1jKSwgIiVzOiBObyB0dW5pbmcgcG9pbnQgZm91bmRcbiIsDQorCQkgICAgICAgbW1jX2hv
c3RuYW1lKG1tYykpOw0KKwkJcmMgPSAtRUlPOw0KKwl9DQorDQorCWlmICghcmMpDQorCQltc21f
YmF5aHViX2hvc3QtPnR1bmluZ19kb25lID0gdHJ1ZTsNCisJcmV0dXJuIHJjOw0KK30NCisNCitz
dGF0aWMgY29uc3QgdW5zaWduZWQgaW50IGZyZXFzW10gPSB7IDQwMDAwMCwgMzAwMDAwLCAyMDAw
MDAsIDEwMDAwMCB9Ow0KKw0KK3N0YXRpYyB2b2lkIGNmZ19iaXRfMl9idChpbnQgbWF4X2JpdCwg
aW50IHRhciwgaW50ICpieXQsIGludCAqYml0KQ0KK3sNCisJc3RydWN0IHJsX2JpdF9sY3QgY2Zn
X2JpdF9tYXBbNl0gPSB7DQorCQl7MCwgNn0sCXsxLCA1fSwJezIsIDR9LA0KKwkJezMsIDJ9LAl7
NCwgMX0sCXs1LCAwfSwNCisJfTsNCisNCisJKmJ5dCA9IChtYXhfYml0IC0gdGFyKSAvIDY7DQor
CSpiaXQgPSBjZmdfYml0X21hcFsobWF4X2JpdCAtIHRhcikgJSA2XS5ybF9iaXRzOw0KK30NCisN
CitzdGF0aWMgdTMyIGNmZ19yZWFkX2JpdHNfb2ZzX21hc2sodTggKmNmZywgc3RydWN0IHRfZ2df
cmVnX3N0cnQgKmJ0cykNCit7DQorCXUzMiBydiA9IDA7DQorCXUzMiBtc2sgPSBidHMtPm1hc2s7
DQorCWludCBieXQgPSAwLCBiaXQgPSAwOw0KKwlpbnQgaSA9IDA7DQorDQorCWRvIHsNCisJCWNm
Z19iaXRfMl9idChNQVhfQ0ZHX0JJVF9WQUwsIGJ0cy0+b2ZzICsgaSwgJmJ5dCwgJmJpdCk7DQor
CQlpZiAoY2ZnW2J5dF0gJiAoMSA8PCBiaXQpKQ0KKwkJCXJ2IHw9IDEgPDwgaTsNCisNCisJCWkr
KzsNCisJCW1zayA+Pj0gMTsNCisJCWlmIChtc2sgPT0gMCkNCisJCQlicmVhazsNCisJfSB3aGls
ZSAoMSk7DQorCXJldHVybiBydjsNCit9DQorDQorc3RhdGljIHZvaWQgZ2V0X2RlZmF1bHRfc2V0
dGluZyhzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgdTggKmRhdGEpDQorew0KKwlzdHJ1Y3Qgc2Ro
Y2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0cnVjdCBz
ZGhjaV9tc21fYmF5aHViX2hvc3QgKnZlbmRvcl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRm
bV9ob3N0KTsNCisNCisJdmVuZG9yX2hvc3QtPmdnYy5kZWZfc2VsYV8xMDBtID0NCisJCWNmZ19y
ZWFkX2JpdHNfb2ZzX21hc2soZGF0YSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxsX3NlbGFfMTAwbV9j
ZmcpOw0KKwl2ZW5kb3JfaG9zdC0+Z2djLmRlZl9zZWxhXzIwMG0gPQ0KKwkJY2ZnX3JlYWRfYml0
c19vZnNfbWFzayhkYXRhLCAmdmVuZG9yX2hvc3QtPmdnYy5kbGxfc2VsYV8yMDBtX2NmZyk7DQor
CXZlbmRvcl9ob3N0LT5nZ2MuZGVmX3NlbGJfMTAwbSA9DQorCQljZmdfcmVhZF9iaXRzX29mc19t
YXNrKGRhdGEsICZ2ZW5kb3JfaG9zdC0+Z2djLmRsbF9zZWxhXzEwMG1fY2ZnKTsNCisJdmVuZG9y
X2hvc3QtPmdnYy5kZWZfc2VsYl8yMDBtID0NCisJCWNmZ19yZWFkX2JpdHNfb2ZzX21hc2soZGF0
YSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxsX3NlbGFfMjAwbV9jZmcpOw0KK30NCisNCitzdGF0aWMg
dm9pZCBjZmdfd3JpdGVfYml0c19vZnNfbWFzayh1OCAqY2ZnLA0KKwkJc3RydWN0IHRfZ2dfcmVn
X3N0cnQgKmJ0cywgdTMyIHdfdmFsdWUpDQorew0KKwl1MzIgd3YgPSB3X3ZhbHVlICYgYnRzLT5t
YXNrOw0KKwl1MzIgbXNrID0gYnRzLT5tYXNrOw0KKwlpbnQgYnl0ID0gMCwgYml0ID0gMDsNCisJ
aW50IGkgPSAwOw0KKw0KKwlkbyB7DQorCQljZmdfYml0XzJfYnQoTUFYX0NGR19CSVRfVkFMLCBi
dHMtPm9mcyArIGksICZieXQsICZiaXQpOw0KKwkJaWYgKHd2ICYgMSkNCisJCQljZmdbYnl0XSB8
PSAodTgpICgxIDw8IGJpdCk7DQorCQllbHNlDQorCQkJY2ZnW2J5dF0gJj0gKHU4KSAofigxIDw8
IGJpdCkpOw0KKw0KKwkJaSsrOw0KKwkJd3YgPj49IDE7DQorCQltc2sgPj49IDE7DQorCQlpZiAo
bXNrID09IDApDQorCQkJYnJlYWs7DQorCX0gd2hpbGUgKDEpOw0KK30NCisNCitzdGF0aWMgdm9p
ZCByYW1fYml0XzJfYnQoaW50IHRhciwgaW50ICpieXQsIGludCAqYml0KQ0KK3sNCisJKmJ5dCA9
IHRhciAvIDg7DQorCSpiaXQgPSB0YXIgJSA4Ow0KK30NCisNCitzdGF0aWMgdm9pZCBzZXRfZ2df
cmVnX2N1cl92YWwoc3RydWN0IGdnY19wbGF0Zm9ybV90ICAqZ2djLA0KKwl1OCAqZGF0YSwgdTgg
bGVuKQ0KK3sNCisJbWVtY3B5KCZnZ2MtPl9nZ19yZWdfY3VyWzBdLCBkYXRhLCBsZW4pOw0KK30N
CisNCitzdGF0aWMgdm9pZCBnZXRfZ2dfcmVnX2N1cl92YWwoc3RydWN0IGdnY19wbGF0Zm9ybV90
ICAqZ2djLA0KKwl1OCAqZGF0YSwgdTggbGVuKQ0KK3sNCisJbWVtY3B5KGRhdGEsICZnZ2MtPl9n
Z19yZWdfY3VyWzBdLCBsZW4pOw0KK30NCisNCitzdGF0aWMgdm9pZCBnZXRfZ2dfcmVnX2RlZihz
dHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgdTggKmRhdGEpDQorew0KKwl1MzIgZ2dfc3dfZGVmWzE2
XSA9IEdHQ19DRkdfREFUQTsNCisNCisJbWVtY3B5KGRhdGEsICh1OCAqKSYoZ2dfc3dfZGVmWzBd
KSwgc2l6ZW9mKGdnX3N3X2RlZikpOw0KK30NCisNCitzdGF0aWMgdTMyIHJlYWRfcmFtX2JpdHNf
b2ZzX21hc2sodTggKmNmZywgc3RydWN0IHRfZ2dfcmVnX3N0cnQgKmJ0cykNCit7DQorCXUzMiBy
diA9IDA7DQorCXUzMiBtc2sgPSBidHMtPm1hc2s7DQorCWludCBieXQgPSAwLCBiaXQgPSAwOw0K
KwlpbnQgaSA9IDA7DQorDQorCWRvIHsNCisJCXJhbV9iaXRfMl9idChidHMtPm9mcyArIGksICZi
eXQsICZiaXQpOw0KKwkJaWYgKGNmZ1tieXRdICYgKDEgPDwgYml0KSkNCisJCQlydiB8PSAxIDw8
IGk7DQorDQorCQlpKys7DQorCQltc2sgPj49IDE7DQorCQlpZiAobXNrID09IDApDQorCQkJYnJl
YWs7DQorDQorCX0gd2hpbGUgKDEpOw0KKwlyZXR1cm4gcnY7DQorfQ0KKw0KK3N0YXRpYyB2b2lk
IGdnY19kbGxfdm9sdGFnZV9pbml0KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0KQ0KK3sNCisJaW50
IGkgPSAwOw0KKwlzdHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3By
aXYoaG9zdCk7DQorCXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKnZlbmRvcl9ob3N0ID0N
CisJCQkJCQlzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKw0KKwlmb3IgKGkgPSAwOyBp
IDwgNDsgaSsrKSB7DQorCQl2ZW5kb3JfaG9zdC0+Z2djLmRsbF92b2x0YWdlX3NjYW5fbWFwW2ld
ID0gMDsNCisJCXZlbmRvcl9ob3N0LT5nZ2Muc2RyNTAuZGxsX3ZvbHRhZ2VfdW5sb2NrX2NudFtp
XSA9IDA7DQorCQl2ZW5kb3JfaG9zdC0+Z2djLnNkcjEwNC5kbGxfdm9sdGFnZV91bmxvY2tfY250
W2ldID0gMDsNCisJfQ0KK30NCisNCitzdGF0aWMgdm9pZCBnZ2NfY2hpcF9pbml0KHN0cnVjdCBz
ZGhjaV9ob3N0ICpob3N0KQ0KK3sNCisJdTggZGF0YVs1MTJdID0geyAwIH07DQorCXN0cnVjdCBz
ZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0
IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPQ0KKwkJCQkJCXNkaGNpX3BsdGZt
X3ByaXYocGx0Zm1faG9zdCk7DQorDQorCWdldF9nZ19yZWdfZGVmKGhvc3QsIGRhdGEpOw0KKwln
ZXRfZGVmYXVsdF9zZXR0aW5nKGhvc3QsIGRhdGEpOw0KKwlzZXRfZ2dfcmVnX2N1cl92YWwoJnZl
bmRvcl9ob3N0LT5nZ2MsIGRhdGEsIDY0KTsNCit9DQorDQorc3RhdGljIGludCBkcml2ZXJfc2Vu
ZF9jb21tYW5kNyhzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCWludCByZXQgPSAwOw0K
KwlpbnQgZXJyOw0KKwlzdHJ1Y3QgbW1jX2hvc3QgKm1tYyA9IGhvc3QtPm1tYzsNCisJc3RydWN0
IG1tY19jb21tYW5kIGNtZCA9IHswfTsNCisNCisJY21kLm9wY29kZSA9IE1NQ19TRUxFQ1RfQ0FS
RDsNCisJY21kLmFyZyA9IDA7DQorCWNtZC5mbGFncyA9IE1NQ19SU1BfTk9ORSB8IE1NQ19DTURf
QUM7DQorCWVyciA9IG1tY193YWl0X2Zvcl9jbWQobW1jLCAmY21kLCAzKTsNCisJaWYgKGVycikN
CisJCXJldCA9IDA7DQorCWVsc2UNCisJCXJldCA9IDE7DQorDQorCXJldHVybiByZXQ7DQorfQ0K
Kw0KK3N0YXRpYyB2b2lkIGRyaXZlcl9zZW5kX2NvbW1hbmQyNChzdHJ1Y3Qgc2RoY2lfaG9zdCAq
aG9zdCwNCisJCXUzMiAqY2ZnX2RhdGEsIGludCBkYXRhX2xlbikNCit7DQorCXN0cnVjdCBtbWNf
aG9zdCAqbW1jID0gaG9zdC0+bW1jOw0KKwlzdHJ1Y3QgbW1jX3JlcXVlc3QgbXJxID0gezB9Ow0K
KwlzdHJ1Y3QgbW1jX2NvbW1hbmQgY21kID0geyAwIH07DQorCXN0cnVjdCBtbWNfZGF0YSBkYXRh
ID0geyAwIH07DQorCXN0cnVjdCBzY2F0dGVybGlzdCBzZzsNCisJdTggKmRhdGExID0ga3phbGxv
YyhQQUdFX1NJWkUsIEdGUF9LRVJORUwpOw0KKw0KKwltZW1jcHkoZGF0YTEsICh1OCAqKSYoY2Zn
X2RhdGFbMF0pLCBkYXRhX2xlbik7DQorCXNnX2luaXRfb25lKCZzZywgZGF0YTEsIDUxMik7DQor
DQorCWNtZC5vcGNvZGUgPSBNTUNfV1JJVEVfQkxPQ0s7DQorCWNtZC5hcmcgPSAwOw0KKwljbWQu
ZmxhZ3MgPSBNTUNfUlNQX1IxIHwgTU1DX0NNRF9BRFRDOw0KKwlkYXRhLmJsa3N6ID0gNTEyOw0K
KwlkYXRhLmJsb2NrcyA9IDE7DQorCWRhdGEuZmxhZ3MgPSBNTUNfREFUQV9XUklURTsNCisJZGF0
YS50aW1lb3V0X25zID0gMTAwMCAqIDEwMDAgKiAxMDAwOw0KKwlkYXRhLnNnID0gJnNnOw0KKwlk
YXRhLnNnX2xlbiA9IDE7DQorCW1ycS5jbWQgPSAmY21kOw0KKwltcnEuZGF0YSA9ICZkYXRhOw0K
KwltcnEuc3RvcCA9IE5VTEw7DQorDQorCW1tY193YWl0X2Zvcl9yZXEobW1jLCAmbXJxKTsNCisJ
a2ZyZWUoZGF0YTEpOw0KK30NCisNCitzdGF0aWMgdm9pZCBiaHRfdXBkYXRlX2NmZyhzdHJ1Y3Qg
bW1jX2hvc3QgKm1tY19ob3N0LA0KKwlzdHJ1Y3QgbW1jX2NhcmQgKmNhcmQsIHUzMiAqY2ZnX2Rh
dGEsIGludCBkYXRhX2xlbikNCit7DQorCWludCByZXQgPSAwOw0KKwlzdHJ1Y3Qgc2RoY2lfaG9z
dCAqaG9zdDsNCisNCisJaG9zdCA9IG1tY19wcml2KG1tY19ob3N0KTsNCisJbW1jX3NldF9idXNf
d2lkdGgobW1jX2hvc3QsIE1NQ19CVVNfV0lEVEhfNCk7DQorCWlmIChob3N0LT5vcHMtPnJlc2V0
KQ0KKwkJaG9zdC0+b3BzLT5yZXNldChob3N0LCBTREhDSV9SRVNFVF9DTUR8U0RIQ0lfUkVTRVRf
REFUQSk7DQorDQorCWRyaXZlcl9zZW5kX2NvbW1hbmQ3KGhvc3QpOw0KKwlkcml2ZXJfc2VuZF9j
b21tYW5kMjQoaG9zdCwgY2ZnX2RhdGEsIGRhdGFfbGVuKTsNCisJZHJpdmVyX3NlbmRfY29tbWFu
ZDcoaG9zdCk7DQorDQorCW1tY19zZXRfYnVzX3dpZHRoKG1tY19ob3N0LCBNTUNfQlVTX1dJRFRI
XzEpOw0KK30NCisNCisNCitzdGF0aWMgdm9pZCB0eF9zZWxiX2ZhaWxlZF90Yl9yZXNldChzdHJ1
Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRm
bV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9z
dCAqdmVuZG9yX2hvc3QgPQ0KKwkJCQkJCXNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQor
DQorCW1lbXNldCgmdmVuZG9yX2hvc3QtPmdnYy5zZHIxMDQudHhfc2VsYl90YiwgMHhmZiwNCisJ
CQlzaXplb2YodmVuZG9yX2hvc3QtPmdnYy5zZHIxMDQudHhfc2VsYl90YikpOw0KKwltZW1zZXQo
JnZlbmRvcl9ob3N0LT5nZ2Muc2RyNTAudHhfc2VsYl90YiwgMHhmZiwNCisJCQlzaXplb2YodmVu
ZG9yX2hvc3QtPmdnYy5zZHI1MC50eF9zZWxiX3RiKSk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGFs
bF9zZWxiX2ZhaWxlZF90Yl9yZXNldChzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCXN0
cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJ
c3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPQ0KKwkJCQkJCXNkaGNp
X3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQorCW1lbXNldCh2ZW5kb3JfaG9zdC0+Z2djLnNk
cjEwNC5hbGxfc2VsYl90YiwgMHhmZiwNCisJCQlzaXplb2YodmVuZG9yX2hvc3QtPmdnYy5zZHIx
MDQuYWxsX3NlbGJfdGIpKTsNCisJbWVtc2V0KHZlbmRvcl9ob3N0LT5nZ2Muc2RyNTAuYWxsX3Nl
bGJfdGIsIDB4ZmYsDQorCQkJc2l6ZW9mKHZlbmRvcl9ob3N0LT5nZ2Muc2RyNTAuYWxsX3NlbGJf
dGIpKTsNCit9DQorDQorc3RhdGljIHZvaWQgdHhfc2VsYl9mYWlsZWRfaGlzdG9yeV9yZXNldChz
dHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpw
bHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJf
aG9zdCAqdmVuZG9yX2hvc3QgPQ0KKwkJCQkJCXNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7
DQorDQorCXZlbmRvcl9ob3N0LT5nZ2Muc2RyNTAudHhfc2VsYl9mYWlsZWRfaGlzdG9yeSA9IEJJ
VF9QQVNTX01BU0s7DQorCXZlbmRvcl9ob3N0LT5nZ2Muc2RyMTA0LnR4X3NlbGJfZmFpbGVkX2hp
c3RvcnkgPSBCSVRfUEFTU19NQVNLOw0KK30NCisNCitzdGF0aWMgdm9pZCBnZ2NfcmVzZXRfc2Vs
eF9mYWlsZWRfdGIoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QpDQorew0KKwl0eF9zZWxiX2ZhaWxl
ZF90Yl9yZXNldChob3N0KTsNCisJYWxsX3NlbGJfZmFpbGVkX3RiX3Jlc2V0KGhvc3QpOw0KKwl0
eF9zZWxiX2ZhaWxlZF9oaXN0b3J5X3Jlc2V0KGhvc3QpOw0KK30NCisNCitzdGF0aWMgdm9pZCBf
Z2djX3Jlc2V0X3NlbGFfdHVuaW5nX3Jlc3VsdCgNCisJCQlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1
Yl9ob3N0ICpob3N0KQ0KK3sNCisJaW50IGkgPSAwOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVO
SU5HX1BIQVNFX1NJWkU7IGkrKykNCisJCWhvc3QtPmdnYy5nZ2Nfc2VsYV90dW5pbmdfcmVzdWx0
W2ldID0gTk9fVFVOSU5HOw0KK30NCisNCitzdGF0aWMgdm9pZCBfZ2djX3Jlc2V0X3R1bmluZ19y
ZXN1bHRfZm9yX2RsbChzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCXN0cnVjdCBzZGhj
aV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNk
aGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPQ0KKwkJCQkJCXNkaGNpX3BsdGZtX3By
aXYocGx0Zm1faG9zdCk7DQorDQorCWdnY19yZXNldF9zZWx4X2ZhaWxlZF90Yihob3N0KTsNCisJ
dmVuZG9yX2hvc3QtPmdnYy5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlID0gQklUX1BBU1Nf
TUFTSzsNCisJdmVuZG9yX2hvc3QtPmdnYy5zZWx4X3R1bmluZ19kb25lX2ZsYWcgPSAwOw0KKwlf
Z2djX3Jlc2V0X3NlbGFfdHVuaW5nX3Jlc3VsdCh2ZW5kb3JfaG9zdCk7DQorfQ0KKw0KK3N0YXRp
YyB2b2lkIGdnY190dW5pbmdfcmVzdWx0X3Jlc2V0KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0KQ0K
K3sNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhv
c3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICp2ZW5kb3JfaG9zdCA9DQorCQkJ
CQkJc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisNCisJX2dnY19yZXNldF90dW5pbmdf
cmVzdWx0X2Zvcl9kbGwoaG9zdCk7DQorDQorCXZlbmRvcl9ob3N0LT5nZ2Muc2RyNTAuYnVzX21v
ZGUgPSBTRF9GTkNfQU1fU0RSNTA7DQorCXZlbmRvcl9ob3N0LT5nZ2Muc2RyMTA0LmJ1c19tb2Rl
ID0gU0RfRk5DX0FNX1NEUjEwNDsNCisJdmVuZG9yX2hvc3QtPmdnYy5kcml2ZXJfc3RyZW5ndGhf
cmVpbml0X2ZsZyA9IDA7DQorCXZlbmRvcl9ob3N0LT5nZ2MuY3VyX2J1c19tb2RlID0gTlVMTDsN
CisJdmVuZG9yX2hvc3QtPmdnYy5kbGxfdW5sb2NrX3JlaW5pdF9mbGcgPSAwOw0KKwl2ZW5kb3Jf
aG9zdC0+Z2djLnR1bmluZ19jbWQ3X3RpbWVvdXRfcmVpbml0X2ZsZyA9IDA7DQorCXZlbmRvcl9o
b3N0LT5nZ2MudHVuaW5nX2NtZDdfdGltZW91dF9yZWluaXRfY250ID0gMDsNCisJdmVuZG9yX2hv
c3QtPmdnYy5zZHI1MF9ub3R1bmluZ19zZWxhX2luamVjdF9mbGFnID0gMTsNCisJdmVuZG9yX2hv
c3QtPmdnYy5zZHI1MF9ub3R1bmluZ19jcmNfZXJyb3JfZmxhZyA9IDA7DQorCWlmICh2ZW5kb3Jf
aG9zdC0+Z2djLmJoMjAxX3NkcjUwX3NlbGFfc3dfaW5qZWN0KQ0KKwkJdmVuZG9yX2hvc3QtPmdn
Yy5zZHI1MF9ub3R1bmluZ19zZWxhX3J4X2luamVjdCA9DQorCQkJCQkJdmVuZG9yX2hvc3QtPmdn
Yy5iaDIwMV9zZHI1MF9zZWxhX3N3X2luamVjdDsNCisJZWxzZQ0KKwkJdmVuZG9yX2hvc3QtPmdn
Yy5zZHI1MF9ub3R1bmluZ19zZWxhX3J4X2luamVjdCA9IDB4NDdGOw0KK30NCisNCitzdGF0aWMg
dm9pZCBiaHRfbG9hZF9od19pbmplY3Qoc3RydWN0IG1tY19ob3N0ICptbWNfaG9zdCwNCisJc3Ry
dWN0IG1tY19jYXJkICpjYXJkLCB1MzIgKmNmZ19kYXRhLCBpbnQgZGF0YV9sZW4sDQorCXUzMiBz
ZWwyMDAsIHUzMiBzZWwxMDApDQorew0KKwlzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCA9IG1tY19w
cml2KG1tY19ob3N0KTsNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBz
ZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICp2ZW5kb3Jf
aG9zdCA9DQorCQkJCQkJc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisJdTMyIGdnX2h3
X2lualsxNl0gPSBHR0NfQ0ZHX0RBVEE7DQorDQorCWdnX2h3X2lualsxXSA9IDB4NzM2NDAzMjsN
CisNCisJaWYgKHZlbmRvcl9ob3N0LT5nZ2MuYmgyMDFfc2RyMTA0X3NlbGJfaHdfaW5qZWN0KQ0K
KwkJZ2dfaHdfaW5qWzExXSA9IHZlbmRvcl9ob3N0LT5nZ2MuYmgyMDFfc2RyMTA0X3NlbGJfaHdf
aW5qZWN0Ow0KKwllbHNlDQorCQlnZ19od19pbmpbMTFdID0gMHg1NzMzNjIwMDsNCisNCisJaWYg
KHZlbmRvcl9ob3N0LT5nZ2MuYmgyMDFfc2RyNTBfc2VsYl9od19pbmplY3QpDQorCQlnZ19od19p
bmpbMTJdID0gdmVuZG9yX2hvc3QtPmdnYy5iaDIwMV9zZHI1MF9zZWxiX2h3X2luamVjdDsNCisJ
ZWxzZQ0KKwkJZ2dfaHdfaW5qWzEyXSA9IDB4MDA3MjU3Nzc7DQorDQorCWlmICh2ZW5kb3JfaG9z
dC0+Z2djLmJoMjAxX2RyaXZlX3N0cmVuZ3RoKQ0KKwkJZ2dfaHdfaW5qWzE1XSA9IHZlbmRvcl9o
b3N0LT5nZ2MuYmgyMDFfZHJpdmVfc3RyZW5ndGg7DQorDQorCWJodF91cGRhdGVfY2ZnKG1tY19o
b3N0LCBjYXJkLCBnZ19od19pbmosIGRhdGFfbGVuKTsNCit9DQorDQorc3RhdGljIHZvaWQgYmh0
X2xvYWQoc3RydWN0IG1tY19ob3N0ICptbWNfaG9zdCwgc3RydWN0IG1tY19jYXJkICpjYXJkKQ0K
K3sNCisJc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QgPSBtbWNfcHJpdihtbWNfaG9zdCk7DQorCXN0
cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJ
c3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPQ0KKwkJCQkJCXNkaGNp
X3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorCXU4IGRyaXZlcl9zdHJlbmd0aF9yZWluaXRfZmxn
ID0NCisJCQkJdmVuZG9yX2hvc3QtPmdnYy5kcml2ZXJfc3RyZW5ndGhfcmVpbml0X2ZsZzsNCisJ
aW50IGN1cl9kbGxfdm9sdGFnZV9pZHggPSB2ZW5kb3JfaG9zdC0+Z2djLmN1cl9kbGxfdm9sdGFn
ZV9pZHg7DQorCXUzMiBpID0gMDsNCisJdTMyIHJlZzsNCisJdTMyIGdnX3N3X2RlZlsxNl0gPSBH
R0NfQ0ZHX0RBVEE7DQorCXU4IGRhdGFbNTEyXTsNCisJc3RhdGljIGNvbnN0IGludCBzX2RsbF92
b2x0YWdlX2NmZ1s0XVsyXSA9IHsNCisJCXsweDMwNTAzMTA2LCAweDY0MTQxNzExfSwNCisJCXsw
eDMxNTAzMTA2LCAweDY0MTQxNzExfSwNCisJCXsweDMwNTAzMTA2LCAweDY0MTQxNzUxfSwNCisJ
CXsweDMxNTAzMTA2LCAweDY0MTQxNzUxfSwNCisJfTsNCisNCisJaWYgKHZlbmRvcl9ob3N0LT5n
Z2MuYmgyMDFfdXNlZCkgew0KKwkJcHJfZGVidWcoIiVzOiBMb2FkIEJIVCBwYXRjaFxuIiwgbW1j
X2hvc3RuYW1lKG1tY19ob3N0KSk7DQorDQorCQltbWNfc2VuZF9yZWxhdGl2ZV9hZGRyKG1tY19o
b3N0LCAmY2FyZC0+cmNhKTsNCisJCW1tY19ob3N0LT5jYXJkID0gY2FyZDsNCisJCWlmICh2ZW5k
b3JfaG9zdC0+Z2djLmRsbF91bmxvY2tfcmVpbml0X2ZsZykgew0KKwkJCXByX2RlYnVnKCJkbGwg
dW5sb2NrIHJlaW5pdDogaWR4PSVkXG4iLA0KKwkJCQkJY3VyX2RsbF92b2x0YWdlX2lkeCk7DQor
CQkJZ2djX3R1bmluZ19yZXN1bHRfcmVzZXQoaG9zdCk7DQorCQkJZ2dfc3dfZGVmWzhdID0gc19k
bGxfdm9sdGFnZV9jZmdbY3VyX2RsbF92b2x0YWdlX2lkeF1bMF07DQorCQkJZ2dfc3dfZGVmWzld
ID0gc19kbGxfdm9sdGFnZV9jZmdbY3VyX2RsbF92b2x0YWdlX2lkeF1bMV07DQorCQl9DQorCQlp
ZiAodmVuZG9yX2hvc3QtPmdnYy5kcml2ZXJfc3RyZW5ndGhfcmVpbml0X2ZsZykgew0KKwkJCXBy
X2RlYnVnKCIlczogZHJpdmVyIHN0cmVuZ3RoIHNob3VsZCBiZSBpbml0IHRvICVkXG4iLA0KKwkJ
CQltbWNfaG9zdG5hbWUobW1jX2hvc3QpLCBkcml2ZXJfc3RyZW5ndGhfcmVpbml0X2ZsZyk7DQor
CQkJZ2djX3R1bmluZ19yZXN1bHRfcmVzZXQoaG9zdCk7DQorCQkJaWYgKHZlbmRvcl9ob3N0LT5n
Z2MuZHJpdmVyX3N0cmVuZ3RoX3JlaW5pdF9mbGcgPD0gNykgew0KKwkJCQlnZ19zd19kZWZbMTVd
ICY9IDB4MGYwZmZmZmY7DQorCQkJCWdnX3N3X2RlZlsxNV0gfD0gKGRyaXZlcl9zdHJlbmd0aF9y
ZWluaXRfZmxnIDw8IDI4KQ0KKwkJCQkJCXwgKGRyaXZlcl9zdHJlbmd0aF9yZWluaXRfZmxnIDw8
IDIwKTsNCisJCQl9DQorCQl9DQorCQlkcml2ZXJfc2VuZF9jb21tYW5kNyhob3N0KTsNCisJCWlm
ICh2ZW5kb3JfaG9zdC0+Z2djLnR1bmluZ19jbWQ3X3RpbWVvdXRfcmVpbml0X2ZsZyA9PSAwDQor
CQkJCQkmJiB2ZW5kb3JfaG9zdC0+Z2djLnNlbHhfdHVuaW5nX2RvbmVfZmxhZyA9PSAwKSB7DQor
CQkJYmh0X2xvYWRfaHdfaW5qZWN0KG1tY19ob3N0LCBjYXJkLCBnZ19zd19kZWYsDQorCQkJCXNp
emVvZihnZ19zd19kZWYpLCAweDNmZiwgMHg3N2YpOw0KKwkJCWJodF91cGRhdGVfY2ZnKG1tY19o
b3N0LCBjYXJkLCBnZ19zd19kZWYsIHNpemVvZihnZ19zd19kZWYpKTsNCisJCQlzZXRfZ2dfcmVn
X2N1cl92YWwoJnZlbmRvcl9ob3N0LT5nZ2MsICh1OCAqKWdnX3N3X2RlZiwgc2l6ZW9mKGdnX3N3
X2RlZikpOw0KKwkJfSBlbHNlIHsNCisJCQlpZiAodmVuZG9yX2hvc3QtPmdnYy5zZWx4X3R1bmlu
Z19kb25lX2ZsYWcpDQorCQkJCXByX2RlYnVnKCIlczogc2tpcCBsb2FkIGRlZmF1bHQgY29uZmln
dXJhdGlvbiBmb3IgdHVuaW5nIGRvbmVcbiIsDQorCQkJCQltbWNfaG9zdG5hbWUobW1jX2hvc3Qp
KTsNCisJCQlpZiAodmVuZG9yX2hvc3QtPmdnYy50dW5pbmdfY21kN190aW1lb3V0X3JlaW5pdF9m
bGcpIHsNCisJCQkJcHJfZGVidWcoIiVzOiB3cml0ZSBwcmV2aW91cyBpbmplY3QgcmVzdWx0cyB0
byBiaDIwMSBmb3IgY21kNyB0aW1lb3V0IGZsYWcgaXMgc2V0XG4iLA0KKwkJCQkJbW1jX2hvc3Ru
YW1lKG1tY19ob3N0KSk7DQorCQkJCWdldF9nZ19yZWdfY3VyX3ZhbCgmdmVuZG9yX2hvc3QtPmdn
YywgZGF0YSwgc2l6ZW9mKGdnX3N3X2RlZikpOw0KKw0KKwkJCQlwcl9kZWJ1ZygiJXM6IGR1bXAg
Y29uZmlnIGRhdGEgYmVmb3JlIHdyaXRlIHRvIGJoMjAxXG4iLCBfX2Z1bmNfXyk7DQorCQkJCWZv
ciAoaSA9IDA7IGkgPCAxMjg7IGkrKykgew0KKwkJCQkJbWVtY3B5KCZyZWcsIGRhdGEraSpzaXpl
b2YodTMyKSwgc2l6ZW9mKHUzMikpOw0KKwkJCQkJcHJfZGVidWcoImdnY19yZWczMlslMDNkXT0w
eCUwOHhcbiIsIGksIHJlZyk7DQorCQkJCX0NCisJCQkJYmh0X3VwZGF0ZV9jZmcobW1jX2hvc3Qs
IGNhcmQsICh1MzIgKilkYXRhLCBzaXplb2YoZGF0YSkpOw0KKwkJCX0NCisJCX0NCisJfQ0KK30N
CisNCitzdGF0aWMgdm9pZCBiaDIwMV9zaWduYWxfdm9sdGFnZV9vbl9vZmYoc3RydWN0IHNkaGNp
X2hvc3QgKmhvc3QsIHUzMiBvbl9vZmYpDQorew0KKwlpbnQgY2FyZF9wcmVzZW50X3N0YXR1cyA9
IDA7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdiho
b3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPSBzZGhj
aV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKw0KKwlpZiAodmVuZG9yX2hvc3QtPmdnYy5iaDIw
MV91c2VkKSB7DQorCQlpZiAoZ3Bpb19pc192YWxpZCh2ZW5kb3JfaG9zdC0+Z2djLmRldF9ncGlv
KSkgew0KKwkJCWNhcmRfcHJlc2VudF9zdGF0dXMgPSBncGlvX2dldF92YWx1ZSh2ZW5kb3JfaG9z
dC0+Z2djLmRldF9ncGlvKTsNCisJCQlwcl9kZWJ1ZygiJXM6IGRldGVjdF9ncGlvIHBpbiAlZCBz
dGF0dXMgaXMgJWRcbiIsDQorCQkJbW1jX2hvc3RuYW1lKGhvc3QtPm1tYyksIHZlbmRvcl9ob3N0
LT5nZ2MuZGV0X2dwaW8sIGNhcmRfcHJlc2VudF9zdGF0dXMpOw0KKwkJfSBlbHNlIHsNCisJCQlw
cl9lcnIoIiVzOiBubyBkZXRfZ3BpbyBwcm92aWRlZFxuIiwgbW1jX2hvc3RuYW1lKGhvc3QtPm1t
YykpOw0KKwkJfQ0KKw0KKwkJaWYgKG9uX29mZikgew0KKwkJCXByX2RlYnVnKCIlczogYXBwbHkg
Ymh0IHBvd2VyIG9uIHBhdGNoXG4iLCBtbWNfaG9zdG5hbWUoaG9zdC0+bW1jKSk7DQorDQorCQkJ
Z2djX2RsbF92b2x0YWdlX2luaXQoaG9zdCk7DQorDQorCQkJZ2djX2NoaXBfaW5pdChob3N0KTsN
CisNCisJCQlpZiAoZ3Bpb19pc192YWxpZCh2ZW5kb3JfaG9zdC0+Z2djLnB3cl9ncGlvKSkgew0K
KwkJCQlncGlvX2RpcmVjdGlvbl9vdXRwdXQodmVuZG9yX2hvc3QtPmdnYy5wd3JfZ3BpbywgMSk7
DQorCQkJCW1zbGVlcCgxMDApOw0KKwkJCQlwcl9kZWJ1ZygiJXM6IHB3cl9ncGlvIHBpbiAlZCBz
dGF0dXMgaXMgJWRcbiIsDQorCQkJCQltbWNfaG9zdG5hbWUoaG9zdC0+bW1jKSwgdmVuZG9yX2hv
c3QtPmdnYy5wd3JfZ3BpbywNCisJCQkJCWdwaW9fZ2V0X3ZhbHVlKHZlbmRvcl9ob3N0LT5nZ2Mu
cHdyX2dwaW8pKTsNCisJCQl9IGVsc2Ugew0KKwkJCQlwcl9lcnIoIiVzOiBubyBwd3JfZ3BpbyBw
cm92aWRlZFxuIiwgbW1jX2hvc3RuYW1lKGhvc3QtPm1tYykpOw0KKwkJCX0NCisJCX0gZWxzZSB7
DQorCQkJcHJfZGVidWcoIiVzOiBhcHBseSBiaHQgcG93ZXIgb2ZmIHBhdGNoXG4iLCBtbWNfaG9z
dG5hbWUoaG9zdC0+bW1jKSk7DQorDQorCQkJZ2djX2RsbF92b2x0YWdlX2luaXQoaG9zdCk7DQor
DQorCQkJaWYgKGNhcmRfcHJlc2VudF9zdGF0dXMgPD0gMCkgew0KKwkJCQlwcl9kZWJ1ZygiJXM6
IGNsZWFyIHR1bmluZyByZXN1bHQgZm9yIHBvd2VyIG9mZiBhbmQgY2FyZCByZW1vdmVkXG4iLA0K
KwkJCQkJbW1jX2hvc3RuYW1lKGhvc3QtPm1tYykpOw0KKwkJCQlnZ2NfdHVuaW5nX3Jlc3VsdF9y
ZXNldChob3N0KTsNCisJCQl9DQorCQkJZ2djX2NoaXBfaW5pdChob3N0KTsNCisNCisJCQlpZiAo
Z3Bpb19pc192YWxpZCh2ZW5kb3JfaG9zdC0+Z2djLnB3cl9ncGlvKSkgew0KKwkJCQlncGlvX2Rp
cmVjdGlvbl9vdXRwdXQodmVuZG9yX2hvc3QtPmdnYy5wd3JfZ3BpbywgMCk7DQorCQkJCXByX2Rl
YnVnKCIlczogcHdyX2dwaW8gcGluICVkIHN0YXR1cyBpcyAlZFxuIiwNCisJCQkJbW1jX2hvc3Ru
YW1lKGhvc3QtPm1tYyksIHZlbmRvcl9ob3N0LT5nZ2MucHdyX2dwaW8sDQorCQkJCWdwaW9fZ2V0
X3ZhbHVlKHZlbmRvcl9ob3N0LT5nZ2MucHdyX2dwaW8pKTsNCisJCQl9IGVsc2Ugew0KKwkJCQlw
cl9lcnIoIiVzOiBubyBwd3JfZ3BpbyBwcm92aWRlZFxuIiwgbW1jX2hvc3RuYW1lKGhvc3QtPm1t
YykpOw0KKwkJCX0NCisJCX0NCisJfQ0KK30NCisNCitzdGF0aWMgdm9pZCBzZGhjaV9iaDIwMV9w
YXJzZShzdHJ1Y3QgbW1jX2hvc3QgKm1tY19ob3N0KQ0KK3sNCisJc3RydWN0IHNkaGNpX2hvc3Qg
Kmhvc3QgPSBtbWNfcHJpdihtbWNfaG9zdCk7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpw
bHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJf
aG9zdCAqdmVuZG9yX2hvc3QgPSBzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKwlzdHJ1
Y3QgZGV2aWNlX25vZGUgKm5wID0gdmVuZG9yX2hvc3QtPnBkZXYtPmRldi5vZl9ub2RlOw0KKwlz
dHJ1Y3QgdF9nZ19yZWdfc3RydCBpbmRleF9hcnJheVtdID0gew0KKwkJeyAxNCwgMHhmZmZmZmZm
ZiwgMCB9LCB7IDQ2LCAweGZmZmZmZmZmLCAwIH0sDQorCQl7IDIwNSwgMHhmZmZmZmZmZiwgMCB9
LCB7IDIzNywgMHhmZmZmZmZmZiwgMCB9LA0KKwkJeyAxNDEsIDB4ZiwgMCB9LCB7IDE0NSwgMHhm
LCAwIH0sDQorCQl7IDgzLCAweGZmZiwgMCB9LCB7IDk1LCAweGZmZiwgMCB9LA0KKwkJeyAxMjYs
IDB4ZiwgMCB9LCB7IDEzMCwgMHhmLCAwIH0sDQorCQl7IDE0MCwgMHhmLCAwIH0sIHsgMTQ0LCAw
eGYsIDAgfSwNCisJCXsgMTgzLCAweDEsIDAgfSwgeyAxODQsIDB4MSwgMCB9LA0KKwkJeyAxNzEs
IDB4MSwgMCB9LCB7IDE3MiwgMHgxLCAwIH0sDQorCQl7IDE3MywgMHgzZiwgMCB9LCB7IDM1Nywg
MHgxLCAwIH0sDQorCQl7IDkzLCAweDdmZiwgMCB9LCB7IDgxLCAweDdmZiwgMCB9LA0KKwl9Ow0K
Kw0KKwltZW1jcHkoJnZlbmRvcl9ob3N0LT5nZ2MucGhhX3N0YXNfcnhfbG93MzIsICZpbmRleF9h
cnJheVswXSwNCisJCXNpemVvZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKwltZW1jcHkoJnZl
bmRvcl9ob3N0LT5nZ2MucGhhX3N0YXNfcnhfaGlnaDMyLCAmaW5kZXhfYXJyYXlbMV0sDQorCQlz
aXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZ2ZW5kb3JfaG9zdC0+Z2dj
LnBoYV9zdGFzX3R4X2xvdzMyLCAmaW5kZXhfYXJyYXlbMl0sDQorCQlzaXplb2Yoc3RydWN0IHRf
Z2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZ2ZW5kb3JfaG9zdC0+Z2djLnBoYV9zdGFzX3R4X2hp
Z2gzMiwgJmluZGV4X2FycmF5WzNdLA0KKwkJc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7
DQorCW1lbWNweSgmdmVuZG9yX2hvc3QtPmdnYy5kbGxfc2VsYV9hZnRlcl9tYXNrLCAmaW5kZXhf
YXJyYXlbNF0sDQorCQlzaXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZ2
ZW5kb3JfaG9zdC0+Z2djLmRsbF9zZWxiX2FmdGVyX21hc2ssICZpbmRleF9hcnJheVs1XSwNCisJ
CXNpemVvZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKw0KKwltZW1jcHkoJnZlbmRvcl9ob3N0
LT5nZ2MuZGxsX2RlbGF5XzEwMG1fYmFja3VwLCAmaW5kZXhfYXJyYXlbNl0sDQorCQlzaXplb2Yo
c3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZ2ZW5kb3JfaG9zdC0+Z2djLmRsbF9k
ZWxheV8yMDBtX2JhY2t1cCwgJmluZGV4X2FycmF5WzddLA0KKwkJc2l6ZW9mKHN0cnVjdCB0X2dn
X3JlZ19zdHJ0KSk7DQorDQorCW1lbWNweSgmdmVuZG9yX2hvc3QtPmdnYy5kbGxfc2VsYV8xMDBt
X2NmZywgJmluZGV4X2FycmF5WzhdLA0KKwkJc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7
DQorCW1lbWNweSgmdmVuZG9yX2hvc3QtPmdnYy5kbGxfc2VsYV8yMDBtX2NmZywgJmluZGV4X2Fy
cmF5WzldLA0KKwkJc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmdmVu
ZG9yX2hvc3QtPmdnYy5kbGxfc2VsYl8xMDBtX2NmZywgJmluZGV4X2FycmF5WzEwXSwNCisJCXNp
emVvZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKwltZW1jcHkoJnZlbmRvcl9ob3N0LT5nZ2Mu
ZGxsX3NlbGJfMjAwbV9jZmcsICZpbmRleF9hcnJheVsxMV0sDQorCQlzaXplb2Yoc3RydWN0IHRf
Z2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZ2ZW5kb3JfaG9zdC0+Z2djLmRsbF9zZWxiXzEwMG1f
Y2ZnX2VuLCAmaW5kZXhfYXJyYXlbMTJdLA0KKwkJc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0
KSk7DQorCW1lbWNweSgmdmVuZG9yX2hvc3QtPmdnYy5kbGxfc2VsYl8yMDBtX2NmZ19lbiwgJmlu
ZGV4X2FycmF5WzEzXSwNCisJCXNpemVvZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKwltZW1j
cHkoJnZlbmRvcl9ob3N0LT5nZ2MuaW50ZXJubF90dW5pbmdfZW5fMTAwbSwgJmluZGV4X2FycmF5
WzE0XSwNCisJCXNpemVvZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKwltZW1jcHkoJnZlbmRv
cl9ob3N0LT5nZ2MuaW50ZXJubF90dW5pbmdfZW5fMjAwbSwgJmluZGV4X2FycmF5WzE1XSwNCisJ
CXNpemVvZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKwltZW1jcHkoJnZlbmRvcl9ob3N0LT5n
Z2MuY21kMTlfY250X2NmZywgJmluZGV4X2FycmF5WzE2XSwNCisJCXNpemVvZihzdHJ1Y3QgdF9n
Z19yZWdfc3RydCkpOw0KKw0KKwltZW1jcHkoJnZlbmRvcl9ob3N0LT5nZ2MuaW5qZWN0X2ZhaWx1
cmVfZm9yX3R1bmluZ19lbmFibGVfY2ZnLA0KKwkmaW5kZXhfYXJyYXlbMTddLCBzaXplb2Yoc3Ry
dWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZ2ZW5kb3JfaG9zdC0+Z2djLmluamVjdF9m
YWlsdXJlX2Zvcl8yMDBtX3R1bmluZ19jZmcsDQorCSZpbmRleF9hcnJheVsxOF0sIHNpemVvZihz
dHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKwltZW1jcHkoJnZlbmRvcl9ob3N0LT5nZ2MuaW5qZWN0
X2ZhaWx1cmVfZm9yXzEwMG1fdHVuaW5nX2NmZywNCisJJmluZGV4X2FycmF5WzE5XSwgc2l6ZW9m
KHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorDQorCXZlbmRvcl9ob3N0LT5nZ2MuYmgyMDFfZHJp
dmVfc3RyZW5ndGggPSAwOw0KKwl2ZW5kb3JfaG9zdC0+Z2djLmJoMjAxX3NkcjUwX3NlbGFfc3df
aW5qZWN0ID0gMDsNCisJdmVuZG9yX2hvc3QtPmdnYy5iaDIwMV9zZHI1MF9zZWxiX2h3X2luamVj
dCA9IDA7DQorCXZlbmRvcl9ob3N0LT5nZ2MuYmgyMDFfc2RyMTA0X3NlbGJfaHdfaW5qZWN0ID0g
MDsNCisJdmVuZG9yX2hvc3QtPmdnYy5iaDIwMV91c2VkID0gMTsNCisJaG9zdC0+ZmxhZ3MgfD0g
U0RIQ0lfU0RSNTBfTkVFRFNfVFVOSU5HOw0KKwlob3N0LT5tbWNfaG9zdF9vcHMuaW5pdF9jYXJk
ID0gYmh0X2xvYWQ7DQorDQorCWlmIChvZl9maW5kX3Byb3BlcnR5KG5wLCAiYmgyMDFfZHJpdmVf
c3RyZW5ndGgiLCBOVUxMKSkNCisJCW9mX3Byb3BlcnR5X3JlYWRfdTMyX2luZGV4KG5wLCAiYmgy
MDFfZHJpdmVfc3RyZW5ndGgiLCAwLA0KKwkJCSZ2ZW5kb3JfaG9zdC0+Z2djLmJoMjAxX2RyaXZl
X3N0cmVuZ3RoKTsNCisJaWYgKG9mX2ZpbmRfcHJvcGVydHkobnAsICJiaDIwMV9zZHI1MF9zZWxh
X3N3X2luamVjdCIsIE5VTEwpKQ0KKwkJb2ZfcHJvcGVydHlfcmVhZF91MzJfaW5kZXgobnAsICJi
aDIwMV9zZHI1MF9zZWxhX3N3X2luamVjdCIsIDAsDQorCQkJJnZlbmRvcl9ob3N0LT5nZ2MuYmgy
MDFfc2RyNTBfc2VsYV9zd19pbmplY3QpOw0KKwlpZiAob2ZfZmluZF9wcm9wZXJ0eShucCwgImJo
MjAxX3NkcjUwX3NlbGJfaHdfaW5qZWN0IiwgTlVMTCkpDQorCQlvZl9wcm9wZXJ0eV9yZWFkX3Uz
Ml9pbmRleChucCwgImJoMjAxX3NkcjUwX3NlbGJfaHdfaW5qZWN0IiwgMCwNCisJCQkmdmVuZG9y
X2hvc3QtPmdnYy5iaDIwMV9zZHI1MF9zZWxiX2h3X2luamVjdCk7DQorCWlmIChvZl9maW5kX3By
b3BlcnR5KG5wLCAiYmgyMDFfc2RyMTA0X3NlbGJfaHdfaW5qZWN0IiwgTlVMTCkpDQorCQlvZl9w
cm9wZXJ0eV9yZWFkX3UzMl9pbmRleChucCwgImJoMjAxX3NkcjEwNF9zZWxiX2h3X2luamVjdCIs
IDAsDQorCQkJJnZlbmRvcl9ob3N0LT5nZ2MuYmgyMDFfc2RyMTA0X3NlbGJfaHdfaW5qZWN0KTsN
CisNCisJdmVuZG9yX2hvc3QtPmdnYy5wd3JfZ3BpbyA9IG9mX2dldF9uYW1lZF9ncGlvKG5wLCAi
cHdyLWdwaW9zIiwgMCk7DQorCWlmICghZ3Bpb19pc192YWxpZCh2ZW5kb3JfaG9zdC0+Z2djLnB3
cl9ncGlvKSkNCisJCWRldl9lcnIoJnZlbmRvcl9ob3N0LT5wZGV2LT5kZXYsICJubyBwd3ItZ3Bp
byBwcm92aWRlZCAhXG4iKTsNCisJZWxzZQ0KKwkJZGV2X2luZm8oJnZlbmRvcl9ob3N0LT5wZGV2
LT5kZXYsICJwd3ItZ3BpbyBwcm92aWRlZFxuIik7DQorDQorCXZlbmRvcl9ob3N0LT5nZ2MuZGV0
X2dwaW8gPSBvZl9nZXRfbmFtZWRfZ3BpbyhucCwgImRldC1ncGlvcyIsIDApOw0KKwlpZiAoIWdw
aW9faXNfdmFsaWQodmVuZG9yX2hvc3QtPmdnYy5kZXRfZ3BpbykpDQorCQlkZXZfZXJyKCZ2ZW5k
b3JfaG9zdC0+cGRldi0+ZGV2LCAibm8gZGV0LWdwaW8gcHJvdmlkZWQgIVxuIik7DQorCWVsc2UN
CisJCWRldl9pbmZvKCZ2ZW5kb3JfaG9zdC0+cGRldi0+ZGV2LCAiZGV0LWdwaW8gcHJvdmlkZWRc
biIpOw0KKw0KKwlpZiAoZ3Bpb19pc192YWxpZCh2ZW5kb3JfaG9zdC0+Z2djLnB3cl9ncGlvKSkg
ew0KKwkJZGV2bV9ncGlvX3JlcXVlc3Rfb25lKCZ2ZW5kb3JfaG9zdC0+cGRldi0+ZGV2LCB2ZW5k
b3JfaG9zdC0+Z2djLnB3cl9ncGlvLA0KKwkJCUdQSU9GX09VVF9JTklUX0xPVywgInNwcmQtMS1w
d3IiKTsNCisJCXByX2RlYnVnKCIlczogZGV0ZWN0X2dwaW8gcGluICVkXG4iLA0KKwkJCW1tY19o
b3N0bmFtZShob3N0LT5tbWMpLCB2ZW5kb3JfaG9zdC0+Z2djLnB3cl9ncGlvKTsNCisJfSBlbHNl
IHsNCisJCXByX2VycigiJXM6IG5vIGRldGVjdF9ncGlvIHByb3ZpZGVkXG4iLA0KKwkJCW1tY19o
b3N0bmFtZShob3N0LT5tbWMpKTsNCisJfQ0KKw0KKwlpZiAoZ3Bpb19pc192YWxpZCh2ZW5kb3Jf
aG9zdC0+Z2djLmRldF9ncGlvKSkgew0KKwkJZGV2bV9ncGlvX3JlcXVlc3Rfb25lKCZ2ZW5kb3Jf
aG9zdC0+cGRldi0+ZGV2LCB2ZW5kb3JfaG9zdC0+Z2djLmRldF9ncGlvLA0KKwkJR1BJT0ZfRElS
X0lOLCAic3ByZC0xLWRldCIpOw0KKwkJcHJfZGVidWcoIiVzOiBkZXRlY3RfZ3BpbyBwaW4gJWRc
biIsDQorCQkJbW1jX2hvc3RuYW1lKGhvc3QtPm1tYyksIHZlbmRvcl9ob3N0LT5nZ2MuZGV0X2dw
aW8pOw0KKwl9IGVsc2Ugew0KKwkJcHJfZXJyKCIlczogbm8gZGV0ZWN0X2dwaW8gcHJvdmlkZWRc
biIsDQorCQkJbW1jX2hvc3RuYW1lKGhvc3QtPm1tYykpOw0KKwl9DQorfQ0KKw0KK3N0YXRpYyBp
bnQgc2Rfc2VsZWN0X2RyaXZlcl90eXBlKHN0cnVjdCBtbWNfY2FyZCAqY2FyZCwgdTggKnN0YXR1
cykNCit7DQorCWludCBjYXJkX2Rydl90eXBlLCBkcml2ZV9zdHJlbmd0aCwgZHJ2X3R5cGU7DQor
CWludCBlcnI7DQorDQorCWNhcmQtPmRyaXZlX3N0cmVuZ3RoID0gMDsNCisNCisJY2FyZF9kcnZf
dHlwZSA9IGNhcmQtPnN3X2NhcHMuc2QzX2Rydl90eXBlIHwgU0RfRFJJVkVSX1RZUEVfQjsNCisN
CisJZHJpdmVfc3RyZW5ndGggPSBtbWNfc2VsZWN0X2RyaXZlX3N0cmVuZ3RoKGNhcmQsDQorCQkJ
CQkJICAgY2FyZC0+c3dfY2Fwcy51aHNfbWF4X2R0ciwNCisJCQkJCQkgICBjYXJkX2Rydl90eXBl
LCAmZHJ2X3R5cGUpOw0KKw0KKwlpZiAoZHJpdmVfc3RyZW5ndGgpIHsNCisJCWVyciA9IG1tY19z
ZF9zd2l0Y2goY2FyZCwgMSwgMiwgZHJpdmVfc3RyZW5ndGgsIHN0YXR1cyk7DQorCQlpZiAoZXJy
KQ0KKwkJCXJldHVybiBlcnI7DQorCQlpZiAoKHN0YXR1c1sxNV0gJiAweEYpICE9IGRyaXZlX3N0
cmVuZ3RoKSB7DQorCQkJcHJfd2FybigiJXM6IFByb2JsZW0gc2V0dGluZyBkcml2ZSBzdHJlbmd0
aCFcbiIsDQorCQkJCW1tY19ob3N0bmFtZShjYXJkLT5ob3N0KSk7DQorCQkJcmV0dXJuIDA7DQor
CQl9DQorCQljYXJkLT5kcml2ZV9zdHJlbmd0aCA9IGRyaXZlX3N0cmVuZ3RoOw0KKwl9DQorDQor
CWlmIChkcnZfdHlwZSkNCisJCW1tY19zZXRfZHJpdmVyX3R5cGUoY2FyZC0+aG9zdCwgZHJ2X3R5
cGUpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorLyogR2V0IGhvc3QncyBtYXggY3VycmVudCBz
ZXR0aW5nIGF0IGl0cyBjdXJyZW50IHZvbHRhZ2UgKi8NCitzdGF0aWMgdTMyIHNkX2dldF9ob3N0
X21heF9jdXJyZW50KHN0cnVjdCBtbWNfaG9zdCAqaG9zdCkNCit7DQorCXUzMiB2b2x0YWdlLCBt
YXhfY3VycmVudDsNCisNCisJdm9sdGFnZSA9IDEgPDwgaG9zdC0+aW9zLnZkZDsNCisJc3dpdGNo
ICh2b2x0YWdlKSB7DQorCWNhc2UgTU1DX1ZERF8xNjVfMTk1Og0KKwkJbWF4X2N1cnJlbnQgPSBo
b3N0LT5tYXhfY3VycmVudF8xODA7DQorCQlicmVhazsNCisJY2FzZSBNTUNfVkREXzI5XzMwOg0K
KwljYXNlIE1NQ19WRERfMzBfMzE6DQorCQltYXhfY3VycmVudCA9IGhvc3QtPm1heF9jdXJyZW50
XzMwMDsNCisJCWJyZWFrOw0KKwljYXNlIE1NQ19WRERfMzJfMzM6DQorCWNhc2UgTU1DX1ZERF8z
M18zNDoNCisJCW1heF9jdXJyZW50ID0gaG9zdC0+bWF4X2N1cnJlbnRfMzMwOw0KKwkJYnJlYWs7
DQorCWRlZmF1bHQ6DQorCQltYXhfY3VycmVudCA9IDA7DQorCX0NCisNCisJcmV0dXJuIG1heF9j
dXJyZW50Ow0KK30NCisNCitzdGF0aWMgaW50IHNkX3NldF9jdXJyZW50X2xpbWl0KHN0cnVjdCBt
bWNfY2FyZCAqY2FyZCwgdTggKnN0YXR1cykNCit7DQorCWludCBjdXJyZW50X2xpbWl0ID0gU0Rf
U0VUX0NVUlJFTlRfTk9fQ0hBTkdFOw0KKwlpbnQgZXJyOw0KKwl1MzIgbWF4X2N1cnJlbnQ7DQor
DQorCS8qDQorCSAqIEN1cnJlbnQgbGltaXQgc3dpdGNoIGlzIG9ubHkgZGVmaW5lZCBmb3IgU0RS
NTAsIFNEUjEwNCwgYW5kIEREUjUwDQorCSAqIGJ1cyBzcGVlZCBtb2Rlcy4gRm9yIG90aGVyIGJ1
cyBzcGVlZCBtb2Rlcywgd2UgZG8gbm90IGNoYW5nZSB0aGUNCisJICogY3VycmVudCBsaW1pdC4N
CisJICovDQorCWlmICgoY2FyZC0+c2RfYnVzX3NwZWVkICE9IFVIU19TRFI1MF9CVVNfU1BFRUQp
ICYmDQorCSAgICAoY2FyZC0+c2RfYnVzX3NwZWVkICE9IFVIU19TRFIxMDRfQlVTX1NQRUVEKSAm
Jg0KKwkgICAgKGNhcmQtPnNkX2J1c19zcGVlZCAhPSBVSFNfRERSNTBfQlVTX1NQRUVEKSkNCisJ
CXJldHVybiAwOw0KKw0KKwkvKg0KKwkgKiBIb3N0IGhhcyBkaWZmZXJlbnQgY3VycmVudCBjYXBh
YmlsaXRpZXMgd2hlbiBvcGVyYXRpbmcgYXQNCisJICogZGlmZmVyZW50IHZvbHRhZ2VzLCBzbyBm
aW5kIG91dCBpdHMgbWF4IGN1cnJlbnQgZmlyc3QuDQorCSAqLw0KKwltYXhfY3VycmVudCA9IHNk
X2dldF9ob3N0X21heF9jdXJyZW50KGNhcmQtPmhvc3QpOw0KKw0KKwkvKg0KKwkgKiBXZSBvbmx5
IGNoZWNrIGhvc3QncyBjYXBhYmlsaXR5IGhlcmUsIGlmIHdlIHNldCBhIGxpbWl0IHRoYXQgaXMN
CisJICogaGlnaGVyIHRoYW4gdGhlIGNhcmQncyBtYXhpbXVtIGN1cnJlbnQsIHRoZSBjYXJkIHdp
bGwgYmUgdXNpbmcgaXRzDQorCSAqIG1heGltdW0gY3VycmVudCwgZS5nLiBpZiB0aGUgY2FyZCdz
IG1heGltdW0gY3VycmVudCBpcyAzMDBtYSwgYW5kDQorCSAqIHdoZW4gd2Ugc2V0IGN1cnJlbnQg
bGltaXQgdG8gMjAwbWEsIHRoZSBjYXJkIHdpbGwgZHJhdyAyMDBtYSwgYW5kDQorCSAqIHdoZW4g
d2Ugc2V0IGN1cnJlbnQgbGltaXQgdG8gNDAwLzYwMC84MDBtYSwgdGhlIGNhcmQgd2lsbCBkcmF3
IGl0cw0KKwkgKiBtYXhpbXVtIDMwMG1hIGZyb20gdGhlIGhvc3QuDQorCSAqDQorCSAqIFRoZSBh
Ym92ZSBpcyBpbmNvcnJlY3Q6IGlmIHdlIHRyeSB0byBzZXQgYSBjdXJyZW50IGxpbWl0IHRoYXQg
aXMNCisJICogbm90IHN1cHBvcnRlZCBieSB0aGUgY2FyZCwgdGhlIGNhcmQgY2FuIHJpZ2h0ZnVs
bHkgZXJyb3Igb3V0IHRoZQ0KKwkgKiBhdHRlbXB0LCBhbmQgcmVtYWluIGF0IHRoZSBkZWZhdWx0
IGN1cnJlbnQgbGltaXQuICBUaGlzIHJlc3VsdHMNCisJICogaW4gYSAzMDBtQSBjYXJkIGJlaW5n
IGxpbWl0ZWQgdG8gMjAwbUEgZXZlbiB0aG91Z2ggdGhlIGhvc3QNCisJICogc3VwcG9ydHMgODAw
bUEuIEZhaWx1cmVzIHNlZW4gd2l0aCBTYW5EaXNrIDhHQiBVSFMgY2FyZHMgd2l0aA0KKwkgKiBh
biBpTVg2IGhvc3QuIC0tcm1rDQorCSAqLw0KKwlpZiAobWF4X2N1cnJlbnQgPj0gODAwICYmDQor
CSAgICBjYXJkLT5zd19jYXBzLnNkM19jdXJyX2xpbWl0ICYgU0RfTUFYX0NVUlJFTlRfODAwKQ0K
KwkJY3VycmVudF9saW1pdCA9IFNEX1NFVF9DVVJSRU5UX0xJTUlUXzgwMDsNCisJZWxzZSBpZiAo
bWF4X2N1cnJlbnQgPj0gNjAwICYmDQorCQkgY2FyZC0+c3dfY2Fwcy5zZDNfY3Vycl9saW1pdCAm
IFNEX01BWF9DVVJSRU5UXzYwMCkNCisJCWN1cnJlbnRfbGltaXQgPSBTRF9TRVRfQ1VSUkVOVF9M
SU1JVF82MDA7DQorCWVsc2UgaWYgKG1heF9jdXJyZW50ID49IDQwMCAmJg0KKwkJIGNhcmQtPnN3
X2NhcHMuc2QzX2N1cnJfbGltaXQgJiBTRF9NQVhfQ1VSUkVOVF80MDApDQorCQljdXJyZW50X2xp
bWl0ID0gU0RfU0VUX0NVUlJFTlRfTElNSVRfNDAwOw0KKwllbHNlIGlmIChtYXhfY3VycmVudCA+
PSAyMDAgJiYNCisJCSBjYXJkLT5zd19jYXBzLnNkM19jdXJyX2xpbWl0ICYgU0RfTUFYX0NVUlJF
TlRfMjAwKQ0KKwkJY3VycmVudF9saW1pdCA9IFNEX1NFVF9DVVJSRU5UX0xJTUlUXzIwMDsNCisN
CisJaWYgKGN1cnJlbnRfbGltaXQgIT0gU0RfU0VUX0NVUlJFTlRfTk9fQ0hBTkdFKSB7DQorCQll
cnIgPSBtbWNfc2Rfc3dpdGNoKGNhcmQsIDEsIDMsIGN1cnJlbnRfbGltaXQsIHN0YXR1cyk7DQor
CQlpZiAoZXJyKQ0KKwkJCXJldHVybiBlcnI7DQorDQorCQlpZiAoKChzdGF0dXNbMTVdID4+IDQp
ICYgMHgwRikgIT0gY3VycmVudF9saW1pdCkNCisJCQlwcl93YXJuKCIlczogUHJvYmxlbSBzZXR0
aW5nIGN1cnJlbnQgbGltaXQhXG4iLA0KKwkJCQltbWNfaG9zdG5hbWUoY2FyZC0+aG9zdCkpOw0K
Kw0KKwl9DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgaW50IHNkX3NldF9idXNfc3Bl
ZWRfbW9kZShzdHJ1Y3QgbW1jX2NhcmQgKmNhcmQsIHU4ICpzdGF0dXMpDQorew0KKwlpbnQgZXJy
Ow0KKwl1bnNpZ25lZCBpbnQgdGltaW5nID0gMDsNCisNCisJc3dpdGNoIChjYXJkLT5zZF9idXNf
c3BlZWQpIHsNCisJY2FzZSBVSFNfU0RSMTA0X0JVU19TUEVFRDoNCisJCXRpbWluZyA9IE1NQ19U
SU1JTkdfVUhTX1NEUjEwNDsNCisJCWNhcmQtPnN3X2NhcHMudWhzX21heF9kdHIgPSBVSFNfU0RS
MTA0X01BWF9EVFI7DQorCQlicmVhazsNCisJY2FzZSBVSFNfRERSNTBfQlVTX1NQRUVEOg0KKwkJ
dGltaW5nID0gTU1DX1RJTUlOR19VSFNfRERSNTA7DQorCQljYXJkLT5zd19jYXBzLnVoc19tYXhf
ZHRyID0gVUhTX0REUjUwX01BWF9EVFI7DQorCQlicmVhazsNCisJY2FzZSBVSFNfU0RSNTBfQlVT
X1NQRUVEOg0KKwkJdGltaW5nID0gTU1DX1RJTUlOR19VSFNfU0RSNTA7DQorCQljYXJkLT5zd19j
YXBzLnVoc19tYXhfZHRyID0gVUhTX1NEUjUwX01BWF9EVFI7DQorCQlicmVhazsNCisJY2FzZSBV
SFNfU0RSMjVfQlVTX1NQRUVEOg0KKwkJdGltaW5nID0gTU1DX1RJTUlOR19VSFNfU0RSMjU7DQor
CQljYXJkLT5zd19jYXBzLnVoc19tYXhfZHRyID0gVUhTX1NEUjI1X01BWF9EVFI7DQorCQlicmVh
azsNCisJY2FzZSBVSFNfU0RSMTJfQlVTX1NQRUVEOg0KKwkJdGltaW5nID0gTU1DX1RJTUlOR19V
SFNfU0RSMTI7DQorCQljYXJkLT5zd19jYXBzLnVoc19tYXhfZHRyID0gVUhTX1NEUjEyX01BWF9E
VFI7DQorCQlicmVhazsNCisJZGVmYXVsdDoNCisJCXJldHVybiAwOw0KKwl9DQorDQorCWVyciA9
IG1tY19zZF9zd2l0Y2goY2FyZCwgMSwgMCwgY2FyZC0+c2RfYnVzX3NwZWVkLCBzdGF0dXMpOw0K
KwlpZiAoZXJyKQ0KKwkJcmV0dXJuIGVycjsNCisNCisJaWYgKChzdGF0dXNbMTZdICYgMHhGKSAh
PSBjYXJkLT5zZF9idXNfc3BlZWQpDQorCQlwcl93YXJuKCIlczogUHJvYmxlbSBzZXR0aW5nIGJ1
cyBzcGVlZCBtb2RlIVxuIiwNCisJCQltbWNfaG9zdG5hbWUoY2FyZC0+aG9zdCkpOw0KKwllbHNl
IHsNCisJCW1tY19zZXRfdGltaW5nKGNhcmQtPmhvc3QsIHRpbWluZyk7DQorCQltbWNfc2V0X2Ns
b2NrKGNhcmQtPmhvc3QsIGNhcmQtPnN3X2NhcHMudWhzX21heF9kdHIpOw0KKwl9DQorDQorCXJl
dHVybiAwOw0KK30NCisNCitzdGF0aWMgdm9pZCBzZF91cGRhdGVfYnVzX3NwZWVkX21vZGUoc3Ry
dWN0IG1tY19jYXJkICpjYXJkKQ0KK3sNCisJLyoNCisJICogSWYgdGhlIGhvc3QgZG9lc24ndCBz
dXBwb3J0IGFueSBvZiB0aGUgVUhTLUkgbW9kZXMsIGZhbGxiYWNrIG9uDQorCSAqIGRlZmF1bHQg
c3BlZWQuDQorCSAqLw0KKwlpZiAoIW1tY19ob3N0X3VocyhjYXJkLT5ob3N0KSkgew0KKwkJY2Fy
ZC0+c2RfYnVzX3NwZWVkID0gMDsNCisJCXJldHVybjsNCisJfQ0KKw0KKwlpZiAoKGNhcmQtPmhv
c3QtPmNhcHMgJiBNTUNfQ0FQX1VIU19TRFIxMDQpICYmDQorCQkoY2FyZC0+c3dfY2Fwcy5zZDNf
YnVzX21vZGUgJiBTRF9NT0RFX1VIU19TRFIxMDQpKSB7DQorCQljYXJkLT5zZF9idXNfc3BlZWQg
PSBVSFNfU0RSMTA0X0JVU19TUEVFRDsNCisJfSBlbHNlIGlmICgoY2FyZC0+aG9zdC0+Y2FwcyAm
IE1NQ19DQVBfVUhTX0REUjUwKSAmJg0KKwkJKGNhcmQtPnN3X2NhcHMuc2QzX2J1c19tb2RlICYg
U0RfTU9ERV9VSFNfRERSNTApKSB7DQorCQljYXJkLT5zZF9idXNfc3BlZWQgPSBVSFNfRERSNTBf
QlVTX1NQRUVEOw0KKwl9IGVsc2UgaWYgKChjYXJkLT5ob3N0LT5jYXBzICYgKE1NQ19DQVBfVUhT
X1NEUjEwNCB8DQorCQlNTUNfQ0FQX1VIU19TRFI1MCkpICYmIChjYXJkLT5zd19jYXBzLnNkM19i
dXNfbW9kZSAmDQorCQlTRF9NT0RFX1VIU19TRFI1MCkpIHsNCisJCWNhcmQtPnNkX2J1c19zcGVl
ZCA9IFVIU19TRFI1MF9CVVNfU1BFRUQ7DQorCX0gZWxzZSBpZiAoKGNhcmQtPmhvc3QtPmNhcHMg
JiAoTU1DX0NBUF9VSFNfU0RSMTA0IHwNCisJCU1NQ19DQVBfVUhTX1NEUjUwIHwgTU1DX0NBUF9V
SFNfU0RSMjUpKSAmJg0KKwkJKGNhcmQtPnN3X2NhcHMuc2QzX2J1c19tb2RlICYgU0RfTU9ERV9V
SFNfU0RSMjUpKSB7DQorCQljYXJkLT5zZF9idXNfc3BlZWQgPSBVSFNfU0RSMjVfQlVTX1NQRUVE
Ow0KKwl9IGVsc2UgaWYgKChjYXJkLT5ob3N0LT5jYXBzICYgKE1NQ19DQVBfVUhTX1NEUjEwNCB8
DQorCQlNTUNfQ0FQX1VIU19TRFI1MCB8IE1NQ19DQVBfVUhTX1NEUjI1IHwNCisJCU1NQ19DQVBf
VUhTX1NEUjEyKSkgJiYgKGNhcmQtPnN3X2NhcHMuc2QzX2J1c19tb2RlICYNCisJCVNEX01PREVf
VUhTX1NEUjEyKSkgew0KKwkJY2FyZC0+c2RfYnVzX3NwZWVkID0gVUhTX1NEUjEyX0JVU19TUEVF
RDsNCisJfQ0KK30NCisNCitzdGF0aWMgaW50IG1tY193YWl0X2Zvcl9hcHBfY21kKHN0cnVjdCBt
bWNfaG9zdCAqaG9zdCwgc3RydWN0IG1tY19jYXJkICpjYXJkLA0KKwkJCQlzdHJ1Y3QgbW1jX2Nv
bW1hbmQgKmNtZCkNCit7DQorCXN0cnVjdCBtbWNfcmVxdWVzdCBtcnEgPSB7fTsNCisJaW50IGks
IGVyciA9IC1FSU87DQorDQorCS8qDQorCSAqIFdlIGhhdmUgdG8gcmVzZW5kIE1NQ19BUFBfQ01E
IGZvciBlYWNoIGF0dGVtcHQgc28NCisJICogd2UgY2Fubm90IHVzZSB0aGUgcmV0cmllcyBmaWVs
ZCBpbiBtbWNfY29tbWFuZC4NCisJICovDQorCWZvciAoaSA9IDA7IGkgPD0gTU1DX0NNRF9SRVRS
SUVTOyBpKyspIHsNCisJCWVyciA9IG1tY19hcHBfY21kKGhvc3QsIGNhcmQpOw0KKwkJaWYgKGVy
cikgew0KKwkJCS8qIG5vIHBvaW50IGluIHJldHJ5aW5nOyBubyBBUFAgY29tbWFuZHMgYWxsb3dl
ZCAqLw0KKwkJCWlmIChtbWNfaG9zdF9pc19zcGkoaG9zdCkpIHsNCisJCQkJaWYgKGNtZC0+cmVz
cFswXSAmIFIxX1NQSV9JTExFR0FMX0NPTU1BTkQpDQorCQkJCQlicmVhazsNCisJCQl9DQorCQkJ
Y29udGludWU7DQorCQl9DQorDQorCQltZW1zZXQoJm1ycSwgMCwgc2l6ZW9mKHN0cnVjdCBtbWNf
cmVxdWVzdCkpOw0KKw0KKwkJbWVtc2V0KGNtZC0+cmVzcCwgMCwgc2l6ZW9mKGNtZC0+cmVzcCkp
Ow0KKwkJY21kLT5yZXRyaWVzID0gMDsNCisNCisJCW1ycS5jbWQgPSBjbWQ7DQorCQljbWQtPmRh
dGEgPSBOVUxMOw0KKw0KKwkJbW1jX3dhaXRfZm9yX3JlcShob3N0LCAmbXJxKTsNCisNCisJCWVy
ciA9IGNtZC0+ZXJyb3I7DQorCQlpZiAoIWNtZC0+ZXJyb3IpDQorCQkJYnJlYWs7DQorDQorCQkv
KiBubyBwb2ludCBpbiByZXRyeWluZyBpbGxlZ2FsIEFQUCBjb21tYW5kcyAqLw0KKwkJaWYgKG1t
Y19ob3N0X2lzX3NwaShob3N0KSkgew0KKwkJCWlmIChjbWQtPnJlc3BbMF0gJiBSMV9TUElfSUxM
RUdBTF9DT01NQU5EKQ0KKwkJCQlicmVhazsNCisJCX0NCisJfQ0KKw0KKwlyZXR1cm4gZXJyOw0K
K30NCisNCitzdGF0aWMgaW50IG1tY19hcHBfc2V0X2Nscl9jYXJkX2RldGVjdChzdHJ1Y3QgbW1j
X2NhcmQgKmNhcmQpDQorew0KKwlzdHJ1Y3QgbW1jX2NvbW1hbmQgY21kID0ge307DQorDQorCWNt
ZC5vcGNvZGUgPSA0MjsNCisJY21kLmZsYWdzID0gTU1DX1JTUF9SMSB8IE1NQ19DTURfQUM7DQor
DQorCXJldHVybiBtbWNfd2FpdF9mb3JfYXBwX2NtZChjYXJkLT5ob3N0LCBjYXJkLCAmY21kKTsN
Cit9DQorDQorLyoNCisgKiBVSFMtSSBzcGVjaWZpYyBpbml0aWFsaXphdGlvbiBwcm9jZWR1cmUN
CisgKi8NCitzdGF0aWMgaW50IHNkX2luaXRfdWhzX2NhcmQoc3RydWN0IG1tY19jYXJkICpjYXJk
KQ0KK3sNCisJaW50IGVycjsNCisJdTggKnN0YXR1czsNCisNCisJaWYgKCEoY2FyZC0+Y3NkLmNt
ZGNsYXNzICYgQ0NDX1NXSVRDSCkpDQorCQlyZXR1cm4gMDsNCisNCisJc3RhdHVzID0ga21hbGxv
Yyg2NCwgR0ZQX0tFUk5FTCk7DQorCWlmICghc3RhdHVzKQ0KKwkJcmV0dXJuIC1FTk9NRU07DQor
DQorCS8qIFNldCA0LWJpdCBidXMgd2lkdGggKi8NCisJZXJyID0gbW1jX2FwcF9zZXRfYnVzX3dp
ZHRoKGNhcmQsIE1NQ19CVVNfV0lEVEhfNCk7DQorCWlmIChlcnIpDQorCQlnb3RvIG91dDsNCisN
CisJbW1jX3NldF9idXNfd2lkdGgoY2FyZC0+aG9zdCwgTU1DX0JVU19XSURUSF80KTsNCisNCisJ
LyoNCisJICogU2VsZWN0IHRoZSBidXMgc3BlZWQgbW9kZSBkZXBlbmRpbmcgb24gaG9zdA0KKwkg
KiBhbmQgY2FyZCBjYXBhYmlsaXR5Lg0KKwkgKi8NCisJc2RfdXBkYXRlX2J1c19zcGVlZF9tb2Rl
KGNhcmQpOw0KKw0KKwltbWNfYXBwX3NldF9jbHJfY2FyZF9kZXRlY3QoY2FyZCk7DQorDQorCS8q
IFNldCB0aGUgZHJpdmVyIHN0cmVuZ3RoIGZvciB0aGUgY2FyZCAqLw0KKwllcnIgPSBzZF9zZWxl
Y3RfZHJpdmVyX3R5cGUoY2FyZCwgc3RhdHVzKTsNCisJaWYgKGVycikNCisJCWdvdG8gb3V0Ow0K
Kw0KKwkvKiBTZXQgY3VycmVudCBsaW1pdCBmb3IgdGhlIGNhcmQgKi8NCisJZXJyID0gc2Rfc2V0
X2N1cnJlbnRfbGltaXQoY2FyZCwgc3RhdHVzKTsNCisJaWYgKGVycikNCisJCWdvdG8gb3V0Ow0K
Kw0KKwkvKiBTZXQgYnVzIHNwZWVkIG1vZGUgb2YgdGhlIGNhcmQgKi8NCisJZXJyID0gc2Rfc2V0
X2J1c19zcGVlZF9tb2RlKGNhcmQsIHN0YXR1cyk7DQorCWlmIChlcnIpDQorCQlnb3RvIG91dDsN
CisNCisJLyoNCisJICogU1BJIG1vZGUgZG9lc24ndCBkZWZpbmUgQ01EMTkgYW5kIHR1bmluZyBp
cyBvbmx5IHZhbGlkIGZvciBTRFI1MCBhbmQNCisJICogU0RSMTA0IG1vZGUgU0QtY2FyZHMuIE5v
dGUgdGhhdCB0dW5pbmcgaXMgbWFuZGF0b3J5IGZvciBTRFIxMDQuDQorCSAqLw0KKwlpZiAoIW1t
Y19ob3N0X2lzX3NwaShjYXJkLT5ob3N0KSAmJg0KKwkJKGNhcmQtPmhvc3QtPmlvcy50aW1pbmcg
PT0gTU1DX1RJTUlOR19VSFNfU0RSNTAgfHwNCisJCSBjYXJkLT5ob3N0LT5pb3MudGltaW5nID09
IE1NQ19USU1JTkdfVUhTX0REUjUwIHx8DQorCQkgY2FyZC0+aG9zdC0+aW9zLnRpbWluZyA9PSBN
TUNfVElNSU5HX1VIU19TRFIxMDQpKSB7DQorCQllcnIgPSBtbWNfZXhlY3V0ZV90dW5pbmcoY2Fy
ZCk7DQorDQorCQkvKg0KKwkJICogQXMgU0QgU3BlY2lmaWNhdGlvbnMgUGFydDEgUGh5c2ljYWwg
TGF5ZXIgU3BlY2lmaWNhdGlvbg0KKwkJICogVmVyc2lvbiAzLjAxIHNheXMsIENNRDE5IHR1bmlu
ZyBpcyBhdmFpbGFibGUgZm9yIHVubG9ja2VkDQorCQkgKiBjYXJkcyBpbiB0cmFuc2ZlciBzdGF0
ZSBvZiAxLjhWIHNpZ25hbGluZyBtb2RlLiBUaGUgc21hbGwNCisJCSAqIGRpZmZlcmVuY2UgYmV0
d2VlbiB2My4wMCBhbmQgMy4wMSBzcGVjIG1lYW5zIHRoYXQgQ01EMTkNCisJCSAqIHR1bmluZyBp
cyBhbHNvIGF2YWlsYWJsZSBmb3IgRERSNTAgbW9kZS4NCisJCSAqLw0KKwkJaWYgKGVyciAmJiBj
YXJkLT5ob3N0LT5pb3MudGltaW5nID09IE1NQ19USU1JTkdfVUhTX0REUjUwKSB7DQorCQkJcHJf
d2FybigiJXM6IGRkcjUwIHR1bmluZyBmYWlsZWRcbiIsDQorCQkJCW1tY19ob3N0bmFtZShjYXJk
LT5ob3N0KSk7DQorCQkJZXJyID0gMDsNCisJCX0NCisJfQ0KKw0KK291dDoNCisJa2ZyZWUoc3Rh
dHVzKTsNCisNCisJcmV0dXJuIGVycjsNCit9DQorDQorc3RhdGljIGJvb2wgbW1jX3NkX2NhcmRf
dXNpbmdfdjE4KHN0cnVjdCBtbWNfY2FyZCAqY2FyZCkNCit7DQorCS8qDQorCSAqIEFjY29yZGlu
ZyB0byB0aGUgU0Qgc3BlYy4sIHRoZSBCdXMgU3BlZWQgTW9kZSAoZnVuY3Rpb24gZ3JvdXAgMSkg
Yml0cw0KKwkgKiAyIHRvIDQgYXJlIHplcm8gaWYgdGhlIGNhcmQgaXMgaW5pdGlhbGl6ZWQgYXQg
My4zViBzaWduYWwgbGV2ZWwuIFRodXMNCisJICogdGhleSBjYW4gYmUgdXNlZCB0byBkZXRlcm1p
bmUgaWYgdGhlIGNhcmQgaGFzIGFscmVhZHkgc3dpdGNoZWQgdG8NCisJICogMS44ViBzaWduYWxp
bmcuDQorCSAqLw0KKwlyZXR1cm4gY2FyZC0+c3dfY2Fwcy5zZDNfYnVzX21vZGUgJg0KKwkgICAg
ICAgKFNEX01PREVfVUhTX1NEUjUwIHwgU0RfTU9ERV9VSFNfU0RSMTA0IHwgU0RfTU9ERV9VSFNf
RERSNTApOw0KK30NCisNCisvKg0KKyAqIEZldGNoZXMgYW5kIGRlY29kZXMgc3dpdGNoIGluZm9y
bWF0aW9uDQorICovDQorc3RhdGljIGludCBtbWNfcmVhZF9zd2l0Y2goc3RydWN0IG1tY19jYXJk
ICpjYXJkKQ0KK3sNCisJaW50IGVycjsNCisJdTggKnN0YXR1czsNCisNCisJaWYgKGNhcmQtPnNj
ci5zZGFfdnNuIDwgU0NSX1NQRUNfVkVSXzEpDQorCQlyZXR1cm4gMDsNCisNCisJaWYgKCEoY2Fy
ZC0+Y3NkLmNtZGNsYXNzICYgQ0NDX1NXSVRDSCkpIHsNCisJCXByX3dhcm4oIiVzOiBjYXJkIGxh
Y2tzIG1hbmRhdG9yeSBzd2l0Y2ggZnVuY3Rpb24sIHBlcmZvcm1hbmNlIG1pZ2h0IHN1ZmZlclxu
IiwNCisJCQltbWNfaG9zdG5hbWUoY2FyZC0+aG9zdCkpOw0KKwkJcmV0dXJuIDA7DQorCX0NCisN
CisJc3RhdHVzID0ga21hbGxvYyg2NCwgR0ZQX0tFUk5FTCk7DQorCWlmICghc3RhdHVzKQ0KKwkJ
cmV0dXJuIC1FTk9NRU07DQorDQorCS8qDQorCSAqIEZpbmQgb3V0IHRoZSBjYXJkJ3Mgc3VwcG9y
dCBiaXRzIHdpdGggYSBtb2RlIDAgb3BlcmF0aW9uLg0KKwkgKiBUaGUgYXJndW1lbnQgZG9lcyBu
b3QgbWF0dGVyLCBhcyB0aGUgc3VwcG9ydCBiaXRzIGRvIG5vdA0KKwkgKiBjaGFuZ2Ugd2l0aCB0
aGUgYXJndW1lbnRzLg0KKwkgKi8NCisJZXJyID0gbW1jX3NkX3N3aXRjaChjYXJkLCAwLCAwLCAw
LCBzdGF0dXMpOw0KKwlpZiAoZXJyKSB7DQorCQkvKg0KKwkJICogSWYgdGhlIGhvc3Qgb3IgdGhl
IGNhcmQgY2FuJ3QgZG8gdGhlIHN3aXRjaCwNCisJCSAqIGZhaWwgbW9yZSBncmFjZWZ1bGx5Lg0K
KwkJICovDQorCQlpZiAoZXJyICE9IC1FSU5WQUwgJiYgZXJyICE9IC1FTk9TWVMgJiYgZXJyICE9
IC1FRkFVTFQpDQorCQkJZ290byBvdXQ7DQorDQorCQlwcl93YXJuKCIlczogcHJvYmxlbSByZWFk
aW5nIEJ1cyBTcGVlZCBtb2Rlc1xuIiwNCisJCQltbWNfaG9zdG5hbWUoY2FyZC0+aG9zdCkpOw0K
KwkJZXJyID0gMDsNCisNCisJCWdvdG8gb3V0Ow0KKwl9DQorDQorCWlmIChzdGF0dXNbMTNdICYg
U0RfTU9ERV9ISUdIX1NQRUVEKQ0KKwkJY2FyZC0+c3dfY2Fwcy5oc19tYXhfZHRyID0gSElHSF9T
UEVFRF9NQVhfRFRSOw0KKw0KKwlpZiAoY2FyZC0+c2NyLnNkYV9zcGVjMykgew0KKwkJY2FyZC0+
c3dfY2Fwcy5zZDNfYnVzX21vZGUgPSBzdGF0dXNbMTNdOw0KKwkJLyogRHJpdmVyIFN0cmVuZ3Ro
cyBzdXBwb3J0ZWQgYnkgdGhlIGNhcmQgKi8NCisJCWNhcmQtPnN3X2NhcHMuc2QzX2Rydl90eXBl
ID0gc3RhdHVzWzldOw0KKwkJY2FyZC0+c3dfY2Fwcy5zZDNfY3Vycl9saW1pdCA9IHN0YXR1c1s3
XSB8IHN0YXR1c1s2XSA8PCA4Ow0KKwl9DQorDQorb3V0Og0KKwlrZnJlZShzdGF0dXMpOw0KKw0K
KwlyZXR1cm4gZXJyOw0KK30NCisNCisvKg0KKyAqIEhhbmRsZSB0aGUgZGV0ZWN0aW9uIGFuZCBp
bml0aWFsaXNhdGlvbiBvZiBhIGNhcmQuDQorICoNCisgKiBJbiB0aGUgY2FzZSBvZiBhIHJlc3Vt
ZSwgIm9sZGNhcmQiIHdpbGwgY29udGFpbiB0aGUgY2FyZA0KKyAqIHdlJ3JlIHRyeWluZyB0byBy
ZWluaXRpYWxpc2UuDQorICovDQoraW50IHNkX2luaXRfY2FyZChzdHJ1Y3QgbW1jX2hvc3QgKmhv
c3QsIHUzMiBvY3IsDQorCXN0cnVjdCBtbWNfY2FyZCAqb2xkY2FyZCkNCit7DQorCXN0cnVjdCBt
bWNfY2FyZCAqY2FyZDsNCisJaW50IGVycjsNCisJdTMyIGNpZFs0XTsNCisJdTMyIHJvY3IgPSAw
Ow0KKwlib29sIHYxOF9maXh1cF9mYWlsZWQgPSBmYWxzZTsNCisNCisJV0FSTl9PTighaG9zdC0+
Y2xhaW1lZCk7DQorcmV0cnk6DQorCWVyciA9IG1tY19zZF9nZXRfY2lkKGhvc3QsIG9jciwgY2lk
LCAmcm9jcik7DQorCWlmIChlcnIpDQorCQlyZXR1cm4gZXJyOw0KKw0KKwlpZiAob2xkY2FyZCkg
ew0KKwkJaWYgKG1lbWNtcChjaWQsIG9sZGNhcmQtPnJhd19jaWQsIHNpemVvZihjaWQpKSAhPSAw
KSB7DQorCQkJcHJfZGVidWcoIiVzOiBQZXJoYXBzIHRoZSBjYXJkIHdhcyByZXBsYWNlZFxuIiwN
CisJCQkJbW1jX2hvc3RuYW1lKGhvc3QpKTsNCisJCQlyZXR1cm4gLUVOT0VOVDsNCisJCX0NCisN
CisJCWNhcmQgPSBvbGRjYXJkOw0KKwl9IGVsc2Ugew0KKwkJLyoNCisJCSAqIEFsbG9jYXRlIGNh
cmQgc3RydWN0dXJlLg0KKwkJICovDQorCQljYXJkID0gbW1jX2FsbG9jX2NhcmQoaG9zdCwgJnNk
X3R5cGUpOw0KKwkJaWYgKElTX0VSUihjYXJkKSkNCisJCQlyZXR1cm4gUFRSX0VSUihjYXJkKTsN
CisNCisJCWNhcmQtPm9jciA9IG9jcjsNCisJCWNhcmQtPnR5cGUgPSBNTUNfVFlQRV9TRDsNCisJ
CW1lbWNweShjYXJkLT5yYXdfY2lkLCBjaWQsIHNpemVvZihjYXJkLT5yYXdfY2lkKSk7DQorCX0N
CisNCisJLyoNCisJICogQ2FsbCB0aGUgb3B0aW9uYWwgSEMncyBpbml0X2NhcmQgZnVuY3Rpb24g
dG8gaGFuZGxlIHF1aXJrcy4NCisJICovDQorCWlmIChob3N0LT5vcHMtPmluaXRfY2FyZCkNCisJ
CWhvc3QtPm9wcy0+aW5pdF9jYXJkKGhvc3QsIGNhcmQpOw0KKw0KKwkvKg0KKwkgKiBGb3IgbmF0
aXZlIGJ1c3NlczogIGdldCBjYXJkIFJDQSBhbmQgcXVpdCBvcGVuIGRyYWluIG1vZGUuDQorCSAq
Lw0KKwlpZiAoIW1tY19ob3N0X2lzX3NwaShob3N0KSkgew0KKwkJZXJyID0gbW1jX3NlbmRfcmVs
YXRpdmVfYWRkcihob3N0LCAmY2FyZC0+cmNhKTsNCisJCWlmIChlcnIpDQorCQkJZ290byBmcmVl
X2NhcmQ7DQorCX0NCisNCisJaWYgKCFvbGRjYXJkKSB7DQorCQllcnIgPSBtbWNfc2RfZ2V0X2Nz
ZChob3N0LCBjYXJkKTsNCisJCWlmIChlcnIpDQorCQkJZ290byBmcmVlX2NhcmQ7DQorDQorCQlt
bWNfZGVjb2RlX2NpZChjYXJkKTsNCisJfQ0KKw0KKwkvKg0KKwkgKiBoYW5kbGluZyBvbmx5IGZv
ciBjYXJkcyBzdXBwb3J0aW5nIERTUiBhbmQgaG9zdHMgcmVxdWVzdGluZw0KKwkgKiBEU1IgY29u
ZmlndXJhdGlvbg0KKwkgKi8NCisJaWYgKGNhcmQtPmNzZC5kc3JfaW1wICYmIGhvc3QtPmRzcl9y
ZXEpDQorCQltbWNfc2V0X2Rzcihob3N0KTsNCisNCisJLyoNCisJICogU2VsZWN0IGNhcmQsIGFz
IGFsbCBmb2xsb3dpbmcgY29tbWFuZHMgcmVseSBvbiB0aGF0Lg0KKwkgKi8NCisJaWYgKCFtbWNf
aG9zdF9pc19zcGkoaG9zdCkpIHsNCisJCWVyciA9IG1tY19zZWxlY3RfY2FyZChjYXJkKTsNCisJ
CWlmIChlcnIpDQorCQkJZ290byBmcmVlX2NhcmQ7DQorCX0NCisNCisJZXJyID0gbW1jX3NkX3Nl
dHVwX2NhcmQoaG9zdCwgY2FyZCwgb2xkY2FyZCAhPSBOVUxMKTsNCisJaWYgKGVycikNCisJCWdv
dG8gZnJlZV9jYXJkOw0KKw0KKwkvKg0KKwkgKiBJZiB0aGUgY2FyZCBoYXMgbm90IGJlZW4gcG93
ZXIgY3ljbGVkLCBpdCBtYXkgc3RpbGwgYmUgdXNpbmcgMS44Vg0KKwkgKiBzaWduYWxpbmcuIERl
dGVjdCB0aGF0IHNpdHVhdGlvbiBhbmQgdHJ5IHRvIGluaXRpYWxpemUgYSBVSFMtSSAoMS44VikN
CisJICogdHJhbnNmZXIgbW9kZS4NCisJICovDQorCWlmICghdjE4X2ZpeHVwX2ZhaWxlZCAmJiAh
bW1jX2hvc3RfaXNfc3BpKGhvc3QpICYmIG1tY19ob3N0X3Vocyhob3N0KSAmJg0KKwkgICAgbW1j
X3NkX2NhcmRfdXNpbmdfdjE4KGNhcmQpICYmDQorCSAgICBob3N0LT5pb3Muc2lnbmFsX3ZvbHRh
Z2UgIT0gTU1DX1NJR05BTF9WT0xUQUdFXzE4MCkgew0KKwkJLyoNCisJCSAqIFJlLXJlYWQgc3dp
dGNoIGluZm9ybWF0aW9uIGluIGNhc2UgaXQgaGFzIGNoYW5nZWQgc2luY2UNCisJCSAqIG9sZGNh
cmQgd2FzIGluaXRpYWxpemVkLg0KKwkJICovDQorCQlpZiAob2xkY2FyZCkgew0KKwkJCWVyciA9
IG1tY19yZWFkX3N3aXRjaChjYXJkKTsNCisJCQlpZiAoZXJyKQ0KKwkJCQlnb3RvIGZyZWVfY2Fy
ZDsNCisJCX0NCisJCWlmIChtbWNfc2RfY2FyZF91c2luZ192MTgoY2FyZCkpIHsNCisJCQlpZiAo
bW1jX2hvc3Rfc2V0X3Voc192b2x0YWdlKGhvc3QpIHx8DQorCQkJICAgIHNkX2luaXRfdWhzX2Nh
cmQoY2FyZCkpIHsNCisJCQkJdjE4X2ZpeHVwX2ZhaWxlZCA9IHRydWU7DQorCQkJCW1tY19wb3dl
cl9jeWNsZShob3N0LCBvY3IpOw0KKwkJCQlpZiAoIW9sZGNhcmQpDQorCQkJCQltbWNfcmVtb3Zl
X2NhcmQoY2FyZCk7DQorCQkJCWdvdG8gcmV0cnk7DQorCQkJfQ0KKwkJCWdvdG8gZG9uZTsNCisJ
CX0NCisJfQ0KKw0KKwkvKiBJbml0aWFsaXphdGlvbiBzZXF1ZW5jZSBmb3IgVUhTLUkgY2FyZHMg
Ki8NCisJaWYgKHJvY3IgJiBTRF9ST0NSX1MxOEEgJiYgbW1jX2hvc3RfdWhzKGhvc3QpKSB7DQor
CQllcnIgPSBzZF9pbml0X3Voc19jYXJkKGNhcmQpOw0KKwkJaWYgKGVycikNCisJCQlnb3RvIGZy
ZWVfY2FyZDsNCisJfSBlbHNlIHsNCisJCS8qDQorCQkgKiBTd2l0Y2ggdG8gd2lkZXIgYnVzIChp
ZiBzdXBwb3J0ZWQpLg0KKwkJICovDQorCQlpZiAoKGhvc3QtPmNhcHMgJiBNTUNfQ0FQXzRfQklU
X0RBVEEpICYmDQorCQkJKGNhcmQtPnNjci5idXNfd2lkdGhzICYgU0RfU0NSX0JVU19XSURUSF80
KSkgew0KKwkJCWVyciA9IG1tY19hcHBfc2V0X2J1c193aWR0aChjYXJkLCBNTUNfQlVTX1dJRFRI
XzQpOw0KKwkJCWlmIChlcnIpDQorCQkJCWdvdG8gZnJlZV9jYXJkOw0KKw0KKwkJCW1tY19zZXRf
YnVzX3dpZHRoKGhvc3QsIE1NQ19CVVNfV0lEVEhfNCk7DQorCQl9DQorDQorCQltbWNfYXBwX3Nl
dF9jbHJfY2FyZF9kZXRlY3QoY2FyZCk7DQorDQorCQkvKg0KKwkJICogQXR0ZW1wdCB0byBjaGFu
Z2UgdG8gaGlnaC1zcGVlZCAoaWYgc3VwcG9ydGVkKQ0KKwkJICovDQorCQllcnIgPSBtbWNfc2Rf
c3dpdGNoX2hzKGNhcmQpOw0KKwkJaWYgKGVyciA+IDApDQorCQkJbW1jX3NldF90aW1pbmcoY2Fy
ZC0+aG9zdCwgTU1DX1RJTUlOR19TRF9IUyk7DQorCQllbHNlIGlmIChlcnIpDQorCQkJZ290byBm
cmVlX2NhcmQ7DQorDQorCQkvKg0KKwkJICogU2V0IGJ1cyBzcGVlZC4NCisJCSAqLw0KKwkJbW1j
X3NldF9jbG9jayhob3N0LCBtbWNfc2RfZ2V0X21heF9jbG9jayhjYXJkKSk7DQorCX0NCisNCisJ
aWYgKGhvc3QtPmNhcHMyICYgTU1DX0NBUDJfQVZPSURfM18zViAmJg0KKwkgICAgaG9zdC0+aW9z
LnNpZ25hbF92b2x0YWdlID09IE1NQ19TSUdOQUxfVk9MVEFHRV8zMzApIHsNCisJCXByX2Vycigi
JXM6IEhvc3QgZmFpbGVkIHRvIG5lZ290aWF0ZSBkb3duIGZyb20gMy4zVlxuIiwNCisJCQltbWNf
aG9zdG5hbWUoaG9zdCkpOw0KKwkJZXJyID0gLUVJTlZBTDsNCisJCWdvdG8gZnJlZV9jYXJkOw0K
Kwl9DQorZG9uZToNCisNCisJaG9zdC0+Y2FyZCA9IGNhcmQ7DQorCXJldHVybiAwOw0KKw0KK2Zy
ZWVfY2FyZDoNCisJaWYgKCFvbGRjYXJkKQ0KKwkJbW1jX3JlbW92ZV9jYXJkKGNhcmQpOw0KKw0K
KwlyZXR1cm4gZXJyOw0KK30NCisNCisNCisvKg0KKyAqIEhvc3QgaXMgYmVpbmcgcmVtb3ZlZC4g
RnJlZSB1cCB0aGUgY3VycmVudCBjYXJkLg0KKyAqLw0KK3N0YXRpYyB2b2lkIG1tY19zZF9yZW1v
dmUoc3RydWN0IG1tY19ob3N0ICpob3N0KQ0KK3sNCisJbW1jX3JlbW92ZV9jYXJkKGhvc3QtPmNh
cmQpOw0KKwlob3N0LT5jYXJkID0gTlVMTDsNCit9DQorDQorLyoNCisgKiBDYXJkIGRldGVjdGlv
biAtIGNhcmQgaXMgYWxpdmUuDQorICovDQorc3RhdGljIGludCBtbWNfc2RfYWxpdmUoc3RydWN0
IG1tY19ob3N0ICpob3N0KQ0KK3sNCisJcmV0dXJuIG1tY19zZW5kX3N0YXR1cyhob3N0LT5jYXJk
LCBOVUxMKTsNCit9DQorDQorLyoNCisgKiBDYXJkIGRldGVjdGlvbiBjYWxsYmFjayBmcm9tIGhv
c3QuDQorICovDQorc3RhdGljIHZvaWQgbW1jX3NkX2RldGVjdChzdHJ1Y3QgbW1jX2hvc3QgKmhv
c3QpDQorew0KKwlpbnQgZXJyOw0KKw0KKwltbWNfZ2V0X2NhcmQoaG9zdC0+Y2FyZCwgTlVMTCk7
DQorDQorCS8qDQorCSAqIEp1c3QgY2hlY2sgaWYgb3VyIGNhcmQgaGFzIGJlZW4gcmVtb3ZlZC4N
CisJICovDQorCWVyciA9IF9tbWNfZGV0ZWN0X2NhcmRfcmVtb3ZlZChob3N0KTsNCisNCisJbW1j
X3B1dF9jYXJkKGhvc3QtPmNhcmQsIE5VTEwpOw0KKw0KKwlpZiAoZXJyKSB7DQorCQltbWNfc2Rf
cmVtb3ZlKGhvc3QpOw0KKw0KKwkJbW1jX2NsYWltX2hvc3QoaG9zdCk7DQorCQltbWNfZGV0YWNo
X2J1cyhob3N0KTsNCisJCW1tY19wb3dlcl9vZmYoaG9zdCk7DQorCQltbWNfcmVsZWFzZV9ob3N0
KGhvc3QpOw0KKwl9DQorfQ0KKw0KK3N0YXRpYyBpbnQgX21tY19zZF9zdXNwZW5kKHN0cnVjdCBt
bWNfaG9zdCAqaG9zdCkNCit7DQorCWludCBlcnIgPSAwOw0KKw0KKwltbWNfY2xhaW1faG9zdCho
b3N0KTsNCisNCisJaWYgKG1tY19jYXJkX3N1c3BlbmRlZChob3N0LT5jYXJkKSkNCisJCWdvdG8g
b3V0Ow0KKw0KKwlpZiAoIW1tY19ob3N0X2lzX3NwaShob3N0KSkNCisJCWVyciA9IG1tY19kZXNl
bGVjdF9jYXJkcyhob3N0KTsNCisNCisJaWYgKCFlcnIpIHsNCisJCW1tY19wb3dlcl9vZmYoaG9z
dCk7DQorCQltbWNfY2FyZF9zZXRfc3VzcGVuZGVkKGhvc3QtPmNhcmQpOw0KKwl9DQorDQorb3V0
Og0KKwltbWNfcmVsZWFzZV9ob3N0KGhvc3QpOw0KKwlyZXR1cm4gZXJyOw0KK30NCisNCisvKg0K
KyAqIENhbGxiYWNrIGZvciBzdXNwZW5kDQorICovDQorc3RhdGljIGludCBtbWNfc2Rfc3VzcGVu
ZChzdHJ1Y3QgbW1jX2hvc3QgKmhvc3QpDQorew0KKwlpbnQgZXJyOw0KKw0KKwllcnIgPSBfbW1j
X3NkX3N1c3BlbmQoaG9zdCk7DQorCWlmICghZXJyKSB7DQorCQlwbV9ydW50aW1lX2Rpc2FibGUo
Jmhvc3QtPmNhcmQtPmRldik7DQorCQlwbV9ydW50aW1lX3NldF9zdXNwZW5kZWQoJmhvc3QtPmNh
cmQtPmRldik7DQorCX0NCisNCisJcmV0dXJuIGVycjsNCit9DQorDQorLyoNCisgKiBUaGlzIGZ1
bmN0aW9uIHRyaWVzIHRvIGRldGVybWluZSBpZiB0aGUgc2FtZSBjYXJkIGlzIHN0aWxsIHByZXNl
bnQNCisgKiBhbmQsIGlmIHNvLCByZXN0b3JlIGFsbCBzdGF0ZSB0byBpdC4NCisgKi8NCitzdGF0
aWMgaW50IF9tbWNfc2RfcmVzdW1lKHN0cnVjdCBtbWNfaG9zdCAqaG9zdCkNCit7DQorCWludCBl
cnIgPSAwOw0KKw0KKwltbWNfY2xhaW1faG9zdChob3N0KTsNCisNCisJaWYgKCFtbWNfY2FyZF9z
dXNwZW5kZWQoaG9zdC0+Y2FyZCkpDQorCQlnb3RvIG91dDsNCisNCisJbW1jX3Bvd2VyX3VwKGhv
c3QsIGhvc3QtPmNhcmQtPm9jcik7DQorCWVyciA9IHNkX2luaXRfY2FyZChob3N0LCBob3N0LT5j
YXJkLT5vY3IsIGhvc3QtPmNhcmQpOw0KKwltbWNfY2FyZF9jbHJfc3VzcGVuZGVkKGhvc3QtPmNh
cmQpOw0KKw0KK291dDoNCisJbW1jX3JlbGVhc2VfaG9zdChob3N0KTsNCisJcmV0dXJuIGVycjsN
Cit9DQorDQorLyoNCisgKiBDYWxsYmFjayBmb3IgcmVzdW1lDQorICovDQorc3RhdGljIGludCBt
bWNfc2RfcmVzdW1lKHN0cnVjdCBtbWNfaG9zdCAqaG9zdCkNCit7DQorCXBtX3J1bnRpbWVfZW5h
YmxlKCZob3N0LT5jYXJkLT5kZXYpOw0KKwlyZXR1cm4gMDsNCit9DQorDQorLyoNCisgKiBDYWxs
YmFjayBmb3IgcnVudGltZV9zdXNwZW5kLg0KKyAqLw0KK3N0YXRpYyBpbnQgbW1jX3NkX3J1bnRp
bWVfc3VzcGVuZChzdHJ1Y3QgbW1jX2hvc3QgKmhvc3QpDQorew0KKwlpbnQgZXJyOw0KKw0KKwlp
ZiAoIShob3N0LT5jYXBzICYgTU1DX0NBUF9BR0dSRVNTSVZFX1BNKSkNCisJCXJldHVybiAwOw0K
Kw0KKwllcnIgPSBfbW1jX3NkX3N1c3BlbmQoaG9zdCk7DQorCWlmIChlcnIpDQorCQlwcl9lcnIo
IiVzOiBlcnJvciAlZCBkb2luZyBhZ2dyZXNzaXZlIHN1c3BlbmRcbiIsDQorCQkJbW1jX2hvc3Ru
YW1lKGhvc3QpLCBlcnIpOw0KKw0KKwlyZXR1cm4gZXJyOw0KK30NCisNCisvKg0KKyAqIENhbGxi
YWNrIGZvciBydW50aW1lX3Jlc3VtZS4NCisgKi8NCitzdGF0aWMgaW50IG1tY19zZF9ydW50aW1l
X3Jlc3VtZShzdHJ1Y3QgbW1jX2hvc3QgKmhvc3QpDQorew0KKwlpbnQgZXJyOw0KKw0KKwllcnIg
PSBfbW1jX3NkX3Jlc3VtZShob3N0KTsNCisJaWYgKGVyciAmJiBlcnIgIT0gLUVOT01FRElVTSkN
CisJCXByX2VycigiJXM6IGVycm9yICVkIGRvaW5nIHJ1bnRpbWUgcmVzdW1lXG4iLA0KKwkJCW1t
Y19ob3N0bmFtZShob3N0KSwgZXJyKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBp
bnQgbW1jX3NkX2h3X3Jlc2V0KHN0cnVjdCBtbWNfaG9zdCAqaG9zdCkNCit7DQorCW1tY19wb3dl
cl9jeWNsZShob3N0LCBob3N0LT5jYXJkLT5vY3IpOw0KKwlyZXR1cm4gc2RfaW5pdF9jYXJkKGhv
c3QsIGhvc3QtPmNhcmQtPm9jciwgaG9zdC0+Y2FyZCk7DQorfQ0KKw0KK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgbW1jX2J1c19vcHMgbW1jX3NkX29wcyA9IHsNCisJLnJlbW92ZSA9IG1tY19zZF9yZW1v
dmUsDQorCS5kZXRlY3QgPSBtbWNfc2RfZGV0ZWN0LA0KKwkucnVudGltZV9zdXNwZW5kID0gbW1j
X3NkX3J1bnRpbWVfc3VzcGVuZCwNCisJLnJ1bnRpbWVfcmVzdW1lID0gbW1jX3NkX3J1bnRpbWVf
cmVzdW1lLA0KKwkuc3VzcGVuZCA9IG1tY19zZF9zdXNwZW5kLA0KKwkucmVzdW1lID0gbW1jX3Nk
X3Jlc3VtZSwNCisJLmFsaXZlID0gbW1jX3NkX2FsaXZlLA0KKwkuc2h1dGRvd24gPSBtbWNfc2Rf
c3VzcGVuZCwNCisJLmh3X3Jlc2V0ID0gbW1jX3NkX2h3X3Jlc2V0LA0KK307DQorDQorLyoNCisg
KiBTdGFydGluZyBwb2ludCBmb3IgU0QgY2FyZCBpbml0Lg0KKyAqLw0KK3N0YXRpYyBpbnQgYXR0
YWNoX3NkKHN0cnVjdCBtbWNfaG9zdCAqaG9zdCkNCit7DQorCWludCBlcnI7DQorCXUzMiBvY3Is
IHJvY3I7DQorDQorCVdBUk5fT04oIWhvc3QtPmNsYWltZWQpOw0KKw0KKwllcnIgPSBtbWNfc2Vu
ZF9hcHBfb3BfY29uZChob3N0LCAwLCAmb2NyKTsNCisJaWYgKGVycikNCisJCXJldHVybiBlcnI7
DQorDQorCW1tY19hdHRhY2hfYnVzKGhvc3QsICZtbWNfc2Rfb3BzKTsNCisJaWYgKGhvc3QtPm9j
cl9hdmFpbF9zZCkNCisJCWhvc3QtPm9jcl9hdmFpbCA9IGhvc3QtPm9jcl9hdmFpbF9zZDsNCisN
CisJLyoNCisJICogV2UgbmVlZCB0byBnZXQgT0NSIGEgZGlmZmVyZW50IHdheSBmb3IgU1BJLg0K
KwkgKi8NCisJaWYgKG1tY19ob3N0X2lzX3NwaShob3N0KSkgew0KKwkJbW1jX2dvX2lkbGUoaG9z
dCk7DQorDQorCQllcnIgPSBtbWNfc3BpX3JlYWRfb2NyKGhvc3QsIDAsICZvY3IpOw0KKwkJaWYg
KGVycikNCisJCQlnb3RvIGVycjsNCisJfQ0KKw0KKwkvKg0KKwkgKiBTb21lIFNEIGNhcmRzIGNs
YWltcyBhbiBvdXQgb2Ygc3BlYyBWREQgdm9sdGFnZSByYW5nZS4gTGV0J3MgdHJlYXQNCisJICog
dGhlc2UgYml0cyBhcyBiZWluZyBpbi12YWxpZCBhbmQgZXNwZWNpYWxseSBhbHNvIGJpdDcuDQor
CSAqLw0KKwlvY3IgJj0gfjB4N0ZGRjsNCisNCisJcm9jciA9IG1tY19zZWxlY3Rfdm9sdGFnZSho
b3N0LCBvY3IpOw0KKw0KKwkvKg0KKwkgKiBDYW4gd2Ugc3VwcG9ydCB0aGUgdm9sdGFnZShzKSBv
ZiB0aGUgY2FyZChzKT8NCisJICovDQorCWlmICghcm9jcikgew0KKwkJZXJyID0gLUVJTlZBTDsN
CisJCWdvdG8gZXJyOw0KKwl9DQorDQorCS8qDQorCSAqIERldGVjdCBhbmQgaW5pdCB0aGUgY2Fy
ZC4NCisJICovDQorCWVyciA9IHNkX2luaXRfY2FyZChob3N0LCByb2NyLCBOVUxMKTsNCisJaWYg
KGVycikNCisJCWdvdG8gZXJyOw0KKw0KKwltbWNfcmVsZWFzZV9ob3N0KGhvc3QpOw0KKwllcnIg
PSBtbWNfYWRkX2NhcmQoaG9zdC0+Y2FyZCk7DQorCWlmIChlcnIpDQorCQlnb3RvIHJlbW92ZV9j
YXJkOw0KKw0KKwltbWNfY2xhaW1faG9zdChob3N0KTsNCisJcmV0dXJuIDA7DQorDQorcmVtb3Zl
X2NhcmQ6DQorCW1tY19yZW1vdmVfY2FyZChob3N0LT5jYXJkKTsNCisJaG9zdC0+Y2FyZCA9IE5V
TEw7DQorCW1tY19jbGFpbV9ob3N0KGhvc3QpOw0KK2VycjoNCisJbW1jX2RldGFjaF9idXMoaG9z
dCk7DQorDQorCXByX2VycigiJXM6IGVycm9yICVkIHdoaWxzdCBpbml0aWFsaXNpbmcgU0QgY2Fy
ZFxuIiwNCisJCW1tY19ob3N0bmFtZShob3N0KSwgZXJyKTsNCisNCisJcmV0dXJuIGVycjsNCit9
DQorDQorc3RhdGljIGludCBtbWNfc2NoZWR1bGVfZGVsYXllZF93b3JrKHN0cnVjdCBkZWxheWVk
X3dvcmsgKndvcmssDQorCQkJCSAgICAgdW5zaWduZWQgbG9uZyBkZWxheSkNCit7DQorCS8qDQor
CSAqIFdlIHVzZSB0aGUgc3lzdGVtX2ZyZWV6YWJsZV93cSwgYmVjYXVzZSBvZiB0d28gcmVhc29u
cy4NCisJICogRmlyc3QsIGl0IGFsbG93cyBzZXZlcmFsIHdvcmtzIChub3QgdGhlIHNhbWUgd29y
ayBpdGVtKSB0byBiZQ0KKwkgKiBleGVjdXRlZCBzaW11bHRhbmVvdXNseS4gU2Vjb25kLCB0aGUg
cXVldWUgYmVjb21lcyBmcm96ZW4gd2hlbg0KKwkgKiB1c2Vyc3BhY2UgYmVjb21lcyBmcm96ZW4g
ZHVyaW5nIHN5c3RlbSBQTS4NCisJICovDQorCXJldHVybiBxdWV1ZV9kZWxheWVkX3dvcmsoc3lz
dGVtX2ZyZWV6YWJsZV93cSwgd29yaywgZGVsYXkpOw0KK30NCisNCitzdGF0aWMgdm9pZCBtbWNf
aHdfcmVzZXRfZm9yX2luaXQoc3RydWN0IG1tY19ob3N0ICpob3N0KQ0KK3sNCisJbW1jX3B3cnNl
cV9yZXNldChob3N0KTsNCisNCisJaWYgKCEoaG9zdC0+Y2FwcyAmIE1NQ19DQVBfSFdfUkVTRVQp
IHx8ICFob3N0LT5vcHMtPmh3X3Jlc2V0KQ0KKwkJcmV0dXJuOw0KKwlob3N0LT5vcHMtPmh3X3Jl
c2V0KGhvc3QpOw0KK30NCisNCitzdGF0aWMgaW50IG1tY19yZXNjYW5fdHJ5X2ZyZXEoc3RydWN0
IG1tY19ob3N0ICpob3N0LCB1bnNpZ25lZCBpbnQgZnJlcSkNCit7DQorCWhvc3QtPmZfaW5pdCA9
IGZyZXE7DQorDQorCXByX2RlYnVnKCIlczogJXM6IHRyeWluZyB0byBpbml0IGNhcmQgYXQgJXUg
SHpcbiIsDQorCQltbWNfaG9zdG5hbWUoaG9zdCksIF9fZnVuY19fLCBob3N0LT5mX2luaXQpOw0K
Kw0KKwltbWNfcG93ZXJfdXAoaG9zdCwgaG9zdC0+b2NyX2F2YWlsKTsNCisNCisJLyoNCisJICog
U29tZSBlTU1DcyAod2l0aCBWQ0NRIGFsd2F5cyBvbikgbWF5IG5vdCBiZSByZXNldCBhZnRlciBw
b3dlciB1cCwgc28NCisJICogZG8gYSBoYXJkd2FyZSByZXNldCBpZiBwb3NzaWJsZS4NCisJICov
DQorCW1tY19od19yZXNldF9mb3JfaW5pdChob3N0KTsNCisNCisJLyoNCisJICogc2Rpb19yZXNl
dCBzZW5kcyBDTUQ1MiB0byByZXNldCBjYXJkLiAgU2luY2Ugd2UgZG8gbm90IGtub3cNCisJICog
aWYgdGhlIGNhcmQgaXMgYmVpbmcgcmUtaW5pdGlhbGl6ZWQsIGp1c3Qgc2VuZCBpdC4gIENNRDUy
DQorCSAqIHNob3VsZCBiZSBpZ25vcmVkIGJ5IFNEL2VNTUMgY2FyZHMuDQorCSAqIFNraXAgaXQg
aWYgd2UgYWxyZWFkeSBrbm93IHRoYXQgd2UgZG8gbm90IHN1cHBvcnQgU0RJTyBjb21tYW5kcw0K
KwkgKi8NCisJaWYgKCEoaG9zdC0+Y2FwczIgJiBNTUNfQ0FQMl9OT19TRElPKSkNCisJCXNkaW9f
cmVzZXQoaG9zdCk7DQorDQorCW1tY19nb19pZGxlKGhvc3QpOw0KKw0KKwlpZiAoIShob3N0LT5j
YXBzMiAmIE1NQ19DQVAyX05PX1NEKSkNCisJCW1tY19zZW5kX2lmX2NvbmQoaG9zdCwgaG9zdC0+
b2NyX2F2YWlsKTsNCisNCisJLyogT3JkZXIncyBpbXBvcnRhbnQ6IHByb2JlIFNESU8sIHRoZW4g
U0QsIHRoZW4gTU1DICovDQorCWlmICghKGhvc3QtPmNhcHMyICYgTU1DX0NBUDJfTk9fU0RJTykp
DQorCQlpZiAoIW1tY19hdHRhY2hfc2Rpbyhob3N0KSkNCisJCQlyZXR1cm4gMDsNCisNCisJaWYg
KCEoaG9zdC0+Y2FwczIgJiBNTUNfQ0FQMl9OT19TRCkpDQorCQlpZiAoIWF0dGFjaF9zZChob3N0
KSkNCisJCQlyZXR1cm4gMDsNCisNCisJaWYgKCEoaG9zdC0+Y2FwczIgJiBNTUNfQ0FQMl9OT19N
TUMpKQ0KKwkJaWYgKCFtbWNfYXR0YWNoX21tYyhob3N0KSkNCisJCQlyZXR1cm4gMDsNCisNCisJ
bW1jX3Bvd2VyX29mZihob3N0KTsNCisJcmV0dXJuIC1FSU87DQorfQ0KKw0KKy8qDQorICogQ2xl
YW51cCB3aGVuIHRoZSBsYXN0IHJlZmVyZW5jZSB0byB0aGUgYnVzIG9wZXJhdG9yIGlzIGRyb3Bw
ZWQuDQorICovDQorc3RhdGljIHZvaWQgX19tbWNfcmVsZWFzZV9idXMoc3RydWN0IG1tY19ob3N0
ICpob3N0KQ0KK3sNCisJV0FSTl9PTighaG9zdC0+YnVzX2RlYWQpOw0KKw0KKwlob3N0LT5idXNf
b3BzID0gTlVMTDsNCit9DQorDQorLyoNCisgKiBJbmNyZWFzZSByZWZlcmVuY2UgY291bnQgb2Yg
YnVzIG9wZXJhdG9yDQorICovDQorc3RhdGljIGlubGluZSB2b2lkIG1tY19idXNfZ2V0KHN0cnVj
dCBtbWNfaG9zdCAqaG9zdCkNCit7DQorCXVuc2lnbmVkIGxvbmcgZmxhZ3M7DQorDQorCXNwaW5f
bG9ja19pcnFzYXZlKCZob3N0LT5sb2NrLCBmbGFncyk7DQorCWhvc3QtPmJ1c19yZWZzKys7DQor
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmhvc3QtPmxvY2ssIGZsYWdzKTsNCit9DQorDQorLyoN
CisgKiBEZWNyZWFzZSByZWZlcmVuY2UgY291bnQgb2YgYnVzIG9wZXJhdG9yIGFuZCBmcmVlIGl0
IGlmDQorICogaXQgaXMgdGhlIGxhc3QgcmVmZXJlbmNlLg0KKyAqLw0KK3N0YXRpYyBpbmxpbmUg
dm9pZCBtbWNfYnVzX3B1dChzdHJ1Y3QgbW1jX2hvc3QgKmhvc3QpDQorew0KKwl1bnNpZ25lZCBs
b25nIGZsYWdzOw0KKw0KKwlzcGluX2xvY2tfaXJxc2F2ZSgmaG9zdC0+bG9jaywgZmxhZ3MpOw0K
Kwlob3N0LT5idXNfcmVmcy0tOw0KKwlpZiAoKGhvc3QtPmJ1c19yZWZzID09IDApICYmIGhvc3Qt
PmJ1c19vcHMpDQorCQlfX21tY19yZWxlYXNlX2J1cyhob3N0KTsNCisJc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmaG9zdC0+bG9jaywgZmxhZ3MpOw0KK30NCisNCit2b2lkIG1tY19yZXNjYW5fYmF5
aHViKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykNCit7DQorCXN0cnVjdCBtbWNfaG9zdCAqaG9z
dCA9DQorCQljb250YWluZXJfb2Yod29yaywgc3RydWN0IG1tY19ob3N0LCBkZXRlY3Qud29yayk7
DQorCWludCBpOw0KKw0KKwlpZiAoaG9zdC0+cmVzY2FuX2Rpc2FibGUpDQorCQlyZXR1cm47DQor
DQorCS8qIElmIHRoZXJlIGlzIGEgbm9uLXJlbW92YWJsZSBjYXJkIHJlZ2lzdGVyZWQsIG9ubHkg
c2NhbiBvbmNlICovDQorCWlmICghbW1jX2NhcmRfaXNfcmVtb3ZhYmxlKGhvc3QpICYmIGhvc3Qt
PnJlc2Nhbl9lbnRlcmVkKQ0KKwkJcmV0dXJuOw0KKwlob3N0LT5yZXNjYW5fZW50ZXJlZCA9IDE7
DQorDQorCWlmIChob3N0LT50cmlnZ2VyX2NhcmRfZXZlbnQgJiYgaG9zdC0+b3BzLT5jYXJkX2V2
ZW50KSB7DQorCQltbWNfY2xhaW1faG9zdChob3N0KTsNCisJCWhvc3QtPm9wcy0+Y2FyZF9ldmVu
dChob3N0KTsNCisJCW1tY19yZWxlYXNlX2hvc3QoaG9zdCk7DQorCQlob3N0LT50cmlnZ2VyX2Nh
cmRfZXZlbnQgPSBmYWxzZTsNCisJfQ0KKw0KKwltbWNfYnVzX2dldChob3N0KTsNCisNCisJLyog
VmVyaWZ5IGEgcmVnaXN0ZXJlZCBjYXJkIHRvIGJlIGZ1bmN0aW9uYWwsIGVsc2UgcmVtb3ZlIGl0
LiAqLw0KKwlpZiAoaG9zdC0+YnVzX29wcyAmJiAhaG9zdC0+YnVzX2RlYWQpDQorCQlob3N0LT5i
dXNfb3BzLT5kZXRlY3QoaG9zdCk7DQorDQorCWhvc3QtPmRldGVjdF9jaGFuZ2UgPSAwOw0KKw0K
KwkvKg0KKwkgKiBMZXQgbW1jX2J1c19wdXQoKSBmcmVlIHRoZSBidXMvYnVzX29wcyBpZiB3ZSd2
ZSBmb3VuZCB0aGF0DQorCSAqIHRoZSBjYXJkIGlzIG5vIGxvbmdlciBwcmVzZW50Lg0KKwkgKi8N
CisJbW1jX2J1c19wdXQoaG9zdCk7DQorCW1tY19idXNfZ2V0KGhvc3QpOw0KKw0KKwkvKiBpZiB0
aGVyZSBzdGlsbCBpcyBhIGNhcmQgcHJlc2VudCwgc3RvcCBoZXJlICovDQorCWlmIChob3N0LT5i
dXNfb3BzICE9IE5VTEwpIHsNCisJCW1tY19idXNfcHV0KGhvc3QpOw0KKwkJZ290byBvdXQ7DQor
CX0NCisNCisJLyoNCisJICogT25seSB3ZSBjYW4gYWRkIGEgbmV3IGhhbmRsZXIsIHNvIGl0J3Mg
c2FmZSB0bw0KKwkgKiByZWxlYXNlIHRoZSBsb2NrIGhlcmUuDQorCSAqLw0KKwltbWNfYnVzX3B1
dChob3N0KTsNCisNCisJbW1jX2NsYWltX2hvc3QoaG9zdCk7DQorCWlmIChtbWNfY2FyZF9pc19y
ZW1vdmFibGUoaG9zdCkgJiYgaG9zdC0+b3BzLT5nZXRfY2QgJiYNCisJCQlob3N0LT5vcHMtPmdl
dF9jZChob3N0KSA9PSAwKSB7DQorCQltbWNfcG93ZXJfb2ZmKGhvc3QpOw0KKwkJbW1jX3JlbGVh
c2VfaG9zdChob3N0KTsNCisJCWdvdG8gb3V0Ow0KKwl9DQorDQorCWZvciAoaSA9IDA7IGkgPCBB
UlJBWV9TSVpFKGZyZXFzKTsgaSsrKSB7DQorCQlpZiAoIW1tY19yZXNjYW5fdHJ5X2ZyZXEoaG9z
dCwgbWF4KGZyZXFzW2ldLCBob3N0LT5mX21pbikpKQ0KKwkJCWJyZWFrOw0KKwkJaWYgKGZyZXFz
W2ldIDw9IGhvc3QtPmZfbWluKQ0KKwkJCWJyZWFrOw0KKwl9DQorCW1tY19yZWxlYXNlX2hvc3Qo
aG9zdCk7DQorDQorIG91dDoNCisJaWYgKGhvc3QtPmNhcHMgJiBNTUNfQ0FQX05FRURTX1BPTEwp
DQorCQltbWNfc2NoZWR1bGVfZGVsYXllZF93b3JrKCZob3N0LT5kZXRlY3QsIEhaKTsNCit9DQor
DQorc3RhdGljIGludCBjYXJkX2Rlc2VsZWN0X2NhcmQoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3Qp
DQorew0KKwlpbnQgcmV0ID0gLTE7DQorCWludCBlcnI7DQorCXN0cnVjdCBtbWNfaG9zdCAqbW1j
ID0gaG9zdC0+bW1jOw0KKwlzdHJ1Y3QgbW1jX2NvbW1hbmQgY21kID0geyAwIH07DQorDQorCWNt
ZC5vcGNvZGUgPSBNTUNfU0VMRUNUX0NBUkQ7DQorCWNtZC5hcmcgPSAwOw0KKwljbWQuZmxhZ3Mg
PSBNTUNfUlNQX05PTkUgfCBNTUNfQ01EX0FDOw0KKw0KKwllcnIgPSBtbWNfd2FpdF9mb3JfY21k
KG1tYywgJmNtZCwgMyk7DQorCWlmIChlcnIpDQorCQlwcl9lcnIoIkJIVCBFUlI6IENNRDcgRkFJ
TDogZXJyID0gJWRcbiIsIGVycik7DQorCWVsc2UNCisJCXJldCA9IDA7DQorDQorCXJldHVybiBy
ZXQ7DQorfQ0KKw0KK3N0YXRpYyBib29sIGVudGVyX2V4aXRfZW11bGF0b3JfbW9kZShzdHJ1Y3Qg
c2RoY2lfaG9zdCAqaG9zdCwgYm9vbCBiX2VudGVyKQ0KK3sNCisJYm9vbCByZXQgPSBGQUxTRTsN
CisJdTggdGltZXMgPSBiX2VudGVyID8gMiA6IDE7DQorCXU4IGkgPSAwOw0KKw0KKwlmb3IgKGkg
PSAwOyBpIDwgdGltZXM7IGkrKykgew0KKwkJcmV0ID0gY2FyZF9kZXNlbGVjdF9jYXJkKGhvc3Qp
Ow0KKwkJaWYgKHJldCkNCisJCQlicmVhazsNCisJfQ0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCitz
dGF0aWMgYm9vbCBfZ2dfZW11bGF0b3JfcmVhZF9vbmx5KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0
LA0KKwkJCQkgICB1OCAqaW5fZGF0YSwgdTMyIGRhdGFsZW4pDQorew0KKwlzdHJ1Y3QgbW1jX2hv
c3QgKm1tYyA9IGhvc3QtPm1tYzsNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hv
c3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICp2
ZW5kb3JfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorCWludCByYyA9IDA7
DQorCXU4ICpkYXRhMSA9IGt6YWxsb2MoUEFHRV9TSVpFLCBHRlBfS0VSTkVMKTsNCisJc3RydWN0
IG1tY19yZXF1ZXN0IG1ycSA9IHsgMCB9Ow0KKwlzdHJ1Y3QgbW1jX2NvbW1hbmQgY21kID0geyAw
IH07DQorCXN0cnVjdCBtbWNfZGF0YSBkYXRhID0geyAwIH07DQorCXN0cnVjdCBzY2F0dGVybGlz
dCBzZzsNCisNCisJaWYgKCFkYXRhMSkgew0KKwkJcHJfZXJyKCJCSFQgTVNHOmdnIHJlYWQgbm8g
bWVtb3J5XG4iKTsNCisJCXJjID0gLUVOT01FTTsNCisJCWdvdG8gb3V0Ow0KKwl9DQorDQorCXNn
X2luaXRfb25lKCZzZywgZGF0YTEsIDUxMik7DQorDQorCWNtZC5vcGNvZGUgPSBNTUNfUkVBRF9T
SU5HTEVfQkxPQ0s7DQorCWNtZC5hcmcgPSAwOw0KKwljbWQuZmxhZ3MgPSBNTUNfUlNQX1IxIHwg
TU1DX0NNRF9BRFRDOw0KKwlkYXRhLmJsa3N6ID0gNTEyOw0KKwlkYXRhLmJsb2NrcyA9IDE7DQor
CWRhdGEuZmxhZ3MgPSBNTUNfREFUQV9SRUFEOw0KKwlkYXRhLnRpbWVvdXRfbnMgPSAxMDAwICog
MTAwMCAqIDEwMDA7DQorCWRhdGEuc2cgPSAmc2c7DQorCWRhdGEuc2dfbGVuID0gMTsNCisJbXJx
LmNtZCA9ICZjbWQ7DQorCW1ycS5kYXRhID0gJmRhdGE7DQorCW1ycS5zdG9wID0gTlVMTDsNCisN
CisJbW1jX3dhaXRfZm9yX3JlcShtbWMsICZtcnEpOw0KKwltZW1jcHkoaW5fZGF0YSwgZGF0YTEs
IGRhdGFsZW4pOw0KKw0KKwlrZnJlZShkYXRhMSk7DQorDQorCWlmICgoY21kLmVycm9yID09IC1F
SUxTRVEpIHx8IChkYXRhLmVycm9yID09IC1FSUxTRVEpKQ0KKwkJdmVuZG9yX2hvc3QtPmdnYy5z
ZHI1MF9ub3R1bmluZ19jcmNfZXJyb3JfZmxhZyA9IDE7DQorDQorCWlmIChjbWQuZXJyb3IgfHwg
ZGF0YS5lcnJvcikNCisJCXJjID0gLTE7DQorb3V0Og0KKwlyZXR1cm4gcmM7DQorfQ0KKw0KK3N0
YXRpYyB2b2lkIGhvc3RfY21kZGF0X2xpbmVfcmVzZXQoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3Qp
DQorew0KKwlpZiAoaG9zdC0+b3BzLT5yZXNldCkNCisJCWhvc3QtPm9wcy0+cmVzZXQoaG9zdCwg
U0RIQ0lfUkVTRVRfQ01EIHwgU0RIQ0lfUkVTRVRfREFUQSk7DQorfQ0KKw0KK3N0YXRpYyBpbnQg
Z2dfc2VsZWN0X2NhcmRfc3BlYyhzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCWludCBl
cnI7DQorCXN0cnVjdCBtbWNfY29tbWFuZCBjbWQgPSB7IDAgfTsNCisJc3RydWN0IG1tY19jYXJk
ICpjYXJkID0gaG9zdC0+bW1jLT5jYXJkOw0KKw0KKwljbWQub3Bjb2RlID0gTU1DX1NFTEVDVF9D
QVJEOw0KKw0KKwlpZiAoY2FyZCkgew0KKwkJY21kLmFyZyA9IGNhcmQtPnJjYSA8PCAxNjsNCisJ
CWNtZC5mbGFncyA9IE1NQ19SU1BfUjEgfCBNTUNfQ01EX0FDOw0KKwl9IGVsc2Ugew0KKwkJY21k
LmFyZyA9IDA7DQorCQljbWQuZmxhZ3MgPSBNTUNfUlNQX05PTkUgfCBNTUNfQ01EX0FDOw0KKwl9
DQorDQorCWVyciA9IG1tY193YWl0X2Zvcl9jbWQoaG9zdC0+bW1jLCAmY21kLCAwKTsNCisJaWYg
KGVyciA9PSAtRUlMU0VRKSB7DQorCQlob3N0X2NtZGRhdF9saW5lX3Jlc2V0KGhvc3QpOw0KKw0K
KwkJbWVtc2V0KCZjbWQsIDAsIHNpemVvZihzdHJ1Y3QgbW1jX2NvbW1hbmQpKTsNCisJCWNtZC5v
cGNvZGUgPSA1Ow0KKwkJY21kLmFyZyA9IDA7DQorCQljbWQuZmxhZ3MgPQ0KKwkJCU1NQ19SU1Bf
U1BJX1I0IHwgTU1DX1JTUF9SNCB8IE1NQ19DTURfQkNSOw0KKw0KKwkJbW1jX3dhaXRfZm9yX2Nt
ZChob3N0LT5tbWMsICZjbWQsIDApOw0KKw0KKwkJcHJfZXJyKCJCSFQgRVJSOiVzOiBDTUQ3IENS
Q1xuIiwgX19mdW5jX18pOw0KKwkJaG9zdF9jbWRkYXRfbGluZV9yZXNldChob3N0KTsNCisJCXJl
dHVybiAwOw0KKwl9DQorCWlmIChlcnIgPT0gLUVUSU1FRE9VVCkgew0KKwkJcHJfZXJyKCJCSFQg
RVJSOiVzOiBDTUQ3IHRpbWVvdXRcbiIsIF9fZnVuY19fKTsNCisJCWhvc3RfY21kZGF0X2xpbmVf
cmVzZXQoaG9zdCk7DQorCQlyZXR1cm4gZXJyOw0KKwl9DQorCXJldHVybiAwOw0KK30NCisNCitz
dGF0aWMgYm9vbCBnZ19lbXVsYXRvcl9yZWFkX2V4dChzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwg
Ym9vbCAqY2FyZF9zdGF0dXMsDQorCQkJCQlib29sICpyZWFkX3N0YXR1cywgdTggKmRhdGEsIHUz
MiBkYXRhbGVuKQ0KK3sNCisJYm9vbCByZXQgPSBGQUxTRTsNCisJYm9vbCBjYXJkX3JldCA9IFRS
VUU7DQorCWJvb2wgcmRfcmV0ID0gRkFMU0U7DQorDQorCWlmIChlbnRlcl9leGl0X2VtdWxhdG9y
X21vZGUoaG9zdCwgVFJVRSkgPT0gMCkNCisJCXJldCA9IFRSVUU7DQorCWVsc2UNCisJCXJldCA9
IEZBTFNFOw0KKwlpZiAoIXJldCkNCisJCWdvdG8gZXhpdDsNCisNCisJaWYgKF9nZ19lbXVsYXRv
cl9yZWFkX29ubHkoaG9zdCwgZGF0YSwgZGF0YWxlbikgPT0gMCkNCisJCXJkX3JldCA9IFRSVUU7
DQorCWVsc2UNCisJCXJkX3JldCA9IEZBTFNFOw0KKw0KKwlpZiAoZW50ZXJfZXhpdF9lbXVsYXRv
cl9tb2RlKGhvc3QsIEZBTFNFKSA9PSAwKQ0KKwkJcmV0ID0gVFJVRTsNCisJZWxzZQ0KKwkJcmV0
ID0gRkFMU0U7DQorDQorCWlmICghcmV0KQ0KKwkJZ290byBleGl0Ow0KKw0KKwlpZiAoZ2dfc2Vs
ZWN0X2NhcmRfc3BlYyhob3N0KSA9PSAwKQ0KKwkJY2FyZF9yZXQgPSBUUlVFOw0KKwllbHNlDQor
CQljYXJkX3JldCA9IEZBTFNFOw0KKw0KKwlpZiAoIXJkX3JldCkNCisJCXByX2VycigiQkhUIEVS
UjpHR0MgcmVhZCBzdGF0dXMgZXJyb3JcbiIpOw0KKw0KK2V4aXQ6DQorCWlmICghY2FyZF9yZXQp
IHsNCisJCXByX2VycigiQkhUIEVSUjpHR0MgRW11bGF0b3IgZXhpdCBGYWlsISFcbiIpOw0KKwkJ
cmV0ID0gRkFMU0U7DQorCX0NCisNCisJaWYgKGNhcmRfc3RhdHVzKQ0KKwkJKmNhcmRfc3RhdHVz
ID0gcmV0Ow0KKw0KKwlpZiAocmVhZF9zdGF0dXMpDQorCQkqcmVhZF9zdGF0dXMgPSByZF9yZXQ7
DQorDQorCWlmIChyZF9yZXQgJiYgIXJldCkNCisJCXByX2VycigiQkhUIEVSUjpkYXRhIHJlYWQg
b2ssIGJ1dCBleGl0IE5HXG4iKTsNCisJZWxzZSBpZiAoIXJkX3JldCAmJiByZXQpDQorCQlwcl9l
cnIoIkJIVCBFUlI6ZGF0YSByZWFkIE5HLCBidXQgZXhpdCBva1xuIik7DQorDQorCXJldHVybiBy
ZXQ7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9zdGF0dXNfYml0XzJfYnQoaW50IHRhciwgaW50ICpi
eXQsIGludCAqYml0KQ0KK3sNCisJKmJ5dCA9IHRhciAvIDg7DQorCSpiaXQgPSB0YXIgJSA4Ow0K
K30NCisNCitzdGF0aWMgdTMyIF9yZWFkX3N0YXR1c19kYXRhX3JlYWRfcmVnaXN0ZXIodTggKmNm
Zywgc3RydWN0IHRfZ2dfcmVnX3N0cnQgKmJ0cykNCit7DQorCXUzMiBydiA9IDA7DQorCXUzMiBt
c2sgPSBidHMtPm1hc2s7DQorCWludCBieXQgPSAwLCBiaXQgPSAwOw0KKwlpbnQgaSA9IDA7DQor
DQorCWRvIHsNCisJCV9zdGF0dXNfYml0XzJfYnQoYnRzLT5vZnMgKyBpLCAmYnl0LCAmYml0KTsN
CisJCWlmIChjZmdbYnl0XSAmICgxIDw8IGJpdCkpDQorCQkJcnYgfD0gMSA8PCBpOw0KKw0KKwkJ
aSsrOw0KKwkJbXNrID4+PSAxOw0KKwkJaWYgKG1zayA9PSAwKQ0KKwkJCWJyZWFrOw0KKwl9IHdo
aWxlICgxKTsNCisJcmV0dXJuIHJ2Ow0KK30NCisNCitzdGF0aWMgYm9vbCBnZ2NfcmVhZF9yZWdp
c3RlcnNfZXh0KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LA0KKwkJYm9vbCAqY2FyZF9zdGF0dXMs
IGJvb2wgKnJlYWRfc3RhdHVzLA0KKwkJc3RydWN0IHRfZ2dfcmVnX3N0cnQgKmdnX3JlZ19hcnIs
IHU4IG51bSkNCit7DQorCXU4IGdldF9pZHggPSAwOw0KKwlib29sIHJldCA9IEZBTFNFOw0KKwlz
dHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQor
CXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKnZlbmRvcl9ob3N0ID0gc2RoY2lfcGx0Zm1f
cHJpdihwbHRmbV9ob3N0KTsNCisJc3RydWN0IGdnY19wbGF0Zm9ybV90ICpnZ2MgPSAmdmVuZG9y
X2hvc3QtPmdnYzsNCisNCisJaWYgKHJlYWRfc3RhdHVzKQ0KKwkJKnJlYWRfc3RhdHVzID0gRkFM
U0U7DQorCWlmIChjYXJkX3N0YXR1cykNCisJCSpjYXJkX3N0YXR1cyA9IEZBTFNFOw0KKw0KKwlt
ZW1zZXQoZ2djLT5fY3VyX3JlYWRfYnVmLCAwLCA1MTIpOw0KKwlyZXQgPSBnZ19lbXVsYXRvcl9y
ZWFkX2V4dChob3N0LCBjYXJkX3N0YXR1cywgcmVhZF9zdGF0dXMsIGdnYy0+X2N1cl9yZWFkX2J1
ZiwgNTEyKTsNCisJaWYgKHJlYWRfc3RhdHVzID09IEZBTFNFKQ0KKwkJZ290byBleGl0Ow0KKw0K
Kwlmb3IgKGdldF9pZHggPSAwOyBnZXRfaWR4IDwgbnVtOyBnZXRfaWR4KyspDQorCQkoZ2dfcmVn
X2FyciArIGdldF9pZHgpLT52YWx1ZSA9DQorCQkJX3JlYWRfc3RhdHVzX2RhdGFfcmVhZF9yZWdp
c3RlcihnZ2MtPl9jdXJfcmVhZF9idWYsIChnZ19yZWdfYXJyICsgZ2V0X2lkeCkpOw0KKw0KK2V4
aXQ6DQorCXJldHVybiByZXQ7DQorfQ0KKw0KK3N0YXRpYyBib29sIGdnX2VtdWxhdG9yX3JlYWQo
c3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsIHU4ICpkYXRhLCB1MzIgZGF0YWxlbikNCit7DQorCWJv
b2wgcmV0ID0gRkFMU0U7DQorCWJvb2wgcmRfcmV0ID0gRkFMU0U7DQorDQorCXJldCA9IGVudGVy
X2V4aXRfZW11bGF0b3JfbW9kZShob3N0LCBUUlVFKTsNCisJaWYgKHJldCkNCisJCWdvdG8gZXhp
dDsNCisNCisJcmRfcmV0ID0gX2dnX2VtdWxhdG9yX3JlYWRfb25seShob3N0LCBkYXRhLCBkYXRh
bGVuKTsNCisNCisJcmV0ID0gZW50ZXJfZXhpdF9lbXVsYXRvcl9tb2RlKGhvc3QsIEZBTFNFKTsN
CisJaWYgKHJldCkNCisJCWdvdG8gZXhpdDsNCisNCisJcmV0ID0gZ2dfc2VsZWN0X2NhcmRfc3Bl
Yyhob3N0KTsNCisNCitleGl0Og0KKwlpZiAocmRfcmV0KQ0KKwkJcHJfZXJyKCJCSFQgRVJSOkdH
QyByZWFkIHN0YXR1cyBlcnJvclxuIik7DQorDQorCWlmIChyZXQpDQorCQlwcl9lcnIoIkJIVCBF
UlI6R0dDIEVtdWxhdG9yIGV4aXQgRmFpbCEhXG4iKTsNCisNCisJaWYgKHJkX3JldCA9PSAwICYm
IHJldCkgew0KKwkJcHJfZXJyKCJCSFQgRVJSOmRhdGEgcmVhZCBvaywgYnV0IGV4aXQgTkdcbiIp
Ow0KKwkJcmV0ID0gMDsNCisJfQ0KKw0KKwlpZiAocmRfcmV0ICYmIHJldCA9PSAwKSB7DQorCQlw
cl9lcnIoIkJIVCBFUlI6ZGF0YSByZWFkIE5HLCBidXQgZXhpdCBva1xuIik7DQorCQlyZXQgPSAt
MTsNCisJfQ0KKw0KKwlyZXR1cm4gcmV0ID8gRkFMU0UgOiBUUlVFOw0KK30NCisNCitzdGF0aWMg
Ym9vbCBfZ2djX2VtdWxhdG9yX3dyaXRlX29ubHkoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsDQor
CQkJCSAgICAgdTggKmluX2RhdGEsIHUzMiBkYXRhbGVuKQ0KK3sNCisJc3RydWN0IG1tY19ob3N0
ICptbWMgPSBob3N0LT5tbWM7DQorCWludCByYyA9IDA7DQorCXU4ICpkYXRhMSA9IGt6YWxsb2Mo
UEFHRV9TSVpFLCBHRlBfS0VSTkVMKTsNCisJc3RydWN0IG1tY19yZXF1ZXN0IG1ycSA9IHsgMCB9
Ow0KKwlzdHJ1Y3QgbW1jX2NvbW1hbmQgY21kID0geyAwIH07DQorCXN0cnVjdCBtbWNfZGF0YSBk
YXRhID0geyAwIH07DQorCXN0cnVjdCBzY2F0dGVybGlzdCBzZzsNCisJc3RydWN0IHNkaGNpX3Bs
dGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lf
bXNtX2JheWh1Yl9ob3N0ICp2ZW5kb3JfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9z
dCk7DQorDQorCWlmICghZGF0YTEpIHsNCisJCXByX2VycigiQkhUIE1TRzpnZyB3cml0ZSBubyBt
ZW1vcnlcbiIpOw0KKwkJcmMgPSAtRU5PTUVNOw0KKwkJZ290byBvdXQ7DQorCX0NCisNCisJbWVt
Y3B5KGRhdGExLCBpbl9kYXRhLCBkYXRhbGVuKTsNCisJc2dfaW5pdF9vbmUoJnNnLCBkYXRhMSwg
NTEyKTsNCisNCisJY21kLm9wY29kZSA9IE1NQ19XUklURV9CTE9DSzsNCisJY21kLmFyZyA9IDA7
DQorCWNtZC5mbGFncyA9IE1NQ19SU1BfUjEgfCBNTUNfQ01EX0FEVEM7DQorCWRhdGEuYmxrc3og
PSA1MTI7DQorCWRhdGEuYmxvY2tzID0gMTsNCisJZGF0YS5mbGFncyA9IE1NQ19EQVRBX1dSSVRF
Ow0KKwlkYXRhLnRpbWVvdXRfbnMgPSAxMDAwICogMTAwMCAqIDEwMDA7DQorCWRhdGEuc2cgPSAm
c2c7DQorCWRhdGEuc2dfbGVuID0gMTsNCisJbXJxLmNtZCA9ICZjbWQ7DQorCW1ycS5kYXRhID0g
JmRhdGE7DQorCW1ycS5zdG9wID0gTlVMTDsNCisNCisJbW1jX3dhaXRfZm9yX3JlcShtbWMsICZt
cnEpOw0KKw0KKwlpZiAoY21kLmVycm9yID09IC1FSUxTRVEpDQorCQl2ZW5kb3JfaG9zdC0+Z2dj
LnNkcjUwX25vdHVuaW5nX2NyY19lcnJvcl9mbGFnID0gMTsNCisNCisJa2ZyZWUoZGF0YTEpOw0K
K291dDoNCisJcmV0dXJuIHJjOw0KK30NCisNCitzdGF0aWMgYm9vbCBnZ19lbXVsYXRvcl93cml0
ZShzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgdTggKmRhdGEsIHUzMiBkYXRhbGVuKQ0KK3sNCisJ
Ym9vbCByZXQgPSBGQUxTRTsNCisJYm9vbCB3cl9yZXQgPSBGQUxTRTsNCisJdTMyIGkgPSAwOw0K
Kwl1MzIgcmVnOw0KKw0KKwlyZXQgPSBlbnRlcl9leGl0X2VtdWxhdG9yX21vZGUoaG9zdCwgVFJV
RSk7DQorCWlmIChyZXQpDQorCQlnb3RvIGV4aXQ7DQorDQorCXByX2RlYnVnKCJCSFQgTVNHOiBk
dW1wIGNvbmZpZyBkYXRhXG4iKTsNCisJZm9yIChpID0gMDsgaSA8IChkYXRhbGVuL3NpemVvZih1
MzIpKTsgaSsrKQl7DQorCQltZW1jcHkoJnJlZywgZGF0YStpKnNpemVvZih1MzIpLCBzaXplb2Yo
dTMyKSk7DQorCQlwcl9kZWJ1ZygiQkhUIE1TRzpcdGdnY19yZWczMlslMDNkXT0weCUwOHhcbiIs
IGksIHJlZyk7DQorCX0NCisNCisJX2dnY19lbXVsYXRvcl93cml0ZV9vbmx5KGhvc3QsIGRhdGEs
IGRhdGFsZW4pOw0KKwl3cl9yZXQgPSBUUlVFOw0KKw0KKwlyZXQgPSBlbnRlcl9leGl0X2VtdWxh
dG9yX21vZGUoaG9zdCwgRkFMU0UpOw0KKwlpZiAocmV0KQ0KKwkJZ290byBleGl0Ow0KKw0KKwly
ZXQgPSBnZ19zZWxlY3RfY2FyZF9zcGVjKGhvc3QpOw0KKw0KK2V4aXQ6DQorCWlmICh3cl9yZXQg
PT0gRkFMU0UpDQorCQlyZXQgPSBGQUxTRTsNCisNCisJaWYgKHJldCA9PSBGQUxTRSkNCisJCXBy
X2VycigiQkhUIEVSUjolczogR0dDIEVtdWxhdG9yIFdyaXRlIEZhaWwhIVxuIiwgX19mdW5jX18p
Ow0KKw0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgYm9vbCBnZXRfZ2dfcmVnX2N1cihz
dHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgdTggKmRhdGEsDQorCQkgICAgc3RydWN0IHRfZ2dfcmVn
X3N0cnQgKmdnX3JlZ19hcnIsIHU4IG51bSkNCit7DQorCXU4IGdldF9pZHggPSAwOw0KKwlib29s
IHJldCA9IEZBTFNFOw0KKw0KKwkvKiByZWFkIGdnYyByZWdpc3RlciAqLw0KKwltZW1zZXQoZGF0
YSwgMCwgNTEyKTsNCisJcmV0ID0gZ2dfZW11bGF0b3JfcmVhZChob3N0LCBkYXRhLCA1MTIpOw0K
Kw0KKwlpZiAocmV0ID09IEZBTFNFKQ0KKwkJZ290byBleGl0Ow0KKw0KKwkvKiByZWFkIHRoZSBv
ZmZzZXQgYml0cyB2YWx1ZSAqLw0KKwlmb3IgKGdldF9pZHggPSAwOyBnZXRfaWR4IDwgbnVtOyBn
ZXRfaWR4KyspIHsNCisJCShnZ19yZWdfYXJyICsgZ2V0X2lkeCktPnZhbHVlID0NCisJCSAgICBy
ZWFkX3JhbV9iaXRzX29mc19tYXNrKGRhdGEsIChnZ19yZWdfYXJyICsgZ2V0X2lkeCkpOw0KKwl9
DQorZXhpdDoNCisJcmV0dXJuIHJldDsNCit9DQorDQorc3RhdGljIHZvaWQgY2hnX2dnX3JlZ19j
dXJfdmFsKHN0cnVjdCBnZ2NfcGxhdGZvcm1fdCAgKmdnYywgdTggKmRhdGEsDQorCXN0cnVjdCB0
X2dnX3JlZ19zdHJ0ICpnZ19yZWdfYXJyLCB1OCBudW0sIGJvb2wgYl9zYXZfY2hnKQ0KK3sNCisJ
dTggY2hnX2lkeCA9IDA7DQorDQorCWZvciAoY2hnX2lkeCA9IDA7IGNoZ19pZHggPCBudW07IGNo
Z19pZHgrKykgew0KKwkJLyogbW9kaWZ5IHRoZSBnZ2MgcmVnaXN0ZXIgYml0IHZhbHVlICovDQor
CQljZmdfd3JpdGVfYml0c19vZnNfbWFzayhkYXRhLCAoZ2dfcmVnX2FyciArIGNoZ19pZHgpLA0K
KwkJCQkJKGdnX3JlZ19hcnIgKyBjaGdfaWR4KS0+dmFsdWUpOw0KKwl9DQorDQorCWlmIChiX3Nh
dl9jaGcpDQorCQlzZXRfZ2dfcmVnX2N1cl92YWwoZ2djLCBkYXRhLCA2NCk7DQorfQ0KKw0KK3N0
YXRpYyB2b2lkIGxvZ19iaW4odTMyIG4pDQorew0KKwlpbnQgaSA9IDA7DQorCXU4IHRiWzMzXSA9
IHsgMCB9Ow0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgMzI7IGkrKykgew0KKwkJaWYgKG4gJiAoMSA8
PCBpKSkNCisJCQl0YltpXSA9ICcxJzsNCisJCWVsc2UNCisJCQl0YltpXSA9ICcwJzsNCisJfQ0K
Kwlwcl9kZWJ1ZygiQkhUIE1TRzpiaW46JXNcbiIsIHRiKTsNCit9DQorDQorc3RhdGljIHZvaWQg
cGhhc2Vfc3RyKHU4ICp0YiwgdTMyIG4pDQorew0KKwlpbnQgaSA9IDA7DQorDQorCWZvciAoaSA9
IDA7IGkgPCBUVU5JTkdfUEhBU0VfU0laRTsgaSsrKSB7DQorCQlpZiAobiAmICgxIDw8IGkpKQ0K
KwkJCXRiW2ldID0gJzEnOw0KKwkJZWxzZQ0KKwkJCXRiW2ldID0gJzAnOw0KKwl9DQorCXRiW1RV
TklOR19QSEFTRV9TSVpFXSA9IDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgZ2V0X2JpdF9udW1iZXIo
dTMyIG4pDQorew0KKwlpbnQgaSA9IDA7DQorCWludCBjbnQgPSAwOw0KKw0KKwlmb3IgKGkgPSAw
OyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykgew0KKwkJaWYgKG4gJiAoMSA8PCBpKSkNCisJ
CQljbnQrKzsNCisJfQ0KKwlyZXR1cm4gY250Ow0KK30NCisNCitzdGF0aWMgYm9vbCBnZ19lbXVs
YXRvcl93cml0ZV9leHQoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsIGJvb2wgKmNhcmRfc3RhdHVz
LCB1OCAqZGF0YSwgdTMyIGRhdGFsZW4pDQorew0KKwlib29sIHJldCA9IEZBTFNFOw0KKwlib29s
IHdyX3JldCA9IEZBTFNFOw0KKw0KKwlyZXQgPSBlbnRlcl9leGl0X2VtdWxhdG9yX21vZGUoaG9z
dCwgVFJVRSk7DQorCWlmIChyZXQpDQorCQlnb3RvIGV4aXQ7DQorDQorCV9nZ2NfZW11bGF0b3Jf
d3JpdGVfb25seShob3N0LCBkYXRhLCBkYXRhbGVuKTsNCisJd3JfcmV0ID0gVFJVRTsNCisNCisJ
cmV0ID0gZW50ZXJfZXhpdF9lbXVsYXRvcl9tb2RlKGhvc3QsIEZBTFNFKTsNCisJaWYgKHJldCkN
CisJCWdvdG8gZXhpdDsNCisNCisJcmV0ID0gKGdnX3NlbGVjdF9jYXJkX3NwZWMoaG9zdCkgPT0g
MCkgPyBUUlVFIDogRkFMU0U7DQorCWlmIChyZXQgPT0gRkFMU0UpIHsNCisJCWlmIChjYXJkX3N0
YXR1cykNCisJCQkqY2FyZF9zdGF0dXMgPSBGQUxTRTsNCisJfQ0KKw0KK2V4aXQ6DQorCWlmICh3
cl9yZXQgPT0gRkFMU0UpDQorCQlyZXQgPSBGQUxTRTsNCisNCisJaWYgKHJldCA9PSBGQUxTRSkN
CisJCXByX2VycigiQkhUIEVSUjolczogR0dDIEVtdWxhdG9yIFdyaXRlIEZhaWwhIVxuIiwgX19m
dW5jX18pOw0KKw0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgYm9vbCBnZ2Nfc2V0X291
dHB1dF90dW5pbmdfcGhhc2VfZXh0KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LA0KKwkJYm9vbCAq
Y2FyZF9zdGF0dXMsIGludCBzZWxhLCBpbnQgc2VsYikNCit7DQorCWJvb2wgcmV0ID0gVFJVRTsN
CisJdTggZGF0YVs1MTJdID0geyAwIH07DQorCXN0cnVjdCB0X2dnX3JlZ19zdHJ0IGdnX3JlZ19h
cnJbOF07DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJp
dihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPSBz
ZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKw0KKwlnZXRfZ2dfcmVnX2N1cl92YWwoJnZl
bmRvcl9ob3N0LT5nZ2MsIGRhdGEsIDY0KTsNCisJbWVtY3B5KCZnZ19yZWdfYXJyWzBdLCAmdmVu
ZG9yX2hvc3QtPmdnYy5kbGxfc2VsYV8xMDBtX2NmZywNCisJCQlzaXplb2Yoc3RydWN0IHRfZ2df
cmVnX3N0cnQpKTsNCisJbWVtY3B5KCZnZ19yZWdfYXJyWzFdLCAmdmVuZG9yX2hvc3QtPmdnYy5k
bGxfc2VsYV8yMDBtX2NmZywNCisJCQlzaXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJ
bWVtY3B5KCZnZ19yZWdfYXJyWzJdLCAmdmVuZG9yX2hvc3QtPmdnYy5kbGxfc2VsYl8xMDBtX2Nm
ZywNCisJCQlzaXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZnZ19yZWdf
YXJyWzNdLCAmdmVuZG9yX2hvc3QtPmdnYy5kbGxfc2VsYl8yMDBtX2NmZywNCisJCQlzaXplb2Yo
c3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZnZ19yZWdfYXJyWzRdLCAmdmVuZG9y
X2hvc3QtPmdnYy5kbGxfc2VsYl8xMDBtX2NmZ19lbiwNCisJCQlzaXplb2Yoc3RydWN0IHRfZ2df
cmVnX3N0cnQpKTsNCisJbWVtY3B5KCZnZ19yZWdfYXJyWzVdLCAmdmVuZG9yX2hvc3QtPmdnYy5k
bGxfc2VsYl8yMDBtX2NmZ19lbiwNCisJCQlzaXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsN
CisJbWVtY3B5KCZnZ19yZWdfYXJyWzZdLCAmdmVuZG9yX2hvc3QtPmdnYy5pbnRlcm5sX3R1bmlu
Z19lbl8xMDBtLA0KKwkJICBzaXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5
KCZnZ19yZWdfYXJyWzddLCAmdmVuZG9yX2hvc3QtPmdnYy5pbnRlcm5sX3R1bmluZ19lbl8yMDBt
LA0KKwkJICBzaXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJZ2dfcmVnX2FyclswXS52
YWx1ZSA9IHNlbGE7DQorCWdnX3JlZ19hcnJbMV0udmFsdWUgPSBzZWxhOw0KKwlnZ19yZWdfYXJy
WzJdLnZhbHVlID0gc2VsYjsNCisJZ2dfcmVnX2FyclszXS52YWx1ZSA9IHNlbGI7DQorCWdnX3Jl
Z19hcnJbNF0udmFsdWUgPSAxOw0KKwlnZ19yZWdfYXJyWzVdLnZhbHVlID0gMTsNCisJZ2dfcmVn
X2Fycls2XS52YWx1ZSA9IDE7DQorCWdnX3JlZ19hcnJbN10udmFsdWUgPSAxOw0KKwlpZiAoY2Fy
ZF9zdGF0dXMpDQorCQkqY2FyZF9zdGF0dXMgPSBUUlVFOw0KKwljaGdfZ2dfcmVnX2N1cl92YWwo
JnZlbmRvcl9ob3N0LT5nZ2MsIGRhdGEsIGdnX3JlZ19hcnIsIDgsIFRSVUUpOw0KKwlyZXQgPSBn
Z19lbXVsYXRvcl93cml0ZV9leHQoaG9zdCwgY2FyZF9zdGF0dXMsIGRhdGEsIDUxMik7DQorCXJl
dHVybiByZXQ7DQorfQ0KKw0KK3N0YXRpYyBib29sIGdnX2ZpeF9vdXRwdXRfdHVuaW5nX3BoYXNl
KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LCBpbnQgc2VsYSwgaW50IHNlbGIpDQorew0KKwl1OCBk
YXRhWzUxMl0gPSB7IDAgfTsNCisJc3RydWN0IHRfZ2dfcmVnX3N0cnQgZ2dfcmVnX2FyclsxMF07
DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0
KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPSBzZGhjaV9w
bHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKw0KKwlwcl9kZWJ1ZygiQkhUIE1TRzogJXMgLSBzZWxh
IGRsbDogJXgsIHNlbGIgZGxsOiAleFxuIiwgX19mdW5jX18sIHNlbGEsDQorCQlzZWxiKTsNCisN
CisJZ2V0X2dnX3JlZ19jdXJfdmFsKCZ2ZW5kb3JfaG9zdC0+Z2djLCBkYXRhLCA2NCk7DQorDQor
CW1lbWNweSgmZ2dfcmVnX2FyclswXSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxsX3NlbGFfMTAwbV9j
ZmcsDQorCQkJc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVn
X2FyclsxXSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxsX3NlbGFfMjAwbV9jZmcsDQorCQkJc2l6ZW9m
KHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVnX2FyclsyXSwgJnZlbmRv
cl9ob3N0LT5nZ2MuZGxsX3NlbGJfMTAwbV9jZmcsDQorCQkJc2l6ZW9mKHN0cnVjdCB0X2dnX3Jl
Z19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVnX2FyclszXSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxs
X3NlbGJfMjAwbV9jZmcsDQorCQkJc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1l
bWNweSgmZ2dfcmVnX2Fycls0XSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxsX3NlbGJfMTAwbV9jZmdf
ZW4sDQorCQkJc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVn
X2Fycls1XSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxsX3NlbGJfMjAwbV9jZmdfZW4sDQorCQkJc2l6
ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVnX2Fycls2XSwgJnZl
bmRvcl9ob3N0LT5nZ2MuaW50ZXJubF90dW5pbmdfZW5fMTAwbSwNCisJCSAgc2l6ZW9mKHN0cnVj
dCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVnX2Fycls3XSwgJnZlbmRvcl9ob3N0
LT5nZ2MuaW50ZXJubF90dW5pbmdfZW5fMjAwbSwNCisJCSAgc2l6ZW9mKHN0cnVjdCB0X2dnX3Jl
Z19zdHJ0KSk7DQorCWdnX3JlZ19hcnJbMF0udmFsdWUgPSBzZWxhOw0KKwlnZ19yZWdfYXJyWzFd
LnZhbHVlID0gc2VsYTsNCisJZ2dfcmVnX2FyclsyXS52YWx1ZSA9IHNlbGI7DQorCWdnX3JlZ19h
cnJbM10udmFsdWUgPSBzZWxiOw0KKwlnZ19yZWdfYXJyWzRdLnZhbHVlID0gMTsNCisJZ2dfcmVn
X2Fycls1XS52YWx1ZSA9IDE7DQorCWdnX3JlZ19hcnJbNl0udmFsdWUgPSAwOw0KKwlnZ19yZWdf
YXJyWzddLnZhbHVlID0gMDsNCisNCisJY2hnX2dnX3JlZ19jdXJfdmFsKCZ2ZW5kb3JfaG9zdC0+
Z2djLCBkYXRhLCBnZ19yZWdfYXJyLCA4LCBUUlVFKTsNCisNCisJcmV0dXJuIGdnX2VtdWxhdG9y
X3dyaXRlKGhvc3QsIGRhdGEsIDUxMik7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGdlbl9hcnJheV9k
YXRhKHUzMiBsb3czMiwgdTMyIGhpZ2gzMiwgdTMyICpwdHcpDQorew0KKwl1OCB0dV9yZXNfcGVy
WzZdW1RVTklOR19QSEFTRV9TSVpFXTsNCisJdTggaSA9IDAsIGogPSAwOw0KKwl1OCBpX21vZGUg
PSAwOw0KKwl1MzIgdHcgPSAwOw0KKw0KKwltZW1zZXQodHVfcmVzX3BlciwgMSwgc2l6ZW9mKHR1
X3Jlc19wZXIpKTsNCisJZm9yIChpID0gMDsgaSA8IDY0OyBpKyspIHsNCisJCXUzMiB0bXBfZGF0
YSA9IChpIDwgMzIpID8gbG93MzIgOiBoaWdoMzI7DQorDQorCQl0dV9yZXNfcGVyW2kgLyBUVU5J
TkdfUEhBU0VfU0laRV1baSAlIFRVTklOR19QSEFTRV9TSVpFXSA9DQorCQkgICAgKHRtcF9kYXRh
ICYgKDEgPDwgKGkgJSAzMikpKSA+PiAoaSAlIDMyKTsNCisJfQ0KKw0KKwlmb3IgKGlfbW9kZSA9
IDA7IGlfbW9kZSA8IFRVTklOR19QSEFTRV9TSVpFOyBpX21vZGUrKykgew0KKwkJZm9yIChqID0g
MDsgaiA8IDY7IGorKykgew0KKwkJCWlmICh0dV9yZXNfcGVyW2pdW2lfbW9kZV0gIT0gMCkNCisJ
CQkJdHcgfD0gKDEgPDwgaV9tb2RlKTsNCisJCQllbHNlIHsNCisJCQkJdHcgJj0gfigxIDw8IGlf
bW9kZSk7DQorCQkJCWJyZWFrOw0KKwkJCX0NCisJCX0NCisJfQ0KKwlpZiAocHR3KQ0KKwkJKnB0
dyA9IHR3Ow0KK30NCisNCitzdGF0aWMgYm9vbCBzd19jYWxjX3R1bmluZ19yZXN1bHQoc3RydWN0
IHNkaGNpX2hvc3QgKmhvc3QsIHUzMiAqdHhfc2VsYiwNCisJCQkgICB1MzIgKmFsbF9zZWxiLCB1
NjQgKnJhd190eF9zZWxiKQ0KK3sNCisJYm9vbCByZXQgPSBGQUxTRTsNCisJdTggZGF0YVs1MTJd
ID0geyAwIH07DQorCXUzMiBzZWxiX3N0YXR1c190eF9sb3czMiA9IDAsIHNlbGJfc3RhdHVzX3R4
X2hpZ2gzMiA9IDA7DQorCXUzMiBzZWxiX3N0YXR1c19nZ2NfbG93MzIgPSAwLCBzZWxiX3N0YXR1
c19nZ2NfaGlnaDMyID0gMDsNCisJc3RydWN0IHRfZ2dfcmVnX3N0cnQgZ2dfcmVnX2Fycls2XTsN
CisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3Qp
Ow0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICp2ZW5kb3JfaG9zdCA9IHNkaGNpX3Bs
dGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQorCW1lbWNweSgmZ2dfcmVnX2FyclswXSwgJnZlbmRv
cl9ob3N0LT5nZ2MucGhhX3N0YXNfdHhfbG93MzIsIHNpemVvZihzdHJ1Y3QgdF9nZ19yZWdfc3Ry
dCkpOw0KKwltZW1jcHkoJmdnX3JlZ19hcnJbMV0sICZ2ZW5kb3JfaG9zdC0+Z2djLnBoYV9zdGFz
X3R4X2hpZ2gzMiwgc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2df
cmVnX2FyclsyXSwgJnZlbmRvcl9ob3N0LT5nZ2MucGhhX3N0YXNfcnhfbG93MzIsIHNpemVvZihz
dHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKwltZW1jcHkoJmdnX3JlZ19hcnJbM10sICZ2ZW5kb3Jf
aG9zdC0+Z2djLnBoYV9zdGFzX3J4X2hpZ2gzMiwgc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0
KSk7DQorCW1lbWNweSgmZ2dfcmVnX2Fycls0XSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxsX3NlbGFf
YWZ0ZXJfbWFzaywgc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2df
cmVnX2Fycls1XSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxsX3NlbGJfYWZ0ZXJfbWFzaywgc2l6ZW9m
KHN0cnVjdCB0X2dnX3JlZ19zdHJ0KSk7DQorDQorCXJldCA9IGdldF9nZ19yZWdfY3VyKGhvc3Qs
IGRhdGEsIGdnX3JlZ19hcnIsIDYpOw0KKw0KKwlpZiAocmV0ID09IFRSVUUpIHsNCisJCXNlbGJf
c3RhdHVzX3R4X2xvdzMyID0gZ2dfcmVnX2FyclswXS52YWx1ZTsNCisJCXByX2RlYnVnKCJCSFQg
TVNHOlsyMDUtMjM2XTpcbiIpOw0KKwkJbG9nX2JpbihzZWxiX3N0YXR1c190eF9sb3czMik7DQor
CQlzZWxiX3N0YXR1c190eF9oaWdoMzIgPSBnZ19yZWdfYXJyWzFdLnZhbHVlOw0KKwkJcHJfZGVi
dWcoIkJIVCBNU0c6WzIzNy0yNjhdOlxuIik7DQorCQlsb2dfYmluKHNlbGJfc3RhdHVzX3R4X2hp
Z2gzMik7DQorCQlzZWxiX3N0YXR1c19nZ2NfbG93MzIgPSBnZ19yZWdfYXJyWzJdLnZhbHVlOw0K
KwkJcHJfZGVidWcoIkJIVCBNU0c6WzE0LTQ1XTpcbiIpOw0KKwkJbG9nX2JpbihzZWxiX3N0YXR1
c19nZ2NfbG93MzIpOw0KKwkJc2VsYl9zdGF0dXNfZ2djX2hpZ2gzMiA9IGdnX3JlZ19hcnJbM10u
dmFsdWU7DQorCQlwcl9kZWJ1ZygiQkhUIE1TRzpbNDYtNzddOlxuIik7DQorCQlsb2dfYmluKHNl
bGJfc3RhdHVzX2dnY19oaWdoMzIpOw0KKwkJcHJfZGVidWcoIkJIVCBNU0c6ZGxsIHNlbGEgYWZ0
ZXIgbWFzaz0leGhcbiIsIGdnX3JlZ19hcnJbNF0udmFsdWUpOw0KKwkJcHJfZGVidWcoIkJIVCBN
U0c6ZGxsIHNlbGIgYWZ0ZXIgbWFzaz0leGhcbiIsIGdnX3JlZ19hcnJbNV0udmFsdWUpOw0KKw0K
KwkJaWYgKHJhd190eF9zZWxiKSB7DQorCQkJKnJhd190eF9zZWxiID0gZ2dfcmVnX2FyclsxXS52
YWx1ZTsNCisJCQkoKnJhd190eF9zZWxiKSA8PD0gMzI7DQorCQkJKnJhd190eF9zZWxiICs9IGdn
X3JlZ19hcnJbMF0udmFsdWU7DQorCQkJcHJfZGVidWcoIkJIVCBNU0c6cmF3X3R4X3NlbGI6JWxs
eGhcbiIsICpyYXdfdHhfc2VsYik7DQorCQl9DQorDQorCQlpZiAodHhfc2VsYikgew0KKwkJCWdl
bl9hcnJheV9kYXRhKGdnX3JlZ19hcnJbMF0udmFsdWUsIGdnX3JlZ19hcnJbMV0udmFsdWUsDQor
CQkJCSAgICAgICB0eF9zZWxiKTsNCisJCQlwcl9kZWJ1ZygiQkhUIE1TRzp0eF9zZWxiOiV4aFxu
IiwgKnR4X3NlbGIpOw0KKwkJfQ0KKwkJaWYgKGFsbF9zZWxiKSB7DQorCQkJZ2VuX2FycmF5X2Rh
dGEoZ2dfcmVnX2FyclsyXS52YWx1ZSwgZ2dfcmVnX2FyclszXS52YWx1ZSwNCisJCQkJICAgICAg
IGFsbF9zZWxiKTsNCisJCQlwcl9kZWJ1ZygiQkhUIE1TRzphbGxfc2VsYjoleGhcbiIsICphbGxf
c2VsYik7DQorCQl9DQorCX0NCisNCisJcmV0dXJuIHJldDsNCit9DQorDQorc3RhdGljIGJvb2wg
Z2dfdHVuaW5nX3Jlc3VsdChzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgdTMyICp0eF9zZWxiLCB1
MzIgKmFsbF9zZWxiLA0KKwkJCXU2NCAqcmF3X3R4X3NlbGIpDQorew0KKwlob3N0X2NtZGRhdF9s
aW5lX3Jlc2V0KGhvc3QpOw0KKwlyZXR1cm4gc3dfY2FsY190dW5pbmdfcmVzdWx0KGhvc3QsIHR4
X3NlbGIsIGFsbF9zZWxiLCByYXdfdHhfc2VsYik7DQorfQ0KKw0KK3N0YXRpYyB1NjQgR0VORVJB
VEVfNjRfSURYX1ZBTFVFKGludCBzZnQpDQorew0KKwl1NjQgdmFsID0gMTsNCisNCisJcmV0dXJu
IHZhbCA8PCBzZnQ7DQorfQ0KKw0KK3N0YXRpYyBib29sIGlzX2J1c19tb2RlX3NkcjEwNChzdHJ1
Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCWJvb2wgcmV0ID0gRkFMU0U7DQorDQorCWlmICho
b3N0LT50aW1pbmcgPT0gTU1DX1RJTUlOR19VSFNfU0RSMTA0KQ0KKwkJcmV0ID0gVFJVRTsNCisN
CisJcmV0dXJuIHJldDsNCit9DQorDQorc3RhdGljIGJvb2wgX2NoZWNrX2J1c19tb2RlKHN0cnVj
dCBzZGhjaV9ob3N0ICpob3N0KQ0KK3sNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZt
X2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0
ICp2ZW5kb3JfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorCXN0cnVjdCBn
Z2NfcGxhdGZvcm1fdCAqZ2djID0gJnZlbmRvcl9ob3N0LT5nZ2M7DQorDQorCWlmIChpc19idXNf
bW9kZV9zZHIxMDQoaG9zdCkpDQorCQlnZ2MtPmN1cl9idXNfbW9kZSA9ICZ2ZW5kb3JfaG9zdC0+
Z2djLnNkcjEwNDsNCisJZWxzZQ0KKwkJZ2djLT5jdXJfYnVzX21vZGUgPSAmdmVuZG9yX2hvc3Qt
PmdnYy5zZHI1MDsNCisNCisJcmV0dXJuIHRydWU7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIHR4X3Nl
bGJfZmFpbGVkX2hpc3RvcnlfdXBkYXRlKHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LCB1MzIgdmFs
KQ0KK3sNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2
KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICp2ZW5kb3JfaG9zdCA9IHNk
aGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQorCV9jaGVja19idXNfbW9kZShob3N0KTsN
CisNCisJdmVuZG9yX2hvc3QtPmdnYy5jdXJfYnVzX21vZGUtPnR4X3NlbGJfZmFpbGVkX2hpc3Rv
cnkgJj0gdmFsOw0KK30NCisNCitzdGF0aWMgdTMyIHR4X3NlbGJfZmFpbGVkX2hpc3RvcnlfZ2V0
KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0KQ0KK3sNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3Qg
KnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1
Yl9ob3N0ICp2ZW5kb3JfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQor
CV9jaGVja19idXNfbW9kZShob3N0KTsNCisNCisJcmV0dXJuIHZlbmRvcl9ob3N0LT5nZ2MuY3Vy
X2J1c19tb2RlLT50eF9zZWxiX2ZhaWxlZF9oaXN0b3J5Ow0KK30NCisNCitzdGF0aWMgdm9pZCB0
eF9zZWxiX2ZhaWxlZF90Yl91cGRhdGUoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsIGludCBzZWxh
LCB1MzIgdmFsKQ0KK3sNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBz
ZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICp2ZW5kb3Jf
aG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQorCV9jaGVja19idXNfbW9k
ZShob3N0KTsNCisJdmVuZG9yX2hvc3QtPmdnYy5jdXJfYnVzX21vZGUtPnR4X3NlbGJfdGJbc2Vs
YV0gJj0gdmFsOw0KK30NCisNCitzdGF0aWMgdTMyIHR4X3NlbGJfZmFpbGVkX3RiX2dldChzdHJ1
Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgaW50IHNlbGEpDQorew0KKwlzdHJ1Y3Qgc2RoY2lfcGx0Zm1f
aG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0cnVjdCBzZGhjaV9tc21f
YmF5aHViX2hvc3QgKnZlbmRvcl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsN
CisJdTMyIHZhbHVlID0gMDsNCisNCisJX2NoZWNrX2J1c19tb2RlKGhvc3QpOw0KKw0KKwlpZiAo
aXNfYnVzX21vZGVfc2RyMTA0KGhvc3QpKQ0KKwkJdmFsdWUgPSB2ZW5kb3JfaG9zdC0+Z2djLnNk
cjEwNC50eF9zZWxiX3RiW3NlbGFdOw0KKwllbHNlDQorCQl2YWx1ZSA9IHZlbmRvcl9ob3N0LT5n
Z2Muc2RyNTAudHhfc2VsYl90YltzZWxhXTsNCisNCisJcmV0dXJuIHZhbHVlOw0KK30NCisNCitz
dGF0aWMgdm9pZCBhbGxfc2VsYl9mYWlsZWRfdGJfdXBkYXRlKHN0cnVjdCBzZGhjaV9ob3N0ICpo
b3N0LCBpbnQgc2VsYSwgdTMyIHZhbCkNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpw
bHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJf
aG9zdCAqdmVuZG9yX2hvc3QgPSBzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKw0KKwlf
Y2hlY2tfYnVzX21vZGUoaG9zdCk7DQorCXZlbmRvcl9ob3N0LT5nZ2MuY3VyX2J1c19tb2RlLT5h
bGxfc2VsYl90YltzZWxhXSAmPSB2YWw7DQorfQ0KKw0KK3N0YXRpYyB1MzIgYWxsX3NlbGJfZmFp
bGVkX3RiX2dldChzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgaW50IHNlbGEpDQorew0KKwlzdHJ1
Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0
cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKnZlbmRvcl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJp
dihwbHRmbV9ob3N0KTsNCisJdTMyIHZhbDsNCisNCisJX2NoZWNrX2J1c19tb2RlKGhvc3QpOw0K
Kw0KKwl2YWwgPSB2ZW5kb3JfaG9zdC0+Z2djLmN1cl9idXNfbW9kZS0+YWxsX3NlbGJfdGJbc2Vs
YV07DQorDQorCXJldHVybiB2YWw7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGNoa19waGFzZV93aW5k
b3codTggKnR1bmluZ193aW4sIHU4ICptaWRfdmFsLCB1OCAqbWF4X3Bhc3Nfd2luKQ0KK3sNCisJ
dTggdHVuaW5nX3Bhc3NbVFVOSU5HX1BIQVNFX1NJWkUgKyAzMl07DQorCXU4IHR1bmluZ19wYXNz
X3N0YXJ0W1RVTklOR19QSEFTRV9TSVpFICsgMzJdOw0KKwl1OCB0dW5pbmdfcGFzc19udW1fbWF4
ID0gMDsNCisJdTggZmlyc3RfMCA9IDA7DQorCXU4IGkgPSAwLCBqID0gMDsNCisJdTggaV9tb2Rl
ID0gMCwgc2VsYl9tb2RlID0gMDsNCisNCisJbWVtc2V0KHR1bmluZ19wYXNzLCAxLCBzaXplb2Yo
dHVuaW5nX3Bhc3MpKTsNCisJbWVtc2V0KHR1bmluZ19wYXNzX3N0YXJ0LCAxLCBzaXplb2YodHVu
aW5nX3Bhc3Nfc3RhcnQpKTsNCisNCisJZm9yIChpID0gMDsgaSA8IFRVTklOR19QSEFTRV9TSVpF
OyBpKyspIHsNCisJCWlmICh0dW5pbmdfd2luW2ldID09IDApIHsNCisJCQlmaXJzdF8wID0gaTsN
CisJCQlicmVhazsNCisJCX0NCisJfQ0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNF
X1NJWkU7IGkrKykgew0KKwkJaV9tb2RlID0gKGZpcnN0XzAgKyBpKSAlIFRVTklOR19QSEFTRV9T
SVpFOw0KKwkJaWYgKHR1bmluZ193aW5baV9tb2RlXSA9PSAxKQ0KKwkJCXR1bmluZ19wYXNzW2pd
Kys7DQorCQllbHNlIGlmICh0dW5pbmdfcGFzc1tqXSkNCisJCQlqKys7DQorCQlpZiAodHVuaW5n
X3Bhc3Nbal0gPT0gMSkNCisJCQl0dW5pbmdfcGFzc19zdGFydFtqXSA9IGlfbW9kZTsNCisJfQ0K
Kw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykgew0KKwkJaWYgKHR1
bmluZ19wYXNzX251bV9tYXggPCB0dW5pbmdfcGFzc1tpXSkgew0KKwkJCXR1bmluZ19wYXNzX251
bV9tYXggPSB0dW5pbmdfcGFzc1tpXTsNCisJCQlpX21vZGUgPSBpOw0KKwkJfQ0KKwl9DQorDQor
CWlmICh0dW5pbmdfcGFzc19udW1fbWF4ID09IDApDQorCQlwcl9lcnINCisJCSAgICAoIkdldCBt
YXggcGFzcyB3aW5kb3cgZmFpbCwgdGhlcmUgaXMgbm8gYW55IHBhc3MgcGhhc2UhIVxuIik7DQor
CWVsc2Ugew0KKwkJKm1heF9wYXNzX3dpbiA9IHR1bmluZ19wYXNzX251bV9tYXggLSAxOw0KKwkJ
dHVuaW5nX3Bhc3NfbnVtX21heCAvPSAyOw0KKwkJc2VsYl9tb2RlID0gdHVuaW5nX3Bhc3Nfc3Rh
cnRbaV9tb2RlXSArIHR1bmluZ19wYXNzX251bV9tYXg7DQorCQlpZiAoKCptYXhfcGFzc193aW4g
JSAyID09IDApKQ0KKwkJCXNlbGJfbW9kZSArPSAxOw0KKwkJc2VsYl9tb2RlICU9IFRVTklOR19Q
SEFTRV9TSVpFOw0KKwl9DQorDQorCSptaWRfdmFsID0gc2VsYl9tb2RlOw0KK30NCisNCitzdGF0
aWMgdm9pZCBkdW1wX2FycmF5KHU4ICp0YikNCit7DQorCWludCBpID0gMDsNCisJdTggc3RyWzEy
XSA9IHsgMCB9Ow0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykN
CisJCXN0cltpXSA9IHRiW2ldICsgJzAnOw0KK30NCisNCitzdGF0aWMgdm9pZCBiaXRzX2dlbmVy
YXRlX2FycmF5KHU4ICp0YiwgdTMyIHYpDQorew0KKwlpbnQgaSA9IDA7DQorDQorCWZvciAoaSA9
IDA7IGkgPCBUVU5JTkdfUEhBU0VfU0laRTsgaSsrKSB7DQorCQlpZiAoKHYgJiAoMSA8PCBpKSkp
DQorCQkJdGJbaV0gPSAxOw0KKwkJZWxzZQ0KKwkJCXRiW2ldID0gMDsNCisJfQ0KKwlkdW1wX2Fy
cmF5KHRiKTsNCit9DQorDQorc3RhdGljIHZvaWQgY2hrX2Fycl9tYXhfd2luKHU4ICp0dW5pbmdf
d2luLCB1OCBmaXJzdF9pLCB1OCAqbWlkX3ZhbCwNCisJCQkJdTggKmZpcnN0X3ZhbCwgdTggKm1h
eF9wYXNzX3dpbiwgc3RydWN0IGNoa190eXBlX3QgdHlwZSkNCit7DQorCXU4IHR1bmluZ19wYXNz
W1RVTklOR19QSEFTRV9TSVpFXTsNCisJdTggdHVuaW5nX3Bhc3Nfc3RhcnRbVFVOSU5HX1BIQVNF
X1NJWkVdOw0KKwl1OCB0dW5pbmdfcGFzc19udW1fbWF4ID0gMDsNCisJdTggZmlyc3RfMCA9IDA7
DQorCXU4IGkgPSAwLCBqID0gMDsNCisJdTggaV9tb2RlID0gMCwgc2VsYl9tb2RlID0gMDsNCisN
CisJbWVtc2V0KHR1bmluZ19wYXNzLCAxLCBzaXplb2YodHVuaW5nX3Bhc3MpKTsNCisJbWVtc2V0
KHR1bmluZ19wYXNzX3N0YXJ0LCAxLCBzaXplb2YodHVuaW5nX3Bhc3Nfc3RhcnQpKTsNCisNCisJ
aWYgKHR5cGUuZmlyc3RfdmFsaWQpDQorCQlmaXJzdF8wID0gZmlyc3RfaTsNCisJZWxzZSB7DQor
CQlmb3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykgew0KKwkJCWlmICh0dW5p
bmdfd2luW2ldID09IDApIHsNCisJCQkJZmlyc3RfMCA9IGk7DQorCQkJCWJyZWFrOw0KKwkJCX0N
CisJCX0NCisJfQ0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykg
ew0KKwkJaV9tb2RlID0gKGZpcnN0XzAgKyBpKSAlIFRVTklOR19QSEFTRV9TSVpFOw0KKwkJaWYg
KHR1bmluZ193aW5baV9tb2RlXSA9PSAxKQ0KKwkJCXR1bmluZ19wYXNzW2pdKys7DQorCQllbHNl
IGlmICh0dW5pbmdfcGFzc1tqXSkNCisJCQlqKys7DQorCQlpZiAodHVuaW5nX3Bhc3Nbal0gPT0g
MSkNCisJCQl0dW5pbmdfcGFzc19zdGFydFtqXSA9IGlfbW9kZTsNCisJfQ0KKw0KKwlmb3IgKGkg
PSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykgew0KKwkJaWYgKHR1bmluZ19wYXNzX251
bV9tYXggPCB0dW5pbmdfcGFzc1tpXSkgew0KKwkJCXR1bmluZ19wYXNzX251bV9tYXggPSB0dW5p
bmdfcGFzc1tpXTsNCisJCQlpX21vZGUgPSBpOw0KKwkJfQ0KKwl9DQorDQorCWlmICh0dW5pbmdf
cGFzc19udW1fbWF4ID09IDApDQorCQlwcl9lcnINCisJCSAgICAoIkdldCBtYXggcGFzcyB3aW5k
b3cgZmFpbCwgdGhlcmUgaXMgbm8gYW55IHBhc3MgcGhhc2UhIVxuIik7DQorCWVsc2Ugew0KKwkJ
Km1heF9wYXNzX3dpbiA9IHR1bmluZ19wYXNzX251bV9tYXggLSAxOw0KKwkJdHVuaW5nX3Bhc3Nf
bnVtX21heCAvPSAyOw0KKwkJaWYgKGZpcnN0X3ZhbCkNCisJCQkqZmlyc3RfdmFsID0gdHVuaW5n
X3Bhc3Nfc3RhcnRbaV9tb2RlXTsNCisJCXNlbGJfbW9kZSA9IHR1bmluZ19wYXNzX3N0YXJ0W2lf
bW9kZV0gKyB0dW5pbmdfcGFzc19udW1fbWF4Ow0KKwkJaWYgKCgqbWF4X3Bhc3Nfd2luICUgMiA9
PSAwKSAmJiAodHlwZS5yaWdodF92YWxpZCkNCisJCSAgICApDQorCQkJc2VsYl9tb2RlICs9IDE7
DQorCQlzZWxiX21vZGUgJT0gVFVOSU5HX1BIQVNFX1NJWkU7DQorCX0NCisNCisJKm1pZF92YWwg
PSBzZWxiX21vZGU7DQorfQ0KKw0KK3ZvaWQgbm9fZmFpbF9wKHU4ICp0dW5pbmdfd2luLCB1OCAq
bWlkX3ZhbCwgdTggKm1heF9wYXNzX3dpbiwgdTggKmZpcnN0X3ZhbCkNCit7DQorCXN0cnVjdCBj
aGtfdHlwZV90IHR5cGU7DQorCXU4IGZpcnN0XzAgPSAwOw0KKw0KKwltZW1zZXQoKHU4ICopJnR5
cGUsIDAsIHNpemVvZihzdHJ1Y3QgY2hrX3R5cGVfdCkpOw0KKw0KKwl0eXBlLmZpcnN0X3ZhbGlk
ID0gMDsNCisJdHlwZS5yaWdodF92YWxpZCA9IDE7DQorCXR5cGUucmVjb3JkX3ZhbGlkID0gMDsN
CisNCisJY2hrX2Fycl9tYXhfd2luKHR1bmluZ193aW4sIGZpcnN0XzAsIG1pZF92YWwsIGZpcnN0
X3ZhbCwNCisJbWF4X3Bhc3Nfd2luLCB0eXBlKTsNCit9DQorDQorc3RhdGljIGludCBnZ2NfZ2V0
X3NlbHhfd2VpZ2h0KHUzMiB2YWwpDQorew0KKwlpbnQgaSA9IDA7DQorCWludCBjbnQgPSAwOw0K
Kw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykgew0KKwkJaWYgKEdF
VF9JRFhfVkFMVUUodmFsLCBpKSkNCisJCQljbnQrKzsNCisJfQ0KKwlyZXR1cm4gY250Ow0KK30N
CisNCit2b2lkIHR4X3NlbGJfY2FsY3VsYXRlX3ZhbGlkX3BoYXNlX3JhbmdlKHUzMiB2YWwsIGlu
dCAqc3RhcnQsDQorCQkJCQkJaW50ICpwYXNzX2NudCkNCit7DQorCWludCBpID0gMCwgZmxnID0g
MDsNCisNCisJKnBhc3NfY250ID0gZ2djX2dldF9zZWx4X3dlaWdodCh2YWwpOw0KKwlmb3IgKGkg
PSAwOyBpIDwgKFRVTklOR19QSEFTRV9TSVpFICogMik7IGkrKykgew0KKwkJaWYgKChHRVRfVFJV
TklOR19SSU5HX0lEWF9WQUxVRSh2YWwsIGkpKSA9PSAwICYmIChmbGcgPT0gMCkpDQorCQkJZmxn
ID0gMTsNCisJCWlmICgoZmxnID09IDEpICYmIEdFVF9UUlVOSU5HX1JJTkdfSURYX1ZBTFVFKHZh
bCwgaSkpIHsNCisJCQkqc3RhcnQgPSBUUlVOSU5HX1JJTkdfSURYKGkpOw0KKwkJCWJyZWFrOw0K
KwkJfQ0KKwl9DQorfQ0KKw0KK2Jvb2wgZ2djX3VwZGF0ZV9kZWZhdWx0X3NlbGJfcGhhc2VfdHVu
aW5nX2NudChzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgaW50IHNlbGIsDQorCQkJCQkgICAgICBp
bnQgdHVuaW5nX2NudCkNCit7DQorCXN0cnVjdCB0X2dnX3JlZ19zdHJ0IGdnX3JlZ19hcnJbM107
DQorCXU4IGRhdGFbNTEyXTsNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3Qg
PSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICp2ZW5k
b3JfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQorCWdldF9nZ19yZWdf
Y3VyX3ZhbCgmdmVuZG9yX2hvc3QtPmdnYywgZGF0YSwgNjQpOw0KKw0KKwlwcl9kZWJ1ZygiQkhU
IE1TRzogc2VsYjoleGgsdHVuaW5nX2NudDoleGhcbiIsIHNlbGIsDQorCQkgdHVuaW5nX2NudCk7
DQorCW1lbWNweSgmZ2dfcmVnX2FyclswXSwgJnZlbmRvcl9ob3N0LT5nZ2MuZGxsX3NlbGJfMTAw
bV9jZmcsDQorCQlzaXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZnZ19y
ZWdfYXJyWzFdLCAmdmVuZG9yX2hvc3QtPmdnYy5kbGxfc2VsYl8yMDBtX2NmZywNCisJCXNpemVv
ZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKwltZW1jcHkoJmdnX3JlZ19hcnJbMl0sICZ2ZW5k
b3JfaG9zdC0+Z2djLmNtZDE5X2NudF9jZmcsDQorCQlzaXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0
cnQpKTsNCisNCisJZ2dfcmVnX2FyclswXS52YWx1ZSA9IHNlbGI7DQorCWdnX3JlZ19hcnJbMV0u
dmFsdWUgPSBzZWxiOw0KKwlnZ19yZWdfYXJyWzJdLnZhbHVlID0gdHVuaW5nX2NudDsNCisJY2hn
X2dnX3JlZ19jdXJfdmFsKCZ2ZW5kb3JfaG9zdC0+Z2djLCBkYXRhLCBnZ19yZWdfYXJyLCAzLCBU
UlVFKTsNCisNCisJcmV0dXJuIFRSVUU7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9nZ2NfdXBkYXRl
X2N1cl9zZXR0aW5nX2Zvcl9zd19zZWxiX3R1bmluZyhzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwN
CisJCQkJCQkgICAgICAgdTMyIHZhbCkNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpw
bHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJf
aG9zdCAqdmVuZG9yX2hvc3QgPSBzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKwlpbnQg
c3RhcnQgPSAwLCBwYXNzX2NudCA9IDA7DQorDQorCXR4X3NlbGJfY2FsY3VsYXRlX3ZhbGlkX3Bo
YXNlX3JhbmdlKHZhbCwgJnN0YXJ0LCAmcGFzc19jbnQpOw0KKwlwcl9kZWJ1ZygiQkhUIE1TRzol
cyAleCAleCAleFxuIiwgX19mdW5jX18sIHZhbCwgc3RhcnQsIHBhc3NfY250KTsNCisJZ2djX3Vw
ZGF0ZV9kZWZhdWx0X3NlbGJfcGhhc2VfdHVuaW5nX2NudChob3N0LCBzdGFydCwgcGFzc19jbnQp
OwkvL3VwZGF0ZQ0KKwl2ZW5kb3JfaG9zdC0+Z2djLmdnY19zd19zZWxiX3R1bmluZ19maXJzdF9z
ZWxiID0gc3RhcnQ7DQorfQ0KKw0KK2ludCBzZGhjaV9iaHRfc2RyNTBfZXhlY3V0ZV90dW5pbmco
c3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsIHUzMiBvcGNvZGUpDQorew0KKw0KKwl1OCBwaGFzZSwg
KmRhdGFfYnVmOw0KKwlpbnQgc2l6ZSA9IDY0Ow0KKwlpbnQgcmMgPSAwOw0KKwlzdHJ1Y3QgbW1j
X2hvc3QgKm1tYyA9IGhvc3QtPm1tYzsNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZt
X2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0
ICp2ZW5kb3JfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQorCXByX2Rl
YnVnKCIlczogRW50ZXIgJXNcbiIsIG1tY19ob3N0bmFtZShtbWMpLCBfX2Z1bmNfXyk7DQorDQor
CWRhdGFfYnVmID0ga21hbGxvYyhzaXplLCBHRlBfS0VSTkVMKTsNCisNCisJcGhhc2UgPSAwOw0K
KwlkbyB7DQorCQlzdHJ1Y3QgbW1jX2NvbW1hbmQgY21kID0geyAwIH07DQorCQlzdHJ1Y3QgbW1j
X2RhdGEgZGF0YSA9IHsgMCB9Ow0KKwkJc3RydWN0IG1tY19yZXF1ZXN0IG1ycSA9IHsNCisJCQku
Y21kID0gJmNtZCwNCisJCQkuZGF0YSA9ICZkYXRhDQorCQl9Ow0KKwkJc3RydWN0IHNjYXR0ZXJs
aXN0IHNnOw0KKw0KKwkJY21kLm9wY29kZSA9IG9wY29kZTsNCisJCWNtZC5mbGFncyA9IE1NQ19S
U1BfUjEgfCBNTUNfQ01EX0FEVEM7DQorDQorCQlkYXRhLmJsa3N6ID0gc2l6ZTsNCisJCWRhdGEu
YmxvY2tzID0gMTsNCisJCWRhdGEuZmxhZ3MgPSBNTUNfREFUQV9SRUFEOw0KKwkJZGF0YS50aW1l
b3V0X25zID0gMzAgKiAxMDAwICogMTAwMDsJLyogMzBtcyAqLw0KKw0KKwkJZGF0YS5zZyA9ICZz
ZzsNCisJCWRhdGEuc2dfbGVuID0gMTsNCisJCXNnX2luaXRfb25lKCZzZywgZGF0YV9idWYsIHNp
emUpOw0KKwkJbWVtc2V0KGRhdGFfYnVmLCAwLCBzaXplKTsNCisJCWhvc3RfY21kZGF0X2xpbmVf
cmVzZXQoaG9zdCk7DQorCQltbWNfd2FpdF9mb3JfcmVxKG1tYywgJm1ycSk7DQorDQorCQlpZiAo
Y21kLmVycm9yKSB7DQorCQkJaWYgKGNtZC5lcnJvciA9PSAtRUlMU0VRKQ0KKwkJCQl2ZW5kb3Jf
aG9zdC0+Z2djLnNkcjUwX25vdHVuaW5nX2NyY19lcnJvcl9mbGFnID0gMTsNCisJCQlpZiAoY21k
LmVycm9yID09IC1FVElNRURPVVQgJiYgcGhhc2UgPT0gMCkgew0KKwkJCQlwcl9lcnIoIkJIVCBF
UlI6Y21kMTkgdGltZW91dFxuIik7DQorCQkJCXJjID0gLUVUSU1FRE9VVDsNCisJCQkJZ290byBr
ZnJlZTsNCisJCQl9DQorCQl9DQorDQorCQlpZiAoZGF0YS5lcnJvcikgew0KKwkJCWlmIChkYXRh
LmVycm9yID09IC1FSUxTRVEpDQorCQkJCXZlbmRvcl9ob3N0LT5nZ2Muc2RyNTBfbm90dW5pbmdf
Y3JjX2Vycm9yX2ZsYWcgPSAxOw0KKwkJfQ0KKwl9IHdoaWxlICgrK3BoYXNlIDwgMTYpOw0KKw0K
K2tmcmVlOg0KKwlrZnJlZShkYXRhX2J1Zik7DQorDQorCXJldHVybiByYzsNCit9DQorDQoraW50
IGdldF9jb25maWdfc2VsYV9zZXR0aW5nKHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0KQ0KK3sNCisJ
c3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0K
KwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICp2ZW5kb3JfaG9zdCA9IHNkaGNpX3BsdGZt
X3ByaXYocGx0Zm1faG9zdCk7DQorDQorCWlmIChpc19idXNfbW9kZV9zZHIxMDQoaG9zdCkpDQor
CQlyZXR1cm4gdmVuZG9yX2hvc3QtPmdnYy5kZWZfc2VsYV8yMDBtOw0KKwllbHNlDQorCQlyZXR1
cm4gdmVuZG9yX2hvc3QtPmdnYy5kZWZfc2VsYV8xMDBtOw0KK30NCisNCitpbnQgZ2V0X2NvbmZp
Z19zZWxiX3NldHRpbmcoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QpDQorew0KKwlzdHJ1Y3Qgc2Ro
Y2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0cnVjdCBz
ZGhjaV9tc21fYmF5aHViX2hvc3QgKnZlbmRvcl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRm
bV9ob3N0KTsNCisNCisJaWYgKGlzX2J1c19tb2RlX3NkcjEwNChob3N0KSkNCisJCXJldHVybiB2
ZW5kb3JfaG9zdC0+Z2djLmRlZl9zZWxiXzIwMG07DQorCWVsc2UNCisJCXJldHVybiB2ZW5kb3Jf
aG9zdC0+Z2djLmRlZl9zZWxiXzEwMG07DQorfQ0KKw0KK3UzMiBnZXRfYWxsX3NlbGFfc3RhdHVz
KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LCB1MzIgdGFyZ2V0X3NlbGIpDQorew0KKwl1MzIgYWxs
X3NlbGEgPSAwOw0KKwl1MzIgYWxsX3NlbGIgPSAwOw0KKwlpbnQgaSA9IDA7DQorDQorCWZvciAo
aSA9IDA7IGkgPCBUVU5JTkdfUEhBU0VfU0laRTsgaSsrKSB7DQorCQlhbGxfc2VsYiA9IGFsbF9z
ZWxiX2ZhaWxlZF90Yl9nZXQoaG9zdCwgaSk7DQorCQlpZiAoYWxsX3NlbGIgJiAoMSA8PCB0YXJn
ZXRfc2VsYikpDQorCQkJYWxsX3NlbGEgfD0gMSA8PCBpOw0KKwl9DQorCXJldHVybiBhbGxfc2Vs
YTsNCit9DQorDQoraW50IGdldF9wYXNzX3dpbmRvd193ZWlnaHQodTMyIHZhbCkNCit7DQorCWlu
dCBpID0gMDsNCisJaW50IGNudCA9IDA7DQorDQorCWZvciAoaSA9IDA7IGkgPCBUVU5JTkdfUEhB
U0VfU0laRTsgaSsrKSB7DQorCQlpZiAoR0VUX0lEWF9WQUxVRSh2YWwsIGkpKQ0KKwkJCWNudCsr
Ow0KKwl9DQorCXJldHVybiBjbnQ7DQorfQ0KKw0KK2ludCBnZXRfc2VsYV9uZWFyYnlfcGFzc193
aW5kb3codTMyIHNlbGEsIHUzMiBiYXNlKQ0KK3sNCisNCisJaW50IGkgPSAwOw0KKwlpbnQgaWR4
ID0gYmFzZTsNCisJaW50IGNudCA9IDA7DQorDQorCWlmIChHRVRfSURYX1ZBTFVFKHNlbGEsIGlk
eCkgPT0gMCkNCisJCXJldHVybiAwOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNF
X1NJWkU7IGkrKykgew0KKwkJaWYgKEdFVF9JRFhfVkFMVUUoc2VsYSwgaWR4KSkgew0KKwkJCWlk
eCsrOw0KKwkJCWlkeCAlPSBUVU5JTkdfUEhBU0VfU0laRTsNCisJCX0gZWxzZSB7DQorCQkJYnJl
YWs7DQorCQl9DQorCX0NCisNCisJaWYgKGlkeCA9PSAwKQ0KKwkJaWR4ID0gMHhhOw0KKwllbHNl
DQorCQlpZHgtLTsNCisNCisJZm9yIChpID0gMDsgaSA8IFRVTklOR19QSEFTRV9TSVpFOyBpKysp
IHsNCisJCWlmIChHRVRfSURYX1ZBTFVFKHNlbGEsIGlkeCkpIHsNCisJCQljbnQrKzsNCisJCQlp
ZiAoaWR4ID09IDApDQorCQkJCWlkeCA9IDB4YTsNCisJCQllbHNlDQorCQkJCWlkeC0tOw0KKwkJ
fSBlbHNlIHsNCisJCQlicmVhazsNCisJCX0NCisJfQ0KKwlyZXR1cm4gY250Ow0KK30NCisNCitp
bnQgZ2V0X2xlZnRfb25lX3NlbChpbnQgYmFzZSkNCit7DQorCWlmIChiYXNlID09IDApDQorCQly
ZXR1cm4gMHhhOw0KKwllbHNlDQorCQlyZXR1cm4gYmFzZSAtIDE7DQorfQ0KKw0KK2ludCBnZXRf
cmlnaHRfb25lX3NlbChpbnQgYmFzZSkNCit7DQorCWlmIChiYXNlID09IDB4YSkNCisJCXJldHVy
biAweDA7DQorCWVsc2UNCisJCXJldHVybiBiYXNlICsgMTsNCit9DQorDQoraW50IGdldF9kaWYo
aW50IHgsIGludCB5KQ0KK3sNCisJaW50IGRpZiA9IDA7DQorDQorCWlmICh5ID4geCkNCisJCWRp
ZiA9IHkgLSB4Ow0KKwllbHNlDQorCQlkaWYgPSB4IC0geTsNCisNCisJcmV0dXJuIGRpZjsNCit9
DQorDQorc3RhdGljIGludCB1cGRhdGVfc2VsYihzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgaW50
IHRhcmdldF9zZWxiKQ0KK3sNCisJcmV0dXJuIHRhcmdldF9zZWxiOw0KK30NCisNCitzdGF0aWMg
aW50IGdnY19nZXRfMTBjYXNlXzBfaW5kZXgodTMyIHZhbCkNCit7DQorCWludCBpID0gMDsNCisN
CisJZm9yIChpID0gMDsgaSA8IFRVTklOR19QSEFTRV9TSVpFOyBpKyspIHsNCisJCWlmIChHRVRf
SURYX1ZBTFVFKHZhbCwgaSkgPT0gMA0KKwkJICAgICYmIEdFVF9JRFhfVkFMVUUodmFsLA0KKwkJ
CQkgICAgIFRSVU5JTkdfUklOR19JRFgoaSArIFRVTklOR19QSEFTRV9TSVpFIC0NCisJCQkJCQkg
ICAgICAxKSkpIHsNCisJCQlyZXR1cm4gaTsNCisJCX0NCisJfQ0KKw0KKwlyZXR1cm4gLTE7DQor
fQ0KKw0KK3N0YXRpYyB1MzIgZ2djX2dldF8wMWNhc2VfMF9pbmRleCh1MzIgdmFsKQ0KK3sNCisJ
aW50IGkgPSAwOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykg
ew0KKwkJaWYgKEdFVF9JRFhfVkFMVUUodmFsLCBpKSA9PSAwDQorCQkgICAgJiYgR0VUX0lEWF9W
QUxVRSh2YWwsIFRSVU5JTkdfUklOR19JRFgoaSArIDEpKSkgew0KKwkJCXJldHVybiBpOw0KKwkJ
fQ0KKwl9DQorDQorCXJldHVybiAtMTsNCit9DQorDQorc3RhdGljIGludCBnZ2NfZ2V0X25leHRf
MV9pbmRleCh1MzIgdmFsLCBpbnQgcG9zKQ0KK3sNCisJaW50IGkgPSAwOw0KKw0KKwlwb3MgPSBw
b3MgJSBUVU5JTkdfUEhBU0VfU0laRTsNCisJZm9yIChpID0gMDsgaSA8IFRVTklOR19QSEFTRV9T
SVpFOyBpKyspCXsNCisJCWlmIChHRVRfSURYX1ZBTFVFKHZhbCwgKHBvcytpKSVUVU5JTkdfUEhB
U0VfU0laRSkpDQorCQkJYnJlYWs7DQorCX0NCisJaWYgKEdFVF9JRFhfVkFMVUUodmFsLCAocG9z
K2kpJVRVTklOR19QSEFTRV9TSVpFKSkNCisJCXJldHVybiAocG9zK2kpJVRVTklOR19QSEFTRV9T
SVpFOw0KKwllbHNlDQorCQlyZXR1cm4gLTE7DQorfQ0KKw0KK3N0YXRpYyB1MzIgZ2djX2dldF8w
MWNhc2VfMV9pbmRleCh1MzIgdmFsKQ0KK3sNCisJaW50IGkgPSAwOw0KKw0KKwlmb3IgKGkgPSAw
OyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykgew0KKwkJaWYgKEdFVF9JRFhfVkFMVUUodmFs
LCBpKSA9PSAwDQorCQkJJiYgR0VUX0lEWF9WQUxVRSh2YWwsIFRSVU5JTkdfUklOR19JRFgoaSAr
IDEpKSkgew0KKwkJCXJldHVybiBUUlVOSU5HX1JJTkdfSURYKGkgKyAxKTsNCisJCX0NCisJfQ0K
Kw0KKwlyZXR1cm4gLTE7DQorfQ0KKw0KK3N0YXRpYyBpbnQgZ2djX2dldF9maXJzdF8wX2luZGV4
KHUzMiB2YWwpDQorew0KKwlpbnQgaSA9IDA7DQorDQorCWZvciAoaSA9IDA7IGkgPCBUVU5JTkdf
UEhBU0VfU0laRTsgaSsrKSB7DQorCQlpZiAoR0VUX0lEWF9WQUxVRSh2YWwsIGkpID09IDApDQor
CQkJcmV0dXJuIGk7DQorCX0NCisJcHJfZGVidWcoIkJIVCBNU0c6b29wcy1ub3QgZmluZCAwIGlu
ZGV4XG4iKTsNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgX3R4X3NlbGJfaW5qZWN0
X3BvbGljeShpbnQgdHhfc2VsYiwgaW50IG9yZ19zZWxiKQ0KK3sNCisJaW50IGdyb3VwX3Bvc1tU
VU5JTkdfUEhBU0VfU0laRSsxXVszXTsNCisJaW50IGdyb3VwX2NudCA9IDA7DQorCWludCBtYXhf
bGVuX2dyb3VwID0gMDsNCisJaW50IG1heF9sZW4gPSAwOw0KKwlpbnQgaSwgaiwgY250Ow0KKwlp
bnQgemVyb19zdGFydCwgemVyb19lbmQsIHNlbDsNCisNCisJaWYgKChvcmdfc2VsYiAmIEJJVF9Q
QVNTX01BU0spICE9IEJJVF9QQVNTX01BU0spIHsNCisJCXNlbCA9IHR4X3NlbGI7DQorCQl6ZXJv
X3N0YXJ0ID0gZ2djX2dldF8xMGNhc2VfMF9pbmRleChzZWwpOw0KKwkJc2VsICY9DQorCQkgICAg
fkdFTkVSQVRFX1RSVU5JTkdfUklOR19JRFhfVkFMVUUoZ2V0X2xlZnRfb25lX3NlbA0KKwkJCQkJ
CSAgICAgKHplcm9fc3RhcnQpKTsNCisJCXplcm9fZW5kID0gZ2djX2dldF8wMWNhc2VfMF9pbmRl
eChzZWwpOw0KKwkJc2VsICY9DQorCQkgICAgfkdFTkVSQVRFX1RSVU5JTkdfUklOR19JRFhfVkFM
VUUoZ2V0X3JpZ2h0X29uZV9zZWwNCisJCQkJCQkgICAgICh6ZXJvX2VuZCkpOw0KKwkJaWYgKHNl
bCAhPSAoc2VsICYgdHhfc2VsYikpIHsNCisJCQlwcl9lcnINCisJCQkgICAgKCJ0eCBzZWxiIHJl
aW5qZWN0IGV4Y2VwdGlvbiBjYXNlIDpub3QgYWRqYWNlbnQgcGhhc2VcbiIpOw0KKwkJCXByX2Vy
cigiQkhUIEVSUjpzZWxiX2ZhaWxlZCByYW5nZToleGggICxuZXcgdHhfc2VsYjoleFxuIiwNCisJ
CQkgICAgICAgb3JnX3NlbGIsIHR4X3NlbGIpOw0KKwkJfQ0KKwkJb3JnX3NlbGIgJj0gdHhfc2Vs
YjsNCisJfSBlbHNlIHsNCisJCWNudCA9IGdnY19nZXRfc2VseF93ZWlnaHQofnR4X3NlbGIpOw0K
KwkJcHJfZGVidWcoIkJIVCBNU0c6JWRcbiIsIGNudCk7DQorCQlzd2l0Y2ggKGNudCkgew0KKwkJ
Y2FzZSAxOg0KKwkJCWkgPSBnZ2NfZ2V0X2ZpcnN0XzBfaW5kZXgodHhfc2VsYik7DQorCQkJdHhf
c2VsYiAmPQ0KKwkJCSAgICB+R0VORVJBVEVfVFJVTklOR19SSU5HX0lEWF9WQUxVRShnZXRfcmln
aHRfb25lX3NlbA0KKwkJCQkJCQkgICAgIChpKSk7DQorCQkJdHhfc2VsYiAmPQ0KKwkJCSAgICB+
R0VORVJBVEVfVFJVTklOR19SSU5HX0lEWF9WQUxVRShnZXRfbGVmdF9vbmVfc2VsDQorCQkJCQkJ
CSAgICAgKGkpKTsNCisNCisJCQlicmVhazsNCisJCWNhc2UgMjoNCisJCQlpID0gZ2djX2dldF8x
MGNhc2VfMF9pbmRleCh0eF9zZWxiKTsNCisJCQl0eF9zZWxiICY9DQorCQkJICAgIH5HRU5FUkFU
RV9UUlVOSU5HX1JJTkdfSURYX1ZBTFVFKGdldF9sZWZ0X29uZV9zZWwNCisJCQkJCQkJICAgICAo
aSkpOw0KKwkJCWkgPSBnZ2NfZ2V0XzAxY2FzZV8wX2luZGV4KHR4X3NlbGIpOw0KKwkJCXR4X3Nl
bGIgJj0NCisJCQkgICAgfkdFTkVSQVRFX1RSVU5JTkdfUklOR19JRFhfVkFMVUUoZ2V0X3JpZ2h0
X29uZV9zZWwNCisJCQkJCQkJICAgICAoaSkpOw0KKwkJCWJyZWFrOw0KKwkJZGVmYXVsdDoNCisJ
CQlwcl9kZWJ1ZygiQkhUIE1TRzo+PSAzIHBvaW50IGNhc2VcbiIpOw0KKwkJfQ0KKwkJb3JnX3Nl
bGIgJj0gdHhfc2VsYjsNCisJfQ0KKw0KKwlwcl9kZWJ1ZygiQkhUIE1TRzp3aWxsIGNoZWNrIGNv
bnRpbnVvdXMgMGJpdHM6IDB4JXhcbiIsIG9yZ19zZWxiKTsNCisNCisJbWVtc2V0KGdyb3VwX3Bv
cywgMCwgc2l6ZW9mKGdyb3VwX3BvcykpOw0KKwlmb3IgKGkgPSBnZ2NfZ2V0XzAxY2FzZV8xX2lu
ZGV4KG9yZ19zZWxiKTsNCisJCWkgPCBUVU5JTkdfUEhBU0VfU0laRSAmJiBpID49IDAgJiYgZ3Jv
dXBfY250IDwgVFVOSU5HX1BIQVNFX1NJWkU7KSB7DQorCQlmb3IgKGogPSAxOyBqIDwgVFVOSU5H
X1BIQVNFX1NJWkU7IGorKykJew0KKwkJCWlmIChHRVRfVFJVTklOR19SSU5HX0lEWF9WQUxVRShv
cmdfc2VsYiwgaStqKSAhPSAwKQ0KKwkJCQljb250aW51ZTsNCisJCQllbHNlDQorCQkJCWJyZWFr
Ow0KKwkJfQ0KKwkJZ3JvdXBfcG9zW2dyb3VwX2NudF1bMF0gPSBpOw0KKwkJZ3JvdXBfcG9zW2dy
b3VwX2NudF1bMV0gPSAoaSArIGogLSAxKSAlIFRVTklOR19QSEFTRV9TSVpFOw0KKwkJZ3JvdXBf
cG9zW2dyb3VwX2NudF1bMl0gPSBqOw0KKwkJZ3JvdXBfY250Kys7DQorCQlpZiAoZ3JvdXBfcG9z
W2dyb3VwX2NudC0xXVswXSA+IGdyb3VwX3Bvc1tncm91cF9jbnQtMV1bMV0pDQorCQkJYnJlYWs7
DQorCQlpID0gZ2djX2dldF9uZXh0XzFfaW5kZXgob3JnX3NlbGIsIChpK2opJVRVTklOR19QSEFT
RV9TSVpFKTsNCisJCWZvciAoaiA9IDA7IGogPCBncm91cF9jbnQ7IGorKykJew0KKwkJCWlmIChp
ID09IGdyb3VwX3Bvc1tqXVswXSkNCisJCQkJYnJlYWs7DQorCQl9DQorCQlpZiAoaiA8IGdyb3Vw
X2NudCkNCisJCQlicmVhazsNCisJfQ0KKw0KKwlpZiAoZ3JvdXBfY250ID4gMSkgew0KKwkJcHJf
ZXJyKCJCSFQgRVJSOkFmdGVyIGluamVjdCwgc2VsYiAweCV4IGhhcyAlZCBjb250aW51b3VzIDAg
Yml0c1xuIiwNCisJCQkJb3JnX3NlbGIsIGdyb3VwX2NudCk7DQorDQorCQlmb3IgKGkgPSAwOyBp
IDwgZ3JvdXBfY250OyBpKyspIHsNCisJCQlpZiAobWF4X2xlbiA8IGdyb3VwX3Bvc1tpXVsyXSkg
ew0KKwkJCQltYXhfbGVuID0gZ3JvdXBfcG9zW2ldWzJdOw0KKwkJCQltYXhfbGVuX2dyb3VwID0g
aTsNCisJCQl9DQorCQl9DQorCQlmb3IgKGkgPSAoZ3JvdXBfcG9zW21heF9sZW5fZ3JvdXBdWzFd
ICsgMSkgJSBUVU5JTkdfUEhBU0VfU0laRTsNCisJCQlpICE9IGdyb3VwX3Bvc1ttYXhfbGVuX2dy
b3VwXVswXTsgaSA9IChpKzEpJVRVTklOR19QSEFTRV9TSVpFKSB7DQorCQkJb3JnX3NlbGIgJj0g
figxIDw8IGkpOw0KKwkJfQ0KKwkJcHJfZXJyKCJCSFQgRVJSOkFmdGVyIG1lcmdlIGluY29udGlv
dXMgMCBncm91cCwgc2VsYiBjaGFuZ2VkIHRvIDB4JXhcbiIsIG9yZ19zZWxiKTsNCisJfSBlbHNl
IGlmIChncm91cF9jbnQgPiAwKSB7DQorCQlwcl9lcnIoIkJIVCBFUlI6QWZ0ZXIgbWVyZ2UgaW5j
b250aW91cyAwIGdyb3VwLCBzZWxiID0gMHgleFxuIiwgb3JnX3NlbGIpOw0KKwl9IGVsc2Ugew0K
KwkJcHJfZXJyKCJCSFQgRVJSOnNlbGIgMHgleCBoYXMgbm8gYml0IGlzIDBcbiIsIG9yZ19zZWxi
KTsNCisJfQ0KKw0KKwlyZXR1cm4gb3JnX3NlbGI7DQorfQ0KKw0KK3ZvaWQgdHhfc2VsYl9pbmpl
Y3RfcG9saWN5KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LCBpbnQgdHhfc2VsYikNCit7DQorDQor
CXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsN
CisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPSBzZGhjaV9wbHRm
bV9wcml2KHBsdGZtX2hvc3QpOw0KKw0KKwlwcl9kZWJ1ZygiQkhUIE1TRzpiZWZvcmUgaW5qZWN0
LCBmYWlsZWQgcmFnZW4gMHgleCwgdHhfc2VsYiAweCV4XG4iLA0KKwkJCXZlbmRvcl9ob3N0LT5n
Z2MuZ2djX2NtZF90eF9zZWxiX2ZhaWxlZF9yYW5nZSwgdHhfc2VsYik7DQorCXZlbmRvcl9ob3N0
LT5nZ2MuZ2djX2NtZF90eF9zZWxiX2ZhaWxlZF9yYW5nZSA9DQorCQlfdHhfc2VsYl9pbmplY3Rf
cG9saWN5KHR4X3NlbGIsIHZlbmRvcl9ob3N0LT5nZ2MuZ2djX2NtZF90eF9zZWxiX2ZhaWxlZF9y
YW5nZSk7DQorCXR4X3NlbGJfZmFpbGVkX2hpc3RvcnlfdXBkYXRlKGhvc3QsIHZlbmRvcl9ob3N0
LT5nZ2MuZ2djX2NtZF90eF9zZWxiX2ZhaWxlZF9yYW5nZSk7DQorCXByX2RlYnVnKCJCSFQgTVNH
OmFmdGVyIGluamVjdCAleGggcmFuZ2U6JXhoXG4iLCB0eF9zZWxiLA0KKwkJIHZlbmRvcl9ob3N0
LT5nZ2MuZ2djX2NtZF90eF9zZWxiX2ZhaWxlZF9yYW5nZSk7DQorCWlmIChpc19idXNfbW9kZV9z
ZHIxMDQoaG9zdCkpDQorCQl2ZW5kb3JfaG9zdC0+Z2djLnNkcjEwNC5mYWlsX3BoYXNlID0gdmVu
ZG9yX2hvc3QtPmdnYy5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlOw0KKwllbHNlDQorCQl2
ZW5kb3JfaG9zdC0+Z2djLnNkcjUwLmZhaWxfcGhhc2UgPSB2ZW5kb3JfaG9zdC0+Z2djLmdnY19j
bWRfdHhfc2VsYl9mYWlsZWRfcmFuZ2U7DQorfQ0KKw0KK2ludCBnZXRfc2VsYl9mYWlsdXJlX3Bv
aW50KGludCBzdGFydCwgdTY0IHJhd190eF9zZWxiLCBpbnQgdHVuaW5nX2NudCkNCit7DQorCWlu
dCBsYXN0ID0gc3RhcnQgKyAodHVuaW5nX2NudCAtIDEpOw0KKwlpbnQgaSA9IDA7DQorCWludCBq
ID0gMDsNCisJaW50IHBoYXNlID0gc3RhcnQ7DQorCWludCB2Y3QgPSBCSVRfUEFTU19NQVNLOw0K
Kw0KKwlwcl9kZWJ1ZygiQkhUIE1TRzolcyBzdGFydDolZCB0dW5pbmdfY250OiVkXG4iLCBfX2Z1
bmNfXywgc3RhcnQsDQorCQkJIHR1bmluZ19jbnQpOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgdHVu
aW5nX2NudDsgaSsrKSB7DQorCQlpZiAoKHJhd190eF9zZWxiICYgR0VORVJBVEVfNjRfSURYX1ZB
TFVFKGxhc3QgLSBpKSkgPT0gMCkNCisJCQlicmVhazsNCisJfQ0KKwlpZiAoaSA9PSB0dW5pbmdf
Y250KSB7DQorCQlwaGFzZSA9IGxhc3QgJSBUVU5JTkdfUEhBU0VfU0laRTsNCisJCXZjdCAmPSAo
figxIDw8IHBoYXNlKSk7DQorCQlnb3RvIGV4aXQ7DQorCX0NCisNCisJZm9yIChpID0gMDsgaSA8
IHR1bmluZ19jbnQ7IGkrKykgew0KKwkJaWYgKChyYXdfdHhfc2VsYiAmIEdFTkVSQVRFXzY0X0lE
WF9WQUxVRShsYXN0IC0gaSkpICE9IDApDQorCQkJYnJlYWs7DQorCX0NCisJZm9yIChqID0gaSAt
IDI7IGogPj0gMDsgai0tKQ0KKwkJcmF3X3R4X3NlbGIgfD0gKDEgPDwgKGxhc3QgLSBqKSk7DQor
DQorCWZvciAoaiA9IDA7IGogPCB0dW5pbmdfY250OyBqKyspIHsNCisJCWlmICgwID09IChyYXdf
dHhfc2VsYiAmIEdFTkVSQVRFXzY0X0lEWF9WQUxVRShsYXN0IC0gaikpKQ0KKwkJCXZjdCAmPSAo
figxIDw8IChsYXN0LWopKSk7DQorCX0NCisNCitleGl0Og0KKwlwcl9kZWJ1ZygiQkhUIE1TRzol
czogYWZ0ZXIgYWRqdXN0IHJhd190eF9zZWxiOiAweCVsbHgsIHZjdCAweCV4XG4iLA0KKwkJCSBf
X2Z1bmNfXywgcmF3X3R4X3NlbGIsIHZjdCk7DQorDQorCXJldHVybiB2Y3Q7DQorfQ0KKw0KK2Jv
b2wgc2VseF9mYWlsdXJlX3BvaW50X2V4aXN0KHUzMiB2YWwpDQorew0KKwlyZXR1cm4gKHZhbCAm
IEJJVF9QQVNTX01BU0spICE9IEJJVF9QQVNTX01BU0s7DQorfQ0KKw0KK3N0YXRpYyBpbnQgX2Jp
dHNfdmN0X2dldF9sZWZ0X2luZGV4KGludCBiYXNlKQ0KK3sNCisJcmV0dXJuIFRSVU5JTkdfUklO
R19JRFgoYmFzZSArIFRVTklOR19QSEFTRV9TSVpFIC0gMSk7DQorfQ0KKw0KK2ludCBfZ2V0X2Jl
c3Rfd2luZG93X3BoYXNlKHUzMiB2Y3QsIGludCAqcG1heF9wYXNzX3dpbiwgaW50IHNoaWZfbGVm
dF9mbGcpDQorew0KKwl1OCB0dW5pbmdfd2luW1RVTklOR19QSEFTRV9TSVpFXSA9IHsgMCB9Ow0K
Kwl1OCB0dW5pbmdfcGFzc1tUVU5JTkdfUEhBU0VfU0laRV07DQorCWludCB0dW5pbmdfcGFzc19z
dGFydFtUVU5JTkdfUEhBU0VfU0laRV07DQorCWludCB0dW5pbmdfcGFzc19udW1fbWF4ID0gMDsN
CisJaW50IGZpcnN0XzAgPSAwOw0KKwlpbnQgaSA9IDAsIGogPSAwOw0KKwlpbnQgaV9tb2RlID0g
MCwgc2VsYl9tb2RlID0gMDsNCisNCisJbWVtc2V0KHR1bmluZ19wYXNzLCAwLCBzaXplb2YodHVu
aW5nX3Bhc3MpKTsNCisJbWVtc2V0KHR1bmluZ19wYXNzX3N0YXJ0LCAwLCBzaXplb2YodHVuaW5n
X3Bhc3Nfc3RhcnQpKTsNCisNCisJZm9yIChpID0gMDsgaSA8IFRVTklOR19QSEFTRV9TSVpFOyBp
KyspIHsNCisJCWlmIChHRVRfSURYX1ZBTFVFKHZjdCwgaSkpDQorCQkJdHVuaW5nX3dpbltpXSA9
IDE7DQorCQllbHNlDQorCQkJdHVuaW5nX3dpbltpXSA9IDA7DQorCX0NCisNCisJZm9yIChpID0g
MDsgaSA8IFRVTklOR19QSEFTRV9TSVpFOyBpKyspIHsNCisJCWlmICh0dW5pbmdfd2luW2ldID09
IDApIHsNCisJCQlmaXJzdF8wID0gaTsNCisJCQlicmVhazsNCisJCX0NCisJfQ0KKw0KKwlmb3Ig
KGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykgew0KKwkJaV9tb2RlID0gVFJVTklO
R19SSU5HX0lEWChmaXJzdF8wICsgaSk7DQorCQlpZiAodHVuaW5nX3dpbltpX21vZGVdID09IDEp
DQorCQkJdHVuaW5nX3Bhc3Nbal0rKzsNCisJCWVsc2UgaWYgKHR1bmluZ19wYXNzW2pdKQ0KKwkJ
CWorKzsNCisJCWlmICh0dW5pbmdfcGFzc1tqXSA9PSAxKQ0KKwkJCXR1bmluZ19wYXNzX3N0YXJ0
W2pdID0gaV9tb2RlOw0KKwl9DQorDQorCWZvciAoaSA9IDA7IGkgPCBUVU5JTkdfUEhBU0VfU0la
RTsgaSsrKSB7DQorCQlpZiAodHVuaW5nX3Bhc3NfbnVtX21heCA8IHR1bmluZ19wYXNzW2ldKSB7
DQorCQkJdHVuaW5nX3Bhc3NfbnVtX21heCA9IHR1bmluZ19wYXNzW2ldOw0KKwkJCWlfbW9kZSA9
IGk7DQorCQl9DQorCX0NCisNCisJaWYgKHR1bmluZ19wYXNzX251bV9tYXggPT0gMCkgew0KKwkJ
cHJfZXJyKCJCSFQgRVJSOiMjIyMjIyBHZXQgbWF4IHBhc3Mgd2luZG93IGZhaWwsIHRoZXJlIGlz
IG5vIGFueSBwYXNzIHBoYXNlISFcbiIpOw0KKwkJc2VsYl9tb2RlID0gMDsNCisJfSBlbHNlIHsN
CisJCWlmICh0dW5pbmdfcGFzc19udW1fbWF4ICUgMikJew0KKwkJCXNlbGJfbW9kZSA9IHR1bmlu
Z19wYXNzX3N0YXJ0W2lfbW9kZV0gKyAodHVuaW5nX3Bhc3NfbnVtX21heCAtIDEpIC8gMjsNCisJ
CX0gZWxzZSB7DQorCQkJc2VsYl9tb2RlID0gdHVuaW5nX3Bhc3Nfc3RhcnRbaV9tb2RlXSArICh0
dW5pbmdfcGFzc19udW1fbWF4KSAvIDI7DQorCQkJaWYgKHNoaWZfbGVmdF9mbGcpIHsNCisJCQkJ
c2VsYl9tb2RlID0gX2JpdHNfdmN0X2dldF9sZWZ0X2luZGV4KHNlbGJfbW9kZSk7DQorCQkJCXBy
X2RlYnVnKCJCSFQgTVNHOnNoaWZ0IGxlZnQgaW5kZXhcbiIpOw0KKwkJCX0NCisJCX0NCisJCXNl
bGJfbW9kZSA9IFRSVU5JTkdfUklOR19JRFgoc2VsYl9tb2RlKTsNCisJfQ0KKwlpZiAocG1heF9w
YXNzX3dpbikNCisJCSpwbWF4X3Bhc3Nfd2luID0gdHVuaW5nX3Bhc3NfbnVtX21heDsNCisNCisJ
cmV0dXJuIHNlbGJfbW9kZTsNCit9DQorDQorDQoraW50IGdldF9iZXN0X3dpbmRvd19waGFzZSh1
MzIgdmN0LCBpbnQgKnBtYXhfcGFzc193aW4pDQorew0KKwlyZXR1cm4gX2dldF9iZXN0X3dpbmRv
d19waGFzZSh2Y3QsIHBtYXhfcGFzc193aW4sIDApOw0KK30NCisNCitzdGF0aWMgaW50IF9nZ2Nf
Z2V0X3N1aXRhYmxlX3NlbGJfZm9yX25leHRfdHVuaW5nKHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0
KQ0KK3sNCisJaW50IHNlbGIgPSAwOw0KKwlzdHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1f
aG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3Qg
KnZlbmRvcl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisJdTMyIGlual90
eF9zZWxiID0gQklUX1BBU1NfTUFTSzsNCisNCisJaWYgKHNlbHhfZmFpbHVyZV9wb2ludF9leGlz
dCh2ZW5kb3JfaG9zdC0+Z2djLmdnY19jbWRfdHhfc2VsYl9mYWlsZWRfcmFuZ2UpKSB7DQorCQlz
ZWxiID0gdmVuZG9yX2hvc3QtPmdnYy5nZ2Nfc3dfc2VsYl90dW5pbmdfZmlyc3Rfc2VsYjsNCisJ
fSBlbHNlIHsNCisJCXByX2RlYnVnKCJCSFQgTVNHOm1hbnVhbCBpbmplY3QgZm9yIGFsbCBwYXNz
IGNhc2VcbiIpOw0KKwkJaWYgKGlzX2J1c19tb2RlX3NkcjEwNChob3N0KSkNCisJCQlpbmpfdHhf
c2VsYiAmPSBTRFIxMDRfTUFOVUFMX0lOSkVDVDsNCisJCWVsc2UNCisJCQlpbmpfdHhfc2VsYiAm
PSBTRFI1MF9NQU5VQUxfSU5KRUNUOw0KKw0KKwkJcHJfZGVidWcoIkJIVCBNU0c6bWFudWFsIGlu
amVjdCBmb3IgYWxsIHBhc3MgY2FzZSwgaW5qX3R4X3NlbGI9MHgleFxuIiwNCisJCQkJaW5qX3R4
X3NlbGIpOw0KKwkJc2VsYiA9IGdldF9iZXN0X3dpbmRvd19waGFzZShpbmpfdHhfc2VsYiwgTlVM
TCk7DQorCQlwcl9kZWJ1ZygiQkhUIE1TRzpzZWxlY3Qgc2VsYiAlZCBmb3IgYWxsIHBhc3MgY2Fz
ZVxuIiwgc2VsYik7DQorCX0NCisJcmV0dXJuIHNlbGI7DQorfQ0KKw0KK3N0YXRpYyBpbnQgZ2dj
X2dldF90dW5pbmdfY250X2Zyb21fYnVmZmVyKHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0KQ0KK3sN
CisJaW50IGNudCA9IDA7DQorCXU4IGRhdGFbNTEyXTsNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hv
c3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2Jh
eWh1Yl9ob3N0ICp2ZW5kb3JfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQor
DQorCWdldF9nZ19yZWdfY3VyX3ZhbCgmdmVuZG9yX2hvc3QtPmdnYywgZGF0YSwgNjQpOw0KKwlj
bnQgPSAoaW50KWNmZ19yZWFkX2JpdHNfb2ZzX21hc2soZGF0YSwgJnZlbmRvcl9ob3N0LT5nZ2Mu
Y21kMTlfY250X2NmZyk7DQorDQorCXByX2RlYnVnKCJCSFQgTVNHOnR1bmluZyBjbnQ9JWRcbiIs
IGNudCk7DQorCXJldHVybiBjbnQ7DQorfQ0KKw0KK2Jvb2wgZ2djX2h3X2luamVjdF9leHQoc3Ry
dWN0IHNkaGNpX2hvc3QgKmhvc3QsIGJvb2wgKmNhcmRfc3RhdHVzLA0KKwkJCXUzMiBzZWwyMDAs
IHUzMiBzZWwxMDAsIGJvb2wgd3JpdGV0b2JoMjAxKQ0KK3sNCisJYm9vbCByZXQgPSBUUlVFOw0K
Kwl1OCBkYXRhWzUxMl07DQorCXN0cnVjdCB0X2dnX3JlZ19zdHJ0IGdnX3JlZ19hcnJbMTBdOw0K
KwlzdHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7
DQorCXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKnZlbmRvcl9ob3N0ID0gc2RoY2lfcGx0
Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisJdTMyIGkgPSAwOw0KKwl1MzIgcmVnOw0KKw0KKwlwcl9k
ZWJ1ZygiQkhUIE1TRzolcyBzZWwyMDA6JXhoLHNlbDEwMDoleGhcbiIsIF9fZnVuY19fLCBzZWwy
MDAsIHNlbDEwMCk7DQorCWdldF9nZ19yZWdfY3VyX3ZhbCgmdmVuZG9yX2hvc3QtPmdnYywgZGF0
YSwgNjQpOw0KKwltZW1jcHkoJmdnX3JlZ19hcnJbMF0sICZ2ZW5kb3JfaG9zdC0+Z2djLmluamVj
dF9mYWlsdXJlX2Zvcl90dW5pbmdfZW5hYmxlX2NmZywNCisJCQkJc2l6ZW9mKHN0cnVjdCB0X2dn
X3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVnX2FyclsxXSwgJnZlbmRvcl9ob3N0LT5nZ2Mu
aW5qZWN0X2ZhaWx1cmVfZm9yXzIwMG1fdHVuaW5nX2NmZywNCisJCQkJc2l6ZW9mKHN0cnVjdCB0
X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVnX2FyclsyXSwgJnZlbmRvcl9ob3N0LT5n
Z2MuaW5qZWN0X2ZhaWx1cmVfZm9yXzEwMG1fdHVuaW5nX2NmZywNCisJCQkJc2l6ZW9mKHN0cnVj
dCB0X2dnX3JlZ19zdHJ0KSk7DQorCWdnX3JlZ19hcnJbMF0udmFsdWUgPSAxOw0KKwlnZ19yZWdf
YXJyWzFdLnZhbHVlID0gc2VsMjAwOw0KKwlnZ19yZWdfYXJyWzJdLnZhbHVlID0gc2VsMTAwOw0K
Kw0KKwljaGdfZ2dfcmVnX2N1cl92YWwoJnZlbmRvcl9ob3N0LT5nZ2MsIGRhdGEsIGdnX3JlZ19h
cnIsIDMsIFRSVUUpOw0KKwlpZiAod3JpdGV0b2JoMjAxKQ0KKwkJcmV0ID0gZ2dfZW11bGF0b3Jf
d3JpdGVfZXh0KGhvc3QsIGNhcmRfc3RhdHVzLCBkYXRhLCA1MTIpOw0KKwllbHNlIHsNCisJCXBy
X2RlYnVnKCJCSFQgTVNHOiVzOiBkdW1wIGNvbmZpZyBkYXRhIGluc3RlYWQgd3JpdGUgdG8gYmgy
MDFcbiIsIF9fZnVuY19fKTsNCisJCWZvciAoaSA9IDA7IGkgPCAxMjg7IGkrKykgew0KKwkJCW1l
bWNweSgmcmVnLCBkYXRhK2kqc2l6ZW9mKHUzMiksIHNpemVvZih1MzIpKTsNCisJCQlwcl9kZWJ1
ZygiQkhUIE1TRzogICAgZ2djX3JlZzMyWyUwM2RdPTB4JTA4eFxuIiwgaSwgcmVnKTsNCisJCX0N
CisJfQ0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCitib29sIF9nZ2NfaHdfaW5qZWN0X21heV9yZWN1
cnNpdmUoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsIHUzMiBzZWwyMDAsDQorCQkJdTMyIHNlbDEw
MCwgaW50IG1heF9yZWN1ciwgYm9vbCB3cml0ZXRvYmgyMDEpDQorew0KKwlib29sIHJldCA9IFRS
VUUsIGNhcmRfc3RhdHVzID0gVFJVRTsNCisJaW50IHNlbGIgPSBCSVRfUEFTU19NQVNLOw0KKwlz
dHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQor
CXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKnZlbmRvcl9ob3N0ID0gc2RoY2lfcGx0Zm1f
cHJpdihwbHRmbV9ob3N0KTsNCisNCisJcmV0ID0gZ2djX2h3X2luamVjdF9leHQoaG9zdCwgJmNh
cmRfc3RhdHVzLCB2ZW5kb3JfaG9zdC0+Z2djLmdnY19jbWRfdHhfc2VsYl9mYWlsZWRfcmFuZ2Us
DQorCQkJdmVuZG9yX2hvc3QtPmdnYy5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlLCB3cml0
ZXRvYmgyMDEpOw0KKwlwcl9kZWJ1ZygiQkhUIE1TRzpyZXQ6JXhcbiIsIHJldCk7DQorCWlmICgo
cmV0ID09IEZBTFNFKSAmJiAoY2FyZF9zdGF0dXMgPT0gRkFMU0UpKSB7DQorCQlwcl9kZWJ1Zygi
QkhUIE1TRzppbmplY3QgYWdhaW4gd2hlbiBodyBpbmplY3RcbiIpOw0KKwkJc2VsYiAmPSB+R0VO
RVJBVEVfSURYX1ZBTFVFKHZlbmRvcl9ob3N0LT5nZ2MuZ2djX3N3X3NlbGJfdHVuaW5nX2ZpcnN0
X3NlbGIpOw0KKwkJdHhfc2VsYl9pbmplY3RfcG9saWN5KGhvc3QsIHNlbGIpOw0KKwkJX2dnY191
cGRhdGVfY3VyX3NldHRpbmdfZm9yX3N3X3NlbGJfdHVuaW5nKGhvc3QsDQorCQkJdmVuZG9yX2hv
c3QtPmdnYy5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlKTsNCisNCisJCWlmICgoKDExIC0g
Z2V0X2JpdF9udW1iZXIodmVuZG9yX2hvc3QtPmdnYy5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3Jh
bmdlKSkgPj0gNSkpIHsNCisJCQlwcl9lcnIoIkJIVCBFUlI6cGFzcyB3aW5kb3dzIHRvbyBzbWFs
bCxyZWluaXQgcmVjdXJzaXZlXG4iKTsNCisJCQlyZXR1cm4gRkFMU0U7DQorCQl9DQorDQorCQlp
ZiAobWF4X3JlY3VyLS0pDQorCQkJcmV0dXJuIF9nZ2NfaHdfaW5qZWN0X21heV9yZWN1cnNpdmUo
aG9zdCwNCisJCQl2ZW5kb3JfaG9zdC0+Z2djLmdnY19jbWRfdHhfc2VsYl9mYWlsZWRfcmFuZ2Us
DQorCQkJdmVuZG9yX2hvc3QtPmdnYy5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlLCBtYXhf
cmVjdXIsIHdyaXRldG9iaDIwMSk7DQorCQllbHNlDQorCQkJcmV0dXJuIEZBTFNFOw0KKwl9IGVs
c2UNCisJCXJldHVybiBUUlVFOw0KK30NCisNCitib29sIGdnY19od19pbmplY3RfbWF5X3JlY3Vy
c2l2ZShzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgdTMyIHNlbDIwMCwNCisJCQl1MzIgc2VsMTAw
LCBib29sIHdyaXRldG9iaDIwMSkNCit7DQorCXJldHVybiBfZ2djX2h3X2luamVjdF9tYXlfcmVj
dXJzaXZlKGhvc3QsIHNlbDIwMCwgc2VsMTAwLCA0LCB3cml0ZXRvYmgyMDEpOw0KK30NCisNCiti
b29sIGdldF9uZXh0X2RsbF92b2x0YWdlKGludCBjdXIsIGludCAqbmV4dCwgdTMyICpkbGxfdm9s
dGFnZV91bmxvY2tfY250LA0KKwkJCWludCAqZGxsX3ZvbHRhZ2Vfc2Nhbl9tYXApDQorew0KKwlp
bnQgbWluX2lkeCA9IDAsIGN1cl9jbnQgPSAwLCBuZXh0X2NudCA9IDA7DQorCWludCBjdXJfZmxn
ID0gMDsNCisJaW50IGkgPSAwOw0KKwl1OCByZXQgPSAwOw0KKw0KKwlwcl93YXJuKCJCSFQgV0FS
TjpkbGxfdm9sdGFnZV91bmxvY2tfY250OiV4ICV4ICV4ICV4XG4iLA0KKwkJCWRsbF92b2x0YWdl
X3VubG9ja19jbnRbMF0sIGRsbF92b2x0YWdlX3VubG9ja19jbnRbMV0sDQorCQkJZGxsX3ZvbHRh
Z2VfdW5sb2NrX2NudFsyXSwgZGxsX3ZvbHRhZ2VfdW5sb2NrX2NudFszXSk7DQorCXByX3dhcm4o
IkJIVCBXQVJOOmRsbF92b2x0YWdlX3NjYW5fbWFwOiV4ICV4ICV4ICV4XG4iLA0KKwkJCWRsbF92
b2x0YWdlX3NjYW5fbWFwWzBdLCBkbGxfdm9sdGFnZV9zY2FuX21hcFsxXSwNCisJCQlkbGxfdm9s
dGFnZV9zY2FuX21hcFsyXSwgZGxsX3ZvbHRhZ2Vfc2Nhbl9tYXBbM10pOw0KKwlmb3IgKGkgPSAx
OyBpIDwgNDsgaSsrKSB7DQorCQlpZiAoY3VyX2ZsZyA9PSAwKSB7DQorCQkJaWYgKGRsbF92b2x0
YWdlX3NjYW5fbWFwWyhjdXIgKyBpKSAlIDRdICE9IDApDQorCQkJCWNvbnRpbnVlOw0KKwkJCWN1
cl9jbnQgPSBkbGxfdm9sdGFnZV91bmxvY2tfY250WyhjdXIgKyBpKSAlIDRdOw0KKwkJCWN1cl9m
bGcgPSAxOw0KKwkJCW1pbl9pZHggPSAoY3VyICsgaSkgJSA0Ow0KKwkJCWNvbnRpbnVlOw0KKwkJ
fSBlbHNlIHsNCisJCQlpZiAoZGxsX3ZvbHRhZ2Vfc2Nhbl9tYXBbKGN1ciArIGkpICUgNF0gIT0g
MCkNCisJCQkJY29udGludWU7DQorCQkJbmV4dF9jbnQgPSBkbGxfdm9sdGFnZV91bmxvY2tfY250
WyhjdXIgKyBpKSAlIDRdOw0KKwkJCWlmIChjdXJfY250ID4gbmV4dF9jbnQpIHsNCisJCQkJY3Vy
X2NudCA9IG5leHRfY250Ow0KKwkJCQltaW5faWR4ID0gKGN1ciArIGkpICUgNDsNCisJCQl9DQor
CQl9DQorCX0NCisJaWYgKGN1cl9mbGcgPT0gMCkgew0KKwkJcHJfZXJyKCJCSFQgRVJSOm5vIGZp
bmQgYXZhaWxhYmxlIHZvbHRhZ2VcbiIpOw0KKwkJcmV0ID0gRkFMU0U7DQorCX0gZWxzZSB7DQor
CQkqbmV4dCA9IG1pbl9pZHg7DQorCQlwcl9lcnIoIkJIVCBFUlI6bmV4dCBhdmFpbGFibGUgdm9s
dGFnZSAlZFxuIiwgbWluX2lkeCk7DQorCQlyZXQgPSBUUlVFOw0KKwl9DQorCXJldHVybiByZXQ7
DQorfQ0KKw0KK2Jvb2wgZ2djX3N3X2NhbGNfdHVuaW5nX3Jlc3VsdChzdHJ1Y3Qgc2RoY2lfaG9z
dCAqaG9zdCwgYm9vbCAqY2FyZF9zdGF0dXMsDQorCQkJICAgICAgIGJvb2wgKnJlYWRfc3RhdHVz
LCB1MzIgKnR4X3NlbGIsIHUzMiAqYWxsX3NlbGIsIHU2NCAqcmF3X3R4X3NlbGIpDQorew0KKwli
b29sIHJldCA9IEZBTFNFOw0KKwlib29sIGNhcmRfcmV0ID0gRkFMU0U7DQorCWJvb2wgcmVhZF9y
ZXQgPSBGQUxTRTsNCisJdTMyIHNlbGJfc3RhdHVzX3R4X2xvdzMyID0gMCwgc2VsYl9zdGF0dXNf
dHhfaGlnaDMyID0gMDsNCisJdTMyIHNlbGJfc3RhdHVzX2dnY19sb3czMiA9IDAsIHNlbGJfc3Rh
dHVzX2dnY19oaWdoMzIgPSAwOw0KKwlzdHJ1Y3QgdF9nZ19yZWdfc3RydCBnZ19yZWdfYXJyWzhd
ID0ge3swfX07DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lf
cHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3Qg
PSBzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKw0KKwltZW1jcHkoJmdnX3JlZ19hcnJb
MF0sICZ2ZW5kb3JfaG9zdC0+Z2djLnBoYV9zdGFzX3R4X2xvdzMyLA0KKwkJc2l6ZW9mKHN0cnVj
dCB0X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVnX2FyclsxXSwgJnZlbmRvcl9ob3N0
LT5nZ2MucGhhX3N0YXNfdHhfaGlnaDMyLA0KKwkJc2l6ZW9mKHN0cnVjdCB0X2dnX3JlZ19zdHJ0
KSk7DQorCW1lbWNweSgmZ2dfcmVnX2FyclsyXSwgJnZlbmRvcl9ob3N0LT5nZ2MucGhhX3N0YXNf
cnhfbG93MzIsDQorCQlzaXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZn
Z19yZWdfYXJyWzNdLCAmdmVuZG9yX2hvc3QtPmdnYy5waGFfc3Rhc19yeF9oaWdoMzIsDQorCQlz
aXplb2Yoc3RydWN0IHRfZ2dfcmVnX3N0cnQpKTsNCisJbWVtY3B5KCZnZ19yZWdfYXJyWzRdLCAm
dmVuZG9yX2hvc3QtPmdnYy5kbGxfc2VsYV9hZnRlcl9tYXNrLA0KKwkJc2l6ZW9mKHN0cnVjdCB0
X2dnX3JlZ19zdHJ0KSk7DQorCW1lbWNweSgmZ2dfcmVnX2Fycls1XSwgJnZlbmRvcl9ob3N0LT5n
Z2MuZGxsX3NlbGJfYWZ0ZXJfbWFzaywNCisJCXNpemVvZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkp
Ow0KKwltZW1jcHkoJmdnX3JlZ19hcnJbNl0sICZ2ZW5kb3JfaG9zdC0+Z2djLmRsbF9kZWxheV8x
MDBtX2JhY2t1cCwNCisJCXNpemVvZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKwltZW1jcHko
JmdnX3JlZ19hcnJbN10sICZ2ZW5kb3JfaG9zdC0+Z2djLmRsbF9kZWxheV8yMDBtX2JhY2t1cCwN
CisJCXNpemVvZihzdHJ1Y3QgdF9nZ19yZWdfc3RydCkpOw0KKw0KKwlyZXQgPSBnZ2NfcmVhZF9y
ZWdpc3RlcnNfZXh0KGhvc3QsICZjYXJkX3JldCwgJnJlYWRfcmV0LCBnZ19yZWdfYXJyLCA4KTsN
CisJaWYgKHJlYWRfcmV0ID09IFRSVUUpIHsNCisJCXNlbGJfc3RhdHVzX3R4X2xvdzMyID0gZ2df
cmVnX2FyclswXS52YWx1ZTsNCisJCXByX2RlYnVnKCJCSFQgTVNHOlsyMDUtMjM2XTpcbiIpOw0K
KwkJbG9nX2JpbihzZWxiX3N0YXR1c190eF9sb3czMik7DQorCQlzZWxiX3N0YXR1c190eF9oaWdo
MzIgPSBnZ19yZWdfYXJyWzFdLnZhbHVlOw0KKwkJcHJfZGVidWcoIkJIVCBNU0c6WzIzNy0yNjhd
OlxuIik7DQorCQlsb2dfYmluKHNlbGJfc3RhdHVzX3R4X2hpZ2gzMik7DQorCQlzZWxiX3N0YXR1
c19nZ2NfbG93MzIgPSBnZ19yZWdfYXJyWzJdLnZhbHVlOw0KKwkJcHJfZGVidWcoIkJIVCBNU0c6
WzE0LTQ1XTpcbiIpOw0KKwkJbG9nX2JpbihzZWxiX3N0YXR1c19nZ2NfbG93MzIpOw0KKwkJc2Vs
Yl9zdGF0dXNfZ2djX2hpZ2gzMiA9IGdnX3JlZ19hcnJbM10udmFsdWU7DQorCQlwcl9kZWJ1Zygi
QkhUIE1TRzpbNDYtNzddOlxuIik7DQorCQlsb2dfYmluKHNlbGJfc3RhdHVzX2dnY19oaWdoMzIp
Ow0KKwkJcHJfZGVidWcoIkJIVCBNU0c6ZGxsICBzZWxhIGFmdGVyIG1hc2s9JXhoIiwgZ2dfcmVn
X2Fycls0XS52YWx1ZSk7DQorCQlwcl9kZWJ1ZygiQkhUIE1TRzpkbGwgIHNlbGIgYWZ0ZXIgbWFz
az0leGgiLCBnZ19yZWdfYXJyWzVdLnZhbHVlKTsNCisNCisJCWlmIChyYXdfdHhfc2VsYikgew0K
KwkJCSpyYXdfdHhfc2VsYiA9IGdnX3JlZ19hcnJbMV0udmFsdWU7DQorCQkJKCpyYXdfdHhfc2Vs
YikgPDw9IDMyOw0KKwkJCSpyYXdfdHhfc2VsYiArPSBnZ19yZWdfYXJyWzBdLnZhbHVlOw0KKwkJ
CXByX2RlYnVnKCJCSFQgTVNHOnJhd190eF9zZWxiOiVsbHhoXG4iLCAqcmF3X3R4X3NlbGIpOw0K
KwkJfQ0KKw0KKwkJaWYgKHR4X3NlbGIpIHsNCisJCQlnZW5fYXJyYXlfZGF0YShnZ19yZWdfYXJy
WzBdLnZhbHVlLCBnZ19yZWdfYXJyWzFdLnZhbHVlLA0KKwkJCQkgICAgICAgdHhfc2VsYik7DQor
CQkJcHJfZGVidWcoIkJIVCBNU0c6dHhfc2VsYjoleGhcbiIsICp0eF9zZWxiKTsNCisJCX0NCisJ
CWlmIChhbGxfc2VsYikgew0KKwkJCWdlbl9hcnJheV9kYXRhKGdnX3JlZ19hcnJbMl0udmFsdWUs
IGdnX3JlZ19hcnJbM10udmFsdWUsDQorCQkJCSAgICAgICBhbGxfc2VsYik7DQorCQkJcHJfZGVi
dWcoIkJIVCBNU0c6YWxsX3NlbGI6JXhoXG4iLCAqYWxsX3NlbGIpOw0KKwkJfQ0KKwl9DQorDQor
CWlmIChyZWFkX3N0YXR1cykNCisJCSgqcmVhZF9zdGF0dXMpID0gcmVhZF9yZXQ7DQorCWlmIChj
YXJkX3N0YXR1cykNCisJCSgqY2FyZF9zdGF0dXMpID0gY2FyZF9yZXQ7DQorDQorCWlmIChjYXJk
X3N0YXR1cyAmJiByZWFkX3N0YXR1cykNCisJCXByX2RlYnVnKCJCSFQgTVNHOmNhcmRfc3RhdHVz
LHJlYWRfc3RhdHVzOiV4ICV4XG4iLCAqY2FyZF9zdGF0dXMsICpyZWFkX3N0YXR1cyk7DQorCXJl
dHVybiByZXQ7DQorfQ0KKw0KK2Jvb2wgX2dnY19jYWxjX2N1cl9zZWxhX3R1bmluZ19yZXN1bHQo
c3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsIGludCBjdXJfc2VsYSwgaW50IHN0YXJ0X3NlbGIpDQor
ew0KKwlib29sIHJlYWRfc3RhdHVzID0gRkFMU0U7DQorCWJvb2wgY2FyZF9zdGF0dXMgPSBGQUxT
RTsNCisJYm9vbCByZXQgPSBUUlVFOw0KKwl1MzIgdHhfc2VsYiwgYWxsX3NlbGI7DQorCXU2NCBy
YXdfdHhfc2VsYiA9IDA7DQorCWJvb2wgcmV0dW5pbmdfZmxnID0gRkFMU0U7DQorCXN0cnVjdCBz
ZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0
IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPSBzZGhjaV9wbHRmbV9wcml2KHBs
dGZtX2hvc3QpOw0KKwlpbnQgc2VsYjsNCisJc3RydWN0IGdnY19wbGF0Zm9ybV90ICpnZ2MgPSAm
dmVuZG9yX2hvc3QtPmdnYzsNCisJZW51bSB0dW5pbmdfc3RhdF9ldCAqcHNlbGFfdHVuaW5nX3Jl
c3VsdCA9IGdnYy0+Z2djX3NlbGFfdHVuaW5nX3Jlc3VsdDsNCisNCisJcmV0ID0gZ2djX3N3X2Nh
bGNfdHVuaW5nX3Jlc3VsdChob3N0LCAmY2FyZF9zdGF0dXMsDQorCQkJJnJlYWRfc3RhdHVzLCAm
dHhfc2VsYiwgJmFsbF9zZWxiLCAmcmF3X3R4X3NlbGIpOw0KKw0KKwlpZiAoY2FyZF9zdGF0dXMg
PT0gRkFMU0UpIHsNCisJCWlmIChyZWFkX3N0YXR1cyA9PSBUUlVFKSB7DQorCQkJc2VsYiA9IGdl
dF9zZWxiX2ZhaWx1cmVfcG9pbnQoc3RhcnRfc2VsYiwgcmF3X3R4X3NlbGIsDQorCQkJCQlnZ2Nf
Z2V0X3R1bmluZ19jbnRfZnJvbV9idWZmZXIoaG9zdCkpOw0KKwkJCXByX2RlYnVnKCJCSFQgTVNH
OmluamVjdCBzZWxiICUwM3ggZm9yIENNRDcgcmVhZCB0aW1lb3V0XG4iLCBzZWxiKTsNCisJCQl0
eF9zZWxiX2luamVjdF9wb2xpY3koaG9zdCwgc2VsYik7DQorCQl9IGVsc2Ugew0KKwkJCXByX2Rl
YnVnKCJCSFQgTVNHOiVzIGRsbDoleGggcmVhZCBzdGF0dXMgZmFpbGVkXG4iLA0KKwkJCQkJX19m
dW5jX18sIGN1cl9zZWxhKTsNCisJCX0NCisJCXJldCA9IEZBTFNFOw0KKwkJZ290byBleGl0Ow0K
Kwl9IGVsc2Ugew0KKwkJaWYgKHJlYWRfc3RhdHVzID09IFRSVUUpIHsNCisJCQlpZiAoc2VseF9m
YWlsdXJlX3BvaW50X2V4aXN0KHR4X3NlbGIpKSB7DQorCQkJCWlmICgoMTEtZ2V0X2JpdF9udW1i
ZXIodHhfc2VsYikpIDw9IDMpIHsNCisJCQkJCXR4X3NlbGJfaW5qZWN0X3BvbGljeShob3N0LCB0
eF9zZWxiKTsNCisJCQkJCWFsbF9zZWxiX2ZhaWxlZF90Yl91cGRhdGUoaG9zdCwgY3VyX3NlbGEs
IGFsbF9zZWxiKTsNCisJCQkJCXR4X3NlbGJfZmFpbGVkX3RiX3VwZGF0ZShob3N0LCBjdXJfc2Vs
YSwgdHhfc2VsYik7DQorCQkJCQl0eF9zZWxiX2ZhaWxlZF9oaXN0b3J5X3VwZGF0ZShob3N0LCB0
eF9zZWxiKTsNCisJCQkJfSBlbHNlIGlmIChnZXRfYml0X251bWJlcih0eF9zZWxiKSA9PSAwKSB7
DQorCQkJCQlzZWxiID0gZ2V0X3NlbGJfZmFpbHVyZV9wb2ludChzdGFydF9zZWxiLCByYXdfdHhf
c2VsYiwNCisJCQkJCQkJZ2djX2dldF90dW5pbmdfY250X2Zyb21fYnVmZmVyKGhvc3QpKTsNCisJ
CQkJCXR4X3NlbGJfaW5qZWN0X3BvbGljeShob3N0LCBzZWxiKTsNCisJCQkJCWFsbF9zZWxiX2Zh
aWxlZF90Yl91cGRhdGUoaG9zdCwgY3VyX3NlbGEsIGFsbF9zZWxiKTsNCisJCQkJCXR4X3NlbGJf
ZmFpbGVkX3RiX3VwZGF0ZShob3N0LCBjdXJfc2VsYSwgc2VsYik7DQorCQkJCQl0eF9zZWxiX2Zh
aWxlZF9oaXN0b3J5X3VwZGF0ZShob3N0LCBzZWxiKTsNCisJCQkJCXJldHVuaW5nX2ZsZyA9IFRS
VUU7DQorCQkJCX0gZWxzZSB7DQorCQkJCQl0eF9zZWxiX2luamVjdF9wb2xpY3koaG9zdCwgdHhf
c2VsYik7DQorCQkJCQlhbGxfc2VsYl9mYWlsZWRfdGJfdXBkYXRlKGhvc3QsIGN1cl9zZWxhLCBh
bGxfc2VsYik7DQorCQkJCQl0eF9zZWxiX2ZhaWxlZF90Yl91cGRhdGUoaG9zdCwgY3VyX3NlbGEs
IHR4X3NlbGIpOw0KKwkJCQkJdHhfc2VsYl9mYWlsZWRfaGlzdG9yeV91cGRhdGUoaG9zdCwgdHhf
c2VsYik7DQorCQkJCQlyZXR1bmluZ19mbGcgPSBUUlVFOw0KKwkJCQl9DQorDQorCQkJCV9nZ2Nf
dXBkYXRlX2N1cl9zZXR0aW5nX2Zvcl9zd19zZWxiX3R1bmluZyhob3N0LA0KKwkJCQkJCWdnYy0+
Z2djX2NtZF90eF9zZWxiX2ZhaWxlZF9yYW5nZSk7DQorCQkJCWdnY19od19pbmplY3RfbWF5X3Jl
Y3Vyc2l2ZShob3N0LCBnZ2MtPmdnY19jbWRfdHhfc2VsYl9mYWlsZWRfcmFuZ2UsDQorCQkJCQkJ
Z2djLT5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlLCBUUlVFKTsNCisJCQl9IGVsc2Ugew0K
KwkJCQlhbGxfc2VsYl9mYWlsZWRfdGJfdXBkYXRlKGhvc3QsIGN1cl9zZWxhLCBhbGxfc2VsYik7
DQorCQkJCXR4X3NlbGJfZmFpbGVkX3RiX3VwZGF0ZShob3N0LCBjdXJfc2VsYSwgdHhfc2VsYik7
DQorCQkJCXR4X3NlbGJfZmFpbGVkX2hpc3RvcnlfdXBkYXRlKGhvc3QsIHR4X3NlbGIpOw0KKwkJ
CX0NCisNCisJCQlpZiAocmV0dW5pbmdfZmxnID09IFRSVUUpIHsNCisJCQkJcHJfZGVidWcoIkJI
VCBNU0c6ICVzIGRsbDoleGggbmVlZCByZXR1bmluZ1xuIiwNCisJCQkJCQlfX2Z1bmNfXywgY3Vy
X3NlbGEpOw0KKwkJCQlwc2VsYV90dW5pbmdfcmVzdWx0W2N1cl9zZWxhXSA9IFJFVFVOSU5HX0NB
U0U7DQorCQkJfSBlbHNlIHsNCisJCQkJcHJfZGVidWcoIkJIVCBNU0c6ICVzIGRsbDoleGggcGFz
c1xuIiwNCisJCQkJCQlfX2Z1bmNfXywgY3VyX3NlbGEpOw0KKwkJCQlwc2VsYV90dW5pbmdfcmVz
dWx0W2N1cl9zZWxhXSA9IE9VVFBVVF9QQVNTX1RZUEU7DQorCQkJfQ0KKwkJfSBlbHNlIHsNCisJ
CQlwc2VsYV90dW5pbmdfcmVzdWx0W2N1cl9zZWxhXSA9IFJFQURfU1RBVFVTX0ZBSUxfVFlQRTsN
CisJCQlhbGxfc2VsYl9mYWlsZWRfdGJfdXBkYXRlKGhvc3QsIGN1cl9zZWxhLCAwKTsNCisJCQlw
cl9kZWJ1ZygiQkhUIE1TRzo9PSAlcyBkbGw6JXhoIHJlYWQgc3RhdHVzIGZhaWxlZCA9PVxuIiwN
CisJCQkJCV9fZnVuY19fLCBjdXJfc2VsYSk7DQorCQl9DQorCX0NCitleGl0Og0KKwlyZXR1cm4g
cmV0Ow0KK30NCitzdGF0aWMgaW50IHNkaGNpX2JodF9zZHIxMDRfZXhlY3V0ZV90dW5pbmcoc3Ry
dWN0IHNkaGNpX2hvc3QgKmhvc3QsIHUzMiBvcGNvZGUpDQorew0KKwlzdHJ1Y3QgbW1jX2hvc3Qg
Km1tYyA9IGhvc3QtPm1tYzsNCisNCisJcmV0dXJuIHNkaGNpX21zbV9iYXlodWJfZXhlY3V0ZV90
dW5pbmcobW1jLCBvcGNvZGUpOw0KK30NCisNCitzdGF0aWMgaW50IHNkX3R1bmluZ19zdyhzdHJ1
Y3Qgc2RoY2lfaG9zdCAqaG9zdCkNCit7DQorCWludCByZXQgPSAwOw0KKw0KKwlpZiAoaXNfYnVz
X21vZGVfc2RyMTA0KGhvc3QpKQ0KKwkJcmV0ID0gc2RoY2lfYmh0X3NkcjEwNF9leGVjdXRlX3R1
bmluZyhob3N0LCAweDEzKTsNCisJZWxzZQ0KKwkJcmV0ID0gc2RoY2lfYmh0X3NkcjUwX2V4ZWN1
dGVfdHVuaW5nKGhvc3QsIDB4MTMpOw0KKw0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMg
Ym9vbCBzZF9nZ190dW5pbmdfc3RhdHVzKHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LA0KKwkJCSB1
MzIgKnR4X3NlbGIsIHUzMiAqYWxsX3NlbGIsIHU2NCAqcmF3X3R4X3NlbGIsDQorCQkJIGJvb2wg
KnN0YXR1c19yZXQsIGJvb2wgKmZpcnN0X2NtZDE5X3N0YXR1cykNCit7DQorCWJvb2wgcmV0ID0g
VFJVRTsNCisJaW50IGVyciA9IHNkX3R1bmluZ19zdyhob3N0KTsNCisNCisJcmV0ID0gZXJyID09
IDAgPyBUUlVFIDogRkFMU0U7DQorCWlmIChlcnIgPT0gLUVUSU1FRE9VVCkgew0KKwkJcmV0ID0g
RkFMU0U7DQorCQlpZiAoZmlyc3RfY21kMTlfc3RhdHVzKQ0KKwkJCSpmaXJzdF9jbWQxOV9zdGF0
dXMgPSBmYWxzZTsNCisJCWdvdG8gZXhpdDsNCisJfQ0KKw0KKwlpZiAoc3RhdHVzX3JldCkgew0K
KwkJKnN0YXR1c19yZXQgPQ0KKwkJCWdnX3R1bmluZ19yZXN1bHQoaG9zdCwgdHhfc2VsYiwgYWxs
X3NlbGIsDQorCQkJCQkJcmF3X3R4X3NlbGIpOw0KKwl9IGVsc2Ugew0KKwkJZ2dfdHVuaW5nX3Jl
c3VsdChob3N0LCAwLCAwLCAwKTsNCisJfQ0KKw0KK2V4aXQ6DQorCXJldHVybiByZXQ7DQorfQ0K
Kw0KK3N0YXRpYyBib29sIGdnY19zZF90dW5pbmcoc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QsDQor
CQkJIGJvb2wgKmZpcnN0X2NtZDE5X3N0YXR1cykNCit7DQorCWJvb2wgcmV0ID0gVFJVRTsNCisJ
aW50IGVyciA9IHNkX3R1bmluZ19zdyhob3N0KTsNCisNCisJcmV0ID0gZXJyID09IDAgPyBUUlVF
IDogRkFMU0U7DQorCWlmIChlcnIgPT0gLUVUSU1FRE9VVCkgew0KKwkJcmV0ID0gRkFMU0U7DQor
CQlpZiAoZmlyc3RfY21kMTlfc3RhdHVzKQ0KKwkJCSpmaXJzdF9jbWQxOV9zdGF0dXMgPSBmYWxz
ZTsNCisJCWdvdG8gZXhpdDsNCisJfQ0KKw0KK2V4aXQ6DQorCXJldHVybiByZXQ7DQorfQ0KKw0K
K3N0YXRpYyBib29sIF9nZ2Nfb3V0cHV0X3R1bmluZyhzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwg
dTggKnNlbGJfcGFzc193aW4pDQorew0KKwlpbnQgY3VyX3NlbGEgPSAwLCBkbGxfc2VsYV9jbnQg
PSAwOw0KKwlpbnQgZGxsX3NlbGFfYmFzaXMgPSAwOw0KKwlib29sIHJldCA9IEZBTFNFOw0KKwl1
OCB3aW5fdGJbMTJdID0geyAwIH07DQorCXU4IHdpbl9taWQgPSAwOw0KKwl1OCB3aW5fbWF4ID0g
MDsNCisJdTMyIHR4X3RtcCA9IDA7DQorCWludCB0YXJnZXRfc2VsYSA9IDA7DQorCWludCB0YXJn
ZXRfc2VsYiA9IDA7DQorCXUzMiBhbGxfc2VsYSwgdHhfc2VsYiwgYWxsX3NlbGI7DQorCXU2NCBy
YXdfdHhfc2VsYjsNCisJYm9vbCBzdGF0dXNfcmV0ID0gRkFMU0U7DQorCWludCBjdXJfc2VsYiA9
IDA7DQorCWludCB0dW5pbmdfZXJyb3JfdHlwZVsxNl0gPSB7IDAgfTsNCisJc3RydWN0IHNkaGNp
X3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2Ro
Y2lfbXNtX2JheWh1Yl9ob3N0ICp2ZW5kb3JfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1f
aG9zdCk7DQorCXN0cnVjdCBnZ2NfcGxhdGZvcm1fdCAqZ2djID0gJnZlbmRvcl9ob3N0LT5nZ2M7
DQorCWVudW0gdHVuaW5nX3N0YXRfZXQgKnBzZWxhX3R1bmluZ19yZXN1bHQgPSBnZ2MtPmdnY19z
ZWxhX3R1bmluZ19yZXN1bHQ7DQorCWludCBpID0gMDsNCisJdTMyIGlkeF9yLCBpZHhfYzsNCisJ
dTMyIG1pbl9wb3MgPSAwOw0KKwl1MzIgYWxsX3NlbGJfYXJbVFVOSU5HX1BIQVNFX1NJWkVdID0g
eyAwIH07DQorCXUzMiBwYXNzX2NudFtUVU5JTkdfUEhBU0VfU0laRV0gPSB7IDAgfTsNCisJdTMy
IGNmZyA9IDA7DQorCWludCByZXNjYW5fc2VsYl9jbnQgPSAwOw0KKwlpbnQgcmV0dXJuaW5nX3Nl
bGJfY250ID0gMDsNCisJYm9vbCBmaXJzdF9jbWQxOV9zdGEgPSBUUlVFOw0KKwlpbnQgbmV4dCA9
IDA7DQorCWJvb2wgY2FyZF9zdGF0dXMgPSBUUlVFOw0KKwlpbnQgc2VsYiA9CUJJVF9QQVNTX01B
U0s7DQorCXU4IGFsbF9zdHJbVFVOSU5HX1BIQVNFX1NJWkUgKyAxXSwgdHhfc3RyW1RVTklOR19Q
SEFTRV9TSVpFICsgMV07DQorDQorCWdnYy0+ZHJpdmVyX3N0cmVuZ3RoX3JlaW5pdF9mbGcgPSAw
Ow0KKwl2ZW5kb3JfaG9zdC0+Z2djLmRsbF91bmxvY2tfcmVpbml0X2ZsZyA9IDA7DQorCWRsbF9z
ZWxhX2Jhc2lzID0gZ2V0X2NvbmZpZ19zZWxhX3NldHRpbmcoaG9zdCk7DQorCWN1cl9zZWxiID0g
Z2V0X2NvbmZpZ19zZWxiX3NldHRpbmcoaG9zdCk7DQorDQorCWlmIChnZ2MtPnR1bmluZ19jbWQ3
X3RpbWVvdXRfcmVpbml0X2ZsZykgew0KKwkJZ2djLT50dW5pbmdfY21kN190aW1lb3V0X3JlaW5p
dF9mbGcgPSAwOw0KKwkJZGxsX3NlbGFfYmFzaXMgPSB2ZW5kb3JfaG9zdC0+Z2djLmdnY19jdXJf
c2VsYTsNCisJCWN1cl9zZWxiID0gdmVuZG9yX2hvc3QtPmdnYy5nZ2Nfc3dfc2VsYl90dW5pbmdf
Zmlyc3Rfc2VsYjsNCisJCXByX2RlYnVnDQorCQkoIkJIVCBNU0c6VHVuaW5nIHN0YXJ0IHNlbGE6
IDB4JXgsIHNlbGI6IDB4JXggd2hlcmUgQ01ENyB0aW1lb3V0XG4iLA0KKwkJCQlkbGxfc2VsYV9i
YXNpcywgY3VyX3NlbGIpOw0KKwl9DQorDQorCWZvciAoZGxsX3NlbGFfY250ID0gMDsgZGxsX3Nl
bGFfY250IDwgVFVOSU5HX1BIQVNFX1NJWkU7IGRsbF9zZWxhX2NudCsrKSB7DQorCQljdXJfc2Vs
YSA9DQorCQkJCShkbGxfc2VsYV9jbnQgKyBkbGxfc2VsYV9iYXNpcykgJSBUVU5JTkdfUEhBU0Vf
U0laRTsNCisJCWdnYy0+Z2djX2N1cl9zZWxhID0gY3VyX3NlbGE7DQorCQlwcl9kZWJ1ZygiQkhU
IE1TRzogJXMgc2VsZWN0IHNlbGEgZGxsOiAleCwgc2VsYiBkbGw6ICV4XG4iLA0KKwkJCQlfX2Z1
bmNfXywgY3VyX3NlbGEsIGN1cl9zZWxiKTsNCisJCWlmIChwc2VsYV90dW5pbmdfcmVzdWx0W2N1
cl9zZWxhXSAhPSBOT19UVU5JTkcpIHsNCisJCQlwcl9kZWJ1ZygiQkhUIE1TRzpzZWxhIHR1bmlu
Zz0lZCBhbHJlYWR5IHR1bmluZyxzbyBza2lwIGl0XG4iLCBjdXJfc2VsYSk7DQorCQkJY29udGlu
dWU7DQorCQl9DQorcmVzY2FuX3NlbGI6DQorCQlob3N0X2NtZGRhdF9saW5lX3Jlc2V0KGhvc3Qp
Ow0KKw0KKwkJaWYgKGRsbF9zZWxhX2NudCA9PSAwKSB7DQorCQkJaWYgKCFzZWx4X2ZhaWx1cmVf
cG9pbnRfZXhpc3QNCisJCQkJCSh2ZW5kb3JfaG9zdC0+Z2djLmdnY19jbWRfdHhfc2VsYl9mYWls
ZWRfcmFuZ2UpKSB7DQorCQkJCXJlc2Nhbl9zZWxiX2NudCA9IDM7DQorCQkJCXByX2RlYnVnKCJC
SFQgTVNHOm5vIG5lZWQgcmVzY2FuIGNhc2VcbiIpOw0KKwkJCX0NCisJCQlzdGF0dXNfcmV0ID0g
RkFMU0U7DQorCQkJcmV0ID0gZ2djX3NkX3R1bmluZyhob3N0LCAmZmlyc3RfY21kMTlfc3RhKTsN
CisNCisJCQlpZiAoZmlyc3RfY21kMTlfc3RhID09IEZBTFNFKSB7DQorCQkJCV9jaGVja19idXNf
bW9kZShob3N0KTsNCisJCQkJZ2djLT5jdXJfYnVzX21vZGUtPmRsbF92b2x0YWdlX3VubG9ja19j
bnQNCisJCQkJCQkJW2dnYy0+Y3VyX2RsbF92b2x0YWdlX2lkeF0rKzsNCisJCQkJZ2djLT5kbGxf
dm9sdGFnZV9zY2FuX21hcFtnZ2MtPmN1cl9kbGxfdm9sdGFnZV9pZHhdID0gMTsNCisJCQkJaWYg
KGdldF9uZXh0X2RsbF92b2x0YWdlKGdnYy0+Y3VyX2RsbF92b2x0YWdlX2lkeCwgJm5leHQsDQor
CQkJCQlnZ2MtPmN1cl9idXNfbW9kZS0+ZGxsX3ZvbHRhZ2VfdW5sb2NrX2NudCwNCisJCQkJCWdn
Yy0+ZGxsX3ZvbHRhZ2Vfc2Nhbl9tYXApID09IFRSVUUpDQorCQkJCQlnZ2MtPmN1cl9kbGxfdm9s
dGFnZV9pZHggPSBuZXh0Ow0KKwkJCQllbHNlDQorCQkJCQlnZ2MtPmN1cl9kbGxfdm9sdGFnZV9p
ZHggPQ0KKwkJCQkJCQkoZ2djLT5jdXJfZGxsX3ZvbHRhZ2VfaWR4ICsgMSkgJSA0Ow0KKw0KKwkJ
CQlwcl9lcnIoIkJIVCBFUlI6Zmlyc3QgY21kMTkgdGltZW91dFxuIik7DQorCQkJCXZlbmRvcl9o
b3N0LT5nZ2MuZGxsX3VubG9ja19yZWluaXRfZmxnID0gMTsNCisJCQkJX2dnY19yZXNldF90dW5p
bmdfcmVzdWx0X2Zvcl9kbGwoaG9zdCk7DQorCQkJCXJldCA9IEZBTFNFOw0KKwkJCQlnb3RvIGV4
aXQ7DQorCQkJfQ0KKwkJfSBlbHNlIGlmICgoaXNfYnVzX21vZGVfc2RyMTA0KGhvc3QpID09IEZB
TFNFKQ0KKwkJCQkmJiB2ZW5kb3JfaG9zdC0+Z2djLnNkcjUwX25vdHVuaW5nX3NlbGFfaW5qZWN0
X2ZsYWcgPT0gMQ0KKwkJCQkmJiAhR0VUX0lEWF9WQUxVRSh2ZW5kb3JfaG9zdC0+Z2djLnNkcjUw
X25vdHVuaW5nX3NlbGFfcnhfaW5qZWN0LA0KKwkJCQljdXJfc2VsYSkpIHsNCisJCQlwcl9kZWJ1
ZygiQkhUIE1TRzpza2lwICVkXG4iLCBjdXJfc2VsYSk7DQorCQkJdHVuaW5nX2Vycm9yX3R5cGVb
Y3VyX3NlbGFdID0gUkVBRF9TVEFUVVNfRkFJTF9UWVBFOw0KKwkJCWdvdG8gY3VyX3NlbGFfZmFp
bGVkOw0KKwkJfSBlbHNlIHsNCisJCQlyZXQgPSBnZ2Nfc2V0X291dHB1dF90dW5pbmdfcGhhc2Vf
ZXh0KGhvc3QsICZjYXJkX3N0YXR1cywNCisJCQkJY3VyX3NlbGEsIHVwZGF0ZV9zZWxiKGhvc3Qs
IGN1cl9zZWxiKSk7DQorCQkJaWYgKHJldCA9PSBGQUxTRSB8fCBjYXJkX3N0YXR1cyA9PSBGQUxT
RSkgew0KKwkJCQlwcl9lcnINCisJCQkJKCJCSFQgRVJSOiBvdXRwdXRfdHVuaW5nIGZhaWwgYXQg
cGhhc2UgJWQscmV0PSVkLGNhcmRfc3RhdHVzPSVkXG4iLA0KKwkJCQkJCWN1cl9zZWxhLCByZXQs
IGNhcmRfc3RhdHVzKTsNCisJCQkJaWYgKGNhcmRfc3RhdHVzID09IEZBTFNFKSB7DQorCQkJCQlz
ZWxiICY9IH5HRU5FUkFURV9JRFhfVkFMVUUoY3VyX3NlbGIpOw0KKwkJCQkJcHJfZXJyKCJCSFQg
RVJSOmluamVjdCBzZWxiICVkIGZvciB1cGRhdGUgc2VsYS9zZWxiIGZhaWxcbiIsDQorCQkJCQkJ
CXNlbGIpOw0KKwkJCQkJdHhfc2VsYl9pbmplY3RfcG9saWN5KGhvc3QsIHNlbGIpOw0KKwkJCQkJ
X2dnY191cGRhdGVfY3VyX3NldHRpbmdfZm9yX3N3X3NlbGJfdHVuaW5nKGhvc3QsDQorCQkJCQkJ
Z2djLT5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlKTsNCisJCQkJCWdnY19od19pbmplY3Rf
bWF5X3JlY3Vyc2l2ZShob3N0LA0KKwkJCQkJCQlnZ2MtPmdnY19jbWRfdHhfc2VsYl9mYWlsZWRf
cmFuZ2UsDQorCQkJCQkJCWdnYy0+Z2djX2NtZF90eF9zZWxiX2ZhaWxlZF9yYW5nZSwgVFJVRSk7
DQorDQorCQkJCQlpZiAoKCgxMSAtIGdldF9iaXRfbnVtYmVyKA0KKwkJCQkJCWdnYy0+Z2djX2Nt
ZF90eF9zZWxiX2ZhaWxlZF9yYW5nZSkpCT49IDUpKSB7DQorCQkJCQkJdTggY3VycmVudF9kcyA9
ICh1OCkoZ2djLT5fZ2dfcmVnX2N1clsxNV0gPj4gMjgpOw0KKw0KKwkJCQkJCXByX2VycigiQkhU
IEVSUjpwYXNzIHdpbmRvd3MgdG9vIHNtYWxsXG4iKTsNCisNCisJCQkJCQlnZ2MtPmRyaXZlcl9z
dHJlbmd0aF9yZWluaXRfZmxnICA9DQorCQkJCQkJY3VycmVudF9kcyA8IDcgPyBjdXJyZW50X2Rz
ICsgMSA6IDc7DQorDQorCQkJCQkJZ2djLT5fZ2dfcmVnX2N1clsxNV0gJj0gMHgwRjBGRkZGRjsN
CisJCQkJCQlnZ2MtPl9nZ19yZWdfY3VyWzE1XSB8PQ0KKwkJCQkJCShnZ2MtPmRyaXZlcl9zdHJl
bmd0aF9yZWluaXRfZmxnIDw8IDI4KQ0KKwkJCQkJCXwgKGdnYy0+ZHJpdmVyX3N0cmVuZ3RoX3Jl
aW5pdF9mbGcgPDwgMjApOw0KKwkJCQkJCXJldCA9IEZBTFNFOw0KKw0KKwkJCQkJCWdvdG8gZXhp
dDsNCisJCQkJCX0NCisJCQkJCWN1cl9zZWxiID0gX2dnY19nZXRfc3VpdGFibGVfc2VsYl9mb3Jf
bmV4dF90dW5pbmcoaG9zdCk7DQorCQkJCX0NCisJCQkJcHNlbGFfdHVuaW5nX3Jlc3VsdFtjdXJf
c2VsYV0gPSBSRVRVTklOR19DQVNFOw0KKwkJCQlnb3RvIHJldHVuaW5nX2Nhc2U7DQorCQkJfQ0K
KwkJCXJldCA9IGdnY19zZF90dW5pbmcoaG9zdCwgTlVMTCk7DQorCQl9DQorDQorCQlpZiAocmV0
ID09IEZBTFNFKSB7DQorCQkJcHJfZXJyKCJCSFQgRVJSOkVycm9yIHdoZW4gb3V0cHV0X3R1bmlu
ZywgZmFpbCBhdCBwaGFzZSAlZFxuIiwNCisJCQkJCWN1cl9zZWxhKTsNCisJCQlwc2VsYV90dW5p
bmdfcmVzdWx0W2N1cl9zZWxhXSA9IFRVTklOR19GQUlMX1RZUEU7DQorCQkJYWxsX3NlbGJfZmFp
bGVkX3RiX3VwZGF0ZShob3N0LCBjdXJfc2VsYSwgMCk7DQorCQkJY29udGludWU7DQorCQl9DQor
DQorCQlyZXQgPSBfZ2djX2NhbGNfY3VyX3NlbGFfdHVuaW5nX3Jlc3VsdChob3N0LCBjdXJfc2Vs
YSwgY3VyX3NlbGIpOw0KKw0KKwkJaWYgKCgxMSAtIGdldF9iaXRfbnVtYmVyKHZlbmRvcl9ob3N0
LT5nZ2MuZ2djX2NtZF90eF9zZWxiX2ZhaWxlZF9yYW5nZSkpID49IDUpIHsNCisJCQl1OCBjdXJy
ZW50X2RzID0gKHU4KShnZ2MtPl9nZ19yZWdfY3VyWzE1XSA+PiAyOCk7DQorDQorCQkJcHJfZXJy
KCJCSFQgRVJSOnBhc3Mgd2luZG93cyB0b28gc21hbGwgYWZ0ZXIgcmVzdWx0IGNhbGN1bGF0ZSwg
cmVpbml0XG4iKTsNCisJCQlpZiAoY3VycmVudF9kcyA8IDcpDQorCQkJCWdnYy0+ZHJpdmVyX3N0
cmVuZ3RoX3JlaW5pdF9mbGcgPSBjdXJyZW50X2RzICsgMTsNCisJCQllbHNlDQorCQkJCWdnYy0+
ZHJpdmVyX3N0cmVuZ3RoX3JlaW5pdF9mbGcgPSA3Ow0KKw0KKwkJCWdnYy0+X2dnX3JlZ19jdXJb
MTVdICY9IDB4MEYwRkZGRkY7DQorCQkJZ2djLT5fZ2dfcmVnX2N1clsxNV0gfD0NCisJCQkJKGdn
Yy0+ZHJpdmVyX3N0cmVuZ3RoX3JlaW5pdF9mbGcgPDwgMjgpDQorCQkJCXwgKGdnYy0+ZHJpdmVy
X3N0cmVuZ3RoX3JlaW5pdF9mbGcgPDwgMjApOw0KKwkJCXJldCA9IEZBTFNFOw0KKwkJCXByX2Vy
cigiQkhUIEVSUjp3aWxsIGNoYW5nZSBkcml2ZXIgc3RyZW5ndGggZnJvbSAlZCB0byAlZFxuIiwN
CisJCQkJCQkgY3VycmVudF9kcywNCisJCQkJCQkgZ2djLT5kcml2ZXJfc3RyZW5ndGhfcmVpbml0
X2ZsZyk7DQorCQkJZ290byBleGl0Ow0KKwkJfQ0KKw0KKwkJaWYgKHJldCA9PSBGQUxTRSkgew0K
KwkJCXByX2VycigiQkhUIEVSUjpjbWQ3IHRpbWVvdXQgZmFpbCxyZWluaXRcbiIpOw0KKwkJCXZl
bmRvcl9ob3N0LT5nZ2MudHVuaW5nX2NtZDdfdGltZW91dF9yZWluaXRfZmxnID0gMTsNCisNCisJ
CQlfZ2djX3VwZGF0ZV9jdXJfc2V0dGluZ19mb3Jfc3dfc2VsYl90dW5pbmcoaG9zdCwNCisJCQkJ
CQkJZ2djLT5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlKTsNCisJCQlnZ2NfaHdfaW5qZWN0
X21heV9yZWN1cnNpdmUoaG9zdCwgZ2djLT5nZ2NfY21kX3R4X3NlbGJfZmFpbGVkX3JhbmdlLA0K
KwkJCQkJCQlnZ2MtPmdnY19jbWRfdHhfc2VsYl9mYWlsZWRfcmFuZ2UsIEZBTFNFKTsNCisJCQlp
ZiAoKDExIC0gZ2V0X2JpdF9udW1iZXIodmVuZG9yX2hvc3QtPmdnYy5nZ2NfY21kX3R4X3NlbGJf
ZmFpbGVkX3JhbmdlKSkNCisJCQkJCQkJCQkJPj0gNSkgew0KKwkJCQl1OCBjdXJyZW50X2RzID0g
KHU4KShnZ2MtPl9nZ19yZWdfY3VyWzE1XSA+PiAyOCk7DQorDQorCQkJCXByX2VycigiQkhUIEVS
UjpwYXNzIHdpbmRvd3MgdG9vIHNtYWxsLCBkcml2ZXIgc3RyZW5ndGggcmVpbml0XG4iKTsNCisN
CisJCQkJdmVuZG9yX2hvc3QtPmdnYy50dW5pbmdfY21kN190aW1lb3V0X3JlaW5pdF9mbGcgPSAw
Ow0KKw0KKwkJCQlnZ2MtPmRyaXZlcl9zdHJlbmd0aF9yZWluaXRfZmxnICA9DQorCQkJCQkJY3Vy
cmVudF9kcyA8IDcgPyBjdXJyZW50X2RzICsgMSA6IDc7DQorDQorCQkJCWdnYy0+X2dnX3JlZ19j
dXJbMTVdICY9IDB4MEYwRkZGRkY7DQorCQkJCWdnYy0+X2dnX3JlZ19jdXJbMTVdIHw9DQorCQkJ
CQkoZ2djLT5kcml2ZXJfc3RyZW5ndGhfcmVpbml0X2ZsZyA8PCAyOCkNCisJCQkJCXwgKGdnYy0+
ZHJpdmVyX3N0cmVuZ3RoX3JlaW5pdF9mbGcgPDwgMjApOw0KKwkJCQlyZXQgPSBGQUxTRTsNCisJ
CQkJcHJfZXJyKCJCSFQgRVJSOndpbGwgY2hhbmdlIGRyaXZlciBzdHJlbmd0aCBmcm9tICVkIHRv
ICVkXG4iLA0KKwkJCQkJCWN1cnJlbnRfZHMsDQorCQkJCQkJZ2djLT5kcml2ZXJfc3RyZW5ndGhf
cmVpbml0X2ZsZyk7DQorCQkJCWdvdG8gZXhpdDsNCisJCQl9DQorCQkJZ290byBleGl0Ow0KKwkJ
fQ0KKw0KKwkJY3VyX3NlbGIgPSBfZ2djX2dldF9zdWl0YWJsZV9zZWxiX2Zvcl9uZXh0X3R1bmlu
Zyhob3N0KTsNCisNCisJCXByX2RlYnVnKCJCSFQgTVNHOiBvdXRwdXQgc2VsYToleGggcGFzc1xu
IiwgY3VyX3NlbGEpOw0KKwkJcmVzY2FuX3NlbGJfY250Kys7DQorCQlpZiAoKHJlc2Nhbl9zZWxi
X2NudCA8IDMpICYmDQorCQkJKHNlbHhfZmFpbHVyZV9wb2ludF9leGlzdCh2ZW5kb3JfaG9zdC0+
Z2djLmdnY19jbWRfdHhfc2VsYl9mYWlsZWRfcmFuZ2UpKSkgew0KKwkJCXByX2RlYnVnKCJCSFQg
TVNHOnJlc2NhbiBjbnQgJWQsIGdnY19jbWRfdHhfc2VsYl9mYWlsZWRfcmFuZ2U9MHgleFxuIiwN
CisJCQkJCQlyZXNjYW5fc2VsYl9jbnQsDQorCQkJCQkJdmVuZG9yX2hvc3QtPmdnYy5nZ2NfY21k
X3R4X3NlbGJfZmFpbGVkX3JhbmdlKTsNCisJCQlnb3RvIHJlc2Nhbl9zZWxiOw0KKwkJfQ0KKw0K
K3JldHVuaW5nX2Nhc2U6DQorCQlpZiAocHNlbGFfdHVuaW5nX3Jlc3VsdFtjdXJfc2VsYV0gPT0g
UkVUVU5JTkdfQ0FTRSkgew0KKwkJCXJldHVybmluZ19zZWxiX2NudCsrOw0KKwkJCWlmIChyZXR1
cm5pbmdfc2VsYl9jbnQgPCAzKSB7DQorCQkJCXJlc2Nhbl9zZWxiX2NudCA9IDA7DQorCQkJCXBy
X2RlYnVnKCJCSFQgTVNHOnJldHVuaW5nICVkXG4iLCByZXNjYW5fc2VsYl9jbnQpOw0KKwkJCQln
b3RvIHJlc2Nhbl9zZWxiOw0KKwkJCX0gZWxzZSB7DQorCQkJCXBzZWxhX3R1bmluZ19yZXN1bHRb
Y3VyX3NlbGFdID0gU0VUX1BIQVNFX0ZBSUxfVFlQRTsNCisJCQkJYWxsX3NlbGJfZmFpbGVkX3Ri
X3VwZGF0ZShob3N0LCBjdXJfc2VsYSwgMCk7DQorCQkJCWNvbnRpbnVlOw0KKwkJCX0NCisJCX0N
CisNCisJCWdvdG8gbmV4dF9kbGxfc2VsYTsNCisNCitjdXJfc2VsYV9mYWlsZWQ6DQorCQlwcl9k
ZWJ1ZygiQkhUIE1TRzpyZWFkIHN0YXR1cyBmYWlsZWRCXG4iKTsNCisJCWFsbF9zZWxiID0gMDsN
CisJCWFsbF9zZWxiX2ZhaWxlZF90Yl91cGRhdGUoaG9zdCwgY3VyX3NlbGEsIGFsbF9zZWxiKTsN
CisJCXByX2RlYnVnKCJCSFQgTVNHOiBvdXRwdXQgc2VsYToleGggZmFpbGVkID09PVxuIiwgY3Vy
X3NlbGEpOw0KK25leHRfZGxsX3NlbGE6DQorCQlpZiAoKGlzX2J1c19tb2RlX3NkcjEwNChob3N0
KSA9PSBGQUxTRSkNCisJCQkJJiYgdmVuZG9yX2hvc3QtPmdnYy5zZHI1MF9ub3R1bmluZ19jcmNf
ZXJyb3JfZmxhZykgew0KKwkJCXUzMiBmcCA9IDA7DQorDQorCQkJZnAgPSBHRU5FUkFURV9JRFhf
VkFMVUUoY3VyX3NlbGEpOw0KKwkJCWZwIHw9IEdFTkVSQVRFX0lEWF9WQUxVRSgoY3VyX3NlbGEg
KyAxKSAlIFRVTklOR19QSEFTRV9TSVpFKTsNCisJCQlmcCB8PSBHRU5FUkFURV9JRFhfVkFMVUUo
KGN1cl9zZWxhICsgMTApICUgVFVOSU5HX1BIQVNFX1NJWkUpOw0KKwkJCXZlbmRvcl9ob3N0LT5n
Z2Muc2RyNTBfbm90dW5pbmdfc2VsYV9yeF9pbmplY3QgJj0gfmZwOw0KKwkJCXZlbmRvcl9ob3N0
LT5nZ2Muc2RyNTBfbm90dW5pbmdfc2VsYV9pbmplY3RfZmxhZyA9IDE7DQorCQkJcHJfZGVidWco
IkJIVCBNU0c6c2RyNTBfbm90dW5pbmdfc2VsYV9yeF9pbmplY3Q6JXhcbiIsDQorCQkJCQkJdmVu
ZG9yX2hvc3QtPmdnYy5zZHI1MF9ub3R1bmluZ19zZWxhX3J4X2luamVjdCk7DQorCQkJcmV0ID0g
RkFMU0U7DQorCQkJZ290byBleGl0Ow0KKwkJfTsNCisJfQ0KKw0KKwlmb3IgKGkgPSAwOyBpIDwg
VFVOSU5HX1BIQVNFX1NJWkU7IGkrKykgew0KKwkJcGhhc2Vfc3RyKGFsbF9zdHIsIGFsbF9zZWxi
X2ZhaWxlZF90Yl9nZXQoaG9zdCwgaSkpOw0KKwkJcGhhc2Vfc3RyKHR4X3N0ciwgdHhfc2VsYl9m
YWlsZWRfdGJfZ2V0KGhvc3QsIGkpKTsNCisJCXByX2RlYnVnDQorCQkJCSgiQkhUIE1TRzpETEwg
c2VsYVsleF0gIGFsbCBzZWxiOiAlcyAgIHR4IHNlbGI6ICVzIFsleGgsJXhoXSAlc1xuIiwNCisJ
CQkJCWksIGFsbF9zdHIsIHR4X3N0ciwNCisJCQkJCWFsbF9zZWxiX2ZhaWxlZF90Yl9nZXQoaG9z
dCwgaSksDQorCQkJCQl0eF9zZWxiX2ZhaWxlZF90Yl9nZXQoaG9zdCwgaSksDQorCQkJCQlvcF9k
Ymdfc3RyW3R1bmluZ19lcnJvcl90eXBlW2ldXSk7DQorDQorCX0NCisNCisJLyogcmVtb3ZlIG1h
cmdpbiBwYXNzZWQgYWxsIHNlbGIgcGhhc2UgKi8NCisJZm9yIChpID0gMDsgaSA8IFRVTklOR19Q
SEFTRV9TSVpFOyBpKyspDQorCQlhbGxfc2VsYl9hcltpXSA9IGFsbF9zZWxiX2ZhaWxlZF90Yl9n
ZXQoaG9zdCwgaSk7DQorDQorCS8qIGNhbGN1bGF0ZSBjdW11bGF0aW9uIG9mIGRpYWdvbmFsIGJp
dHMgKi8NCisJZm9yIChpZHhfYyA9IDA7IGlkeF9jIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGlkeF9j
KyspIHsNCisJCWZvciAoaWR4X3IgPSAwOyBpZHhfciA8IFRVTklOR19QSEFTRV9TSVpFOw0KKwkJ
CQkJaWR4X3IrKykgew0KKwkJCXBhc3NfY250W2lkeF9jXSArPQkoKGFsbF9zZWxiX2FyW2lkeF9y
XSA+Pg0KKwkJCQkJKChpZHhfciArIGlkeF9jKSAlIFRVTklOR19QSEFTRV9TSVpFKSkgJiAweDAx
KTsNCisJCX0NCisJCWlmIChpZHhfYyA9PSAwKQ0KKwkJCW1pbl9wb3MgPSAwOw0KKwkJZWxzZSBp
ZiAocGFzc19jbnRbaWR4X2NdIDwgcGFzc19jbnRbbWluX3Bvc10pDQorCQkJbWluX3BvcyA9IGlk
eF9jOw0KKwl9DQorCWZvciAoaSA9IDA7IGkgPCBUVU5JTkdfUEhBU0VfU0laRTsgaSsrKSB7DQor
CQlhbGxfc2VsYl9hcltpXSAmPSB+KDEgPDwgKG1pbl9wb3MgKyBpKSAlIFRVTklOR19QSEFTRV9T
SVpFKTsNCisJCWFsbF9zZWxiX2ZhaWxlZF90Yl91cGRhdGUoaG9zdCwgaSwgYWxsX3NlbGJfYXJb
aV0pOw0KKwl9DQorDQorCXR4X3NlbGIgPSB0eF9zZWxiX2ZhaWxlZF9oaXN0b3J5X2dldChob3N0
KTsNCisNCisJcHJfZGVidWcoImluamVjdCBzdyBzZWxiICYgbWVyZ2UgdHhfc2VsYiBmYWlsZWQg
cG9pbnQgdG8gYWxsX3NlbGJcbiIpOw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJ
WkU7IGkrKykNCisJCWFsbF9zZWxiX2ZhaWxlZF90Yl91cGRhdGUoaG9zdCwgaSwgdHhfc2VsYik7
DQorDQorCXByX2RlYnVnKCJCSFQgTVNHOmluamVjdCBzdyBzZWxhIGZhaWxlZCBwb2ludCB0byBh
bGxfc2VsYlxuIik7DQorCWlmIChpc19idXNfbW9kZV9zZHIxMDQoaG9zdCkpDQorCQljZmcgPSAw
eDdmZjsNCisJZWxzZQ0KKwkJY2ZnID0gMHg3ZmY7DQorDQorCWZvciAoaSA9IDA7IGkgPCBUVU5J
TkdfUEhBU0VfU0laRTsgaSsrKSB7DQorCQlpZiAoR0VUX0lEWF9WQUxVRShjZmcsIGkpID09IDAp
DQorCQkJYWxsX3NlbGJfZmFpbGVkX3RiX3VwZGF0ZShob3N0LCBpLCAwKTsNCisJfQ0KKw0KKwlm
b3IgKGkgPSAwOyBpIDwgVFVOSU5HX1BIQVNFX1NJWkU7IGkrKykgew0KKwkJcGhhc2Vfc3RyKGFs
bF9zdHIsIGFsbF9zZWxiX2ZhaWxlZF90Yl9nZXQoaG9zdCwgaSkpOw0KKwkJcGhhc2Vfc3RyKHR4
X3N0ciwgdHhfc2VsYl9mYWlsZWRfdGJfZ2V0KGhvc3QsIGkpKTsNCisJCXByX2RlYnVnKCJCSFQg
TVNHOkRMTCBzZWxhWyV4XSAgYWxsIHNlbGI6ICVzIHR4IHNlbGI6ICVzIFsleGgsJXhoXSAlc1xu
IiwNCisJCQkJaSwgYWxsX3N0ciwgdHhfc3RyLA0KKwkJCQlhbGxfc2VsYl9mYWlsZWRfdGJfZ2V0
KGhvc3QsIGkpLA0KKwkJCQl0eF9zZWxiX2ZhaWxlZF90Yl9nZXQoaG9zdCwgaSksDQorCQkJCW9w
X2RiZ19zdHJbdHVuaW5nX2Vycm9yX3R5cGVbaV1dKTsNCisJfQ0KKw0KKwl0eF9zZWxiID0gdHhf
c2VsYl9mYWlsZWRfaGlzdG9yeV9nZXQoaG9zdCk7DQorCXR4X3NlbGIgJj0gMHg3ZmY7DQorCXR4
X3RtcCA9IHR4X3NlbGI7DQorDQorCXByX2RlYnVnKCJCSFQgTVNHOi0tLXNlbGIgbWVyZ2UtLS1c
biIpOw0KKwlpZiAoKHR4X3NlbGImMHg3ZmYpID09IDB4N2ZmKSB7DQorCQlpZiAoaXNfYnVzX21v
ZGVfc2RyMTA0KGhvc3QpKSB7DQorCQkJdTMyIGNmZyA9IFNEUjEwNF9NQU5VQUxfSU5KRUNUOw0K
Kw0KKwkJCXR4X3NlbGIgJj0gY2ZnOw0KKwkJCXByX2RlYnVnKCJ0eCBzZWxiOiV4aCBTRFIxMDQg
aW5qZWN0OiV4aCBtZXJnZSB0eF9zZWxiOiV4aFxuIiwNCisJCQkJCQl0eF90bXAsIGNmZywgdHhf
c2VsYik7DQorCQl9IGVsc2Ugew0KKwkJCXUzMiBjZmcgPSBTRFI1MF9NQU5VQUxfSU5KRUNUOw0K
Kw0KKwkJCXR4X3NlbGIgJj0gY2ZnOw0KKwkJCXByX2RlYnVnKCJ0eCBzZWxiOiV4aCBTRFI1MCBp
bmplY3Q6JXhoIG1lcmdlIHR4X3NlbGI6JXhoXG4iLA0KKwkJCQkJCXR4X3RtcCwgY2ZnLCB0eF9z
ZWxiKTsNCisJCX0NCisJfQ0KKw0KKwlpZiAodHhfc2VsYiA9PSAwKSB7DQorCQlwcl9lcnIoImFs
bCBmYWlsZWQsIGZvcmNlIGZpeGVkIHBoYXNlIHNlbGEgc2VsYiB0byBkZWZhdWx0XG4iKTsNCisJ
CXRhcmdldF9zZWxiID0NCisJCQkJZ2V0X2NvbmZpZ19zZWxiX3NldHRpbmcoaG9zdCk7DQorCQl0
YXJnZXRfc2VsYSA9DQorCQkJCWdldF9jb25maWdfc2VsYV9zZXR0aW5nKGhvc3QpOw0KKwkJZ290
byBmaW5hbDsNCisJfQ0KKwlwaGFzZV9zdHIod2luX3RiLCB0eF9zZWxiKTsNCisJcHJfZGVidWco
IkJIVCBNU0c6IHR4IHNlbGJbJXhoXSAxMSBiaXQ6ICVzXG4iLA0KKwkJCQkJCXR4X3NlbGIsIHdp
bl90Yik7DQorCWJpdHNfZ2VuZXJhdGVfYXJyYXkod2luX3RiLCB0eF9zZWxiKTsNCisJY2hrX3Bo
YXNlX3dpbmRvdyh3aW5fdGIsICZ3aW5fbWlkLCAmd2luX21heCk7DQorCXRhcmdldF9zZWxiID0g
d2luX21pZDsNCisNCisJYWxsX3NlbGEgPSAwOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgVFVOSU5H
X1BIQVNFX1NJWkU7IGkrKykgew0KKwkJdTMyIGFsbF9zZWxiID0gYWxsX3NlbGJfZmFpbGVkX3Ri
X2dldChob3N0LCBpKTsNCisNCisJCXBoYXNlX3N0cih3aW5fdGIsIGFsbF9zZWxiKTsNCisJCXBy
X2RlYnVnKCJCSFQgTVNHOiBhbGxfc2VsYlsleGhdIDExIGJpdDogJXNcbiIsDQorCQkJCWFsbF9z
ZWxiLCB3aW5fdGIpOw0KKwkJYml0c19nZW5lcmF0ZV9hcnJheSh3aW5fdGIsIGFsbF9zZWxiKTsN
CisJCWNoa19waGFzZV93aW5kb3cod2luX3RiLCAmd2luX21pZCwNCisJCQkJCSZ3aW5fbWF4KTsN
CisJCSpzZWxiX3Bhc3Nfd2luID0gd2luX21heDsNCisJCWlmIChhbGxfc2VsYiAmICgxIDw8IHRh
cmdldF9zZWxiKSkNCisJCQlhbGxfc2VsYSB8PSAxIDw8IGk7DQorCX0NCisNCisJcGhhc2Vfc3Ry
KHdpbl90YiwgYWxsX3NlbGEpOw0KKwlwcl9kZWJ1ZygiQkhUIE1TRzogYWxsX3NlbGFbJXhoXSAx
MSBiaXQ6ICVzXG4iLA0KKwkJCWFsbF9zZWxhLCB3aW5fdGIpOw0KKwliaXRzX2dlbmVyYXRlX2Fy
cmF5KHdpbl90YiwgYWxsX3NlbGEpOw0KKwljaGtfcGhhc2Vfd2luZG93KHdpbl90YiwgJndpbl9t
aWQsICZ3aW5fbWF4KTsNCisJdGFyZ2V0X3NlbGEgPSB3aW5fbWlkOw0KKw0KK2ZpbmFsOg0KKw0K
KwlnZ19maXhfb3V0cHV0X3R1bmluZ19waGFzZShob3N0LCB0YXJnZXRfc2VsYSwNCisJCQkJCQl0
YXJnZXRfc2VsYik7DQorDQorCXJldCA9IHNkX2dnX3R1bmluZ19zdGF0dXMoaG9zdCwgJnR4X3Nl
bGIsDQorCQkJJmFsbF9zZWxiLCAmcmF3X3R4X3NlbGIsICZzdGF0dXNfcmV0LCBOVUxMKTsNCisJ
aWYgKHJldCA9PSBGQUxTRSkgew0KKwkJcHJfZXJyKCJFcnJvciB3aGVuIG91dHB1dF90dW5pbmcs
ICBzZF90dW5pbmcgZmFpbFxuIik7DQorCQlyZXQgPSBGQUxTRTsNCisJCWdvdG8gZXhpdDsNCisJ
fQ0KKw0KKwkvKiB1c2UgZmluYWwgcGFzcyB3aW5kb3dzICovDQorCXBoYXNlX3N0cih3aW5fdGIs
IGFsbF9zZWxiKTsNCisJcHJfZGVidWcoIkJIVCBNU0c6IGFsbF9zZWxiWyV4aF0gMTEgYml0OiAl
c1xuIiwNCisJCQlhbGxfc2VsYiwgd2luX3RiKTsNCisJYml0c19nZW5lcmF0ZV9hcnJheSh3aW5f
dGIsIGFsbF9zZWxiKTsNCisJY2hrX3BoYXNlX3dpbmRvdyh3aW5fdGIsICZ3aW5fbWlkLCAmd2lu
X21heCk7DQorCSpzZWxiX3Bhc3Nfd2luID0gd2luX21heDsNCisNCisJdmVuZG9yX2hvc3QtPmdn
Yy5zZWx4X3R1bmluZ19kb25lX2ZsYWcgPSAxOw0KKw0KK2V4aXQ6DQorCXByX2RlYnVnKCJCSFQg
TVNHOmV4aXQ6JXMgICVkXG4iLCBfX2Z1bmNfXywgcmV0KTsNCisJcmV0dXJuIHJldDsNCit9DQor
DQorc3RhdGljIGludCBzZGhjaV9iaHRfZXhlY3V0ZV90dW5pbmcoc3RydWN0IG1tY19ob3N0ICpt
bWMsIHUzMiBvcGNvZGUpDQorew0KKwlzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCA9IG1tY19wcml2
KG1tYyk7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJp
dihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqdmVuZG9yX2hvc3QgPSBz
ZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKwl1OCB0dyA9IDA7DQorCWludCByZXQgPSAw
Ow0KKw0KKwlpZiAodmVuZG9yX2hvc3QtPmdnYy5iaDIwMV91c2VkKSB7DQorCQlwcl9kZWJ1Zygi
QkhUIE1TRzplbnRlciBiaHQgdHVuaW5nXG4iKTsNCisJCWlmIChob3N0LT5jbG9jayA8IENPUkVf
RlJFUV8xMDBNSFopIHsNCisJCQlwcl9kZWJ1ZygiQkhUIE1TRzolZCBsZXNzIDEwME1oeixubyB0
dW5pbmdcbiIsIGhvc3QtPmNsb2NrKTsNCisJCQlyZXR1cm4gMDsNCisJCX0NCisNCisJCWlmICh2
ZW5kb3JfaG9zdC0+Z2djLnR1bmluZ19pbl9wcm9ncmVzcykgew0KKwkJCXByX2RlYnVnKCJCSFQg
TVNHOnR1bmluZ19pbl9wcm9ncmVzc1xuIik7DQorCQkJcmV0dXJuIDA7DQorCQl9DQorCQl2ZW5k
b3JfaG9zdC0+Z2djLnR1bmluZ19pbl9wcm9ncmVzcyA9IHRydWU7DQorDQorCQlpZiAodmVuZG9y
X2hvc3QtPmdnYy5zZWx4X3R1bmluZ19kb25lX2ZsYWcpIHsNCisJCQlwcl9kZWJ1ZygiQkhUIE1T
RzpHR0MgdHVuaW5nIGlzIGRvbmUsIGp1c3QgZG8gdmVuZG9yIGhvc3QgdHVuaW5nIik7DQorCQkJ
aWYgKGlzX2J1c19tb2RlX3NkcjEwNChob3N0KSkNCisJCQkJcmV0ID0gc2RoY2lfYmh0X3NkcjEw
NF9leGVjdXRlX3R1bmluZyhob3N0LCAweDEzKTsNCisJCQllbHNlDQorCQkJCXJldCA9IHNkaGNp
X2JodF9zZHI1MF9leGVjdXRlX3R1bmluZyhob3N0LCAweDEzKTsNCisJCX0gZWxzZSB7DQorCQkJ
cmV0ID0gIV9nZ2Nfb3V0cHV0X3R1bmluZyhob3N0LCAmdHcpOw0KKwkJfQ0KKwkJdmVuZG9yX2hv
c3QtPmdnYy50dW5pbmdfaW5fcHJvZ3Jlc3MgPSBmYWxzZTsNCisJCXJldHVybiByZXQ7DQorCX0g
ZWxzZQ0KKwkJcmV0dXJuIHNkaGNpX21zbV9iYXlodWJfZXhlY3V0ZV90dW5pbmcodmVuZG9yX2hv
c3QtPm1tYywgb3Bjb2RlKTsNCit9DQorDQorLyoNCisgKiBzZGhjaV9tc21fYmF5aHViX2hzNDAw
IC0gQ2FsaWJyYXRlIHRoZSBETEwgZm9yIEhTNDAwIGJ1cyBzcGVlZCBtb2RlIG9wZXJhdGlvbi4N
CisgKiBUaGlzIG5lZWRzIHRvIGJlIGRvbmUgZm9yIGJvdGggdHVuaW5nIGFuZCBlbmhhbmNlZF9z
dHJvYmUgbW9kZS4NCisgKiBETEwgb3BlcmF0aW9uIGlzIG9ubHkgbmVlZGVkIGZvciBjbG9jayA+
IDEwME1Iei4gRm9yIGNsb2NrIDw9IDEwME1Ieg0KKyAqIGZpeGVkIGZlZWRiYWNrIGNsb2NrIGlz
IHVzZWQuDQorICovDQorc3RhdGljIHZvaWQgc2RoY2lfbXNtX2JheWh1Yl9oczQwMChzdHJ1Y3Qg
c2RoY2lfaG9zdCAqaG9zdCwgc3RydWN0IG1tY19pb3MgKmlvcykNCit7DQorCXN0cnVjdCBzZGhj
aV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNk
aGNpX21zbV9iYXlodWJfaG9zdCAqbXNtX2JheWh1Yl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihw
bHRmbV9ob3N0KTsNCisJaW50IHJldDsNCisNCisJaWYgKGhvc3QtPmNsb2NrID4gQ09SRV9GUkVR
XzEwME1IWiAmJg0KKwkgICAgKG1zbV9iYXlodWJfaG9zdC0+dHVuaW5nX2RvbmUgfHwgaW9zLT5l
bmhhbmNlZF9zdHJvYmUpICYmDQorCSAgICAhbXNtX2JheWh1Yl9ob3N0LT5jYWxpYnJhdGlvbl9k
b25lKSB7DQorCQlyZXQgPSBzZGhjaV9tc21fYmF5aHViX2hzNDAwX2RsbF9jYWxpYnJhdGlvbiho
b3N0KTsNCisJCWlmICghcmV0KQ0KKwkJCW1zbV9iYXlodWJfaG9zdC0+Y2FsaWJyYXRpb25fZG9u
ZSA9IHRydWU7DQorCQllbHNlDQorCQkJcHJfZXJyKCIlczogRmFpbGVkIHRvIGNhbGlicmF0ZSBE
TEwgZm9yIGhzNDAwIG1vZGUgKCVkKVxuIiwNCisJCQkgICAgICAgbW1jX2hvc3RuYW1lKGhvc3Qt
Pm1tYyksIHJldCk7DQorCX0NCit9DQorDQorc3RhdGljIHZvaWQgc2RoY2lfbXNtX2JheWh1Yl9z
ZXRfdWhzX3NpZ25hbGluZyhzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwNCisJCQkJCXVuc2lnbmVk
IGludCB1aHMpDQorew0KKwlzdHJ1Y3QgbW1jX2hvc3QgKm1tYyA9IGhvc3QtPm1tYzsNCisJc3Ry
dWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlz
dHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3QgPSBzZGhjaV9wbHRm
bV9wcml2KHBsdGZtX2hvc3QpOw0KKwl1MTYgY3RybF8yOw0KKwl1MzIgY29uZmlnOw0KKwljb25z
dCBzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9vZmZzZXQgKm1zbV9iYXlodWJfb2Zmc2V0ID0NCisJ
CQkJCW1zbV9iYXlodWJfaG9zdC0+b2Zmc2V0Ow0KKw0KKwljdHJsXzIgPSBzZGhjaV9yZWFkdyho
b3N0LCBTREhDSV9IT1NUX0NPTlRST0wyKTsNCisJLyogU2VsZWN0IEJ1cyBTcGVlZCBNb2RlIGZv
ciBob3N0ICovDQorCWN0cmxfMiAmPSB+U0RIQ0lfQ1RSTF9VSFNfTUFTSzsNCisJc3dpdGNoICh1
aHMpIHsNCisJY2FzZSBNTUNfVElNSU5HX1VIU19TRFIxMjoNCisJCWN0cmxfMiB8PSBTREhDSV9D
VFJMX1VIU19TRFIxMjsNCisJCWJyZWFrOw0KKwljYXNlIE1NQ19USU1JTkdfVUhTX1NEUjI1Og0K
KwkJY3RybF8yIHw9IFNESENJX0NUUkxfVUhTX1NEUjI1Ow0KKwkJYnJlYWs7DQorCWNhc2UgTU1D
X1RJTUlOR19VSFNfU0RSNTA6DQorCQljdHJsXzIgfD0gU0RIQ0lfQ1RSTF9VSFNfU0RSNTA7DQor
CQlicmVhazsNCisJY2FzZSBNTUNfVElNSU5HX01NQ19IUzQwMDoNCisJY2FzZSBNTUNfVElNSU5H
X01NQ19IUzIwMDoNCisJY2FzZSBNTUNfVElNSU5HX1VIU19TRFIxMDQ6DQorCQljdHJsXzIgfD0g
U0RIQ0lfQ1RSTF9VSFNfU0RSMTA0Ow0KKwkJYnJlYWs7DQorCWNhc2UgTU1DX1RJTUlOR19VSFNf
RERSNTA6DQorCWNhc2UgTU1DX1RJTUlOR19NTUNfRERSNTI6DQorCQljdHJsXzIgfD0gU0RIQ0lf
Q1RSTF9VSFNfRERSNTA7DQorCQlicmVhazsNCisJfQ0KKw0KKwkvKg0KKwkgKiBXaGVuIGNsb2Nr
IGZyZXF1ZW5jeSBpcyBsZXNzIHRoYW4gMTAwTUh6LCB0aGUgZmVlZGJhY2sgY2xvY2sgbXVzdCBi
ZQ0KKwkgKiBwcm92aWRlZCBhbmQgRExMIG11c3Qgbm90IGJlIHVzZWQgc28gdGhhdCB0dW5pbmcg
Y2FuIGJlIHNraXBwZWQuIFRvDQorCSAqIHByb3ZpZGUgZmVlZGJhY2sgY2xvY2ssIHRoZSBtb2Rl
IHNlbGVjdGlvbiBjYW4gYmUgYW55IHZhbHVlIGxlc3MNCisJICogdGhhbiAzJ2IwMTEgaW4gYml0
cyBbMjowXSBvZiBIT1NUIENPTlRST0wyIHJlZ2lzdGVyLg0KKwkgKi8NCisJaWYgKGhvc3QtPmNs
b2NrIDw9IENPUkVfRlJFUV8xMDBNSFopIHsNCisJCWlmICh1aHMgPT0gTU1DX1RJTUlOR19NTUNf
SFM0MDAgfHwNCisJCSAgICB1aHMgPT0gTU1DX1RJTUlOR19NTUNfSFMyMDAgfHwNCisJCSAgICB1
aHMgPT0gTU1DX1RJTUlOR19VSFNfU0RSMTA0KQ0KKwkJCWN0cmxfMiAmPSB+U0RIQ0lfQ1RSTF9V
SFNfTUFTSzsNCisJCS8qDQorCQkgKiBETEwgaXMgbm90IHJlcXVpcmVkIGZvciBjbG9jayA8PSAx
MDBNSHoNCisJCSAqIFRodXMsIG1ha2Ugc3VyZSBETEwgaXQgaXMgZGlzYWJsZWQgd2hlbiBub3Qg
cmVxdWlyZWQNCisJCSAqLw0KKwkJY29uZmlnID0gcmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIg
Kw0KKwkJCQltc21fYmF5aHViX29mZnNldC0+Y29yZV9kbGxfY29uZmlnKTsNCisJCWNvbmZpZyB8
PSBDT1JFX0RMTF9SU1Q7DQorCQl3cml0ZWxfcmVsYXhlZChjb25maWcsIGhvc3QtPmlvYWRkciAr
DQorCQkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9jb25maWcpOw0KKw0KKwkJY29uZmln
ID0gcmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKw0KKwkJCQltc21fYmF5aHViX29mZnNldC0+
Y29yZV9kbGxfY29uZmlnKTsNCisJCWNvbmZpZyB8PSBDT1JFX0RMTF9QRE47DQorCQl3cml0ZWxf
cmVsYXhlZChjb25maWcsIGhvc3QtPmlvYWRkciArDQorCQkJCW1zbV9iYXlodWJfb2Zmc2V0LT5j
b3JlX2RsbF9jb25maWcpOw0KKw0KKwkJLyoNCisJCSAqIFRoZSBETEwgbmVlZHMgdG8gYmUgcmVz
dG9yZWQgYW5kIENEQ0xQNTMzIHJlY2FsaWJyYXRlZA0KKwkJICogd2hlbiB0aGUgY2xvY2sgZnJl
cXVlbmN5IGlzIHNldCBiYWNrIHRvIDQwME1Iei4NCisJCSAqLw0KKwkJbXNtX2JheWh1Yl9ob3N0
LT5jYWxpYnJhdGlvbl9kb25lID0gZmFsc2U7DQorCX0NCisNCisJZGV2X2RiZyhtbWNfZGV2KG1t
YyksICIlczogY2xvY2s9JXUgdWhzPSV1IGN0cmxfMj0weCV4XG4iLA0KKwkJbW1jX2hvc3RuYW1l
KGhvc3QtPm1tYyksIGhvc3QtPmNsb2NrLCB1aHMsIGN0cmxfMik7DQorCXNkaGNpX3dyaXRldyho
b3N0LCBjdHJsXzIsIFNESENJX0hPU1RfQ09OVFJPTDIpOw0KKw0KKwlpZiAobW1jLT5pb3MudGlt
aW5nID09IE1NQ19USU1JTkdfTU1DX0hTNDAwKQ0KKwkJc2RoY2lfbXNtX2JheWh1Yl9oczQwMCho
b3N0LCAmbW1jLT5pb3MpOw0KK30NCisNCitzdGF0aWMgaW50IHNkaGNpX21zbV9iYXlodWJfc2V0
X3BpbmNmZyhzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3QsIGJv
b2wgbGV2ZWwpDQorew0KKwlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2ID0gbXNtX2JheWh1
Yl9ob3N0LT5wZGV2Ow0KKwlpbnQgcmV0Ow0KKw0KKwlpZiAobGV2ZWwpDQorCQlyZXQgPSBwaW5j
dHJsX3BtX3NlbGVjdF9kZWZhdWx0X3N0YXRlKCZwZGV2LT5kZXYpOw0KKwllbHNlDQorCQlyZXQg
PSBwaW5jdHJsX3BtX3NlbGVjdF9zbGVlcF9zdGF0ZSgmcGRldi0+ZGV2KTsNCisNCisJcmV0dXJu
IHJldDsNCit9DQorDQorc3RhdGljIGludCBzZGhjaV9tc21fYmF5aHViX3NldF92bW1jKHN0cnVj
dCBtbWNfaG9zdCAqbW1jKQ0KK3sNCisJaWYgKElTX0VSUihtbWMtPnN1cHBseS52bW1jKSkNCisJ
CXJldHVybiAwOw0KKw0KKwlyZXR1cm4gbW1jX3JlZ3VsYXRvcl9zZXRfb2NyKG1tYywgbW1jLT5z
dXBwbHkudm1tYywgbW1jLT5pb3MudmRkKTsNCit9DQorDQorc3RhdGljIGludCBtc21fYmF5aHVi
X3RvZ2dsZV92cW1tYyhzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hv
c3QsDQorCQkJICAgICAgc3RydWN0IG1tY19ob3N0ICptbWMsIGJvb2wgbGV2ZWwpDQorew0KKwlp
bnQgcmV0Ow0KKwlzdHJ1Y3QgbW1jX2lvcyBpb3M7DQorDQorCWlmIChtc21fYmF5aHViX2hvc3Qt
PnZxbW1jX2VuYWJsZWQgPT0gbGV2ZWwpDQorCQlyZXR1cm4gMDsNCisNCisJaWYgKGxldmVsKSB7
DQorCQkvKiBTZXQgdGhlIElPIHZvbHRhZ2UgcmVndWxhdG9yIHRvIGRlZmF1bHQgdm9sdGFnZSBs
ZXZlbCAqLw0KKwkJaWYgKG1zbV9iYXlodWJfaG9zdC0+Y2Fwc18wICYgQ09SRV8zXzBWX1NVUFBP
UlQpDQorCQkJaW9zLnNpZ25hbF92b2x0YWdlID0gTU1DX1NJR05BTF9WT0xUQUdFXzMzMDsNCisJ
CWVsc2UgaWYgKG1zbV9iYXlodWJfaG9zdC0+Y2Fwc18wICYgQ09SRV8xXzhWX1NVUFBPUlQpDQor
CQkJaW9zLnNpZ25hbF92b2x0YWdlID0gTU1DX1NJR05BTF9WT0xUQUdFXzE4MDsNCisNCisJCWlm
IChtc21fYmF5aHViX2hvc3QtPmNhcHNfMCAmIENPUkVfVk9MVF9TVVBQT1JUKSB7DQorCQkJcmV0
ID0gbW1jX3JlZ3VsYXRvcl9zZXRfdnFtbWMobW1jLCAmaW9zKTsNCisJCQlpZiAocmV0IDwgMCkg
ew0KKwkJCQlkZXZfZXJyKG1tY19kZXYobW1jKSwgIiVzOiB2cW1tYyBzZXQgdm9sZ2F0ZSBmYWls
ZWQ6ICVkXG4iLA0KKwkJCQkJbW1jX2hvc3RuYW1lKG1tYyksIHJldCk7DQorCQkJCWdvdG8gb3V0
Ow0KKwkJCX0NCisJCX0NCisJCXJldCA9IHJlZ3VsYXRvcl9lbmFibGUobW1jLT5zdXBwbHkudnFt
bWMpOw0KKwl9IGVsc2Ugew0KKwkJcmV0ID0gcmVndWxhdG9yX2Rpc2FibGUobW1jLT5zdXBwbHku
dnFtbWMpOw0KKwl9DQorDQorCWlmIChyZXQpDQorCQlkZXZfZXJyKG1tY19kZXYobW1jKSwgIiVz
OiB2cW1tICVzYWJsZSBmYWlsZWQ6ICVkXG4iLA0KKwkJCW1tY19ob3N0bmFtZShtbWMpLCBsZXZl
bCA/ICJlbiI6ImRpcyIsIHJldCk7DQorCWVsc2UNCisJCW1zbV9iYXlodWJfaG9zdC0+dnFtbWNf
ZW5hYmxlZCA9IGxldmVsOw0KK291dDoNCisJcmV0dXJuIHJldDsNCit9DQorDQorc3RhdGljIGlu
dCBtc21fYmF5aHViX2NvbmZpZ192cW1tY19tb2RlKHN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hv
c3QgKm1zbV9iYXlodWJfaG9zdCwNCisJCQkgICAgICBzdHJ1Y3QgbW1jX2hvc3QgKm1tYywgYm9v
bCBocG0pDQorew0KKwlpbnQgbG9hZCwgcmV0Ow0KKw0KKwlsb2FkID0gaHBtID8gTU1DX1ZRTU1D
X01BWF9MT0FEX1VBIDogMDsNCisJcmV0ID0gcmVndWxhdG9yX3NldF9sb2FkKG1tYy0+c3VwcGx5
LnZxbW1jLCBsb2FkKTsNCisJaWYgKHJldCkNCisJCWRldl9lcnIobW1jX2RldihtbWMpLCAiJXM6
IHZxbW1jIHNldCBsb2FkIGZhaWxlZDogJWRcbiIsDQorCQkJbW1jX2hvc3RuYW1lKG1tYyksIHJl
dCk7DQorCXJldHVybiByZXQ7DQorfQ0KKw0KK3N0YXRpYyBpbnQgc2RoY2lfbXNtX2JheWh1Yl9z
ZXRfdnFtbWMoc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqbXNtX2JheWh1Yl9ob3N0LA0K
KwkJCSAgICAgIHN0cnVjdCBtbWNfaG9zdCAqbW1jLCBib29sIGxldmVsKQ0KK3sNCisJaW50IHJl
dDsNCisJYm9vbCBhbHdheXNfb247DQorDQorCWlmIChJU19FUlIobW1jLT5zdXBwbHkudnFtbWMp
IHx8DQorCQkJKG1tYy0+aW9zLnBvd2VyX21vZGUgPT0gTU1DX1BPV0VSX1VOREVGSU5FRCkpDQor
CQlyZXR1cm4gMDsNCisJLyoNCisJICogRm9yIGVNTUMgZG9uJ3QgdHVybiBvZmYgVnFtbWMsIElu
c3RlYWQganVzdCBjb25maWd1cmUgaXQgaW4gTFBNDQorCSAqIGFuZCBIUE0gbW9kZXMgYnkgc2V0
dGluZyB0aGUgY29ycmVzcG9uZGluZyBsb2FkLg0KKwkgKg0KKwkgKiBUaWxsIGVNTUMgaXMgaW5p
dGlhbGl6ZWQgKGkuZS4gYWx3YXlzX29uID09IDApLCBqdXN0IHR1cm4gb24vb2ZmDQorCSAqIFZx
bW1jLiBWcW1tYyBnZXRzIHR1cm5lZCBvZmYgb25seSBpZiBpbml0IGZhaWxzIGFuZCBtbWNfcG93
ZXJfb2ZmDQorCSAqIGdldHMgaW52b2tlZC4gT25jZSBlTU1DIGlzIGluaXRpYWxpemVkIChpLmUu
IGFsd2F5c19vbiA9PSAxKSwNCisJICogVnFtbWMgc2hvdWxkIHJlbWFpbiBPTiwgU28ganVzdCBz
ZXQgdGhlIGxvYWQgaW5zdGVhZCBvZiB0dXJuaW5nIGl0DQorCSAqIG9mZi9vbi4NCisJICovDQor
CWFsd2F5c19vbiA9ICFtbWNfY2FyZF9pc19yZW1vdmFibGUobW1jKSAmJg0KKwkJCW1tYy0+Y2Fy
ZCAmJiBtbWNfY2FyZF9tbWMobW1jLT5jYXJkKTsNCisNCisJaWYgKGFsd2F5c19vbikNCisJCXJl
dCA9IG1zbV9iYXlodWJfY29uZmlnX3ZxbW1jX21vZGUobXNtX2JheWh1Yl9ob3N0LCBtbWMsIGxl
dmVsKTsNCisJZWxzZQ0KKwkJcmV0ID0gbXNtX2JheWh1Yl90b2dnbGVfdnFtbWMobXNtX2JheWh1
Yl9ob3N0LCBtbWMsIGxldmVsKTsNCisNCisJcmV0dXJuIHJldDsNCit9DQorDQorc3RhdGljIGlu
bGluZSB2b2lkIHNkaGNpX21zbV9iYXlodWJfaW5pdF9wd3JfaXJxX3dhaXQoc3RydWN0IHNkaGNp
X21zbV9iYXlodWJfaG9zdCAqbXNtX2JheWh1Yl9ob3N0KQ0KK3sNCisJaW5pdF93YWl0cXVldWVf
aGVhZCgmbXNtX2JheWh1Yl9ob3N0LT5wd3JfaXJxX3dhaXQpOw0KK30NCisNCitzdGF0aWMgaW5s
aW5lIHZvaWQgc2RoY2lfbXNtX2JheWh1Yl9jb21wbGV0ZV9wd3JfaXJxX3dhaXQoDQorCQlzdHJ1
Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3QpDQorew0KKwl3YWtlX3Vw
KCZtc21fYmF5aHViX2hvc3QtPnB3cl9pcnFfd2FpdCk7DQorfQ0KKw0KKy8qDQorICogc2RoY2lf
bXNtX2JheWh1Yl9jaGVja19wb3dlcl9zdGF0dXMgQVBJIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBy
ZWdpc3RlcnMgd3JpdGVzDQorICogd2hpY2ggY2FuIHRvZ2dsZSBzZGhjaSBJTyBidXMgT04vT0ZG
IG9yIGNoYW5nZSBJTyBsaW5lcyBISUdIL0xPVyBoYXBwZW5zLg0KKyAqIFRvIHdoYXQgc3RhdGUg
dGhlIHJlZ2lzdGVyIHdyaXRlcyB3aWxsIGNoYW5nZSB0aGUgSU8gbGluZXMgc2hvdWxkIGJlIHBh
c3NlZA0KKyAqIGFzIHRoZSBhcmd1bWVudCByZXFfdHlwZS4gVGhpcyBBUEkgd2lsbCBjaGVjayB3
aGV0aGVyIHRoZSBJTyBsaW5lJ3Mgc3RhdGUNCisgKiBpcyBhbHJlYWR5IHRoZSBleHBlY3RlZCBz
dGF0ZSBhbmQgd2lsbCB3YWl0IGZvciBwb3dlciBpcnEgb25seSBpZg0KKyAqIHBvd2VyIGlycSBp
cyBleHBlY3RlZCB0byBiZSB0cmlnZ2VyZWQgYmFzZWQgb24gdGhlIGN1cnJlbnQgSU8gbGluZSBz
dGF0ZQ0KKyAqIGFuZCBleHBlY3RlZCBJTyBsaW5lIHN0YXRlLg0KKyAqLw0KK3N0YXRpYyB2b2lk
IHNkaGNpX21zbV9iYXlodWJfY2hlY2tfcG93ZXJfc3RhdHVzKHN0cnVjdCBzZGhjaV9ob3N0ICpo
b3N0LCB1MzIgcmVxX3R5cGUpDQorew0KKwlzdHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1f
aG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3Qg
Km1zbV9iYXlodWJfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorCWJvb2wg
ZG9uZSA9IGZhbHNlOw0KKwl1MzIgdmFsID0gU1dJVENIQUJMRV9TSUdOQUxJTkdfVk9MVEFHRTsN
CisJY29uc3Qgc3RydWN0IHNkaGNpX21zbV9iYXlodWJfb2Zmc2V0ICptc21fYmF5aHViX29mZnNl
dCA9DQorCQkJCQltc21fYmF5aHViX2hvc3QtPm9mZnNldDsNCisNCisJcHJfZGVidWcoIiVzOiAl
czogcmVxdWVzdCAlZCBjdXJyX3B3cl9zdGF0ZSAleCBjdXJyX2lvX2xldmVsICV4XG4iLA0KKwkJ
CW1tY19ob3N0bmFtZShob3N0LT5tbWMpLCBfX2Z1bmNfXywgcmVxX3R5cGUsDQorCQkJbXNtX2Jh
eWh1Yl9ob3N0LT5jdXJyX3B3cl9zdGF0ZSwgbXNtX2JheWh1Yl9ob3N0LT5jdXJyX2lvX2xldmVs
KTsNCisNCisJLyoNCisJICogVGhlIHBvd2VyIGludGVycnVwdCB3aWxsIG5vdCBiZSBnZW5lcmF0
ZWQgZm9yIHNpZ25hbCB2b2x0YWdlDQorCSAqIHN3aXRjaGVzIGlmIFNXSVRDSEFCTEVfU0lHTkFM
SU5HX1ZPTFRBR0UgaW4gTUNJX0dFTkVSSUNTIGlzIG5vdCBzZXQuDQorCSAqIFNpbmNlIHNkaGNp
LW1zbV9iYXlodWItdjUsIHRoaXMgYml0IGhhcyBiZWVuIHJlbW92ZWQgYW5kIFNXIG11c3QgY29u
c2lkZXINCisJICogaXQgYXMgYWx3YXlzIHNldC4NCisJICovDQorCWlmICghbXNtX2JheWh1Yl9o
b3N0LT5tY2lfcmVtb3ZlZCkNCisJCXZhbCA9IG1zbV9iYXlodWJfaG9zdF9yZWFkbChtc21fYmF5
aHViX2hvc3QsIGhvc3QsDQorCQkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2dlbmVyaWNzKTsN
CisJaWYgKChyZXFfdHlwZSAmIFJFUV9JT19ISUdIIHx8IHJlcV90eXBlICYgUkVRX0lPX0xPVykg
JiYNCisJICAgICEodmFsICYgU1dJVENIQUJMRV9TSUdOQUxJTkdfVk9MVEFHRSkpIHsNCisJCXJl
dHVybjsNCisJfQ0KKw0KKwkvKg0KKwkgKiBUaGUgSVJRIGZvciByZXF1ZXN0IHR5cGUgSU8gSGln
aC9MT1cgd2lsbCBiZSBnZW5lcmF0ZWQgd2hlbiAtDQorCSAqIHRoZXJlIGlzIGEgc3RhdGUgY2hh
bmdlIGluIDEuOFYgZW5hYmxlIGJpdCAoYml0IDMpIG9mDQorCSAqIFNESENJX0hPU1RfQ09OVFJP
TDIgcmVnaXN0ZXIuIFRoZSByZXNldCBzdGF0ZSBvZiB0aGF0IGJpdCBpcyAwDQorCSAqIHdoaWNo
IGluZGljYXRlcyAzLjNWIElPIHZvbHRhZ2UuIFNvLCB3aGVuIE1NQyBjb3JlIGxheWVyIHRyaWVz
DQorCSAqIHRvIHNldCBpdCB0byAzLjNWIGJlZm9yZSBjYXJkIGRldGVjdGlvbiBoYXBwZW5zLCB0
aGUNCisJICogSVJRIGRvZXNuJ3QgZ2V0IHRyaWdnZXJlZCBhcyB0aGVyZSBpcyBubyBzdGF0ZSBj
aGFuZ2UgaW4gdGhpcyBiaXQuDQorCSAqIFRoZSBkcml2ZXIgYWxyZWFkeSBoYW5kbGVzIHRoaXMg
Y2FzZSBieSBjaGFuZ2luZyB0aGUgSU8gdm9sdGFnZQ0KKwkgKiBsZXZlbCB0byBoaWdoIGFzIHBh
cnQgb2YgY29udHJvbGxlciBwb3dlciB1cCBzZXF1ZW5jZS4gSGVuY2UsIGNoZWNrDQorCSAqIGZv
ciBob3N0LT5wd3IgdG8gaGFuZGxlIGEgY2FzZSB3aGVyZSBJTyB2b2x0YWdlIGhpZ2ggcmVxdWVz
dCBpcw0KKwkgKiBpc3N1ZWQgZXZlbiBiZWZvcmUgY29udHJvbGxlciBwb3dlciB1cC4NCisJICov
DQorCWlmICgocmVxX3R5cGUgJiBSRVFfSU9fSElHSCkgJiYgIWhvc3QtPnB3cikgew0KKwkJcHJf
ZGVidWcoIiVzOiBkbyBub3Qgd2FpdCBmb3IgcG93ZXIgSVJRIHRoYXQgbmV2ZXIgY29tZXMsIHJl
cV90eXBlOiAlZFxuIiwNCisJCQkJbW1jX2hvc3RuYW1lKGhvc3QtPm1tYyksIHJlcV90eXBlKTsN
CisJCXJldHVybjsNCisJfQ0KKwlpZiAoKHJlcV90eXBlICYgbXNtX2JheWh1Yl9ob3N0LT5jdXJy
X3B3cl9zdGF0ZSkgfHwNCisJCQkocmVxX3R5cGUgJiBtc21fYmF5aHViX2hvc3QtPmN1cnJfaW9f
bGV2ZWwpKQ0KKwkJZG9uZSA9IHRydWU7DQorCS8qDQorCSAqIFRoaXMgaXMgbmVlZGVkIGhlcmUg
dG8gaGFuZGxlIGNhc2VzIHdoZXJlIHJlZ2lzdGVyIHdyaXRlcyB3aWxsDQorCSAqIG5vdCBjaGFu
Z2UgdGhlIGN1cnJlbnQgYnVzIHN0YXRlIG9yIGlvIGxldmVsIG9mIHRoZSBjb250cm9sbGVyLg0K
KwkgKiBJbiB0aGlzIGNhc2UsIG5vIHBvd2VyIGlycSB3aWxsIGJlIHRyaWdnZXJyZWQgYW5kIHdl
IHNob3VsZA0KKwkgKiBub3Qgd2FpdC4NCisJICovDQorCWlmICghZG9uZSkgew0KKwkJaWYgKCF3
YWl0X2V2ZW50X3RpbWVvdXQobXNtX2JheWh1Yl9ob3N0LT5wd3JfaXJxX3dhaXQsDQorCQkJCW1z
bV9iYXlodWJfaG9zdC0+cHdyX2lycV9mbGFnLA0KKwkJCQltc2Vjc190b19qaWZmaWVzKE1TTV9Q
V1JfSVJRX1RJTUVPVVRfTVMpKSkNCisJCQlkZXZfd2FybigmbXNtX2JheWh1Yl9ob3N0LT5wZGV2
LT5kZXYsDQorCQkJCSAiJXM6IHB3cl9pcnEgZm9yIHJlcTogKCVkKSB0aW1lZCBvdXRcbiIsDQor
CQkJCSBtbWNfaG9zdG5hbWUoaG9zdC0+bW1jKSwgcmVxX3R5cGUpOw0KKwl9DQorCXByX2RlYnVn
KCIlczogJXM6IHJlcXVlc3QgJWQgZG9uZVxuIiwgbW1jX2hvc3RuYW1lKGhvc3QtPm1tYyksDQor
CQkJX19mdW5jX18sIHJlcV90eXBlKTsNCit9DQorDQorc3RhdGljIHZvaWQgc2RoY2lfbXNtX2Jh
eWh1Yl9kdW1wX3B3cl9jdHJsX3JlZ3Moc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QpDQorew0KKwlz
dHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQor
CXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKm1zbV9iYXlodWJfaG9zdCA9IHNkaGNpX3Bs
dGZtX3ByaXYocGx0Zm1faG9zdCk7DQorCWNvbnN0IHN0cnVjdCBzZGhjaV9tc21fYmF5aHViX29m
ZnNldCAqbXNtX2JheWh1Yl9vZmZzZXQgPQ0KKwkJCQkJbXNtX2JheWh1Yl9ob3N0LT5vZmZzZXQ7
DQorDQorCXByX2VycigiJXM6IFBXUkNUTF9TVEFUVVM6IDB4JTA4eCB8IFBXUkNUTF9NQVNLOiAw
eCUwOHggfCBQV1JDVExfQ1RMOiAweCUwOHhcbiIsDQorCQltbWNfaG9zdG5hbWUoaG9zdC0+bW1j
KSwNCisJCW1zbV9iYXlodWJfaG9zdF9yZWFkbChtc21fYmF5aHViX2hvc3QsIGhvc3QsIG1zbV9i
YXlodWJfb2Zmc2V0LT5jb3JlX3B3cmN0bF9zdGF0dXMpLA0KKwkJbXNtX2JheWh1Yl9ob3N0X3Jl
YWRsKG1zbV9iYXlodWJfaG9zdCwgaG9zdCwgbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfcHdyY3Rs
X21hc2spLA0KKwkJbXNtX2JheWh1Yl9ob3N0X3JlYWRsKG1zbV9iYXlodWJfaG9zdCwgaG9zdCwg
bXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfcHdyY3RsX2N0bCkpOw0KK30NCisNCitzdGF0aWMgdm9p
ZCBzZGhjaV9tc21fYmF5aHViX2hhbmRsZV9wd3JfaXJxKHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0
LCBpbnQgaXJxKQ0KK3sNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBz
ZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICptc21fYmF5
aHViX2hvc3QgPSBzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKwlzdHJ1Y3QgbW1jX2hv
c3QgKm1tYyA9IGhvc3QtPm1tYzsNCisJdTMyIGlycV9zdGF0dXMsIGlycV9hY2sgPSAwOw0KKwlp
bnQgcmV0cnkgPSAxMCwgcmV0Ow0KKwl1MzIgcHdyX3N0YXRlID0gMCwgaW9fbGV2ZWwgPSAwOw0K
Kwl1MzIgY29uZmlnOw0KKwljb25zdCBzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9vZmZzZXQgKm1z
bV9iYXlodWJfb2Zmc2V0ID0gbXNtX2JheWh1Yl9ob3N0LT5vZmZzZXQ7DQorDQorCWlycV9zdGF0
dXMgPSBtc21fYmF5aHViX2hvc3RfcmVhZGwobXNtX2JheWh1Yl9ob3N0LCBob3N0LA0KKwkJCW1z
bV9iYXlodWJfb2Zmc2V0LT5jb3JlX3B3cmN0bF9zdGF0dXMpOw0KKwlpcnFfc3RhdHVzICY9IElO
VF9NQVNLOw0KKw0KKwltc21fYmF5aHViX2hvc3Rfd3JpdGVsKG1zbV9iYXlodWJfaG9zdCwgaXJx
X3N0YXR1cywgaG9zdCwNCisJCQltc21fYmF5aHViX29mZnNldC0+Y29yZV9wd3JjdGxfY2xlYXIp
Ow0KKw0KKwkvKg0KKwkgKiBUaGVyZSBpcyBhIHJhcmUgSFcgc2NlbmFyaW8gd2hlcmUgdGhlIGZp
cnN0IGNsZWFyIHB1bHNlIGNvdWxkIGJlDQorCSAqIGxvc3Qgd2hlbiBhY3R1YWwgcmVzZXQgYW5k
IGNsZWFyL3JlYWQgb2Ygc3RhdHVzIHJlZ2lzdGVyIGlzDQorCSAqIGhhcHBlbmluZyBhdCBhIHRp
bWUuIEhlbmNlLCByZXRyeSBmb3IgYXQgbGVhc3QgMTAgdGltZXMgdG8gbWFrZQ0KKwkgKiBzdXJl
IHN0YXR1cyByZWdpc3RlciBpcyBjbGVhcmVkLiBPdGhlcndpc2UsIHRoaXMgd2lsbCByZXN1bHQg
aW4NCisJICogYSBzcHVyaW91cyBwb3dlciBJUlEgcmVzdWx0aW5nIGluIHN5c3RlbSBpbnN0YWJp
bGl0eS4NCisJICovDQorCXdoaWxlIChpcnFfc3RhdHVzICYgbXNtX2JheWh1Yl9ob3N0X3JlYWRs
KG1zbV9iYXlodWJfaG9zdCwgaG9zdCwNCisJCQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfcHdy
Y3RsX3N0YXR1cykpIHsNCisJCWlmIChyZXRyeSA9PSAwKSB7DQorCQkJcHJfZXJyKCIlczogVGlt
ZWRvdXQgY2xlYXJpbmcgKDB4JXgpIHB3cmN0bCBzdGF0dXMgcmVnaXN0ZXJcbiIsDQorCQkJCQlt
bWNfaG9zdG5hbWUoaG9zdC0+bW1jKSwgaXJxX3N0YXR1cyk7DQorCQkJc2RoY2lfbXNtX2JheWh1
Yl9kdW1wX3B3cl9jdHJsX3JlZ3MoaG9zdCk7DQorCQkJV0FSTl9PTigxKTsNCisJCQlicmVhazsN
CisJCX0NCisJCW1zbV9iYXlodWJfaG9zdF93cml0ZWwobXNtX2JheWh1Yl9ob3N0LCBpcnFfc3Rh
dHVzLCBob3N0LA0KKwkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX3B3cmN0bF9jbGVhcik7DQor
CQlyZXRyeS0tOw0KKwkJdWRlbGF5KDEwKTsNCisJfQ0KKw0KKwkvKiBIYW5kbGUgQlVTIE9OL09G
RiovDQorCWlmIChpcnFfc3RhdHVzICYgQ09SRV9QV1JDVExfQlVTX09OKSB7DQorCQlpZiAobXNt
X2JheWh1Yl9ob3N0LT5nZ2MuYmgyMDFfdXNlZCkNCisJCQliaDIwMV9zaWduYWxfdm9sdGFnZV9v
bl9vZmYoaG9zdCwgMSk7DQorCQlwd3Jfc3RhdGUgPSBSRVFfQlVTX09OOw0KKwkJaW9fbGV2ZWwg
PSBSRVFfSU9fSElHSDsNCisJfQ0KKwlpZiAoaXJxX3N0YXR1cyAmIENPUkVfUFdSQ1RMX0JVU19P
RkYpIHsNCisJCWlmIChtc21fYmF5aHViX2hvc3QtPmdnYy5iaDIwMV91c2VkKQ0KKwkJCWJoMjAx
X3NpZ25hbF92b2x0YWdlX29uX29mZihob3N0LCAwKTsNCisJCXB3cl9zdGF0ZSA9IFJFUV9CVVNf
T0ZGOw0KKwkJaW9fbGV2ZWwgPSBSRVFfSU9fTE9XOw0KKwl9DQorDQorCWlmIChwd3Jfc3RhdGUp
IHsNCisJCXJldCA9IHNkaGNpX21zbV9iYXlodWJfc2V0X3ZtbWMobW1jKTsNCisJCWlmICghcmV0
KQ0KKwkJCXJldCA9IHNkaGNpX21zbV9iYXlodWJfc2V0X3ZxbW1jKG1zbV9iYXlodWJfaG9zdCwg
bW1jLA0KKwkJCQkJcHdyX3N0YXRlICYgUkVRX0JVU19PTik7DQorCQlpZiAoIXJldCkNCisJCQly
ZXQgPSBzZGhjaV9tc21fYmF5aHViX3NldF9waW5jZmcobXNtX2JheWh1Yl9ob3N0LA0KKwkJCQkJ
cHdyX3N0YXRlICYgUkVRX0JVU19PTik7DQorCQlpZiAoIXJldCkNCisJCQlpcnFfYWNrIHw9IENP
UkVfUFdSQ1RMX0JVU19TVUNDRVNTOw0KKwkJZWxzZQ0KKwkJCWlycV9hY2sgfD0gQ09SRV9QV1JD
VExfQlVTX0ZBSUw7DQorCX0NCisNCisJLyogSGFuZGxlIElPIExPVy9ISUdIICovDQorCWlmIChp
cnFfc3RhdHVzICYgQ09SRV9QV1JDVExfSU9fTE9XKQ0KKwkJaW9fbGV2ZWwgPSBSRVFfSU9fTE9X
Ow0KKw0KKwlpZiAoaXJxX3N0YXR1cyAmIENPUkVfUFdSQ1RMX0lPX0hJR0gpDQorCQlpb19sZXZl
bCA9IFJFUV9JT19ISUdIOw0KKw0KKwlpZiAoaW9fbGV2ZWwpDQorCQlpcnFfYWNrIHw9IENPUkVf
UFdSQ1RMX0lPX1NVQ0NFU1M7DQorDQorCWlmIChpb19sZXZlbCAmJiAhSVNfRVJSKG1tYy0+c3Vw
cGx5LnZxbW1jKSAmJiAhcHdyX3N0YXRlKSB7DQorCQlyZXQgPSBtbWNfcmVndWxhdG9yX3NldF92
cW1tYyhtbWMsICZtbWMtPmlvcyk7DQorCQlpZiAocmV0IDwgMCkgew0KKwkJCWRldl9lcnIobW1j
X2RldihtbWMpLCAiJXM6IElPX2xldmVsIHNldHRpbmcgZmFpbGVkKCVkKS4gc2lnbmFsX3ZvbHRh
Z2U6ICVkLCB2ZGQ6ICVkIGlycV9zdGF0dXM6IDB4JTA4eFxuIiwNCisJCQkJCW1tY19ob3N0bmFt
ZShtbWMpLCByZXQsDQorCQkJCQltbWMtPmlvcy5zaWduYWxfdm9sdGFnZSwgbW1jLT5pb3MudmRk
LA0KKwkJCQkJaXJxX3N0YXR1cyk7DQorCQkJaXJxX2FjayB8PSBDT1JFX1BXUkNUTF9JT19GQUlM
Ow0KKwkJfQ0KKwl9DQorDQorCS8qDQorCSAqIFRoZSBkcml2ZXIgaGFzIHRvIGFja25vd2xlZGdl
IHRoZSBpbnRlcnJ1cHQsIHN3aXRjaCB2b2x0YWdlcyBhbmQNCisJICogcmVwb3J0IGJhY2sgaWYg
aXQgc3VjY2VlZGVkIG9yIG5vdCB0byB0aGlzIHJlZ2lzdGVyLiBUaGUgdm9sdGFnZQ0KKwkgKiBz
d2l0Y2hlcyBhcmUgaGFuZGxlZCBieSB0aGUgc2RoY2kgY29yZSwgc28ganVzdCByZXBvcnQgc3Vj
Y2Vzcy4NCisJICovDQorCW1zbV9iYXlodWJfaG9zdF93cml0ZWwobXNtX2JheWh1Yl9ob3N0LCBp
cnFfYWNrLCBob3N0LA0KKwkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX3B3cmN0bF9jdGwpOw0K
Kw0KKwkvKg0KKwkgKiBJZiB3ZSBkb24ndCBoYXZlIGluZm8gcmVnYXJkaW5nIHRoZSB2b2x0YWdl
IGxldmVscyBzdXBwb3J0ZWQgYnkNCisJICogcmVndWxhdG9ycywgZG9uJ3QgY2hhbmdlIHRoZSBJ
TyBQQUQgUFdSIFNXSVRDSC4NCisJICovDQorCWlmIChtc21fYmF5aHViX2hvc3QtPmNhcHNfMCAm
IENPUkVfVk9MVF9TVVBQT1JUKSB7DQorCQl1MzIgbmV3X2NvbmZpZzsNCisJCS8qDQorCQkgKiBX
ZSBzaG91bGQgdW5zZXQgSU8gUEFEIFBXUiBzd2l0Y2ggb25seSBpZiB0aGUgcmVnaXN0ZXIgd3Jp
dGUNCisJCSAqIGNhbiBzZXQgSU8gbGluZXMgaGlnaCBhbmQgdGhlIHJlZ3VsYXRvciBhbHNvIHN3
aXRjaGVzIHRvIDMgVi4NCisJCSAqIEVsc2UsIHdlIHNob3VsZCBrZWVwIHRoZSBJTyBQQUQgUFdS
IHN3aXRjaCBzZXQuDQorCQkgKiBUaGlzIGlzIGFwcGxpY2FibGUgdG8gY2VydGFpbiB0YXJnZXRz
IHdoZXJlIGVNTUMgdmNjcSBzdXBwbHkNCisJCSAqIGlzIG9ubHkgMS44Vi4gSW4gc3VjaCB0YXJn
ZXRzLCBldmVuIGR1cmluZyBSRVFfSU9fSElHSCwgdGhlDQorCQkgKiBJTyBQQUQgUFdSIHN3aXRj
aCBtdXN0IGJlIGtlcHQgc2V0IHRvIHJlZmxlY3QgYWN0dWFsDQorCQkgKiByZWd1bGF0b3Igdm9s
dGFnZS4gVGhpcyB3YXksIGR1cmluZyBpbml0aWFsaXphdGlvbiBvZg0KKwkJICogY29udHJvbGxl
cnMgd2l0aCBvbmx5IDEuOFYsIHdlIHdpbGwgc2V0IHRoZSBJTyBQQUQgYml0DQorCQkgKiB3aXRo
b3V0IHdhaXRpbmcgZm9yIGEgUkVRX0lPX0xPVy4NCisJCSAqLw0KKwkJY29uZmlnID0gcmVhZGxf
cmVsYXhlZChob3N0LT5pb2FkZHIgKw0KKwkJCQltc21fYmF5aHViX29mZnNldC0+Y29yZV92ZW5k
b3Jfc3BlYyk7DQorCQluZXdfY29uZmlnID0gY29uZmlnOw0KKw0KKwkJaWYgKChpb19sZXZlbCAm
IFJFUV9JT19ISUdIKSAmJg0KKwkJCQkobXNtX2JheWh1Yl9ob3N0LT5jYXBzXzAgJiBDT1JFXzNf
MFZfU1VQUE9SVCkpDQorCQkJbmV3X2NvbmZpZyAmPSB+Q09SRV9JT19QQURfUFdSX1NXSVRDSDsN
CisJCWVsc2UgaWYgKChpb19sZXZlbCAmIFJFUV9JT19MT1cpIHx8DQorCQkJCShtc21fYmF5aHVi
X2hvc3QtPmNhcHNfMCAmIENPUkVfMV84Vl9TVVBQT1JUKSkNCisJCQluZXdfY29uZmlnIHw9IENP
UkVfSU9fUEFEX1BXUl9TV0lUQ0g7DQorDQorCQlpZiAoY29uZmlnIF4gbmV3X2NvbmZpZykNCisJ
CQl3cml0ZWxfcmVsYXhlZChuZXdfY29uZmlnLCBob3N0LT5pb2FkZHIgKw0KKwkJCQkJbXNtX2Jh
eWh1Yl9vZmZzZXQtPmNvcmVfdmVuZG9yX3NwZWMpOw0KKwl9DQorDQorCWlmIChwd3Jfc3RhdGUp
DQorCQltc21fYmF5aHViX2hvc3QtPmN1cnJfcHdyX3N0YXRlID0gcHdyX3N0YXRlOw0KKwlpZiAo
aW9fbGV2ZWwpDQorCQltc21fYmF5aHViX2hvc3QtPmN1cnJfaW9fbGV2ZWwgPSBpb19sZXZlbDsN
CisNCisJZGV2X2RiZyhtbWNfZGV2KG1tYyksICIlczogJXM6IEhhbmRsZWQgSVJRKCVkKSwgaXJx
X3N0YXR1cz0weCV4LCBhY2s9MHgleFxuIiwNCisJCW1tY19ob3N0bmFtZShtc21fYmF5aHViX2hv
c3QtPm1tYyksIF9fZnVuY19fLCBpcnEsIGlycV9zdGF0dXMsDQorCQlpcnFfYWNrKTsNCit9DQor
DQorc3RhdGljIGlycXJldHVybl90IHNkaGNpX21zbV9iYXlodWJfcHdyX2lycShpbnQgaXJxLCB2
b2lkICpkYXRhKQ0KK3sNCisJc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QgPSAoc3RydWN0IHNkaGNp
X2hvc3QgKilkYXRhOw0KKwlzdHJ1Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNk
aGNpX3ByaXYoaG9zdCk7DQorCXN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKm1zbV9iYXlo
dWJfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9zdCk7DQorDQorCXNkaGNpX21zbV9i
YXlodWJfaGFuZGxlX3B3cl9pcnEoaG9zdCwgaXJxKTsNCisJbXNtX2JheWh1Yl9ob3N0LT5wd3Jf
aXJxX2ZsYWcgPSAxOw0KKwlzZGhjaV9tc21fYmF5aHViX2NvbXBsZXRlX3B3cl9pcnFfd2FpdCht
c21fYmF5aHViX2hvc3QpOw0KKw0KKw0KKwlyZXR1cm4gSVJRX0hBTkRMRUQ7DQorfQ0KKw0KK3N0
YXRpYyB1bnNpZ25lZCBpbnQgc2RoY2lfbXNtX2JheWh1Yl9nZXRfbWF4X2Nsb2NrKHN0cnVjdCBz
ZGhjaV9ob3N0ICpob3N0KQ0KK3sNCisJc3RydWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hv
c3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICpt
c21fYmF5aHViX2hvc3QgPSBzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKwlzdHJ1Y3Qg
Y2xrICpjb3JlX2NsayA9IG1zbV9iYXlodWJfaG9zdC0+YnVsa19jbGtzWzBdLmNsazsNCisNCisJ
cmV0dXJuIGNsa19yb3VuZF9yYXRlKGNvcmVfY2xrLCBVTE9OR19NQVgpOw0KK30NCisNCitzdGF0
aWMgdW5zaWduZWQgaW50IHNkaGNpX21zbV9iYXlodWJfZ2V0X21pbl9jbG9jayhzdHJ1Y3Qgc2Ro
Y2lfaG9zdCAqaG9zdCkNCit7DQorCXJldHVybiBTREhDSV9NU01fTUlOX0NMT0NLOw0KK30NCisN
CisvKioNCisgKiBfX3NkaGNpX21zbV9iYXlodWJfc2V0X2Nsb2NrIC0gc2RoY2lfbXNtX2JheWh1
YiBjbG9jayBjb250cm9sLg0KKyAqDQorICogRGVzY3JpcHRpb246DQorICogTVNNIGNvbnRyb2xs
ZXIgZG9lcyBub3QgdXNlIGludGVybmFsIGRpdmlkZXIgYW5kDQorICogaW5zdGVhZCBkaXJlY3Rs
eSBjb250cm9sIHRoZSBHQ0MgY2xvY2sgYXMgcGVyDQorICogSFcgcmVjb21tZW5kYXRpb24uDQor
ICoqLw0KK3N0YXRpYyB2b2lkIF9fc2RoY2lfbXNtX2JheWh1Yl9zZXRfY2xvY2soc3RydWN0IHNk
aGNpX2hvc3QgKmhvc3QsIHVuc2lnbmVkIGludCBjbG9jaykNCit7DQorCXUxNiBjbGs7DQorDQor
CXNkaGNpX3dyaXRldyhob3N0LCAwLCBTREhDSV9DTE9DS19DT05UUk9MKTsNCisNCisJaWYgKGNs
b2NrID09IDApDQorCQlyZXR1cm47DQorDQorCS8qDQorCSAqIE1TTSBjb250cm9sbGVyIGRvIG5v
dCB1c2UgY2xvY2sgZGl2aWRlci4NCisJICogVGh1cyByZWFkIFNESENJX0NMT0NLX0NPTlRST0wg
YW5kIG9ubHkgZW5hYmxlDQorCSAqIGNsb2NrIHdpdGggbm8gZGl2aWRlciB2YWx1ZSBwcm9ncmFt
bWVkLg0KKwkgKi8NCisJY2xrID0gc2RoY2lfcmVhZHcoaG9zdCwgU0RIQ0lfQ0xPQ0tfQ09OVFJP
TCk7DQorCXNkaGNpX2VuYWJsZV9jbGsoaG9zdCwgY2xrKTsNCit9DQorDQorLyogc2RoY2lfbXNt
X2JheWh1Yl9zZXRfY2xvY2sgLSBDYWxsZWQgd2l0aCAoaG9zdC0+bG9jaykgc3BpbmxvY2sgaGVs
ZC4gKi8NCitzdGF0aWMgdm9pZCBzZGhjaV9tc21fYmF5aHViX3NldF9jbG9jayhzdHJ1Y3Qgc2Ro
Y2lfaG9zdCAqaG9zdCwgdW5zaWduZWQgaW50IGNsb2NrKQ0KK3sNCisJc3RydWN0IHNkaGNpX3Bs
dGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lf
bXNtX2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3QgPSBzZGhjaV9wbHRmbV9wcml2KHBsdGZt
X2hvc3QpOw0KKw0KKwlpZiAoIWNsb2NrKSB7DQorCQlob3N0LT5tbWMtPmFjdHVhbF9jbG9jayA9
IG1zbV9iYXlodWJfaG9zdC0+Y2xrX3JhdGUgPSAwOw0KKwkJZ290byBvdXQ7DQorCX0NCisNCisJ
c2RoY2lfbXNtX2JheWh1Yl9oY19zZWxlY3RfbW9kZShob3N0KTsNCisNCisJbXNtX2JheWh1Yl9z
ZXRfY2xvY2tfcmF0ZV9mb3JfYnVzX21vZGUoaG9zdCwgY2xvY2spOw0KK291dDoNCisJX19zZGhj
aV9tc21fYmF5aHViX3NldF9jbG9jayhob3N0LCBjbG9jayk7DQorfQ0KKw0KKy8qKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKlwNCisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoNCisgKiBNU00gQ29tbWFuZCBRdWV1
ZSBFbmdpbmUgKENRRSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICoNCisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICoNCitcKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovDQorDQor
c3RhdGljIHUzMiBzZGhjaV9tc21fYmF5aHViX2NxZV9pcnEoc3RydWN0IHNkaGNpX2hvc3QgKmhv
c3QsIHUzMiBpbnRtYXNrKQ0KK3sNCisJaW50IGNtZF9lcnJvciA9IDA7DQorCWludCBkYXRhX2Vy
cm9yID0gMDsNCisNCisJaWYgKCFzZGhjaV9jcWVfaXJxKGhvc3QsIGludG1hc2ssICZjbWRfZXJy
b3IsICZkYXRhX2Vycm9yKSkNCisJCXJldHVybiBpbnRtYXNrOw0KKw0KKwljcWhjaV9pcnEoaG9z
dC0+bW1jLCBpbnRtYXNrLCBjbWRfZXJyb3IsIGRhdGFfZXJyb3IpOw0KKwlyZXR1cm4gMDsNCit9
DQorDQorc3RhdGljIHZvaWQgc2RoY2lfbXNtX2JheWh1Yl9jcWVfZGlzYWJsZShzdHJ1Y3QgbW1j
X2hvc3QgKm1tYywgYm9vbCByZWNvdmVyeSkNCit7DQorCXN0cnVjdCBzZGhjaV9ob3N0ICpob3N0
ID0gbW1jX3ByaXYobW1jKTsNCisJdW5zaWduZWQgbG9uZyBmbGFnczsNCisJdTMyIGN0cmw7DQor
DQorCS8qDQorCSAqIFdoZW4gQ1FFIGlzIGhhbHRlZCwgdGhlIGxlZ2FjeSBTREhDSSBwYXRoIG9w
ZXJhdGVzIG9ubHkNCisJICogb24gMTYtYnl0ZSBkZXNjcmlwdG9ycyBpbiA2NGJpdCBtb2RlLg0K
KwkgKi8NCisJaWYgKGhvc3QtPmZsYWdzICYgU0RIQ0lfVVNFXzY0X0JJVF9ETUEpDQorCQlob3N0
LT5kZXNjX3N6ID0gMTY7DQorDQorCXNwaW5fbG9ja19pcnFzYXZlKCZob3N0LT5sb2NrLCBmbGFn
cyk7DQorDQorCS8qDQorCSAqIER1cmluZyBDUUUgY29tbWFuZCB0cmFuc2ZlcnMsIGNvbW1hbmQg
Y29tcGxldGUgYml0IGdldHMgbGF0Y2hlZC4NCisJICogU28gcy93IHNob3VsZCBjbGVhciBjb21t
YW5kIGNvbXBsZXRlIGludGVycnVwdCBzdGF0dXMgd2hlbiBDUUUgaXMNCisJICogZWl0aGVyIGhh
bHRlZCBvciBkaXNhYmxlZC4gT3RoZXJ3aXNlIHVuZXhwZWN0ZWQgU0RDSEkgbGVnYWN5DQorCSAq
IGludGVycnVwdCBnZXRzIHRyaWdnZXJlZCB3aGVuIENRRSBpcyBoYWx0ZWQvZGlzYWJsZWQuDQor
CSAqLw0KKwljdHJsID0gc2RoY2lfcmVhZGwoaG9zdCwgU0RIQ0lfSU5UX0VOQUJMRSk7DQorCWN0
cmwgfD0gU0RIQ0lfSU5UX1JFU1BPTlNFOw0KKwlzZGhjaV93cml0ZWwoaG9zdCwgIGN0cmwsIFNE
SENJX0lOVF9FTkFCTEUpOw0KKwlzZGhjaV93cml0ZWwoaG9zdCwgU0RIQ0lfSU5UX1JFU1BPTlNF
LCBTREhDSV9JTlRfU1RBVFVTKTsNCisNCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaG9zdC0+
bG9jaywgZmxhZ3MpOw0KKw0KKwlzZGhjaV9jcWVfZGlzYWJsZShtbWMsIHJlY292ZXJ5KTsNCit9
DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBjcWhjaV9ob3N0X29wcyBzZGhjaV9tc21fYmF5aHVi
X2NxaGNpX29wcyA9IHsNCisJLmVuYWJsZQkJPSBzZGhjaV9jcWVfZW5hYmxlLA0KKwkuZGlzYWJs
ZQk9IHNkaGNpX21zbV9iYXlodWJfY3FlX2Rpc2FibGUsDQorfTsNCisNCitzdGF0aWMgaW50IHNk
aGNpX21zbV9iYXlodWJfY3FlX2FkZF9ob3N0KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LA0KKwkJ
CQlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQ0KK3sNCisJc3RydWN0IHNkaGNpX3BsdGZt
X2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlzdHJ1Y3Qgc2RoY2lfbXNt
X2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3QgPSBzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hv
c3QpOw0KKwlzdHJ1Y3QgY3FoY2lfaG9zdCAqY3FfaG9zdDsNCisJYm9vbCBkbWE2NDsNCisJdTMy
IGNxY2ZnOw0KKwlpbnQgcmV0Ow0KKw0KKwkvKg0KKwkgKiBXaGVuIENRRSBpcyBoYWx0ZWQsIFNE
SEMgb3BlcmF0ZXMgb25seSBvbiAxNmJ5dGUgQURNQSBkZXNjcmlwdG9ycy4NCisJICogU28gZW5z
dXJlIEFETUEgdGFibGUgaXMgYWxsb2NhdGVkIGZvciAxNmJ5dGUgZGVzY3JpcHRvcnMuDQorCSAq
Lw0KKwlpZiAoaG9zdC0+Y2FwcyAmIFNESENJX0NBTl82NEJJVCkNCisJCWhvc3QtPmFsbG9jX2Rl
c2Nfc3ogPSAxNjsNCisNCisJcmV0ID0gc2RoY2lfc2V0dXBfaG9zdChob3N0KTsNCisJaWYgKHJl
dCkNCisJCXJldHVybiByZXQ7DQorDQorCWNxX2hvc3QgPSBjcWhjaV9wbHRmbV9pbml0KHBkZXYp
Ow0KKwlpZiAoSVNfRVJSKGNxX2hvc3QpKSB7DQorCQlyZXQgPSBQVFJfRVJSKGNxX2hvc3QpOw0K
KwkJZGV2X2VycigmcGRldi0+ZGV2LCAiY3FoY2ktcGx0Zm0gaW5pdDogZmFpbGVkOiAlZFxuIiwg
cmV0KTsNCisJCWdvdG8gY2xlYW51cDsNCisJfQ0KKw0KKwltc21fYmF5aHViX2hvc3QtPm1tYy0+
Y2FwczIgfD0gTU1DX0NBUDJfQ1FFIHwgTU1DX0NBUDJfQ1FFX0RDTUQ7DQorCWNxX2hvc3QtPm9w
cyA9ICZzZGhjaV9tc21fYmF5aHViX2NxaGNpX29wczsNCisNCisJZG1hNjQgPSBob3N0LT5mbGFn
cyAmIFNESENJX1VTRV82NF9CSVRfRE1BOw0KKw0KKwlyZXQgPSBjcWhjaV9pbml0KGNxX2hvc3Qs
IGhvc3QtPm1tYywgZG1hNjQpOw0KKwlpZiAocmV0KSB7DQorCQlkZXZfZXJyKCZwZGV2LT5kZXYs
ICIlczogQ1FFIGluaXQ6IGZhaWxlZCAoJWQpXG4iLA0KKwkJCQltbWNfaG9zdG5hbWUoaG9zdC0+
bW1jKSwgcmV0KTsNCisJCWdvdG8gY2xlYW51cDsNCisJfQ0KKw0KKwkvKiBEaXNhYmxlIGNxZSBy
ZXNldCBkdWUgdG8gY3FlIGVuYWJsZSBzaWduYWwgKi8NCisJY3FjZmcgPSBjcWhjaV9yZWFkbChj
cV9ob3N0LCBDUUhDSV9WRU5ET1JfQ0ZHMSk7DQorCWNxY2ZnIHw9IENRSENJX1ZFTkRPUl9ESVNf
UlNUX09OX0NRX0VOOw0KKwljcWhjaV93cml0ZWwoY3FfaG9zdCwgY3FjZmcsIENRSENJX1ZFTkRP
Ul9DRkcxKTsNCisNCisJLyoNCisJICogU0RIQyBleHBlY3RzIDEyYnl0ZSBBRE1BIGRlc2NyaXB0
b3JzIHRpbGwgQ1FFIGlzIGVuYWJsZWQuDQorCSAqIFNvIGxpbWl0IGRlc2Nfc3ogdG8gMTIgc28g
dGhhdCB0aGUgZGF0YSBjb21tYW5kcyB0aGF0IGFyZSBzZW50DQorCSAqIGR1cmluZyBjYXJkIGlu
aXRpYWxpemF0aW9uIChiZWZvcmUgQ1FFIGdldHMgZW5hYmxlZCkgd291bGQNCisJICogZ2V0IGV4
ZWN1dGVkIHdpdGhvdXQgYW55IGlzc3Vlcy4NCisJICovDQorCWlmIChob3N0LT5mbGFncyAmIFNE
SENJX1VTRV82NF9CSVRfRE1BKQ0KKwkJaG9zdC0+ZGVzY19zeiA9IDEyOw0KKw0KKwlyZXQgPSBf
X3NkaGNpX2FkZF9ob3N0KGhvc3QpOw0KKwlpZiAocmV0KQ0KKwkJZ290byBjbGVhbnVwOw0KKw0K
KwlkZXZfaW5mbygmcGRldi0+ZGV2LCAiJXM6IENRRSBpbml0OiBzdWNjZXNzXG4iLA0KKwkJCW1t
Y19ob3N0bmFtZShob3N0LT5tbWMpKTsNCisJcmV0dXJuIHJldDsNCisNCitjbGVhbnVwOg0KKwlz
ZGhjaV9jbGVhbnVwX2hvc3QoaG9zdCk7DQorCXJldHVybiByZXQ7DQorfQ0KKw0KKy8qDQorICog
UGxhdGZvcm0gc3BlY2lmaWMgcmVnaXN0ZXIgd3JpdGUgZnVuY3Rpb25zLiBUaGlzIGlzIHNvIHRo
YXQsIGlmIGFueQ0KKyAqIHJlZ2lzdGVyIHdyaXRlIG5lZWRzIHRvIGJlIGZvbGxvd2VkIHVwIGJ5
IHBsYXRmb3JtIHNwZWNpZmljIGFjdGlvbnMsDQorICogdGhleSBjYW4gYmUgYWRkZWQgaGVyZS4g
VGhlc2UgZnVuY3Rpb25zIGNhbiBnbyB0byBzbGVlcCB3aGVuIHdyaXRlcw0KKyAqIHRvIGNlcnRh
aW4gcmVnaXN0ZXJzIGFyZSBkb25lLg0KKyAqIFRoZXNlIGZ1bmN0aW9ucyBhcmUgcmVseWluZyBv
biBzZGhjaV9zZXRfaW9zIG5vdCB1c2luZyBzcGlubG9jay4NCisgKi8NCitzdGF0aWMgaW50IF9f
c2RoY2lfbXNtX2JheWh1Yl9jaGVja193cml0ZShzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9zdCwgdTE2
IHZhbCwgaW50IHJlZykNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0
ID0gc2RoY2lfcHJpdihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqbXNt
X2JheWh1Yl9ob3N0ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisJdTMyIHJlcV90
eXBlID0gMDsNCisNCisJc3dpdGNoIChyZWcpIHsNCisJY2FzZSBTREhDSV9IT1NUX0NPTlRST0wy
Og0KKwkJcmVxX3R5cGUgPSAodmFsICYgU0RIQ0lfQ1RSTF9WRERfMTgwKSA/IFJFUV9JT19MT1cg
Og0KKwkJCVJFUV9JT19ISUdIOw0KKwkJYnJlYWs7DQorCWNhc2UgU0RIQ0lfU09GVFdBUkVfUkVT
RVQ6DQorCQlpZiAoaG9zdC0+cHdyICYmICh2YWwgJiBTREhDSV9SRVNFVF9BTEwpKQ0KKwkJCXJl
cV90eXBlID0gUkVRX0JVU19PRkY7DQorCQlicmVhazsNCisJY2FzZSBTREhDSV9QT1dFUl9DT05U
Uk9MOg0KKwkJcmVxX3R5cGUgPSAhdmFsID8gUkVRX0JVU19PRkYgOiBSRVFfQlVTX09OOw0KKwkJ
YnJlYWs7DQorCWNhc2UgU0RIQ0lfVFJBTlNGRVJfTU9ERToNCisJCW1zbV9iYXlodWJfaG9zdC0+
dHJhbnNmZXJfbW9kZSA9IHZhbDsNCisJCWJyZWFrOw0KKwljYXNlIFNESENJX0NPTU1BTkQ6DQor
CQlpZiAoIW1zbV9iYXlodWJfaG9zdC0+dXNlX2NkcikNCisJCQlicmVhazsNCisJCWlmICgobXNt
X2JheWh1Yl9ob3N0LT50cmFuc2Zlcl9tb2RlICYgU0RIQ0lfVFJOU19SRUFEKSAmJg0KKwkJICAg
IFNESENJX0dFVF9DTUQodmFsKSAhPSBNTUNfU0VORF9UVU5JTkdfQkxPQ0tfSFMyMDAgJiYNCisJ
CSAgICBTREhDSV9HRVRfQ01EKHZhbCkgIT0gTU1DX1NFTkRfVFVOSU5HX0JMT0NLKQ0KKwkJCXNk
aGNpX21zbV9iYXlodWJfc2V0X2Nkcihob3N0LCB0cnVlKTsNCisJCWVsc2UNCisJCQlzZGhjaV9t
c21fYmF5aHViX3NldF9jZHIoaG9zdCwgZmFsc2UpOw0KKwkJYnJlYWs7DQorCX0NCisNCisJaWYg
KHJlcV90eXBlKSB7DQorCQltc21fYmF5aHViX2hvc3QtPnB3cl9pcnFfZmxhZyA9IDA7DQorCQkv
Kg0KKwkJICogU2luY2UgdGhpcyByZWdpc3RlciB3cml0ZSBtYXkgdHJpZ2dlciBhIHBvd2VyIGly
cSwgZW5zdXJlDQorCQkgKiBhbGwgcHJldmlvdXMgcmVnaXN0ZXIgd3JpdGVzIGFyZSBjb21wbGV0
ZSBieSB0aGlzIHBvaW50Lg0KKwkJICovDQorCQltYigpOw0KKwl9DQorCXJldHVybiByZXFfdHlw
ZTsNCit9DQorDQorLyogVGhpcyBmdW5jdGlvbiBtYXkgc2xlZXAqLw0KK3N0YXRpYyB2b2lkIHNk
aGNpX21zbV9iYXlodWJfd3JpdGV3KHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LCB1MTYgdmFsLCBp
bnQgcmVnKQ0KK3sNCisJdTMyIHJlcV90eXBlID0gMDsNCisNCisJcmVxX3R5cGUgPSBfX3NkaGNp
X21zbV9iYXlodWJfY2hlY2tfd3JpdGUoaG9zdCwgdmFsLCByZWcpOw0KKwl3cml0ZXdfcmVsYXhl
ZCh2YWwsIGhvc3QtPmlvYWRkciArIHJlZyk7DQorDQorCWlmIChyZXFfdHlwZSkNCisJCXNkaGNp
X21zbV9iYXlodWJfY2hlY2tfcG93ZXJfc3RhdHVzKGhvc3QsIHJlcV90eXBlKTsNCit9DQorDQor
LyogVGhpcyBmdW5jdGlvbiBtYXkgc2xlZXAqLw0KK3N0YXRpYyB2b2lkIHNkaGNpX21zbV9iYXlo
dWJfd3JpdGViKHN0cnVjdCBzZGhjaV9ob3N0ICpob3N0LCB1OCB2YWwsIGludCByZWcpDQorew0K
Kwl1MzIgcmVxX3R5cGUgPSAwOw0KKw0KKwlyZXFfdHlwZSA9IF9fc2RoY2lfbXNtX2JheWh1Yl9j
aGVja193cml0ZShob3N0LCB2YWwsIHJlZyk7DQorDQorCXdyaXRlYl9yZWxheGVkKHZhbCwgaG9z
dC0+aW9hZGRyICsgcmVnKTsNCisNCisJaWYgKHJlcV90eXBlKQ0KKwkJc2RoY2lfbXNtX2JheWh1
Yl9jaGVja19wb3dlcl9zdGF0dXMoaG9zdCwgcmVxX3R5cGUpOw0KK30NCisNCitzdGF0aWMgdm9p
ZCBzZGhjaV9tc21fYmF5aHViX3NldF9yZWd1bGF0b3JfY2FwcyhzdHJ1Y3Qgc2RoY2lfbXNtX2Jh
eWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3QpDQorew0KKwlzdHJ1Y3QgbW1jX2hvc3QgKm1tYyA9
IG1zbV9iYXlodWJfaG9zdC0+bW1jOw0KKwlzdHJ1Y3QgcmVndWxhdG9yICpzdXBwbHkgPSBtbWMt
PnN1cHBseS52cW1tYzsNCisJdTMyIGNhcHMgPSAwLCBjb25maWc7DQorCXN0cnVjdCBzZGhjaV9o
b3N0ICpob3N0ID0gbW1jX3ByaXYobW1jKTsNCisJY29uc3Qgc3RydWN0IHNkaGNpX21zbV9iYXlo
dWJfb2Zmc2V0ICptc21fYmF5aHViX29mZnNldCA9IG1zbV9iYXlodWJfaG9zdC0+b2Zmc2V0Ow0K
Kw0KKwlpZiAoIUlTX0VSUihtbWMtPnN1cHBseS52cW1tYykpIHsNCisJCWlmIChyZWd1bGF0b3Jf
aXNfc3VwcG9ydGVkX3ZvbHRhZ2Uoc3VwcGx5LCAxNzAwMDAwLCAxOTUwMDAwKSkNCisJCQljYXBz
IHw9IENPUkVfMV84Vl9TVVBQT1JUOw0KKwkJaWYgKHJlZ3VsYXRvcl9pc19zdXBwb3J0ZWRfdm9s
dGFnZShzdXBwbHksIDI3MDAwMDAsIDM2MDAwMDApKQ0KKwkJCWNhcHMgfD0gQ09SRV8zXzBWX1NV
UFBPUlQ7DQorDQorCQlpZiAoIWNhcHMpDQorCQkJcHJfd2FybigiJXM6IDEuOC8zViBub3Qgc3Vw
cG9ydGVkIGZvciB2cW1tY1xuIiwNCisJCQkJCW1tY19ob3N0bmFtZShtbWMpKTsNCisJfQ0KKw0K
KwlpZiAoY2Fwcykgew0KKwkJLyoNCisJCSAqIFNldCB0aGUgUEFEX1BXUl9TV0lUQ0hfRU4gYml0
IHNvIHRoYXQgdGhlIFBBRF9QV1JfU1dJVENIDQorCQkgKiBiaXQgY2FuIGJlIHVzZWQgYXMgcmVx
dWlyZWQgbGF0ZXIgb24uDQorCQkgKi8NCisJCXUzMiBpb19sZXZlbCA9IG1zbV9iYXlodWJfaG9z
dC0+Y3Vycl9pb19sZXZlbDsNCisNCisJCWNvbmZpZyA9IHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9h
ZGRyICsNCisJCQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfdmVuZG9yX3NwZWMpOw0KKwkJY29u
ZmlnIHw9IENPUkVfSU9fUEFEX1BXUl9TV0lUQ0hfRU47DQorDQorCQlpZiAoKGlvX2xldmVsICYg
UkVRX0lPX0hJR0gpICYmIChjYXBzICYJQ09SRV8zXzBWX1NVUFBPUlQpKQ0KKwkJCWNvbmZpZyAm
PSB+Q09SRV9JT19QQURfUFdSX1NXSVRDSDsNCisJCWVsc2UgaWYgKChpb19sZXZlbCAmIFJFUV9J
T19MT1cpIHx8IChjYXBzICYgQ09SRV8xXzhWX1NVUFBPUlQpKQ0KKwkJCWNvbmZpZyB8PSBDT1JF
X0lPX1BBRF9QV1JfU1dJVENIOw0KKw0KKwkJd3JpdGVsX3JlbGF4ZWQoY29uZmlnLA0KKwkJCQlo
b3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+Y29yZV92ZW5kb3Jfc3BlYyk7DQorCX0N
CisJbXNtX2JheWh1Yl9ob3N0LT5jYXBzXzAgfD0gY2FwczsNCisJcHJfZGVidWcoIiVzOiBzdXBw
b3J0ZWQgY2FwczogMHglMDh4XG4iLCBtbWNfaG9zdG5hbWUobW1jKSwgY2Fwcyk7DQorfQ0KKw0K
K3N0YXRpYyB2b2lkIHNkaGNpX21zbV9iYXlodWJfcmVzZXQoc3RydWN0IHNkaGNpX2hvc3QgKmhv
c3QsIHU4IG1hc2spDQorew0KKwlpZiAoKGhvc3QtPm1tYy0+Y2FwczIgJiBNTUNfQ0FQMl9DUUUp
ICYmIChtYXNrICYgU0RIQ0lfUkVTRVRfQUxMKSkNCisJCWNxaGNpX2RlYWN0aXZhdGUoaG9zdC0+
bW1jKTsNCisJc2RoY2lfcmVzZXQoaG9zdCwgbWFzayk7DQorfQ0KKw0KK3N0YXRpYyBpbnQgc2Ro
Y2lfbXNtX2JheWh1Yl9yZWdpc3Rlcl92cmVnKHN0cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3Qg
Km1zbV9iYXlodWJfaG9zdCkNCit7DQorCWludCByZXQ7DQorDQorCXJldCA9IG1tY19yZWd1bGF0
b3JfZ2V0X3N1cHBseShtc21fYmF5aHViX2hvc3QtPm1tYyk7DQorCWlmIChyZXQpDQorCQlyZXR1
cm4gcmV0Ow0KKw0KKwlzZGhjaV9tc21fYmF5aHViX3NldF9yZWd1bGF0b3JfY2Fwcyhtc21fYmF5
aHViX2hvc3QpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGludCBzZGhjaV9tc21f
YmF5aHViX3N0YXJ0X3NpZ25hbF92b2x0YWdlX3N3aXRjaChzdHJ1Y3QgbW1jX2hvc3QgKm1tYywN
CisJCQkJICAgICAgc3RydWN0IG1tY19pb3MgKmlvcykNCit7DQorCXN0cnVjdCBzZGhjaV9ob3N0
ICpob3N0ID0gbW1jX3ByaXYobW1jKTsNCisJdTE2IGN0cmwsIHN0YXR1czsNCisNCisJLyoNCisJ
ICogU2lnbmFsIFZvbHRhZ2UgU3dpdGNoaW5nIGlzIG9ubHkgYXBwbGljYWJsZSBmb3IgSG9zdCBD
b250cm9sbGVycw0KKwkgKiB2My4wMCBhbmQgYWJvdmUuDQorCSAqLw0KKwlpZiAoaG9zdC0+dmVy
c2lvbiA8IFNESENJX1NQRUNfMzAwKQ0KKwkJcmV0dXJuIDA7DQorDQorCWN0cmwgPSBzZGhjaV9y
ZWFkdyhob3N0LCBTREhDSV9IT1NUX0NPTlRST0wyKTsNCisNCisJc3dpdGNoIChpb3MtPnNpZ25h
bF92b2x0YWdlKSB7DQorCWNhc2UgTU1DX1NJR05BTF9WT0xUQUdFXzMzMDoNCisJCWlmICghKGhv
c3QtPmZsYWdzICYgU0RIQ0lfU0lHTkFMSU5HXzMzMCkpDQorCQkJcmV0dXJuIC1FSU5WQUw7DQor
DQorCQkvKiBTZXQgMS44ViBTaWduYWwgRW5hYmxlIGluIHRoZSBIb3N0IENvbnRyb2wyIHJlZ2lz
dGVyIHRvIDAgKi8NCisJCWN0cmwgJj0gflNESENJX0NUUkxfVkREXzE4MDsNCisJCWJyZWFrOw0K
KwljYXNlIE1NQ19TSUdOQUxfVk9MVEFHRV8xODA6DQorCQlpZiAoIShob3N0LT5mbGFncyAmIFNE
SENJX1NJR05BTElOR18xODApKQ0KKwkJCXJldHVybiAtRUlOVkFMOw0KKw0KKwkJLyogRW5hYmxl
IDEuOFYgU2lnbmFsIEVuYWJsZSBpbiB0aGUgSG9zdCBDb250cm9sMiByZWdpc3RlciAqLw0KKwkJ
Y3RybCB8PSBTREhDSV9DVFJMX1ZERF8xODA7DQorCQlicmVhazsNCisNCisJZGVmYXVsdDoNCisJ
CXJldHVybiAtRUlOVkFMOw0KKwl9DQorDQorCXNkaGNpX3dyaXRldyhob3N0LCBjdHJsLCBTREhD
SV9IT1NUX0NPTlRST0wyKTsNCisNCisJLyogV2FpdCBmb3IgNW1zICovDQorCXVzbGVlcF9yYW5n
ZSg1MDAwLCA1NTAwKTsNCisNCisJLyogcmVndWxhdG9yIG91dHB1dCBzaG91bGQgYmUgc3RhYmxl
IHdpdGhpbiA1IG1zICovDQorCXN0YXR1cyA9IGN0cmwgJiBTREhDSV9DVFJMX1ZERF8xODA7DQor
CWN0cmwgPSBzZGhjaV9yZWFkdyhob3N0LCBTREhDSV9IT1NUX0NPTlRST0wyKTsNCisJaWYgKChj
dHJsICYgU0RIQ0lfQ1RSTF9WRERfMTgwKSA9PSBzdGF0dXMpDQorCQlyZXR1cm4gMDsNCisNCisJ
ZGV2X3dhcm4obW1jX2RldihtbWMpLCAiJXM6IFJlZ3VsYXRvciBvdXRwdXQgZGlkIG5vdCBiZWNh
bWUgc3RhYmxlXG4iLA0KKwkJbW1jX2hvc3RuYW1lKG1tYykpOw0KKw0KKwlyZXR1cm4gLUVBR0FJ
TjsNCit9DQorDQorI2RlZmluZSBEUklWRVJfTkFNRSAic2RoY2lfbXNtX2JheWh1YiINCisjZGVm
aW5lIFNESENJX01TTV9EVU1QKGYsIHguLi4pIFwNCisJcHJfZXJyKCIlczogIiBEUklWRVJfTkFN
RSAiOiAiIGYsIG1tY19ob3N0bmFtZShob3N0LT5tbWMpLCAjIyB4KQ0KKw0KK3N0YXRpYyB2b2lk
IHNkaGNpX21zbV9iYXlodWJfZHVtcF92ZW5kb3JfcmVncyhzdHJ1Y3Qgc2RoY2lfaG9zdCAqaG9z
dCkNCit7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJp
dihob3N0KTsNCisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqbXNtX2JheWh1Yl9ob3N0
ID0gc2RoY2lfcGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisJY29uc3Qgc3RydWN0IHNkaGNpX21z
bV9iYXlodWJfb2Zmc2V0ICptc21fYmF5aHViX29mZnNldCA9IG1zbV9iYXlodWJfaG9zdC0+b2Zm
c2V0Ow0KKw0KKwlTREhDSV9NU01fRFVNUCgiLS0tLS0tLS0tLS0gVkVORE9SIFJFR0lTVEVSIERV
TVAgLS0tLS0tLS0tLS1cbiIpOw0KKw0KKwlTREhDSV9NU01fRFVNUCgNCisJCQkiRExMIHN0czog
MHglMDh4IHwgRExMIGNmZzogIDB4JTA4eCB8IERMTCBjZmcyOiAweCUwOHhcbiIsDQorCQlyZWFk
bF9yZWxheGVkKGhvc3QtPmlvYWRkciArIG1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF9zdGF0
dXMpLA0KKwkJcmVhZGxfcmVsYXhlZChob3N0LT5pb2FkZHIgKyBtc21fYmF5aHViX29mZnNldC0+
Y29yZV9kbGxfY29uZmlnKSwNCisJCXJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsgbXNtX2Jh
eWh1Yl9vZmZzZXQtPmNvcmVfZGxsX2NvbmZpZ18yKSk7DQorCVNESENJX01TTV9EVU1QKA0KKwkJ
CSJETEwgY2ZnMzogMHglMDh4IHwgRExMIHVzciBjdGw6ICAweCUwOHggfCBERFIgY2ZnOiAweCUw
OHhcbiIsDQorCQlyZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRkciArIG1zbV9iYXlodWJfb2Zmc2V0
LT5jb3JlX2RsbF9jb25maWdfMyksDQorCQlyZWFkbF9yZWxheGVkKGhvc3QtPmlvYWRkciArIG1z
bV9iYXlodWJfb2Zmc2V0LT5jb3JlX2RsbF91c3JfY3RsKSwNCisJCXJlYWRsX3JlbGF4ZWQoaG9z
dC0+aW9hZGRyICsgbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfZGRyX2NvbmZpZykpOw0KKwlTREhD
SV9NU01fRFVNUCgNCisJCQkiVm5kciBmdW5jOiAweCUwOHggfCBWbmRyIGZ1bmMyIDogMHglMDh4
IFZuZHIgZnVuYzM6IDB4JTA4eFxuIiwNCisJCXJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsg
bXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfdmVuZG9yX3NwZWMpLA0KKwkJcmVhZGxfcmVsYXhlZCho
b3N0LT5pb2FkZHIgKw0KKwkJCW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX3ZlbmRvcl9zcGVjX2Z1
bmMyKSwNCisJCXJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9hZGRyICsgbXNtX2JheWh1Yl9vZmZzZXQt
PmNvcmVfdmVuZG9yX3NwZWMzKSk7DQorfQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgc2RoY2lf
bXNtX2JheWh1Yl92YXJpYW50X29wcyBtY2lfdmFyX29wcyA9IHsNCisJLm1zbV9iYXlodWJfcmVh
ZGxfcmVsYXhlZCA9IHNkaGNpX21zbV9iYXlodWJfbWNpX3ZhcmlhbnRfcmVhZGxfcmVsYXhlZCwN
CisJLm1zbV9iYXlodWJfd3JpdGVsX3JlbGF4ZWQgPSBzZGhjaV9tc21fYmF5aHViX21jaV92YXJp
YW50X3dyaXRlbF9yZWxheGVkLA0KK307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBzZGhjaV9t
c21fYmF5aHViX3ZhcmlhbnRfb3BzIHY1X3Zhcl9vcHMgPSB7DQorCS5tc21fYmF5aHViX3JlYWRs
X3JlbGF4ZWQgPSBzZGhjaV9tc21fYmF5aHViX3Y1X3ZhcmlhbnRfcmVhZGxfcmVsYXhlZCwNCisJ
Lm1zbV9iYXlodWJfd3JpdGVsX3JlbGF4ZWQgPSBzZGhjaV9tc21fYmF5aHViX3Y1X3ZhcmlhbnRf
d3JpdGVsX3JlbGF4ZWQsDQorfTsNCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IHNkaGNpX21zbV9i
YXlodWJfdmFyaWFudF9pbmZvIHNkaGNpX21zbV9iYXlodWJfdjVfdmFyID0gew0KKwkubWNpX3Jl
bW92ZWQgPSB0cnVlLA0KKwkudmFyX29wcyA9ICZ2NV92YXJfb3BzLA0KKwkub2Zmc2V0ID0gJnNk
aGNpX21zbV9iYXlodWJfdjVfb2Zmc2V0LA0KK307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBz
ZGhjaV9tc21fYmF5aHViX3ZhcmlhbnRfaW5mbyBzZG04NDVfc2RoY2lfdmFyID0gew0KKwkubWNp
X3JlbW92ZWQgPSB0cnVlLA0KKwkucmVzdG9yZV9kbGxfY29uZmlnID0gdHJ1ZSwNCisJLnZhcl9v
cHMgPSAmdjVfdmFyX29wcywNCisJLm9mZnNldCA9ICZzZGhjaV9tc21fYmF5aHViX3Y1X29mZnNl
dCwNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIHNkaGNpX21zbV9i
YXlodWJfZHRfbWF0Y2hbXSA9IHsNCisJey5jb21wYXRpYmxlID0gInFjb20sc2RoY2ktbXNtLWJh
eWh1Yi12NSIsIC5kYXRhID0gJnNkaGNpX21zbV9iYXlodWJfdjVfdmFyfSwNCisJey5jb21wYXRp
YmxlID0gInFjb20sc2RtODQ1LWJheWh1Yi1zZGhjaSIsIC5kYXRhID0gJnNkbTg0NV9zZGhjaV92
YXJ9LA0KKwl7fSwNCit9Ow0KKw0KK01PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIHNkaGNpX21zbV9i
YXlodWJfZHRfbWF0Y2gpOw0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgc2RoY2lfb3BzIHNkaGNp
X21zbV9iYXlodWJfb3BzID0gew0KKwkucmVzZXQgPSBzZGhjaV9tc21fYmF5aHViX3Jlc2V0LA0K
Kwkuc2V0X2Nsb2NrID0gc2RoY2lfbXNtX2JheWh1Yl9zZXRfY2xvY2ssDQorCS5nZXRfbWluX2Ns
b2NrID0gc2RoY2lfbXNtX2JheWh1Yl9nZXRfbWluX2Nsb2NrLA0KKwkuZ2V0X21heF9jbG9jayA9
IHNkaGNpX21zbV9iYXlodWJfZ2V0X21heF9jbG9jaywNCisJLnNldF9idXNfd2lkdGggPSBzZGhj
aV9zZXRfYnVzX3dpZHRoLA0KKwkuc2V0X3Voc19zaWduYWxpbmcgPSBzZGhjaV9tc21fYmF5aHVi
X3NldF91aHNfc2lnbmFsaW5nLA0KKwkud3JpdGVfdyA9IHNkaGNpX21zbV9iYXlodWJfd3JpdGV3
LA0KKwkud3JpdGVfYiA9IHNkaGNpX21zbV9iYXlodWJfd3JpdGViLA0KKwkuaXJxCT0gc2RoY2lf
bXNtX2JheWh1Yl9jcWVfaXJxLA0KKwkuZHVtcF92ZW5kb3JfcmVncyA9IHNkaGNpX21zbV9iYXlo
dWJfZHVtcF92ZW5kb3JfcmVncywNCisJLnNldF9wb3dlciA9IHNkaGNpX3NldF9wb3dlcl9ub3Jl
ZywNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgc2RoY2lfcGx0Zm1fZGF0YSBzZGhjaV9t
c21fYmF5aHViX3BkYXRhID0gew0KKwkucXVpcmtzID0gU0RIQ0lfUVVJUktfQlJPS0VOX0NBUkRf
REVURUNUSU9OIHwNCisJCSAgU0RIQ0lfUVVJUktfU0lOR0xFX1BPV0VSX1dSSVRFIHwNCisJCSAg
U0RIQ0lfUVVJUktfQ0FQX0NMT0NLX0JBU0VfQlJPS0VOIHwNCisJCSAgU0RIQ0lfUVVJUktfTVVM
VElCTE9DS19SRUFEX0FDTUQxMiwNCisNCisJLnF1aXJrczIgPSBTREhDSV9RVUlSSzJfUFJFU0VU
X1ZBTFVFX0JST0tFTiwNCisJLm9wcyA9ICZzZGhjaV9tc21fYmF5aHViX29wcywNCit9Ow0KKw0K
K3N0YXRpYyBpbmxpbmUgdm9pZCBzZGhjaV9tc21fYmF5aHViX2dldF9vZl9wcm9wZXJ0eShzdHJ1
Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2LA0KKwkJc3RydWN0IHNkaGNpX2hvc3QgKmhvc3QpDQor
ew0KKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm5vZGUgPSBwZGV2LT5kZXYub2Zfbm9kZTsNCisJc3Ry
dWN0IHNkaGNpX3BsdGZtX2hvc3QgKnBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwlz
dHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3QgPSBzZGhjaV9wbHRm
bV9wcml2KHBsdGZtX2hvc3QpOw0KKw0KKwlpZiAob2ZfcHJvcGVydHlfcmVhZF91MzIobm9kZSwg
InFjb20sZGRyLWNvbmZpZyIsDQorCQkJCSZtc21fYmF5aHViX2hvc3QtPmRkcl9jb25maWcpKQ0K
KwkJbXNtX2JheWh1Yl9ob3N0LT5kZHJfY29uZmlnID0gRERSX0NPTkZJR19QT1JfVkFMOw0KKw0K
KwlvZl9wcm9wZXJ0eV9yZWFkX3UzMihub2RlLCAicWNvbSxkbGwtY29uZmlnIiwgJm1zbV9iYXlo
dWJfaG9zdC0+ZGxsX2NvbmZpZyk7DQorfQ0KKw0KK3N0YXRpYyBpbnQgc2RoY2lfbXNtX2JheWh1
Yl9wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQ0KK3sNCisJc3RydWN0IHNkaGNp
X2hvc3QgKmhvc3Q7DQorCXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0Ow0KKwlz
dHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9ob3N0ICptc21fYmF5aHViX2hvc3Q7DQorCXN0cnVjdCBy
ZXNvdXJjZSAqY29yZV9tZW1yZXM7DQorCXN0cnVjdCBjbGsgKmNsazsNCisJaW50IHJldDsNCisJ
dTE2IGhvc3RfdmVyc2lvbiwgY29yZV9taW5vcjsNCisJdTMyIGNvcmVfdmVyc2lvbiwgY29uZmln
Ow0KKwl1OCBjb3JlX21ham9yOw0KKwljb25zdCBzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl9vZmZz
ZXQgKm1zbV9iYXlodWJfb2Zmc2V0Ow0KKwljb25zdCBzdHJ1Y3Qgc2RoY2lfbXNtX2JheWh1Yl92
YXJpYW50X2luZm8gKnZhcl9pbmZvOw0KKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm5vZGUgPSBwZGV2
LT5kZXYub2Zfbm9kZTsNCisNCisJaG9zdCA9IHNkaGNpX3BsdGZtX2luaXQocGRldiwgJnNkaGNp
X21zbV9iYXlodWJfcGRhdGEsIHNpemVvZigqbXNtX2JheWh1Yl9ob3N0KSk7DQorCWlmIChJU19F
UlIoaG9zdCkpDQorCQlyZXR1cm4gUFRSX0VSUihob3N0KTsNCisNCisJaG9zdC0+c2RtYV9ib3Vu
ZGFyeSA9IDA7DQorCXBsdGZtX2hvc3QgPSBzZGhjaV9wcml2KGhvc3QpOw0KKwltc21fYmF5aHVi
X2hvc3QgPSBzZGhjaV9wbHRmbV9wcml2KHBsdGZtX2hvc3QpOw0KKwltc21fYmF5aHViX2hvc3Qt
Pm1tYyA9IGhvc3QtPm1tYzsNCisJbXNtX2JheWh1Yl9ob3N0LT5wZGV2ID0gcGRldjsNCisNCisJ
cmV0ID0gbW1jX29mX3BhcnNlKGhvc3QtPm1tYyk7DQorCWlmIChyZXQpDQorCQlnb3RvIHBsdGZt
X2ZyZWU7DQorDQorCWlmIChvZl9maW5kX3Byb3BlcnR5KG5vZGUsICJ1c2UtYmF5aHViLWJoMjAx
IiwgTlVMTCkpIHsNCisJCXNkaGNpX2JoMjAxX3BhcnNlKG1zbV9iYXlodWJfaG9zdC0+bW1jKTsN
CisJCUlOSVRfREVMQVlFRF9XT1JLKCZob3N0LT5tbWMtPmRldGVjdCwgbW1jX3Jlc2Nhbl9iYXlo
dWIpOw0KKwl9IGVsc2UNCisJCW1zbV9iYXlodWJfaG9zdC0+Z2djLmJoMjAxX3VzZWQgPSAwOw0K
Kw0KKwkvKg0KKwkgKiBCYXNlZCBvbiB0aGUgY29tcGF0aWJsZSBzdHJpbmcsIGxvYWQgdGhlIHJl
cXVpcmVkIG1zbV9iYXlodWIgaG9zdCBpbmZvIGZyb20NCisJICogdGhlIGRhdGEgYXNzb2NpYXRl
ZCB3aXRoIHRoZSB2ZXJzaW9uIGluZm8uDQorCSAqLw0KKwl2YXJfaW5mbyA9IG9mX2RldmljZV9n
ZXRfbWF0Y2hfZGF0YSgmcGRldi0+ZGV2KTsNCisNCisJbXNtX2JheWh1Yl9ob3N0LT5tY2lfcmVt
b3ZlZCA9IHZhcl9pbmZvLT5tY2lfcmVtb3ZlZDsNCisJbXNtX2JheWh1Yl9ob3N0LT5yZXN0b3Jl
X2RsbF9jb25maWcgPSB2YXJfaW5mby0+cmVzdG9yZV9kbGxfY29uZmlnOw0KKwltc21fYmF5aHVi
X2hvc3QtPnZhcl9vcHMgPSB2YXJfaW5mby0+dmFyX29wczsNCisJbXNtX2JheWh1Yl9ob3N0LT5v
ZmZzZXQgPSB2YXJfaW5mby0+b2Zmc2V0Ow0KKwltc21fYmF5aHViX2hvc3QtPnVzZXNfdGFzc2Fk
YXJfZGxsID0gdmFyX2luZm8tPnVzZXNfdGFzc2FkYXJfZGxsOw0KKw0KKwltc21fYmF5aHViX29m
ZnNldCA9IG1zbV9iYXlodWJfaG9zdC0+b2Zmc2V0Ow0KKw0KKwlzZGhjaV9nZXRfb2ZfcHJvcGVy
dHkocGRldik7DQorCXNkaGNpX21zbV9iYXlodWJfZ2V0X29mX3Byb3BlcnR5KHBkZXYsIGhvc3Qp
Ow0KKw0KKwltc21fYmF5aHViX2hvc3QtPnNhdmVkX3R1bmluZ19waGFzZSA9IElOVkFMSURfVFVO
SU5HX1BIQVNFOw0KKw0KKwkvKiBTZXR1cCBTRENDIGJ1cyB2b3RlciBjbG9jay4gKi8NCisJbXNt
X2JheWh1Yl9ob3N0LT5idXNfY2xrID0gZGV2bV9jbGtfZ2V0KCZwZGV2LT5kZXYsICJidXMiKTsN
CisJaWYgKCFJU19FUlIobXNtX2JheWh1Yl9ob3N0LT5idXNfY2xrKSkgew0KKwkJLyogVm90ZSBm
b3IgbWF4LiBjbGsgcmF0ZSBmb3IgbWF4LiBwZXJmb3JtYW5jZSAqLw0KKwkJcmV0ID0gY2xrX3Nl
dF9yYXRlKG1zbV9iYXlodWJfaG9zdC0+YnVzX2NsaywgSU5UX01BWCk7DQorCQlpZiAocmV0KQ0K
KwkJCWdvdG8gcGx0Zm1fZnJlZTsNCisJCXJldCA9IGNsa19wcmVwYXJlX2VuYWJsZShtc21fYmF5
aHViX2hvc3QtPmJ1c19jbGspOw0KKwkJaWYgKHJldCkNCisJCQlnb3RvIHBsdGZtX2ZyZWU7DQor
CX0NCisNCisJLyogU2V0dXAgbWFpbiBwZXJpcGhlcmFsIGJ1cyBjbG9jayAqLw0KKwljbGsgPSBk
ZXZtX2Nsa19nZXQoJnBkZXYtPmRldiwgImlmYWNlIik7DQorCWlmIChJU19FUlIoY2xrKSkgew0K
KwkJcmV0ID0gUFRSX0VSUihjbGspOw0KKwkJZGV2X2VycigmcGRldi0+ZGV2LCAiUGVyaXBoZXJh
bCBjbGsgc2V0dXAgZmFpbGVkICglZClcbiIsIHJldCk7DQorCQlnb3RvIGJ1c19jbGtfZGlzYWJs
ZTsNCisJfQ0KKwltc21fYmF5aHViX2hvc3QtPmJ1bGtfY2xrc1sxXS5jbGsgPSBjbGs7DQorDQor
CS8qIFNldHVwIFNEQyBNTUMgY2xvY2sgKi8NCisJY2xrID0gZGV2bV9jbGtfZ2V0KCZwZGV2LT5k
ZXYsICJjb3JlIik7DQorCWlmIChJU19FUlIoY2xrKSkgew0KKwkJcmV0ID0gUFRSX0VSUihjbGsp
Ow0KKwkJZGV2X2VycigmcGRldi0+ZGV2LCAiU0RDIE1NQyBjbGsgc2V0dXAgZmFpbGVkICglZClc
biIsIHJldCk7DQorCQlnb3RvIGJ1c19jbGtfZGlzYWJsZTsNCisJfQ0KKwltc21fYmF5aHViX2hv
c3QtPmJ1bGtfY2xrc1swXS5jbGsgPSBjbGs7DQorDQorCSAvKiBDaGVjayBmb3Igb3B0aW9uYWwg
aW50ZXJjb25uZWN0IHBhdGhzICovDQorCXJldCA9IGRldl9wbV9vcHBfb2ZfZmluZF9pY2NfcGF0
aHMoJnBkZXYtPmRldiwgTlVMTCk7DQorCWlmIChyZXQpDQorCQlnb3RvIGJ1c19jbGtfZGlzYWJs
ZTsNCisNCisJbXNtX2JheWh1Yl9ob3N0LT5vcHBfdGFibGUgPSBkZXZfcG1fb3BwX3NldF9jbGtu
YW1lKCZwZGV2LT5kZXYsICJjb3JlIik7DQorCWlmIChJU19FUlIobXNtX2JheWh1Yl9ob3N0LT5v
cHBfdGFibGUpKSB7DQorCQlyZXQgPSBQVFJfRVJSKG1zbV9iYXlodWJfaG9zdC0+b3BwX3RhYmxl
KTsNCisJCWdvdG8gYnVzX2Nsa19kaXNhYmxlOw0KKwl9DQorDQorCS8qIE9QUCB0YWJsZSBpcyBv
cHRpb25hbCAqLw0KKwlyZXQgPSBkZXZfcG1fb3BwX29mX2FkZF90YWJsZSgmcGRldi0+ZGV2KTsN
CisJaWYgKCFyZXQpIHsNCisJCW1zbV9iYXlodWJfaG9zdC0+aGFzX29wcF90YWJsZSA9IHRydWU7
DQorCX0gZWxzZSBpZiAocmV0ICE9IC1FTk9ERVYpIHsNCisJCWRldl9lcnIoJnBkZXYtPmRldiwg
IkludmFsaWQgT1BQIHRhYmxlIGluIERldmljZSB0cmVlXG4iKTsNCisJCWdvdG8gb3BwX2NsZWFu
dXA7DQorCX0NCisNCisJLyogVm90ZSBmb3IgbWF4aW11bSBjbG9jayByYXRlIGZvciBtYXhpbXVt
IHBlcmZvcm1hbmNlICovDQorCXJldCA9IGRldl9wbV9vcHBfc2V0X3JhdGUoJnBkZXYtPmRldiwg
SU5UX01BWCk7DQorCWlmIChyZXQpDQorCQlkZXZfd2FybigmcGRldi0+ZGV2LCAiY29yZSBjbG9j
ayBib29zdCBmYWlsZWRcbiIpOw0KKw0KKwljbGsgPSBkZXZtX2Nsa19nZXQoJnBkZXYtPmRldiwg
ImNhbCIpOw0KKwlpZiAoSVNfRVJSKGNsaykpDQorCQljbGsgPSBOVUxMOw0KKwltc21fYmF5aHVi
X2hvc3QtPmJ1bGtfY2xrc1syXS5jbGsgPSBjbGs7DQorDQorCWNsayA9IGRldm1fY2xrX2dldCgm
cGRldi0+ZGV2LCAic2xlZXAiKTsNCisJaWYgKElTX0VSUihjbGspKQ0KKwkJY2xrID0gTlVMTDsN
CisJbXNtX2JheWh1Yl9ob3N0LT5idWxrX2Nsa3NbM10uY2xrID0gY2xrOw0KKw0KKwlyZXQgPSBj
bGtfYnVsa19wcmVwYXJlX2VuYWJsZShBUlJBWV9TSVpFKG1zbV9iYXlodWJfaG9zdC0+YnVsa19j
bGtzKSwNCisJCQkJICAgICAgbXNtX2JheWh1Yl9ob3N0LT5idWxrX2Nsa3MpOw0KKwlpZiAocmV0
KQ0KKwkJZ290byBvcHBfY2xlYW51cDsNCisNCisJLyoNCisJICogeG8gY2xvY2sgaXMgbmVlZGVk
IGZvciBGTEwgZmVhdHVyZSBvZiBjbV9kbGwuDQorCSAqIEluIGNhc2UgaWYgeG8gY2xvY2sgaXMg
bm90IG1lbnRpb25lZCBpbiBEVCwgd2FybiBhbmQgcHJvY2VlZC4NCisJICovDQorCW1zbV9iYXlo
dWJfaG9zdC0+eG9fY2xrID0gZGV2bV9jbGtfZ2V0KCZwZGV2LT5kZXYsICJ4byIpOw0KKwlpZiAo
SVNfRVJSKG1zbV9iYXlodWJfaG9zdC0+eG9fY2xrKSkgew0KKwkJcmV0ID0gUFRSX0VSUihtc21f
YmF5aHViX2hvc3QtPnhvX2Nsayk7DQorCQlkZXZfd2FybigmcGRldi0+ZGV2LCAiVENYTyBjbGsg
bm90IHByZXNlbnQgKCVkKVxuIiwgcmV0KTsNCisJfQ0KKw0KKwlpZiAoIW1zbV9iYXlodWJfaG9z
dC0+bWNpX3JlbW92ZWQpIHsNCisJCWNvcmVfbWVtcmVzID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNl
KHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAxKTsNCisJCW1zbV9iYXlodWJfaG9zdC0+Y29yZV9tZW0g
PSBkZXZtX2lvcmVtYXBfcmVzb3VyY2UoJnBkZXYtPmRldiwNCisJCQkJY29yZV9tZW1yZXMpOw0K
Kw0KKwkJaWYgKElTX0VSUihtc21fYmF5aHViX2hvc3QtPmNvcmVfbWVtKSkgew0KKwkJCXJldCA9
IFBUUl9FUlIobXNtX2JheWh1Yl9ob3N0LT5jb3JlX21lbSk7DQorCQkJZ290byBjbGtfZGlzYWJs
ZTsNCisJCX0NCisJfQ0KKw0KKwkvKiBSZXNldCB0aGUgdmVuZG9yIHNwZWMgcmVnaXN0ZXIgdG8g
cG93ZXIgb24gcmVzZXQgc3RhdGUgKi8NCisJd3JpdGVsX3JlbGF4ZWQoQ09SRV9WRU5ET1JfU1BF
Q19QT1JfVkFMLA0KKwkJCWhvc3QtPmlvYWRkciArIG1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX3Zl
bmRvcl9zcGVjKTsNCisNCisJaWYgKCFtc21fYmF5aHViX2hvc3QtPm1jaV9yZW1vdmVkKSB7DQor
CQkvKiBTZXQgSENfTU9ERV9FTiBiaXQgaW4gSENfTU9ERSByZWdpc3RlciAqLw0KKwkJbXNtX2Jh
eWh1Yl9ob3N0X3dyaXRlbChtc21fYmF5aHViX2hvc3QsIEhDX01PREVfRU4sIGhvc3QsDQorCQkJ
CW1zbV9iYXlodWJfb2Zmc2V0LT5jb3JlX2hjX21vZGUpOw0KKwkJY29uZmlnID0gbXNtX2JheWh1
Yl9ob3N0X3JlYWRsKG1zbV9iYXlodWJfaG9zdCwgaG9zdCwNCisJCQkJbXNtX2JheWh1Yl9vZmZz
ZXQtPmNvcmVfaGNfbW9kZSk7DQorCQljb25maWcgfD0gRkZfQ0xLX1NXX1JTVF9ESVM7DQorCQlt
c21fYmF5aHViX2hvc3Rfd3JpdGVsKG1zbV9iYXlodWJfaG9zdCwgY29uZmlnLCBob3N0LA0KKwkJ
CQltc21fYmF5aHViX29mZnNldC0+Y29yZV9oY19tb2RlKTsNCisJfQ0KKw0KKwlob3N0X3ZlcnNp
b24gPSByZWFkd19yZWxheGVkKChob3N0LT5pb2FkZHIgKyBTREhDSV9IT1NUX1ZFUlNJT04pKTsN
CisJZGV2X2RiZygmcGRldi0+ZGV2LCAiSG9zdCBWZXJzaW9uOiAweCV4IFZlbmRvciBWZXJzaW9u
IDB4JXhcbiIsDQorCQlob3N0X3ZlcnNpb24sICgoaG9zdF92ZXJzaW9uICYgU0RIQ0lfVkVORE9S
X1ZFUl9NQVNLKSA+Pg0KKwkJCSAgICAgICBTREhDSV9WRU5ET1JfVkVSX1NISUZUKSk7DQorDQor
CWNvcmVfdmVyc2lvbiA9IG1zbV9iYXlodWJfaG9zdF9yZWFkbChtc21fYmF5aHViX2hvc3QsIGhv
c3QsDQorCQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfbWNpX3ZlcnNpb24pOw0KKwljb3JlX21h
am9yID0gKGNvcmVfdmVyc2lvbiAmIENPUkVfVkVSU0lPTl9NQUpPUl9NQVNLKSA+Pg0KKwkJICAg
ICAgQ09SRV9WRVJTSU9OX01BSk9SX1NISUZUOw0KKwljb3JlX21pbm9yID0gY29yZV92ZXJzaW9u
ICYgQ09SRV9WRVJTSU9OX01JTk9SX01BU0s7DQorCWRldl9kYmcoJnBkZXYtPmRldiwgIk1DSSBW
ZXJzaW9uOiAweCUwOHgsIG1ham9yOiAweCUwNHgsIG1pbm9yOiAweCUwMnhcbiIsDQorCQljb3Jl
X3ZlcnNpb24sIGNvcmVfbWFqb3IsIGNvcmVfbWlub3IpOw0KKw0KKwlpZiAoY29yZV9tYWpvciA9
PSAxICYmIGNvcmVfbWlub3IgPj0gMHg0MikNCisJCW1zbV9iYXlodWJfaG9zdC0+dXNlXzE0bHBw
X2RsbF9yZXNldCA9IHRydWU7DQorDQorCS8qDQorCSAqIFNEQ0MgNSBjb250cm9sbGVyIHdpdGgg
bWFqb3IgdmVyc2lvbiAxLCBtaW5vciB2ZXJzaW9uIDB4MzQgYW5kIGxhdGVyDQorCSAqIHdpdGgg
SFMgNDAwIG1vZGUgc3VwcG9ydCB3aWxsIHVzZSBDTSBETEwgaW5zdGVhZCBvZiBDREMgTFAgNTMz
IERMTC4NCisJICovDQorCWlmIChjb3JlX21ham9yID09IDEgJiYgY29yZV9taW5vciA8IDB4MzQp
DQorCQltc21fYmF5aHViX2hvc3QtPnVzZV9jZGNscDUzMyA9IHRydWU7DQorDQorCS8qDQorCSAq
IFN1cHBvcnQgZm9yIHNvbWUgY2FwYWJpbGl0aWVzIGlzIG5vdCBhZHZlcnRpc2VkIGJ5IG5ld2Vy
DQorCSAqIGNvbnRyb2xsZXIgdmVyc2lvbnMgYW5kIG11c3QgYmUgZXhwbGljaXRseSBlbmFibGVk
Lg0KKwkgKi8NCisJaWYgKGNvcmVfbWFqb3IgPj0gMSAmJiBjb3JlX21pbm9yICE9IDB4MTEgJiYg
Y29yZV9taW5vciAhPSAweDEyKSB7DQorCQljb25maWcgPSByZWFkbF9yZWxheGVkKGhvc3QtPmlv
YWRkciArIFNESENJX0NBUEFCSUxJVElFUyk7DQorCQljb25maWcgfD0gU0RIQ0lfQ0FOX1ZERF8z
MDAgfCBTREhDSV9DQU5fRE9fOEJJVDsNCisJCXdyaXRlbF9yZWxheGVkKGNvbmZpZywgaG9zdC0+
aW9hZGRyICsNCisJCQkJbXNtX2JheWh1Yl9vZmZzZXQtPmNvcmVfdmVuZG9yX3NwZWNfY2FwYWJp
bGl0aWVzMCk7DQorCX0NCisNCisJaWYgKGNvcmVfbWFqb3IgPT0gMSAmJiBjb3JlX21pbm9yID49
IDB4NDkpDQorCQltc21fYmF5aHViX2hvc3QtPnVwZGF0ZWRfZGRyX2NmZyA9IHRydWU7DQorDQor
CXJldCA9IHNkaGNpX21zbV9iYXlodWJfcmVnaXN0ZXJfdnJlZyhtc21fYmF5aHViX2hvc3QpOw0K
KwlpZiAocmV0KQ0KKwkJZ290byBjbGtfZGlzYWJsZTsNCisNCisJLyoNCisJICogUG93ZXIgb24g
cmVzZXQgc3RhdGUgbWF5IHRyaWdnZXIgcG93ZXIgaXJxIGlmIHByZXZpb3VzIHN0YXR1cyBvZg0K
KwkgKiBQV1JDVEwgd2FzIGVpdGhlciBCVVNfT04gb3IgSU9fSElHSF9WLiBTbyBiZWZvcmUgZW5h
YmxpbmcgcHdyIGlycQ0KKwkgKiBpbnRlcnJ1cHQgaW4gR0lDLCBhbnkgcGVuZGluZyBwb3dlciBp
cnEgaW50ZXJydXB0IHNob3VsZCBiZQ0KKwkgKiBhY2tub3dsZWRnZWQuIE90aGVyd2lzZSBwb3dl
ciBpcnEgaW50ZXJydXB0IGhhbmRsZXIgd291bGQgYmUNCisJICogZmlyZWQgcHJlbWF0dXJlbHku
DQorCSAqLw0KKwlzZGhjaV9tc21fYmF5aHViX2hhbmRsZV9wd3JfaXJxKGhvc3QsIDApOw0KKw0K
KwkvKg0KKwkgKiBFbnN1cmUgdGhhdCBhYm92ZSB3cml0ZXMgYXJlIHByb3BvZ2F0ZWQgYmVmb3Jl
IGludGVycnVwdCBlbmFibGVtZW50DQorCSAqIGluIEdJQy4NCisJICovDQorCW1iKCk7DQorDQor
CS8qIFNldHVwIElSUSBmb3IgaGFuZGxpbmcgcG93ZXIvdm9sdGFnZSB0YXNrcyB3aXRoIFBNSUMg
Ki8NCisJbXNtX2JheWh1Yl9ob3N0LT5wd3JfaXJxID0gcGxhdGZvcm1fZ2V0X2lycV9ieW5hbWUo
cGRldiwgInB3cl9pcnEiKTsNCisJaWYgKG1zbV9iYXlodWJfaG9zdC0+cHdyX2lycSA8IDApIHsN
CisJCXJldCA9IG1zbV9iYXlodWJfaG9zdC0+cHdyX2lycTsNCisJCWdvdG8gY2xrX2Rpc2FibGU7
DQorCX0NCisNCisJc2RoY2lfbXNtX2JheWh1Yl9pbml0X3B3cl9pcnFfd2FpdChtc21fYmF5aHVi
X2hvc3QpOw0KKwkvKiBFbmFibGUgcHdyIGlycSBpbnRlcnJ1cHRzICovDQorCW1zbV9iYXlodWJf
aG9zdF93cml0ZWwobXNtX2JheWh1Yl9ob3N0LCBJTlRfTUFTSywgaG9zdCwNCisJCW1zbV9iYXlo
dWJfb2Zmc2V0LT5jb3JlX3B3cmN0bF9tYXNrKTsNCisNCisJcmV0ID0gZGV2bV9yZXF1ZXN0X3Ro
cmVhZGVkX2lycSgmcGRldi0+ZGV2LCBtc21fYmF5aHViX2hvc3QtPnB3cl9pcnEsIE5VTEwsDQor
CQkJCQlzZGhjaV9tc21fYmF5aHViX3B3cl9pcnEsIElSUUZfT05FU0hPVCwNCisJCQkJCWRldl9u
YW1lKCZwZGV2LT5kZXYpLCBob3N0KTsNCisJaWYgKHJldCkgew0KKwkJZGV2X2VycigmcGRldi0+
ZGV2LCAiUmVxdWVzdCBJUlEgZmFpbGVkICglZClcbiIsIHJldCk7DQorCQlnb3RvIGNsa19kaXNh
YmxlOw0KKwl9DQorDQorCW1zbV9iYXlodWJfaG9zdC0+bW1jLT5jYXBzIHw9IE1NQ19DQVBfV0FJ
VF9XSElMRV9CVVNZIHwgTU1DX0NBUF9ORUVEX1JTUF9CVVNZOw0KKw0KKwlwbV9ydW50aW1lX2dl
dF9ub3Jlc3VtZSgmcGRldi0+ZGV2KTsNCisJcG1fcnVudGltZV9zZXRfYWN0aXZlKCZwZGV2LT5k
ZXYpOw0KKwlwbV9ydW50aW1lX2VuYWJsZSgmcGRldi0+ZGV2KTsNCisJcG1fcnVudGltZV9zZXRf
YXV0b3N1c3BlbmRfZGVsYXkoJnBkZXYtPmRldiwNCisJCQkJCSBNU01fTU1DX0FVVE9TVVNQRU5E
X0RFTEFZX01TKTsNCisJcG1fcnVudGltZV91c2VfYXV0b3N1c3BlbmQoJnBkZXYtPmRldik7DQor
DQorCWhvc3QtPm1tY19ob3N0X29wcy5zdGFydF9zaWduYWxfdm9sdGFnZV9zd2l0Y2ggPQ0KKwkJ
c2RoY2lfbXNtX2JheWh1Yl9zdGFydF9zaWduYWxfdm9sdGFnZV9zd2l0Y2g7DQorCWlmIChtc21f
YmF5aHViX2hvc3QtPmdnYy5iaDIwMV91c2VkKQ0KKwkJaG9zdC0+bW1jX2hvc3Rfb3BzLmV4ZWN1
dGVfdHVuaW5nID0gc2RoY2lfYmh0X2V4ZWN1dGVfdHVuaW5nOw0KKwllbHNlDQorCQlob3N0LT5t
bWNfaG9zdF9vcHMuZXhlY3V0ZV90dW5pbmcgPSBzZGhjaV9tc21fYmF5aHViX2V4ZWN1dGVfdHVu
aW5nOw0KKw0KKwlpZiAob2ZfcHJvcGVydHlfcmVhZF9ib29sKG5vZGUsICJzdXBwb3J0cy1jcWUi
KSkNCisJCXJldCA9IHNkaGNpX21zbV9iYXlodWJfY3FlX2FkZF9ob3N0KGhvc3QsIHBkZXYpOw0K
KwllbHNlDQorCQlyZXQgPSBzZGhjaV9hZGRfaG9zdChob3N0KTsNCisJaWYgKHJldCkNCisJCWdv
dG8gcG1fcnVudGltZV9kaXNhYmxlOw0KKw0KKwlwbV9ydW50aW1lX21hcmtfbGFzdF9idXN5KCZw
ZGV2LT5kZXYpOw0KKwlwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZCgmcGRldi0+ZGV2KTsNCisN
CisJcmV0dXJuIDA7DQorDQorcG1fcnVudGltZV9kaXNhYmxlOg0KKwlwbV9ydW50aW1lX2Rpc2Fi
bGUoJnBkZXYtPmRldik7DQorCXBtX3J1bnRpbWVfc2V0X3N1c3BlbmRlZCgmcGRldi0+ZGV2KTsN
CisJcG1fcnVudGltZV9wdXRfbm9pZGxlKCZwZGV2LT5kZXYpOw0KK2Nsa19kaXNhYmxlOg0KKwlj
bGtfYnVsa19kaXNhYmxlX3VucHJlcGFyZShBUlJBWV9TSVpFKG1zbV9iYXlodWJfaG9zdC0+YnVs
a19jbGtzKSwNCisJCQkJICAgbXNtX2JheWh1Yl9ob3N0LT5idWxrX2Nsa3MpOw0KK29wcF9jbGVh
bnVwOg0KKwlpZiAobXNtX2JheWh1Yl9ob3N0LT5oYXNfb3BwX3RhYmxlKQ0KKwkJZGV2X3BtX29w
cF9vZl9yZW1vdmVfdGFibGUoJnBkZXYtPmRldik7DQorCWRldl9wbV9vcHBfcHV0X2Nsa25hbWUo
bXNtX2JheWh1Yl9ob3N0LT5vcHBfdGFibGUpOw0KK2J1c19jbGtfZGlzYWJsZToNCisJaWYgKCFJ
U19FUlIobXNtX2JheWh1Yl9ob3N0LT5idXNfY2xrKSkNCisJCWNsa19kaXNhYmxlX3VucHJlcGFy
ZShtc21fYmF5aHViX2hvc3QtPmJ1c19jbGspOw0KK3BsdGZtX2ZyZWU6DQorCWlmIChtc21fYmF5
aHViX2hvc3QtPmdnYy5iaDIwMV91c2VkKSB7DQorCQlpZiAoZ3Bpb19pc192YWxpZChtc21fYmF5
aHViX2hvc3QtPmdnYy5kZXRfZ3BpbykpDQorCQkJZGV2bV9ncGlvX2ZyZWUoJnBkZXYtPmRldiwg
bXNtX2JheWh1Yl9ob3N0LT5nZ2MuZGV0X2dwaW8pOw0KKwkJaWYgKGdwaW9faXNfdmFsaWQobXNt
X2JheWh1Yl9ob3N0LT5nZ2MucHdyX2dwaW8pKQ0KKwkJCWRldm1fZ3Bpb19mcmVlKCZwZGV2LT5k
ZXYsIG1zbV9iYXlodWJfaG9zdC0+Z2djLnB3cl9ncGlvKTsNCisJfQ0KKw0KKwlzZGhjaV9wbHRm
bV9mcmVlKHBkZXYpOw0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgaW50IHNkaGNpX21z
bV9iYXlodWJfcmVtb3ZlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpDQorew0KKwlzdHJ1
Y3Qgc2RoY2lfaG9zdCAqaG9zdCA9IHBsYXRmb3JtX2dldF9kcnZkYXRhKHBkZXYpOw0KKwlzdHJ1
Y3Qgc2RoY2lfcGx0Zm1faG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0
cnVjdCBzZGhjaV9tc21fYmF5aHViX2hvc3QgKm1zbV9iYXlodWJfaG9zdCA9IHNkaGNpX3BsdGZt
X3ByaXYocGx0Zm1faG9zdCk7DQorCWludCBkZWFkID0gKHJlYWRsX3JlbGF4ZWQoaG9zdC0+aW9h
ZGRyICsgU0RIQ0lfSU5UX1NUQVRVUykgPT0NCisJCSAgICAweGZmZmZmZmZmKTsNCisNCisJc2Ro
Y2lfcmVtb3ZlX2hvc3QoaG9zdCwgZGVhZCk7DQorCWlmIChtc21fYmF5aHViX2hvc3QtPmdnYy5i
aDIwMV91c2VkKSB7DQorCQlpZiAoZ3Bpb19pc192YWxpZChtc21fYmF5aHViX2hvc3QtPmdnYy5k
ZXRfZ3BpbykpDQorCQkJZGV2bV9ncGlvX2ZyZWUoJnBkZXYtPmRldiwgbXNtX2JheWh1Yl9ob3N0
LT5nZ2MuZGV0X2dwaW8pOw0KKwkJaWYgKGdwaW9faXNfdmFsaWQobXNtX2JheWh1Yl9ob3N0LT5n
Z2MucHdyX2dwaW8pKQ0KKwkJCWRldm1fZ3Bpb19mcmVlKCZwZGV2LT5kZXYsIG1zbV9iYXlodWJf
aG9zdC0+Z2djLnB3cl9ncGlvKTsNCisJfQ0KKwlpZiAobXNtX2JheWh1Yl9ob3N0LT5oYXNfb3Bw
X3RhYmxlKQ0KKwkJZGV2X3BtX29wcF9vZl9yZW1vdmVfdGFibGUoJnBkZXYtPmRldik7DQorCWRl
dl9wbV9vcHBfcHV0X2Nsa25hbWUobXNtX2JheWh1Yl9ob3N0LT5vcHBfdGFibGUpOw0KKwlwbV9y
dW50aW1lX2dldF9zeW5jKCZwZGV2LT5kZXYpOw0KKwlwbV9ydW50aW1lX2Rpc2FibGUoJnBkZXYt
PmRldik7DQorCXBtX3J1bnRpbWVfcHV0X25vaWRsZSgmcGRldi0+ZGV2KTsNCisNCisJY2xrX2J1
bGtfZGlzYWJsZV91bnByZXBhcmUoQVJSQVlfU0laRShtc21fYmF5aHViX2hvc3QtPmJ1bGtfY2xr
cyksDQorCQkJCSAgIG1zbV9iYXlodWJfaG9zdC0+YnVsa19jbGtzKTsNCisJaWYgKCFJU19FUlIo
bXNtX2JheWh1Yl9ob3N0LT5idXNfY2xrKSkNCisJCWNsa19kaXNhYmxlX3VucHJlcGFyZShtc21f
YmF5aHViX2hvc3QtPmJ1c19jbGspOw0KKwlzZGhjaV9wbHRmbV9mcmVlKHBkZXYpOw0KKwlyZXR1
cm4gMDsNCit9DQorDQorc3RhdGljIF9fbWF5YmVfdW51c2VkIGludCBzZGhjaV9tc21fYmF5aHVi
X3J1bnRpbWVfc3VzcGVuZChzdHJ1Y3QgZGV2aWNlICpkZXYpDQorew0KKwlzdHJ1Y3Qgc2RoY2lf
aG9zdCAqaG9zdCA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOw0KKwlzdHJ1Y3Qgc2RoY2lfcGx0Zm1f
aG9zdCAqcGx0Zm1faG9zdCA9IHNkaGNpX3ByaXYoaG9zdCk7DQorCXN0cnVjdCBzZGhjaV9tc21f
YmF5aHViX2hvc3QgKm1zbV9iYXlodWJfaG9zdCA9IHNkaGNpX3BsdGZtX3ByaXYocGx0Zm1faG9z
dCk7DQorDQorCS8qIERyb3AgdGhlIHBlcmZvcm1hbmNlIHZvdGUgKi8NCisJZGV2X3BtX29wcF9z
ZXRfcmF0ZShkZXYsIDApOw0KKwljbGtfYnVsa19kaXNhYmxlX3VucHJlcGFyZShBUlJBWV9TSVpF
KG1zbV9iYXlodWJfaG9zdC0+YnVsa19jbGtzKSwNCisJCQkJICAgbXNtX2JheWh1Yl9ob3N0LT5i
dWxrX2Nsa3MpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIF9fbWF5YmVfdW51c2Vk
IGludCBzZGhjaV9tc21fYmF5aHViX3J1bnRpbWVfcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikN
Cit7DQorCXN0cnVjdCBzZGhjaV9ob3N0ICpob3N0ID0gZGV2X2dldF9kcnZkYXRhKGRldik7DQor
CXN0cnVjdCBzZGhjaV9wbHRmbV9ob3N0ICpwbHRmbV9ob3N0ID0gc2RoY2lfcHJpdihob3N0KTsN
CisJc3RydWN0IHNkaGNpX21zbV9iYXlodWJfaG9zdCAqbXNtX2JheWh1Yl9ob3N0ID0gc2RoY2lf
cGx0Zm1fcHJpdihwbHRmbV9ob3N0KTsNCisJaW50IHJldDsNCisNCisJcmV0ID0gY2xrX2J1bGtf
cHJlcGFyZV9lbmFibGUoQVJSQVlfU0laRShtc21fYmF5aHViX2hvc3QtPmJ1bGtfY2xrcyksDQor
CQkJCSAgICAgICBtc21fYmF5aHViX2hvc3QtPmJ1bGtfY2xrcyk7DQorCWlmIChyZXQpDQorCQly
ZXR1cm4gcmV0Ow0KKwkvKg0KKwkgKiBXaGVuZXZlciBjb3JlLWNsb2NrIGlzIGdhdGVkIGR5bmFt
aWNhbGx5LCBpdCdzIG5lZWRlZCB0bw0KKwkgKiByZXN0b3JlIHRoZSBTRFIgRExMIHNldHRpbmdz
IHdoZW4gdGhlIGNsb2NrIGlzIHVuZ2F0ZWQuDQorCSAqLw0KKwlpZiAobXNtX2JheWh1Yl9ob3N0
LT5yZXN0b3JlX2RsbF9jb25maWcgJiYgbXNtX2JheWh1Yl9ob3N0LT5jbGtfcmF0ZSkNCisJCXJl
dCA9IHNkaGNpX21zbV9iYXlodWJfcmVzdG9yZV9zZHJfZGxsX2NvbmZpZyhob3N0KTsNCisNCisJ
ZGV2X3BtX29wcF9zZXRfcmF0ZShkZXYsIG1zbV9iYXlodWJfaG9zdC0+Y2xrX3JhdGUpOw0KKw0K
KwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRldl9wbV9vcHMgc2Ro
Y2lfbXNtX2JheWh1Yl9wbV9vcHMgPSB7DQorCVNFVF9TWVNURU1fU0xFRVBfUE1fT1BTKHBtX3J1
bnRpbWVfZm9yY2Vfc3VzcGVuZCwNCisJCQkJcG1fcnVudGltZV9mb3JjZV9yZXN1bWUpDQorCVNF
VF9SVU5USU1FX1BNX09QUyhzZGhjaV9tc21fYmF5aHViX3J1bnRpbWVfc3VzcGVuZCwNCisJCQkg
ICBzZGhjaV9tc21fYmF5aHViX3J1bnRpbWVfcmVzdW1lLA0KKwkJCSAgIE5VTEwpDQorfTsNCisN
CitzdGF0aWMgc3RydWN0IHBsYXRmb3JtX2RyaXZlciBzZGhjaV9tc21fYmF5aHViX2RyaXZlciA9
IHsNCisJLnByb2JlID0gc2RoY2lfbXNtX2JheWh1Yl9wcm9iZSwNCisJLnJlbW92ZSA9IHNkaGNp
X21zbV9iYXlodWJfcmVtb3ZlLA0KKwkuZHJpdmVyID0gew0KKwkJICAgLm5hbWUgPSAic2RoY2lf
bXNtX2JheWh1YiIsDQorCQkgICAub2ZfbWF0Y2hfdGFibGUgPSBzZGhjaV9tc21fYmF5aHViX2R0
X21hdGNoLA0KKwkJICAgLnBtID0gJnNkaGNpX21zbV9iYXlodWJfcG1fb3BzLA0KKwkJICAgLnBy
b2JlX3R5cGUgPSBQUk9CRV9QUkVGRVJfQVNZTkNIUk9OT1VTLA0KKwl9LA0KK307DQorDQorbW9k
dWxlX3BsYXRmb3JtX2RyaXZlcihzZGhjaV9tc21fYmF5aHViX2RyaXZlcik7DQorDQorTU9EVUxF
X0RFU0NSSVBUSU9OKCJRdWFsY29tbS1iYXlodWIgU2VjdXJlIERpZ2l0YWwgSG9zdCBDb250cm9s
bGVyIEludGVyZmFjZSBkcml2ZXIiKTsNCitNT0RVTEVfTElDRU5TRSgiR1BMIHYyIik7DQotLSAN
CjIuMjUuMQ0KDQo=
