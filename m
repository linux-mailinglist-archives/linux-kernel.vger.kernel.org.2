Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id D382D3ED3B6
	for <lists+linux-kernel@lfdr.de>; Mon, 16 Aug 2021 14:11:43 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S233130AbhHPMMN (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Mon, 16 Aug 2021 08:12:13 -0400
Received: from mailgw02.mediatek.com ([210.61.82.184]:51156 "EHLO
        mailgw02.mediatek.com" rhost-flags-OK-FAIL-OK-FAIL) by vger.kernel.org
        with ESMTP id S229836AbhHPMMM (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Mon, 16 Aug 2021 08:12:12 -0400
X-UUID: 5e47368bc4da423b8b293617b2f75340-20210816
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=mediatek.com; s=dk;
        h=Content-Transfer-Encoding:MIME-Version:Content-Type:References:In-Reply-To:Date:CC:To:From:Subject:Message-ID; bh=kkysPn/5aJXvWrgV2Um/G5eKzXBq7Ohp9jMuEy/5iYQ=;
        b=Fjqo8WY5cgB2jePVO0i542gfEym99HrP0JrThjvjeUrpf1HG5tX6ExGpoS0qX4jaY0eodyMVtT+2MOPhMmEKwfEWvwsuh+2Js21ZqOfbKWqLNLza2rUKXLMVhAqEsWmTrcBzavSfo2uRFgw88Qw9pIDH3Y1JGycIdN6Y7MR91FA=;
X-UUID: 5e47368bc4da423b8b293617b2f75340-20210816
Received: from mtkexhb02.mediatek.inc [(172.21.101.103)] by mailgw02.mediatek.com
        (envelope-from <hsin-hsiung.wang@mediatek.com>)
        (Generic MTA with TLSv1.2 ECDHE-RSA-AES256-SHA384 256/256)
        with ESMTP id 146643191; Mon, 16 Aug 2021 20:11:39 +0800
Received: from mtkcas07.mediatek.inc (172.21.101.84) by
 mtkmbs07n2.mediatek.inc (172.21.101.141) with Microsoft SMTP Server (TLS) id
 15.0.1497.2; Mon, 16 Aug 2021 20:11:38 +0800
Received: from [172.21.77.4] (172.21.77.4) by mtkcas07.mediatek.inc
 (172.21.101.73) with Microsoft SMTP Server id 15.0.1497.2 via Frontend
 Transport; Mon, 16 Aug 2021 20:11:38 +0800
Message-ID: <1629115898.29907.3.camel@mtksdaap41>
Subject: Re: [PATCH v10 3/5] spmi: mediatek: Add support for MT6873/8192
From:   Hsin-hsiung Wang <hsin-hsiung.wang@mediatek.com>
To:     Stephen Boyd <sboyd@kernel.org>
CC:     Matthias Brugger <matthias.bgg@gmail.com>,
        Rob Herring <robh+dt@kernel.org>,
        <linux-kernel@vger.kernel.org>, <devicetree@vger.kernel.org>,
        <linux-arm-kernel@lists.infradead.org>,
        <linux-mediatek@lists.infradead.org>,
        <srv_heupstream@mediatek.com>,
        <Project_Global_Chrome_Upstream_Group@mediatek.com>
Date:   Mon, 16 Aug 2021 20:11:38 +0800
In-Reply-To: <162853170949.1975443.12492156194100139076@swboyd.mtv.corp.google.com>
References: <1627972461-2627-1-git-send-email-hsin-hsiung.wang@mediatek.com>
         <1627972461-2627-4-git-send-email-hsin-hsiung.wang@mediatek.com>
         <162853170949.1975443.12492156194100139076@swboyd.mtv.corp.google.com>
Content-Type: text/plain; charset="UTF-8"
X-Mailer: Evolution 3.10.4-0ubuntu2 
MIME-Version: 1.0
X-MTK:  N
Content-Transfer-Encoding: base64
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

SGksDQoNCk9uIE1vbiwgMjAyMS0wOC0wOSBhdCAxMDo1NSAtMDcwMCwgU3RlcGhlbiBCb3lkIHdy
b3RlOg0KPiBRdW90aW5nIEhzaW4tSHNpdW5nIFdhbmcgKDIwMjEtMDgtMDIgMjM6MzQ6MTkpDQo+
ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3BtaS9zcG1pLW10ay1wbWlmLmMgYi9kcml2ZXJzL3Nw
bWkvc3BtaS1tdGstcG1pZi5jDQo+ID4gbmV3IGZpbGUgbW9kZSAxMDA2NDQNCj4gPiBpbmRleCAw
MDAwMDAwMDAwMDAuLjk0YzQ1ZDQ2YWIwYw0KPiA+IC0tLSAvZGV2L251bGwNCj4gPiArKysgYi9k
cml2ZXJzL3NwbWkvc3BtaS1tdGstcG1pZi5jDQo+ID4gQEAgLTAsMCArMSw0NjUgQEANCj4gPiAr
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjANCj4gPiArLy8NCj4gPiArLy8gQ29w
eXJpZ2h0IChjKSAyMDIxIE1lZGlhVGVrIEluYy4NCj4gPiArDQo+ID4gKyNpbmNsdWRlIDxsaW51
eC9jbGsuaD4NCj4gPiArI2luY2x1ZGUgPGxpbnV4L2lvcG9sbC5oPg0KPiA+ICsjaW5jbHVkZSA8
bGludXgvbW9kdWxlLmg+DQo+ID4gKyNpbmNsdWRlIDxsaW51eC9vZl9kZXZpY2UuaD4NCj4gDQo+
IGluY2x1ZGUgcGxhdGZvcm1fZGV2aWNlLmggZm9yIHRoZSBwbGF0Zm9ybSBkZXZpY2UgZHJpdmVy
IHRoYXQgdGhpcyBpcy4NCj4gDQpUaGFua3MgZm9yIHRoZSBjb21taXQsIEkgd2lsbCB1cGRhdGUg
aXQgaW4gdGhlIG5leHQgcGF0Y2guDQoNCj4gPiArI2luY2x1ZGUgPGxpbnV4L3NwbWkuaD4NCj4g
PiArDQo+ID4gKyNkZWZpbmUgU1dJTkZfSURMRSAgICAgMHgwMA0KPiA+ICsjZGVmaW5lIFNXSU5G
X1dGVkxEQ0xSIDB4MDYNCj4gPiArDQo+ID4gKyNkZWZpbmUgR0VUX1NXSU5GKHgpICAgKCgoeCkg
Pj4gMSkgJiAweDcpDQo+ID4gKw0KPiA+ICsjZGVmaW5lIFBNSUZfQ01EX1JFR18wICAgICAgICAg
MA0KPiA+ICsjZGVmaW5lIFBNSUZfQ01EX1JFRyAgICAgICAgICAgMQ0KPiA+ICsjZGVmaW5lIFBN
SUZfQ01EX0VYVF9SRUcgICAgICAgMg0KPiA+ICsjZGVmaW5lIFBNSUZfQ01EX0VYVF9SRUdfTE9O
RyAgMw0KPiA+ICsNCj4gPiArI2RlZmluZSBQTUlGX0RFTEFZX1VTICAgMTANCj4gPiArI2RlZmlu
ZSBQTUlGX1RJTUVPVVRfVVMgKDEwICogMTAwMCkNCj4gPiArDQo+ID4gKyNkZWZpbmUgUE1JRl9D
SEFOX09GRlNFVCAweDUNCj4gPiArDQo+ID4gKyNkZWZpbmUgUE1JRl9NQVhfQ0xLUyAgMw0KPiA+
ICsNCj4gPiArI2RlZmluZSBTUE1JX09QX1NUX0JVU1kgMQ0KPiA+ICsNCj4gPiArc3RydWN0IGNo
X3JlZyB7DQo+ID4gKyAgICAgICB1MzIgY2hfc3RhOw0KPiA+ICsgICAgICAgdTMyIHdkYXRhOw0K
PiA+ICsgICAgICAgdTMyIHJkYXRhOw0KPiA+ICsgICAgICAgdTMyIGNoX3NlbmQ7DQo+ID4gKyAg
ICAgICB1MzIgY2hfcmR5Ow0KPiA+ICt9Ow0KPiA+ICsNCj4gPiArc3RydWN0IHBtaWZfZGF0YSB7
DQo+ID4gKyAgICAgICBjb25zdCB1MzIgICAgICAgKnJlZ3M7DQo+ID4gKyAgICAgICBjb25zdCB1
MzIgICAgICAgKnNwbWltc3RfcmVnczsNCj4gPiArICAgICAgIHUzMiAgICAgc29jX2NoYW47DQo+
ID4gK307DQo+ID4gKw0KPiA+ICtzdHJ1Y3QgcG1pZiB7DQo+ID4gKyAgICAgICB2b2lkIF9faW9t
ZW0gICAgKmJhc2U7DQo+ID4gKyAgICAgICB2b2lkIF9faW9tZW0gICAgKnNwbWltc3RfYmFzZTsN
Cj4gPiArICAgICAgIHN0cnVjdCBjaF9yZWcgICBjaGFuOw0KPiA+ICsgICAgICAgc3RydWN0IGNs
a19idWxrX2RhdGEgY2xrc1tQTUlGX01BWF9DTEtTXTsNCj4gPiArICAgICAgIHUzMiBuY2xrczsN
Cj4gDQo+IHNpemVfdD8gU3VyZWx5IDMyLWJpdHMgaXNuJ3QgaW1wb3J0YW50Lg0KPiANCg0KVGhh
bmtzLiBJIHdpbGwgdXNlIHNpemVfdCBpbiB0aGUgbmV4dCBwYXRjaC4NCg0KPiA+ICsgICAgICAg
Y29uc3Qgc3RydWN0IHBtaWZfZGF0YSAqZGF0YTsNCj4gPiArfTsNCj4gPiArDQo+ID4gK3N0YXRp
YyBjb25zdCBjaGFyICogY29uc3QgcG1pZl9jbG9ja19uYW1lc1tdID0gew0KPiA+ICsgICAgICAg
InBtaWZfc3lzX2NrIiwgInBtaWZfdG1yX2NrIiwgInNwbWltc3RfY2xrX211eCIsDQo+ID4gK307
DQo+IFsuLi5dDQo+ID4gKw0KPiA+ICtzdGF0aWMgYm9vbCBwbWlmX2lzX2ZzbV92bGRjbHIoc3Ry
dWN0IHBtaWYgKmFyYikNCj4gPiArew0KPiA+ICsgICAgICAgdTMyIHJlZ19yZGF0YTsNCj4gPiAr
DQo+ID4gKyAgICAgICByZWdfcmRhdGEgPSBwbWlmX3JlYWRsKGFyYiwgYXJiLT5jaGFuLmNoX3N0
YSk7DQo+IA0KPiBOZXdsaW5lIGhlcmUgcGxlYXNlLg0KPiANCg0KVGhhbmtzLCBJIHdpbGwgdXBk
YXRlIGl0IGluIHRoZSBuZXh0IHBhdGNoLg0KDQo+ID4gKyAgICAgICByZXR1cm4gR0VUX1NXSU5G
KHJlZ19yZGF0YSkgPT0gU1dJTkZfV0ZWTERDTFI7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRp
YyBpbnQgcG1pZl9hcmJfY21kKHN0cnVjdCBzcG1pX2NvbnRyb2xsZXIgKmN0cmwsIHU4IG9wYywg
dTggc2lkKQ0KPiA+ICt7DQo+ID4gKyAgICAgICBzdHJ1Y3QgcG1pZiAqYXJiID0gc3BtaV9jb250
cm9sbGVyX2dldF9kcnZkYXRhKGN0cmwpOw0KPiA+ICsgICAgICAgdTMyIHJkYXRhLCBjbWQ7DQo+
ID4gKyAgICAgICBpbnQgcmV0Ow0KPiA+ICsNCj4gPiArICAgICAgIC8qIENoZWNrIHRoZSBvcGNv
ZGUgKi8NCj4gPiArICAgICAgIGlmIChvcGMgPCBTUE1JX0NNRF9SRVNFVCB8fCBvcGMgPiBTUE1J
X0NNRF9XQUtFVVApDQo+ID4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiA+ICsN
Cj4gPiArICAgICAgIGNtZCA9IG9wYyAtIFNQTUlfQ01EX1JFU0VUOw0KPiA+ICsNCj4gPiArICAg
ICAgIG10a19zcG1pX3dyaXRlbChhcmIsIChjbWQgPDwgMHg0KSB8IHNpZCwgU1BNSV9PUF9TVF9D
VFJMKTsNCj4gPiArICAgICAgIHJldCA9IHJlYWRsX3BvbGxfdGltZW91dF9hdG9taWMoYXJiLT5z
cG1pbXN0X2Jhc2UgKyBhcmItPmRhdGEtPnNwbWltc3RfcmVnc1tTUE1JX09QX1NUX1NUQV0sDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJkYXRhLCAocmRhdGEg
JiBTUE1JX09QX1NUX0JVU1kpID09IFNQTUlfT1BfU1RfQlVTWSwNCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgUE1JRl9ERUxBWV9VUywgUE1JRl9USU1FT1VUX1VT
KTsNCj4gPiArICAgICAgIGlmIChyZXQgPCAwKQ0KPiA+ICsgICAgICAgICAgICAgICBkZXZfZXJy
KCZjdHJsLT5kZXYsICJ0aW1lb3V0LCBlcnIgPSAlZFxuIiwgcmV0KTsNCj4gPiArDQo+ID4gKyAg
ICAgICByZXR1cm4gcmV0Ow0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IHBtaWZfc3Bt
aV9yZWFkX2NtZChzdHJ1Y3Qgc3BtaV9jb250cm9sbGVyICpjdHJsLCB1OCBvcGMsIHU4IHNpZCwN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MTYgYWRkciwgdTggKmJ1Ziwgc2l6
ZV90IGxlbikNCj4gPiArew0KPiA+ICsgICAgICAgc3RydWN0IHBtaWYgKmFyYiA9IHNwbWlfY29u
dHJvbGxlcl9nZXRfZHJ2ZGF0YShjdHJsKTsNCj4gPiArICAgICAgIHN0cnVjdCBjaF9yZWcgKmlu
Zl9yZWc7DQo+ID4gKyAgICAgICBpbnQgcmV0Ow0KPiA+ICsgICAgICAgdTMyIGRhdGEsIGNtZDsN
Cj4gPiArDQo+ID4gKyAgICAgICAvKiBDaGVjayBmb3IgYXJndW1lbnQgdmFsaWRhdGlvbi4gKi8N
Cj4gPiArICAgICAgIGlmIChzaWQgJiB+MHhmKSB7DQo+ID4gKyAgICAgICAgICAgICAgIGRldl9l
cnIoJmN0cmwtPmRldiwgImV4Y2VlZCB0aGUgbWF4IHNsdiBpZFxuIik7DQo+ID4gKyAgICAgICAg
ICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiA+ICsgICAgICAgfQ0KPiA+ICsNCj4gPiArICAgICAg
IGlmIChsZW4gPiA0KSB7DQo+ID4gKyAgICAgICAgICAgICAgIGRldl9lcnIoJmN0cmwtPmRldiwg
InBtaWYgc3VwcG9ydHMgMS4uNCBieXRlcyBwZXIgdHJhbnMsIGJ1dDolenUgcmVxdWVzdGVkIiwg
bGVuKTsNCj4gDQo+IE1pc3NpbmcgbmV3bGluZQ0KPiANCg0KVGhhbmtzLCBJIHdpbGwgdXBkYXRl
IGl0IGluIHRoZSBuZXh0IHBhdGNoLg0KDQo+ID4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlO
VkFMOw0KPiA+ICsgICAgICAgfQ0KPiA+ICsNCj4gPiArICAgICAgIGlmIChvcGMgPj0gMHg2MCAm
JiBvcGMgPD0gMHg3ZikNCj4gPiArICAgICAgICAgICAgICAgb3BjID0gUE1JRl9DTURfUkVHOw0K
PiA+ICsgICAgICAgZWxzZSBpZiAoKG9wYyA+PSAweDIwICYmIG9wYyA8PSAweDJmKSB8fCAob3Bj
ID49IDB4MzggJiYgb3BjIDw9IDB4M2YpKQ0KPiA+ICsgICAgICAgICAgICAgICBvcGMgPSBQTUlG
X0NNRF9FWFRfUkVHX0xPTkc7DQo+ID4gKyAgICAgICBlbHNlDQo+ID4gKyAgICAgICAgICAgICAg
IHJldHVybiAtRUlOVkFMOw0KPiA+ICsNCj4gPiArICAgICAgIC8qIFdhaXQgZm9yIFNvZnR3YXJl
IEludGVyZmFjZSBGU00gc3RhdGUgdG8gYmUgSURMRS4gKi8NCj4gPiArICAgICAgIGluZl9yZWcg
PSAmYXJiLT5jaGFuOw0KPiA+ICsgICAgICAgcmV0ID0gcmVhZGxfcG9sbF90aW1lb3V0X2F0b21p
YyhhcmItPmJhc2UgKyBhcmItPmRhdGEtPnJlZ3NbaW5mX3JlZy0+Y2hfc3RhXSwNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSwgR0VUX1NXSU5GKGRhdGEp
ID09IFNXSU5GX0lETEUsDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFBNSUZfREVMQVlfVVMsIFBNSUZfVElNRU9VVF9VUyk7DQo+ID4gKyAgICAgICBpZiAocmV0
IDwgMCkgew0KPiA+ICsgICAgICAgICAgICAgICAvKiBzZXQgY2hhbm5lbCByZWFkeSBpZiB0aGUg
ZGF0YSBoYXMgdHJhbnNmZXJyZWQgKi8NCj4gPiArICAgICAgICAgICAgICAgaWYgKHBtaWZfaXNf
ZnNtX3ZsZGNscihhcmIpKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHBtaWZfd3JpdGVs
KGFyYiwgMSwgaW5mX3JlZy0+Y2hfcmR5KTsNCj4gPiArICAgICAgICAgICAgICAgZGV2X2Vycigm
Y3RybC0+ZGV2LCAiZmFpbGVkIHRvIHdhaXQgZm9yIFNXSU5GX0lETEVcbiIpOw0KPiA+ICsgICAg
ICAgICAgICAgICBnb3RvIG91dDsNCj4gPiArICAgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgICAv
KiBTZW5kIHRoZSBjb21tYW5kLiAqLw0KPiA+ICsgICAgICAgY21kID0gKG9wYyA8PCAzMCkgfCAo
c2lkIDw8IDI0KSB8ICgobGVuIC0gMSkgPDwgMTYpIHwgYWRkcjsNCj4gPiArICAgICAgIHBtaWZf
d3JpdGVsKGFyYiwgY21kLCBpbmZfcmVnLT5jaF9zZW5kKTsNCj4gPiArDQo+ID4gKyAgICAgICAv
Kg0KPiA+ICsgICAgICAgICogV2FpdCBmb3IgU29mdHdhcmUgSW50ZXJmYWNlIEZTTSBzdGF0ZSB0
byBiZSBXRlZMRENMUiwNCj4gPiArICAgICAgICAqIHJlYWQgdGhlIGRhdGEgYW5kIGNsZWFyIHRo
ZSB2YWxpZCBmbGFnLg0KPiA+ICsgICAgICAgICovDQo+ID4gKyAgICAgICByZXQgPSByZWFkbF9w
b2xsX3RpbWVvdXRfYXRvbWljKGFyYi0+YmFzZSArIGFyYi0+ZGF0YS0+cmVnc1tpbmZfcmVnLT5j
aF9zdGFdLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRh
LCBHRVRfU1dJTkYoZGF0YSkgPT0gU1dJTkZfV0ZWTERDTFIsDQo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFBNSUZfREVMQVlfVVMsIFBNSUZfVElNRU9VVF9VUyk7
DQo+ID4gKyAgICAgICBpZiAocmV0IDwgMCkgew0KPiA+ICsgICAgICAgICAgICAgICBkZXZfZXJy
KCZjdHJsLT5kZXYsICJmYWlsZWQgdG8gd2FpdCBmb3IgU1dJTkZfV0ZWTERDTFJcbiIpOw0KPiA+
ICsgICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiArICAgICAgIH0NCj4gPiArDQo+ID4gKyAg
ICAgICBkYXRhID0gcG1pZl9yZWFkbChhcmIsIGluZl9yZWctPnJkYXRhKTsNCj4gPiArICAgICAg
IG1lbWNweShidWYsICZkYXRhLCBsZW4pOw0KPiA+ICsgICAgICAgcG1pZl93cml0ZWwoYXJiLCAx
LCBpbmZfcmVnLT5jaF9yZHkpOw0KPiA+ICsNCj4gPiArb3V0Og0KPiA+ICsgICAgICAgaWYgKHJl
dCA8IDApDQo+ID4gKyAgICAgICAgICAgICAgIHJldHVybiByZXQ7DQo+ID4gKw0KPiA+ICsgICAg
ICAgcmV0dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgcG1pZl9zcG1pX3dy
aXRlX2NtZChzdHJ1Y3Qgc3BtaV9jb250cm9sbGVyICpjdHJsLCB1OCBvcGMsIHU4IHNpZCwNCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTE2IGFkZHIsIGNvbnN0IHU4ICpidWYs
IHNpemVfdCBsZW4pDQo+ID4gK3sNCj4gPiArICAgICAgIHN0cnVjdCBwbWlmICphcmIgPSBzcG1p
X2NvbnRyb2xsZXJfZ2V0X2RydmRhdGEoY3RybCk7DQo+ID4gKyAgICAgICBzdHJ1Y3QgY2hfcmVn
ICppbmZfcmVnOw0KPiA+ICsgICAgICAgaW50IHJldDsNCj4gPiArICAgICAgIHUzMiBkYXRhLCBj
bWQ7DQo+ID4gKw0KPiA+ICsgICAgICAgaWYgKGxlbiA+IDQpIHsNCj4gPiArICAgICAgICAgICAg
ICAgZGV2X2VycigmY3RybC0+ZGV2LCAicG1pZiBzdXBwb3J0cyAxLi40IGJ5dGVzIHBlciB0cmFu
cywgYnV0OiV6dSByZXF1ZXN0ZWQiLCBsZW4pOw0KPiANCj4gTWlzc2luZyBuZXdsaW5lDQo+IA0K
DQpUaGFua3MsIEkgd2lsbCB1cGRhdGUgaXQgaW4gdGhlIG5leHQgcGF0Y2guDQoNCj4gPiArICAg
ICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ID4gKyAgICAgICB9DQo+ID4gKw0KPiA+ICsg
ICAgICAgLyogQ2hlY2sgdGhlIG9wY29kZSAqLw0KPiA+ICsgICAgICAgaWYgKG9wYyA+PSAweDQw
ICYmIG9wYyA8PSAweDVGKQ0KPiA+ICsgICAgICAgICAgICAgICBvcGMgPSBQTUlGX0NNRF9SRUc7
DQo+ID4gKyAgICAgICBlbHNlIGlmICgob3BjIDw9IDB4RikgfHwgKG9wYyA+PSAweDMwICYmIG9w
YyA8PSAweDM3KSkNCj4gPiArICAgICAgICAgICAgICAgb3BjID0gUE1JRl9DTURfRVhUX1JFR19M
T05HOw0KPiA+ICsgICAgICAgZWxzZSBpZiAob3BjID49IDB4ODApDQo+ID4gKyAgICAgICAgICAg
ICAgIG9wYyA9IFBNSUZfQ01EX1JFR18wOw0KPiA+ICsgICAgICAgZWxzZQ0KPiA+ICsgICAgICAg
ICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gPiArDQo+ID4gKyAgICAgICAvKiBXYWl0IGZvciBT
b2Z0d2FyZSBJbnRlcmZhY2UgRlNNIHN0YXRlIHRvIGJlIElETEUuICovDQo+ID4gKyAgICAgICBp
bmZfcmVnID0gJmFyYi0+Y2hhbjsNCj4gPiArICAgICAgIHJldCA9IHJlYWRsX3BvbGxfdGltZW91
dF9hdG9taWMoYXJiLT5iYXNlICsgYXJiLT5kYXRhLT5yZWdzW2luZl9yZWctPmNoX3N0YV0sDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEsIEdFVF9TV0lO
RihkYXRhKSA9PSBTV0lORl9JRExFLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBQTUlGX0RFTEFZX1VTLCBQTUlGX1RJTUVPVVRfVVMpOw0KPiA+ICsgICAgICAg
aWYgKHJldCA8IDApIHsNCj4gPiArICAgICAgICAgICAgICAgLyogc2V0IGNoYW5uZWwgcmVhZHkg
aWYgdGhlIGRhdGEgaGFzIHRyYW5zZmVycmVkICovDQo+ID4gKyAgICAgICAgICAgICAgIGlmIChw
bWlmX2lzX2ZzbV92bGRjbHIoYXJiKSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICBwbWlm
X3dyaXRlbChhcmIsIDEsIGluZl9yZWctPmNoX3JkeSk7DQo+ID4gKyAgICAgICAgICAgICAgIGRl
dl9lcnIoJmN0cmwtPmRldiwgImZhaWxlZCB0byB3YWl0IGZvciBTV0lORl9JRExFXG4iKTsNCj4g
PiArICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAgICB9DQo+ID4gKw0KPiA+ICsg
ICAgICAgLyogU2V0IHRoZSB3cml0ZSBkYXRhLiAqLw0KPiA+ICsgICAgICAgbWVtY3B5KCZkYXRh
LCBidWYsIGxlbik7DQo+ID4gKyAgICAgICBwbWlmX3dyaXRlbChhcmIsIGRhdGEsIGluZl9yZWct
PndkYXRhKTsNCj4gPiArDQo+ID4gKyAgICAgICAvKiBTZW5kIHRoZSBjb21tYW5kLiAqLw0KPiA+
ICsgICAgICAgY21kID0gKG9wYyA8PCAzMCkgfCBCSVQoMjkpIHwgKHNpZCA8PCAyNCkgfCAoKGxl
biAtIDEpIDw8IDE2KSB8IGFkZHI7DQo+ID4gKyAgICAgICBwbWlmX3dyaXRlbChhcmIsIGNtZCwg
aW5mX3JlZy0+Y2hfc2VuZCk7DQo+ID4gKw0KPiA+ICtvdXQ6DQo+ID4gKyAgICAgICBpZiAocmV0
IDwgMCkNCj4gPiArICAgICAgICAgICAgICAgcmV0dXJuIHJldDsNCj4gPiArDQo+ID4gKyAgICAg
ICByZXR1cm4gMDsNCj4gDQo+IFNpbXBsaWZ5IHRvIA0KPiANCj4gCW91dDoNCj4gCQlyZXR1cm4g
cmV0Ow0KPiANCg0KVGhhbmtzLCBJIHdpbGwgdXBkYXRlIGl0IGluIHRoZSBuZXh0IHBhdGNoLg0K
DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgcG1pZl9kYXRhIG10Njg3
M19wbWlmX2FyYiA9IHsNCj4gPiArICAgICAgIC5yZWdzID0gbXQ2ODczX3JlZ3MsDQo+ID4gKyAg
ICAgICAuc3BtaW1zdF9yZWdzID0gbXQ2ODczX3NwbWlfcmVncywNCj4gPiArICAgICAgIC5zb2Nf
Y2hhbiA9IDIsDQo+ID4gK307DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IG10a19zcG1pX3Byb2Jl
KHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpDQo+ID4gK3sNCj4gPiArICAgICAgIHN0cnVj
dCBwbWlmICphcmI7DQo+ID4gKyAgICAgICBzdHJ1Y3Qgc3BtaV9jb250cm9sbGVyICpjdHJsOw0K
PiA+ICsgICAgICAgaW50IGVyciwgaTsNCj4gPiArICAgICAgIHUzMiBjaGFuX29mZnNldDsNCj4g
PiArDQo+ID4gKyAgICAgICBjdHJsID0gc3BtaV9jb250cm9sbGVyX2FsbG9jKCZwZGV2LT5kZXYs
IHNpemVvZigqYXJiKSk7DQo+ID4gKyAgICAgICBpZiAoIWN0cmwpDQo+ID4gKyAgICAgICAgICAg
ICAgIHJldHVybiAtRU5PTUVNOw0KPiA+ICsNCj4gPiArICAgICAgIGFyYiA9IHNwbWlfY29udHJv
bGxlcl9nZXRfZHJ2ZGF0YShjdHJsKTsNCj4gPiArICAgICAgIGFyYi0+ZGF0YSA9IG9mX2Rldmlj
ZV9nZXRfbWF0Y2hfZGF0YSgmcGRldi0+ZGV2KTsNCj4gDQo+IFVzZSBkZXZpY2VfZ2V0X21hdGNo
X2RhdGEoKSBpbnN0ZWFkIHBsZWFzZS4NCj4gDQoNClRoYW5rcywgSSB3aWxsIGNoYW5nZSB0byB1
c2UgZGV2aWNlX2dldF9tYXRjaF9kYXRhIGluIHRoZSBuZXh0IHBhdGNoLg0KDQo+ID4gKyAgICAg
ICBpZiAoIWFyYi0+ZGF0YSkgew0KPiA+ICsgICAgICAgICAgICAgICBlcnIgPSAtRUlOVkFMOw0K
PiA+ICsgICAgICAgICAgICAgICBkZXZfZXJyKCZwZGV2LT5kZXYsICJDYW5ub3QgZ2V0IGRydl9k
YXRhXG4iKTsNCj4gPiArICAgICAgICAgICAgICAgZ290byBlcnJfcHV0X2N0cmw7DQo+ID4gKyAg
ICAgICB9DQo+ID4gKw0KPiA+ICsgICAgICAgYXJiLT5iYXNlID0gZGV2bV9wbGF0Zm9ybV9pb3Jl
bWFwX3Jlc291cmNlX2J5bmFtZShwZGV2LCAicG1pZiIpOw0KPiA+ICsgICAgICAgaWYgKElTX0VS
UihhcmItPmJhc2UpKSB7DQo+ID4gKyAgICAgICAgICAgICAgIGVyciA9IFBUUl9FUlIoYXJiLT5i
YXNlKTsNCj4gPiArICAgICAgICAgICAgICAgZGV2X2VycigmcGRldi0+ZGV2LCAicG1pZiBmYWls
ZWQgdG8gZ2V0IHRoZSByZW1hcHBwZWQgbWVtb3J5XG4iKTsNCj4gDQo+IFBsZWFzZSBkcm9wIHBy
aW50IGFzIHRoZSBBUEkgYWxyZWFkeSBwcmludHMgZXJyb3JzIGZvciBldmVyeSBwcm9ibGVtLg0K
PiANCg0KVGhhbmtzLCBJIHdpbGwgdXBkYXRlIGl0IGluIHRoZSBuZXh0IHBhdGNoLg0KDQo+ID4g
KyAgICAgICAgICAgICAgIGdvdG8gZXJyX3B1dF9jdHJsOw0KPiA+ICsgICAgICAgfQ0KPiA+ICsN
Cj4gPiArICAgICAgIGFyYi0+c3BtaW1zdF9iYXNlID0gZGV2bV9wbGF0Zm9ybV9pb3JlbWFwX3Jl
c291cmNlX2J5bmFtZShwZGV2LCAic3BtaW1zdCIpOw0KPiA+ICsgICAgICAgaWYgKElTX0VSUihh
cmItPnNwbWltc3RfYmFzZSkpIHsNCj4gPiArICAgICAgICAgICAgICAgZXJyID0gUFRSX0VSUihh
cmItPnNwbWltc3RfYmFzZSk7DQo+ID4gKyAgICAgICAgICAgICAgIGRldl9lcnIoJnBkZXYtPmRl
diwgInNwbWltc3QgZmFpbGVkIHRvIGdldCB0aGUgcmVtYXBwcGVkIG1lbW9yeVxuIik7DQo+IA0K
PiBQbGVhc2UgZHJvcCBwcmludCBhcyB0aGUgQVBJIGFscmVhZHkgcHJpbnRzIGVycm9ycyBmb3Ig
ZXZlcnkgcHJvYmxlbS4NCj4gDQoNClRoYW5rcywgSSB3aWxsIHVwZGF0ZSBpdCBpbiB0aGUgbmV4
dCBwYXRjaC4NCg0KPiA+ICsgICAgICAgICAgICAgICBnb3RvIGVycl9wdXRfY3RybDsNCj4gPiAr
ICAgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgICBhcmItPm5jbGtzID0gQVJSQVlfU0laRShwbWlm
X2Nsb2NrX25hbWVzKTsNCj4gPiArICAgICAgIGlmIChhcmItPm5jbGtzID4gUE1JRl9NQVhfQ0xL
Uykgew0KPiA+ICsgICAgICAgICAgICAgICBlcnIgPSAtRUlOVkFMOw0KPiA+ICsgICAgICAgICAg
ICAgICBkZXZfZXJyKCZwZGV2LT5kZXYsICJleGNlZWQgdGhlIG1heCBjbG9jayBudW1iZXJzXG4i
KTsNCj4gDQo+IERvIHdlIHJlYWxseSBjYXJlPyBUaGUgZHQgc2NoZW1hIHNob3VsZCBiZSBjaGVj
a2luZyB0aGlzIGluc3RlYWQgb2YgdGhlDQo+IGRyaXZlci4NCj4gDQoNClRoYW5rcywgSSB3aWxs
IHJlbW92ZSB0aGUgY2hlY2sgaW4gdGhlIG5leHQgcGF0Y2guDQoNCj4gPiArICAgICAgICAgICAg
ICAgZ290byBlcnJfcHV0X2N0cmw7DQo+ID4gKyAgICAgICB9DQo+ID4gKw0KPiA+ICsgICAgICAg
Zm9yIChpID0gMDsgaSA8IGFyYi0+bmNsa3M7IGkrKykNCj4gPiArICAgICAgICAgICAgICAgYXJi
LT5jbGtzW2ldLmlkID0gcG1pZl9jbG9ja19uYW1lc1tpXTsNCj4gPiArDQoNCg==

