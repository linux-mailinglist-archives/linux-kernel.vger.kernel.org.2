Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id AA0364087A8
	for <lists+linux-kernel@lfdr.de>; Mon, 13 Sep 2021 10:57:42 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S238326AbhIMI6x (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Mon, 13 Sep 2021 04:58:53 -0400
Received: from szxga02-in.huawei.com ([45.249.212.188]:9422 "EHLO
        szxga02-in.huawei.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S238275AbhIMI6v (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Mon, 13 Sep 2021 04:58:51 -0400
Received: from dggeme762-chm.china.huawei.com (unknown [172.30.72.53])
        by szxga02-in.huawei.com (SkyGuard) with ESMTP id 4H7Kxx3wWLz8ySk;
        Mon, 13 Sep 2021 16:53:09 +0800 (CST)
Received: from dggeme759-chm.china.huawei.com (10.3.19.105) by
 dggeme762-chm.china.huawei.com (10.3.19.108) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id
 15.1.2308.8; Mon, 13 Sep 2021 16:57:34 +0800
Received: from dggeme759-chm.china.huawei.com ([10.8.81.151]) by
 dggeme759-chm.china.huawei.com ([10.8.81.151]) with mapi id 15.01.2308.008;
 Mon, 13 Sep 2021 16:57:34 +0800
From:   weizhenliang <weizhenliang@huawei.com>
To:     Andrew Morton <akpm@linux-foundation.org>
CC:     "tangbin@cmss.chinamobile.com" <tangbin@cmss.chinamobile.com>,
        "zhangshengju@cmss.chinamobile.com" 
        <zhangshengju@cmss.chinamobile.com>,
        "linux-mm@kvack.org" <linux-mm@kvack.org>,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
        Nixiaoming <nixiaoming@huawei.com>,
        "Xiaoqian (xiaoqian, RTOS FAE)" <xiaoqian9@huawei.com>
Subject: =?gb2312?B?tPC4tDogW1BBVENIXSB0b29scy92bS9wYWdlX293bmVyX3NvcnQuYzogY291?=
 =?gb2312?Q?nt_and_sort_by_mem?=
Thread-Topic: [PATCH] tools/vm/page_owner_sort.c: count and sort by mem
Thread-Index: AQHXpfB+f0OYJ3BhKEyklvTUrbLdJKue5dEAgALIGWA=
Date:   Mon, 13 Sep 2021 08:57:33 +0000
Message-ID: <7912a2a7dc5544509d96541dad2dde06@huawei.com>
References: <1631243023-47849-1-git-send-email-weizhenliang@huawei.com>
 <20210911152520.45d6e3ed690b652a4d49a1c0@linux-foundation.org>
In-Reply-To: <20210911152520.45d6e3ed690b652a4d49a1c0@linux-foundation.org>
Accept-Language: en-US
Content-Language: zh-CN
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [10.67.101.97]
Content-Type: text/plain; charset="gb2312"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-CFilter-Loop: Reflected
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

T24gRnJpLCAxMiBTZXAgMjAyMSBBbmRyZXcgTW9ydG9uIHdyb3RlOg0KDQo+T24gRnJpLCAxMCBT
ZXAgMjAyMSAxMTowMzo0MyArMDgwMCBaaGVubGlhbmcgV2VpIDx3ZWl6aGVubGlhbmdAaHVhd2Vp
LmNvbT4gd3JvdGU6DQo+DQo+PiBXaGVuIHZpZXdpbmcgcGFnZSBvd25lciBpbmZvcm1hdGlvbiwg
d2UgbWF5IGJlIG1vcmUgY29uY2VybmVkIGFib3V0IA0KPj4gdGhlIHRvdGFsIG1lbW9yeSB0aGFu
IHRoZSBudW1iZXIgb2Ygc3RhY2sgb2NjdXJyZW5jZXMuIFRoZXJlZm9yZSwgdGhlIA0KPj4gZm9s
bG93aW5nIGFkanVzdG1lbnRzIGFyZSBtYWRlOg0KPj4gMS4gQWRkZWQgdGhlIHN0YXRpc3RpY3Mg
b24gdGhlIHRvdGFsIG51bWJlciBvZiBwYWdlcy4NCj4+IDIuIEFkZGVkIHRoZSBvcHRpb25hbCBw
YXJhbWV0ZXIgIi1tIiB0byBjb25maWd1cmUgdGhlIHByb2dyYW0gdG8gc29ydCBieQ0KPj4gICAg
bWVtb3J5ICh0b3RhbCBwYWdlcykuDQo+PiANCj4NCj5XaHkgZG9lcyBpdCBhZGQgcmVnZXhwIG1h
dGNoaW5nIHRvIGFkZF9saXN0KCk/ICBQcmVzdW1hYmx5IHRoaXMgaXMgc29tZSANCj5lbmhhbmNl
bWVudCB0byB0aGUgdXNlciBpbnRlcmZhY2Ugd2hpY2ggSSBjYW5ub3Qgc2VlIGRvY3VtZW50ZWQg
aW4gdGhlIA0KPmNoYW5nZWxvZyBvciB0aGUgY29kZSBjb21tZW50cywNCj4NCj5DYW4gd2UgcGxl
YXNlIGFkZC9tYWludGFpbiBhIGZ1bGwgZGVzY3JpcHRpb24gb2YgdGhlIHVzZXIgaW50ZXJmYWNl
IGluLCBJIGd1ZXNzLCBEb2N1bWVudGF0aW9uL3ZtL3BhZ2Vfb3duZXIucnN0Pw0KDQpUaGFua3Mg
Zm9yIHJldmlld2luZywgSSBkaWQgb21pdCB0aGUgZG9jdW1lbnRhdGlvbiBwYXJ0LCBJIHdpbGwg
aW1wcm92ZSBnaXQgbXNnIGFuZCBwYWdlX293bmVyLnJzdCBsYXRlci4NCg0KVGhlIGdlbmVyYWwg
b3V0cHV0IG9mIHBhZ2Vfb3duZXIgaXMgYXMgZm9sbG93czoNCg0KCQlQYWdlIGFsbG9jYXRlZCB2
aWEgb3JkZXIgWFhYLCAuLi4NCgkJUEZOIFhYWCAuLi4NCgkJIC8vIERldGFpbGVkIHN0YWNrDQoN
CgkJUGFnZSBhbGxvY2F0ZWQgdmlhIG9yZGVyIFhYWCwgLi4uDQoJCVBGTiBYWFggLi4uDQoJCSAv
LyBEZXRhaWxlZCBzdGFjaw0KDQpUaGUgb3JpZ2luYWwgcGFnZV9vd25lcl9zb3J0IHRvb2wgaWdu
b3JlcyBQRk4gcm93cywgcHV0cyB0aGUgcmVtYWluaW5nIHJvd3MgaW4gYnVmLCBjb3VudHMgdGhl
IHRpbWVzIG9mIGJ1ZiwgYW5kIGZpbmFsbHkgc29ydHMgdGhlbSBhY2NvcmRpbmcgdG8gdGhlIHRp
bWVzLg0KR2VuZXJhbCBvdXRwdXQ6DQoNCgkJWFhYIHRpbWVzOg0KCQlQYWdlIGFsbG9jYXRlZCB2
aWEgb3JkZXIgWFhYLCAuLi4NCgkJIC8vIERldGFpbGVkIHN0YWNrDQoNCk5vdywgd2UgdXNlIHJl
Z2V4cCB0byBleHRyYWN0IHRoZSBwYWdlIG9yZGVyIHZhbHVlIGZyb20gdGhlIGJ1ZiwgYW5kIGNv
dW50IHRoZSB0b3RhbCBwYWdlcyBmb3IgdGhlIGJ1Zi4NCkdlbmVyYWwgb3V0cHV0Og0KDQoJCVhY
WCB0aW1lcywgWFhYIHBhZ2VzOg0KCQlQYWdlIGFsbG9jYXRlZCB2aWEgb3JkZXIgWFhYLCAuLi4N
CgkJIC8vIERldGFpbGVkIHN0YWNrDQoNCkJ5IGRlZmF1bHQsIGl0IGlzIHN0aWxsIHNvcnRlZCBi
eSB0aGUgdGltZXMgb2YgYnVmOyBJZiB3ZSB3YW50IHRvIHNvcnQgYnkgdGhlIHBhZ2VzIG51bXMg
b2YgYnVmLCB1c2UgdGhlIG5ldyAtbSBwYXJhbWV0ZXIuDQoNCj4+IEBAIC01OSwxMiArNjUsNTAg
QEAgc3RhdGljIGludCBjb21wYXJlX251bShjb25zdCB2b2lkICpwMSwgY29uc3Qgdm9pZCAqcDIp
DQo+PiAgCXJldHVybiBsMi0+bnVtIC0gbDEtPm51bTsNCj4+ICB9DQo+PiAgDQo+PiArc3RhdGlj
IGludCBjb21wYXJlX3BhZ2VfbnVtKGNvbnN0IHZvaWQgKnAxLCBjb25zdCB2b2lkICpwMikgew0K
Pj4gKwljb25zdCBzdHJ1Y3QgYmxvY2tfbGlzdCAqbDEgPSBwMSwgKmwyID0gcDI7DQo+PiArDQo+
PiArCXJldHVybiBsMi0+cGFnZV9udW0gLSBsMS0+cGFnZV9udW07IH0NCj4+ICsNCj4+ICtzdGF0
aWMgaW50IGdldF9wYWdlX251bShjaGFyICpidWYpDQo+PiArew0KPj4gKwlpbnQgZXJyLCB2YWxf
bGVuLCBvcmRlcl92YWw7DQo+PiArCWNoYXIgb3JkZXJfc3RyWzRdID0gezB9Ow0KPj4gKwljaGFy
ICplbmRwdHI7DQo+PiArCXJlZ21hdGNoX3QgcG1hdGNoWzJdOw0KPj4gKw0KPj4gKwllcnIgPSBy
ZWdleGVjKCZvcmRlcl9wYXR0ZXJuLCBidWYsIDIsIHBtYXRjaCwgUkVHX05PVEJPTCk7DQo+PiAr
CWlmIChlcnIgIT0gMCB8fCBwbWF0Y2hbMV0ucm1fc28gPT0gLTEpIHsNCj4+ICsJCXByaW50Zigi
bm8gb3JkZXIgcGF0dGVybiBpbiAlc1xuIiwgYnVmKTsNCj4NCj5TaG91bGRuJ3QgZXJyb3IgbWVz
c2FnZXMgbm9ybWFsbHkgYmUgZGlyZWN0ZWQgdG8gc3RkZXJyPyAgV2UgYXJlbid0IHZlcnkgY29u
c2lzdGVudCBhYm91dCB0aGlzIGJ1dCBpdCB3YXMgdGhlIGFjY2VwdGVkIHRoaW5nIHRvIGRvIDIw
LTMwIHllYXJzIGFnbywgbG9sLg0KDQpPbiB0aGlzIHBvaW50LCBpdCBkb2VzIG5vdCBhZmZlY3Qg
dGhlIHVzZSBvZiB0aGUgdG9vbC4gUGVyc29uYWxseSwgSSBwcmVmZXIgdG8gcmV0YWluIHRoZSBv
cmlnaW5hbCBjb2Rpbmcgc3R5bGUgb2YgdGhlIHRvb2wuIElzIHRoaXMgb2s/IGxvbA0KDQo+PiAr
CQlyZXR1cm4gMDsNCj4+ICsJfQ0KPj4gKwl2YWxfbGVuID0gcG1hdGNoWzFdLnJtX2VvIC0gcG1h
dGNoWzFdLnJtX3NvOw0KPj4gKwlpZiAodmFsX2xlbiA+IDIpIC8qIG1heF9vcmRlciBzaG91bGQg
bm90IGV4Y2VlZCAyIGRpZ2l0cyAqLw0KPj4gKwkJZ290byB3cm9uZ19vcmRlcjsNCj4+ICsNCj4+
ICsJbWVtY3B5KG9yZGVyX3N0ciwgYnVmICsgcG1hdGNoWzFdLnJtX3NvLCB2YWxfbGVuKTsNCj4+
ICsNCj4+ICsJZXJybm8gPSAwOw0KPj4gKwlvcmRlcl92YWwgPSBzdHJ0b2wob3JkZXJfc3RyLCAm
ZW5kcHRyLCAxMCk7DQo+PiArCWlmIChlcnJubyAhPSAwIHx8IGVuZHB0ciA9PSBvcmRlcl9zdHIg
fHwgKmVuZHB0ciAhPSAnXDAnKQ0KPj4gKwkJZ290byB3cm9uZ19vcmRlcjsNCj4+ICsNCj4+ICsJ
cmV0dXJuIDEgPDwgb3JkZXJfdmFsOw0KPj4gKw0KPj4gK3dyb25nX29yZGVyOg0KPj4gKwlwcmlu
dGYoIndyb25nIG9yZGVyIGluIGZvbGxvdyBidWY6XG4lc1xuIiwgYnVmKTsNCj4+ICsJcmV0dXJu
IDA7DQo+PiArfQ0KPj4gKw0KPj4gIHN0YXRpYyB2b2lkIGFkZF9saXN0KGNoYXIgKmJ1ZiwgaW50
IGxlbikgIHsNCj4+ICAJaWYgKGxpc3Rfc2l6ZSAhPSAwICYmDQo+PiAgCSAgICBsZW4gPT0gbGlz
dFtsaXN0X3NpemUtMV0ubGVuICYmDQo+PiAgCSAgICBtZW1jbXAoYnVmLCBsaXN0W2xpc3Rfc2l6
ZS0xXS50eHQsIGxlbikgPT0gMCkgew0KPj4gIAkJbGlzdFtsaXN0X3NpemUtMV0ubnVtKys7DQo+
PiArCQlsaXN0W2xpc3Rfc2l6ZS0xXS5wYWdlX251bSArPSBnZXRfcGFnZV9udW0oYnVmKTsNCj4+
ICAJCXJldHVybjsNCj4+ICAJfQ0KPj4gIAlpZiAobGlzdF9zaXplID09IG1heF9zaXplKSB7DQo+
PiBAQCAtNzQsNiArMTE4LDcgQEAgc3RhdGljIHZvaWQgYWRkX2xpc3QoY2hhciAqYnVmLCBpbnQg
bGVuKQ0KPj4gIAlsaXN0W2xpc3Rfc2l6ZV0udHh0ID0gbWFsbG9jKGxlbisxKTsNCj4+ICAJbGlz
dFtsaXN0X3NpemVdLmxlbiA9IGxlbjsNCj4+ICAJbGlzdFtsaXN0X3NpemVdLm51bSA9IDE7DQo+
PiArCWxpc3RbbGlzdF9zaXplXS5wYWdlX251bSA9IGdldF9wYWdlX251bShidWYpOw0KPj4gIAlt
ZW1jcHkobGlzdFtsaXN0X3NpemVdLnR4dCwgYnVmLCBsZW4pOw0KPj4gIAlsaXN0W2xpc3Rfc2l6
ZV0udHh0W2xlbl0gPSAwOw0KPj4gIAlsaXN0X3NpemUrKzsNCj4+IEBAIC04NSw2ICsxMzAsMTMg
QEAgc3RhdGljIHZvaWQgYWRkX2xpc3QoY2hhciAqYnVmLCBpbnQgbGVuKQ0KPj4gIA0KPj4gICNk
ZWZpbmUgQlVGX1NJWkUJKDEyOCAqIDEwMjQpDQo+PiAgDQo+PiArc3RhdGljIHZvaWQgdXNhZ2Uo
dm9pZCkNCj4+ICt7DQo+PiArCXByaW50ZigiVXNhZ2U6IC4vcGFnZV9vd25lcl9zb3J0IFstbV0g
PGlucHV0PiA8b3V0cHV0PlxuIg0KPj4gKwkJIi1tCVNvcnQgYnkgdG90YWwgbWVtb3J5LiBJZiBu
b3Qgc2V0IHRoaXMgb3B0aW9uLCBzb3J0IGJ5IHRpbWVzXG4iDQo+DQo+cy9JZiBub3Qgc2V0IHRo
aXMgb3B0aW9uL0lmIHRoaXMgb3B0aW9uIGlzIHVuc2V0Lw0KDQpPa2F5LCB0aGFuayB5b3UsIEkg
d2lsbCBhZGp1c3QgdGhlIFVzYWdlIGRlc2NyaXB0aW9uIGxhdGVyDQoNCkFuZCBhbnkgb3RoZXIg
c3VnZ2VzdGlvbnMgYWJvdXQgdGhlIHBhdGNoPw0KDQpXZWkuDQo=
